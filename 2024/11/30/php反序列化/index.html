

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="chaye">
  <meta name="keywords" content="">
  
    <meta name="description" content="PHP常见的命令执行函数与代码执行函数PHP执行系统外部命令函数:exec()、passthru()、system()、shell_exec()php提供4种方法执行系统外部命令：exec()、passthru()、system()、 shell_exec()。在开始介绍前，先检查下php配置文件php.ini中是有禁止这是个函数。找到 disable_functions，配置如下： 1disab">
<meta property="og:type" content="article">
<meta property="og:title" content="php反序列化漏洞">
<meta property="og:url" content="http://example.com/2024/11/30/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/index.html">
<meta property="og:site_name" content="chaye的博客">
<meta property="og:description" content="PHP常见的命令执行函数与代码执行函数PHP执行系统外部命令函数:exec()、passthru()、system()、shell_exec()php提供4种方法执行系统外部命令：exec()、passthru()、system()、 shell_exec()。在开始介绍前，先检查下php配置文件php.ini中是有禁止这是个函数。找到 disable_functions，配置如下： 1disab">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099140612-b10fc269-3ebb-425c-a1bc-fc1f62121557.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099185243-22c9f681-b1d5-4bb2-8a76-ba008d940c33.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099258604-f5d4a5bc-7e6f-485f-a6aa-bc3e3ffa8cf0.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721096788442-887f41e4-e4b1-44bd-b3f7-7471c6d1f44f.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721097117032-d57dda34-ea71-41c1-a4fb-21576df6f33f.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721097577133-43135873-64d6-49a9-b015-6cb865e76ce5.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721097881417-097e8727-4962-49dc-a4bd-537b76d00aaf.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099370686-a349c132-93f3-4b43-b359-beb702a35d2f.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099381880-869f8a70-2ea9-4bc7-91bc-a6be18ff646f.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099418494-94cf7196-efee-4868-bb44-2ec872791c2e.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099473622-dbf1f2e2-80a2-4093-a74e-9aaf1651f65b.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721100835442-20a31da3-353b-44e9-9aa0-3f8e0b84f12a.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721101253506-21c27b83-c6cd-467d-aafa-314b0b26d7b4.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/42988179/1721107899794-ad4930fe-4802-46fd-945a-8c8e6a7d8265.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721109043464-2e10cc3f-6ff5-4ab4-9687-210eb511456c.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721109073501-6eda0e5d-0ad0-4d0d-afdc-2f0aad8638d2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721109089298-337f83b6-8488-4a65-b171-6268353b77dd.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721110034654-349d0584-1c85-4403-90ae-27039d61410e.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1722078779888-3a0c04ec-3a3c-4802-88aa-0790304ae0eb.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1722079596346-2ecb91b4-2cfd-4240-a902-549b3b75b30f.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1726712425114-c49d122f-93eb-43e7-8f38-8bb304d6cc23.png">
<meta property="article:published_time" content="2024-11-30T05:42:45.000Z">
<meta property="article:modified_time" content="2025-03-29T07:48:57.344Z">
<meta property="article:author" content="chaye">
<meta property="article:tag" content="WEB">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099140612-b10fc269-3ebb-425c-a1bc-fc1f62121557.png">
  
  
  
  <title>php反序列化漏洞 - chaye的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>chaye</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="php反序列化漏洞"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-11-30 13:42" pubdate>
          November 30, 2024 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.5k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          38 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">php反序列化漏洞</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="PHP常见的命令执行函数与代码执行函数"><a href="#PHP常见的命令执行函数与代码执行函数" class="headerlink" title="PHP常见的命令执行函数与代码执行函数"></a>PHP常见的命令执行函数与代码执行函数</h1><h1 id="PHP执行系统外部命令函数-exec-、passthru-、system-、shell-exec"><a href="#PHP执行系统外部命令函数-exec-、passthru-、system-、shell-exec" class="headerlink" title="PHP执行系统外部命令函数:exec()、passthru()、system()、shell_exec()"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaohj/p/3267692.html">PHP执行系统外部命令函数:exec()、passthru()、system()、shell_exec()</a></h1><p>php提供4种方法执行系统外部命令：exec()、passthru()、system()、 shell_exec()。<br>在开始介绍前，先检查下php配置文件php.ini中是有禁止这是个函数。找到 disable_functions，配置如下：</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">disable_functions <span class="hljs-operator">=</span><br></code></pre></td></tr></table></figure>

<p>如果“disable_functions&#x3D;”后面有接上面四个函数，将其删除。<br>默认php.ini配置文件中是不禁止你调用执行外部命令的函数的。</p>
<h2 id="方法一：exec"><a href="#方法一：exec" class="headerlink" title="方法一：exec()"></a>方法一：exec()</h2><p>function exec(string $command,array[optional] $output,int[optional] $return_value)</p>
<p>php代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;ls&quot;</span>,<span class="hljs-variable">$file</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>        <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$file</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">test<span class="hljs-selector-class">.php</span><br><span class="hljs-function"><span class="hljs-title">Array</span><span class="hljs-params">( [<span class="hljs-number">0</span>] =&gt; index.php [<span class="hljs-number">1</span>] =&gt; test.php)</span></span><br></code></pre></td></tr></table></figure>

<p>知识点：<br>exec 执行系统外部命令时不会输出结果，而是返回结果的最后一行，如果你想得到结果你可以使用第二个参数，让其输出到指定的数组，此数组一个记录代表输出的一行，即如果输出结果有20行，则这个数组就有20条记录，所以如果你需要反复输出调用不同系统外部命令的结果，你最好在输出每一条系统外部命令结果时清空这个数组，以防混乱。第三个参数用来取得命令执行的状态码，通常执行成功都是返回０。</p>
<h2 id="方法二：passthru"><a href="#方法二：passthru" class="headerlink" title="方法二：passthru()"></a>方法二：passthru()</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">passthru</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$command</span>,<span class="hljs-keyword">int</span>[optional] <span class="hljs-variable">$return_value</span></span>)</span><br></code></pre></td></tr></table></figure>

<p>代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>        <span class="hljs-title function_ invoke__">passthru</span>(<span class="hljs-string">&quot;ls&quot;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>执行结果：</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-keyword">index</span>.phptest.php<br></code></pre></td></tr></table></figure>

<p>知识点：<br>passthru与system的区别，passthru直接将结果输出到浏览器，不需要使用 echo 或 return 来查看结果，不返回任何值，且其可以输出二进制，比如图像数据。</p>
<h2 id="方法三：system"><a href="#方法三：system" class="headerlink" title="方法三：system()"></a>方法三：system()</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">system</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$command</span>,<span class="hljs-keyword">int</span>[optional] <span class="hljs-variable">$return_value</span></span>)</span><br></code></pre></td></tr></table></figure>

<p>代码：</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;br&gt;&lt;?php&lt;br&gt;        system(&quot;ls /&quot;);&lt;br&gt;?&gt;&lt;br&gt;</code></td>
</tr>
</tbody></table>
<p>执行结果：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">binbootcgroupdevetchomeliblost+foundmediamntoptprocrootsbinselinuxsrvsystmpusrvar<br></code></pre></td></tr></table></figure>

<p>知识点：<br>system和exec的区别在于system在执行系统外部命令时，直接将结果输出到浏览器，不需要使用 echo 或 return 来查看结果，如果执行命令成功则返回true，否则返回false。第二个参数与exec第三个参数含义一样。</p>
<h2 id="方法四：反撇号-和shell-exec"><a href="#方法四：反撇号-和shell-exec" class="headerlink" title="方法四：反撇号&#96;和shell_exec()"></a>方法四：反撇号&#96;和shell_exec()</h2><p>shell_exec() 函数实际上仅是反撇号 (&#96;) 操作符的变体<br>代码：</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;br&gt;&lt;?php&lt;br&gt;        echo `pwd`;&lt;br&gt;?&gt;&lt;br&gt;</code></td>
</tr>
</tbody></table>
<p>执行结果：</p>
<p>&#x2F;var&#x2F;www&#x2F;html</p>
<h1 id="1-eval（）和include的区别"><a href="#1-eval（）和include的区别" class="headerlink" title="1. eval（）和include的区别"></a>1. eval（）和include的区别</h1><p>都不是函数，都是语言结构 无法通过配置文件的禁用来禁用</p>
<p>eval 要执行的php代码</p>
<p>include 参数是一个路径，表示执行php文件的路径，读取路径中文件的内容，然后执行里面的php代码</p>
<p>include “common.php”</p>
<p>include “phpinfo();”;错误❌</p>
<h1 id="2-intval-函数详解，intval-函数漏洞原理及绕过思路"><a href="#2-intval-函数详解，intval-函数漏洞原理及绕过思路" class="headerlink" title="2. intval()函数详解，intval()函数漏洞原理及绕过思路"></a>2. intval()函数详解，intval()函数漏洞原理及绕过思路</h1><p>intval() 函数可以获取变量的「整数值」。常用于<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2&spm=1001.2101.3001.7020">强制类型转换</a></p>
<p>语法</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-built_in">int</span> intval( $var, $base )<br></code></pre></td></tr></table></figure>

<p>参数</p>
<ul>
<li>$var：需要转换成 integer 的「变量」</li>
<li>$base：转换所使用的「进制」</li>
</ul>
<p>返回值</p>
<p>返回值为 integer 类型，可能是 0 或 1 或 其他integer 值。</p>
<ul>
<li>0：失败 或 空array 返回 0</li>
<li>1：非空array 返回 1</li>
<li>其他integer值：成功时 返回 $var 的 integer 值。</li>
<li>返回值的「最大值」取决于系统</li>
<li>32 位系统（-2147483648 到 2147483647）</li>
<li>64 位系统（-9223372036854775808到9223372036854775807）</li>
</ul>
<h3 id="2-1-1-进制自动转换"><a href="#2-1-1-进制自动转换" class="headerlink" title="2.1.1. 进制自动转换"></a>2.1.1. 进制自动转换</h3><p>第二个参数 $base 允许为空。</p>
<p>当 base 为空时，默认值是 0，会根据 $var 的格式来调整转换的进制。</p>
<ul>
<li>如果 $var 以 0 开头，就使用 8进制</li>
<li>如果 $var 以0x开头，就使用 16进制</li>
<li>否则，就使用 10进制</li>
</ul>
<p>例子</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># 10的 8进制是12</span><br><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">012</span>));<br><span class="hljs-comment"># 10的 16进制是A</span><br><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">0</span>xA));<br><span class="hljs-comment"># 10的 10进制是10</span><br><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">10</span>));<br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>绕过思路：当某个数字被过滤时，可以使用它的 8进制&#x2F;16进制来绕过。</p>
<h3 id="2-1-2-转换数组"><a href="#2-1-2-转换数组" class="headerlink" title="2.1.2. 转换数组"></a>2.1.2. 转换数组</h3><p>intval() 转换数组类型时，不关心数组中的内容，只判断数组中有没有元素。</p>
<ul>
<li>「空数组」返回 0</li>
<li>「非空数组」返回 1</li>
</ul>
<p><strong>实例：</strong></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lisp">var_dump(<span class="hljs-name">intval</span>(<span class="hljs-name">array</span>()))<span class="hljs-comment">;</span><br>var_dump(<span class="hljs-name">intval</span>(<span class="hljs-name">array</span>(<span class="hljs-number">3</span>,<span class="hljs-number">2</span>)))<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>如果传入的 $var是数组中的某个值时，则当做变量来转换，而不是当做数组类型。</p>
<p><strong>实例：</strong></p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$arr1</span> = array(8,6);</span><br><br>var_dump(intval(<span class="hljs-symbol">$</span>arr1[<span class="hljs-number">0</span>]));<br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>绕过思路：对于弱比较（a&#x3D;&#x3D;b），可以给a、b两个参数传入空数组，使弱比较为true。</p>
<h3 id="2-1-3-转换小数"><a href="#2-1-3-转换小数" class="headerlink" title="2.1.3. 转换小数"></a>2.1.3. 转换小数</h3><p>intval() 转换小数类型时，只返回个位数，不遵循四舍五入的原则。</p>
<p>例子</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-number">12</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-number">1.2</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-number">1.9</span>));</span><br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>绕过思路：当某个数字被过滤时，可以给它增加小数位来绕过。</p>
<h3 id="2-1-4-转换字符串"><a href="#2-1-4-转换字符串" class="headerlink" title="2.1.4. 转换字符串"></a>2.1.4. 转换字符串</h3><p>intval() 转换字符串类型时，会判断字符串是否以数字开头</p>
<ul>
<li>如果以数字开头，就返回1个或多个连续的数字</li>
<li>如果以字母开头，就返回0</li>
</ul>
<p>单双引号对转换结果没有影响，并且 0 或 0x 开头也只会当做普通<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86&spm=1001.2101.3001.7020">字符串处理</a>。</p>
<p>例子</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-string">&#x27;12abc&#x27;</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-string">&quot;12abc&quot;</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-string">&#x27;abc123&#x27;</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-string">&#x27;1a2b3c&#x27;</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-string">&#x27;0101&#x27;</span>));</span><br><span class="hljs-function"><span class="hljs-title">var_dump</span>(<span class="hljs-title">intval</span>(<span class="hljs-string">&quot;0x2b&quot;</span>));</span><br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">12</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">101</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">0</span>)</span></span><br></code></pre></td></tr></table></figure>

<h3 id="2-1-5-五取反"><a href="#2-1-5-五取反" class="headerlink" title="2.1.5. 五取反~"></a>2.1.5. 五取反~</h3><p>intval() 函数支持一些<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7&spm=1001.2101.3001.7020">特殊符号</a>的，比如~取反。</p>
<p><strong>实例：</strong></p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lisp">var_dump(<span class="hljs-name">intval</span>(~<span class="hljs-number">10</span>))<span class="hljs-comment">;</span><br>var_dump(<span class="hljs-name">intval</span>(~~<span class="hljs-number">10</span>))<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>

<p><strong>输出</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(-<span class="hljs-number">11</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>绕过思路：当某个数字被过滤时，可以两次取反来绕过。</p>
<h3 id="2-1-6-算数运算符"><a href="#2-1-6-算数运算符" class="headerlink" title="2.1.6. 算数运算符"></a>2.1.6. 算数运算符</h3><p>intval() 函数支持算数运算符，如果传入的 $var参数包含算数运算符，会先传入再运算，再对运算结果进行转换。</p>
<p><strong>实例：</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">5</span>*<span class="hljs-number">5</span>));<br><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">5</span>+<span class="hljs-number">5</span>));<br><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">05</span>+<span class="hljs-number">5</span>));<br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">25</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">10</span>)</span></span><br></code></pre></td></tr></table></figure>

<p>绕过思路：当某个数字被过滤时，可以使用算数运算符绕过。</p>
<h3 id="2-1-7-浮点数精度缺失问题"><a href="#2-1-7-浮点数精度缺失问题" class="headerlink" title="2.1.7. 浮点数精度缺失问题"></a>2.1.7. 浮点数精度缺失问题</h3><p>由于PHP中的浮点数是「弱类型」，存在「精度丢失」的问题，在转换时可能会出现意料之外的情况。</p>
<p>比如下面这个案例，第一个输出34正常，第二个以为会输出58，结果输出了57。</p>
<p><strong>实例：</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">0</span>.<span class="hljs-number">34</span>*<span class="hljs-number">100</span>.<span class="hljs-number">0</span>));<br><span class="hljs-attribute">var_dump</span>(intval(<span class="hljs-number">0</span>.<span class="hljs-number">58</span>*<span class="hljs-number">100</span>.<span class="hljs-number">0</span>));<br></code></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">34</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">int</span><span class="hljs-params">(<span class="hljs-number">57</span>)</span></span><br></code></pre></td></tr></table></figure>

<h3 id="2-1-8-intval-绕过思路"><a href="#2-1-8-intval-绕过思路" class="headerlink" title="2.1.8. intval()绕过思路"></a>2.1.8. intval()绕过思路</h3><p>最后汇总一下intval()函数漏洞的绕过思路：</p>
<p>1）当某个数字被过滤时，可以使用它的 8进制&#x2F;16进制来绕过；比如过滤10，就用012（八进制）或0xA（十六进制）。</p>
<p>2）对于弱比较（a&#x3D;&#x3D;b），可以给a、b两个参数传入空数组，使弱比较为true。</p>
<p>3）当某个数字被过滤时，可以给它增加小数位来绕过；比如过滤3，就用3.1。</p>
<p>4）当某个数字被过滤时，可以给它拼接字符串来绕过；比如过滤3，就用3ab。（GET请求的参数会自动拼接单引号）</p>
<p>5）当某个数字被过滤时，可以两次取反来绕过；比如过滤10，就用~~10。</p>
<p>6）当某个数字被过滤时，可以使用算数运算符绕过；比如过滤10，就用 5+5 或 2*5。</p>
<h1 id="3-绕过还可以用base编码"><a href="#3-绕过还可以用base编码" class="headerlink" title="3. 绕过还可以用base编码"></a>3. 绕过还可以用base编码</h1><p>tac flag.php</p>
<p>dGFjIGZsYWcucGhw</p>
<p>?cmd&#x3D;echo ‘dGFjIGZsYWcucGhw’|base64 -d ‘</p>
<h1 id="4-通配符-使用-绕过"><a href="#4-通配符-使用-绕过" class="headerlink" title="4. 通配符 使用 * ?绕过"></a>4. 通配符 使用 * ?绕过</h1><h1 id="5-关键词拼接法"><a href="#5-关键词拼接法" class="headerlink" title="5. 关键词拼接法"></a>5. 关键词拼接法</h1><p>a&#x3D;c;b&#x3D;at;c&#x3D;fla;d&#x3D;g.php&#x2F;&#x2F; cat flag.php</p>
<h1 id="6-符号过滤法"><a href="#6-符号过滤法" class="headerlink" title="6. 符号过滤法"></a>6. 符号过滤法</h1><p>空格 代替 %09 {$IF} &lt;&gt;</p>
<h1 id="7-环境变量字符串截取法-获取敏感字符"><a href="#7-环境变量字符串截取法-获取敏感字符" class="headerlink" title="7. 环境变量字符串截取法 获取敏感字符"></a>7. 环境变量字符串截取法 获取敏感字符</h1><h1 id="PHP反序列化漏洞详解"><a href="#PHP反序列化漏洞详解" class="headerlink" title="PHP反序列化漏洞详解"></a>PHP反序列化漏洞详解</h1><p>在面向对象的程序设计（Object-oriented programming，OOP）中，</p>
<p>对象是一个由信息及对信息进行处理的描述所组成的整体，是对现实世界的抽象。</p>
<p>类是一个共享相同结构和行为的对象的集合。每个类的定义都以关键字class开头，后面跟着类的名字。</p>
<p>创建一个PHP类：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestClass</span> //定义一个类</span><br><span class="hljs-class"></span>&#123;<br><span class="hljs-comment">//一个变量</span><br><span class="hljs-keyword">public</span> <span class="hljs-variable">$variable</span> = <span class="hljs-string">&#x27;This is a string&#x27;</span>;<br><span class="hljs-comment">//一个方法</span><br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PrintVariable</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;variable;<br>&#125;<br>&#125;<br><span class="hljs-comment">//创建一个对象</span><br><span class="hljs-variable">$object</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestClass</span>();<br><span class="hljs-comment">//调用一个方法</span><br><span class="hljs-variable">$object</span>-&gt;<span class="hljs-title function_ invoke__">PrintVariable</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="linux下不用空格执行带参数的5种姿势-sevck-博客园-cnblogs-com"><a href="#linux下不用空格执行带参数的5种姿势-sevck-博客园-cnblogs-com" class="headerlink" title="linux下不用空格执行带参数的5种姿势 - sevck - 博客园 (cnblogs.com)"></a>linux下不用空格执行带参数的5种姿势 - sevck - 博客园 (cnblogs.com)</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/sevck/p/6072721.html">linux下不用空格执行带参数的5种姿势 - sevck - 博客园 (cnblogs.com)</a></p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs erlang"><span class="hljs-string">$&#123;</span>IFS&#125;<span class="hljs-string">$9</span><br>&#123;IFS&#125;<br><span class="hljs-string">$I</span>FS<br><span class="hljs-string">$&#123;</span>IFS&#125;<br><span class="hljs-string">$I</span>FS<span class="hljs-string">$1</span> //<span class="hljs-string">$1</span>改成<span class="hljs-string">$加</span>其他数字貌似都行<br>IFS<br>&lt; <br>&lt;&gt; <br>&#123;cat,flag.php&#125;  //用逗号实现了空格功能，需要用&#123;&#125;括起来<br><span class="hljs-comment">%20   (space)</span><br><span class="hljs-comment">%09   (tab)</span><br>X=<span class="hljs-string">$&#x27;</span>cat\x09./flag.php&#x27;;<span class="hljs-string">$X</span>       （\x09表示tab，也可以用\x20）<br></code></pre></td></tr></table></figure>

<h2 id="用-IFS-代替空格"><a href="#用-IFS-代替空格" class="headerlink" title="用${IFS}代替空格"></a>用${IFS}代替空格</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">url</span>=ls<span class="hljs-variable">$&#123;IFS&#125;</span>/<br></code></pre></td></tr></table></figure>

<h2 id="对-20的补充说明-即空格"><a href="#对-20的补充说明-即空格" class="headerlink" title="对%20的补充说明(即空格)"></a>对%20的补充说明(即空格)</h2><p>URL中的空格有时候被编码成%20，有时候被编码成加号+，曾经迷糊过一段时间，后来查了下资料才搞明白。</p>
<p>一个URL的基本组成部分包括协议(scheme),域名，端口号，路径和查询字符串（路径参数和锚点标记就暂不考虑了）。路径和查询字符串之间用问号?分离。例如<a target="_blank" rel="noopener" href="http://www.example.com/index?param=1">http://www.example.com/index?param=1</a>，路径为index，查询字符串(Query String)为param&#x3D;1。URL中关于空格的编码正是与空格所在位置相关：空格被编码成加号+的情况只会在查询字符串部分出现，而被编码成%20则可以出现在路径和查询字符串中。</p>
<p>造成这种混乱局面的原因在于：W3C标准规定，当Content-Type为application&#x2F;x-www-form-urlencoded时，URL中查询参数名和参数值中空格要用加号+替代，所以几乎所有使用该规范的浏览器在表单提交后，URL查询参数中空格都会被编成加号+。而在另一份规范(RFC 2396，定义URI)里, URI里的保留字符都需转义成%HH格式(Section 3.4 Query Component)，因此空格会被编码成%20，加号+本身也作为保留字而被编成%2B，对于某些遵循RFC 2396标准的应用来说，它可能不接受查询字符串中出现加号+，认为它是非法字符。所以一个安全的举措是URL中统一使用%20来编码空格字符。</p>
<p>JavaScript中的URLEncode本意是用来把字符串编码成application&#x2F;x-www-form-urlencoded MIME格式字符串，也就是说仅仅适用于URL中的查询字符串部分，但是URLEncoder经常被用来对URL的其他部分编码，它的encode方法会把空格编成加号+，与之对应的是，URLDecoder的decode方法会把加号+和%20都解码为空格，这种违反直觉的做法造成了当初我对空格URL编码问题的困扰。因此后来我的做法都是，在调用URLEncoder.encode对URL进行编码后(所有加号+已被编码成%2B)，再调用replaceAll(“+”, “%20″)，将所有加号+替换为%20。</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43061215/article/details/126121193">https://blog.csdn.net/qq_43061215&#x2F;article&#x2F;details&#x2F;126121193</a></p>
<h1 id="cat与tac的区别（tac的优先级更高）"><a href="#cat与tac的区别（tac的优先级更高）" class="headerlink" title="cat与tac的区别（tac的优先级更高）"></a>cat与tac的区别（tac的优先级更高）</h1><p>cat命令主要有以下功能：将FILE或标准输入连接到标准输出，其实说白了就是用来显示文件的内容。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-A或--show-all   显示不可打印字符，行尾显示“$”，等价于 -vET</span><br> <br><span class="hljs-deletion">-b或--number-nonblank  和-n相似，对非空输出行编号(对于空白行不编号)</span><br> <br><span class="hljs-deletion">-e  等价于-vE</span><br> <br><span class="hljs-deletion">-E或--show-ends  在每行结束处显示</span><br> <br><span class="hljs-deletion">-n或--number   对输出的所有行编号,由1开始对所有输出的行数编号</span><br> <br><span class="hljs-deletion">-s或--squeeze-blank 当遇到有连续两行以上的空白行，就代换为一行的空白行</span><br> <br><span class="hljs-deletion">-t  与-vT等价</span><br> <br><span class="hljs-deletion">-T或--show-tabs  将跳格字符显示为^I</span><br> <br><span class="hljs-deletion">-u  (被忽略)</span><br> <br><span class="hljs-deletion">-v或--show-nonprinting  使用^和M-引用，除了LFD和TAB之外</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099140612-b10fc269-3ebb-425c-a1bc-fc1f62121557.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">cat</span>还有一种用法是经常用到的，比如catalina.<span class="hljs-keyword">out</span>和<span class="hljs-keyword">te</span>.txt是当前目录下的两个文件：<br><br><span class="hljs-keyword">cat</span> <span class="hljs-keyword">te</span>.txt    在屏幕上显示文件<span class="hljs-keyword">te</span>.txt的内容<br><br><span class="hljs-keyword">cat</span> catalina.<span class="hljs-keyword">out</span> <span class="hljs-keyword">te</span>.txt 同时显示两个文件的内容<br><br><span class="hljs-keyword">cat</span> catalina.<span class="hljs-keyword">out</span> <span class="hljs-keyword">te</span>.txt &gt; <span class="hljs-keyword">cc</span>.txt 将文件合并后放入文件<span class="hljs-keyword">cc</span>.txt中<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099185243-22c9f681-b1d5-4bb2-8a76-ba008d940c33.png" srcset="/img/loading.gif" lazyload></p>
<p>注意：当cat的文件较大时，文本在屏幕上迅速闪过（滚屏），用户往往看不清所显示的内容。因此，一般用more等命令分屏显示。为了控制滚屏，可以按Ctrl+S键，停止滚屏；按Ctrl+Q键可以恢复滚屏。按Ctrl+C（中断）键可以终止该命令的执行，并且返回Shell提示符状态。</p>
<p>tac命令与cat命令展示内容相反，用于将文件以行为单位的反序输出，即第一行最后显示，最后一行先显示，且不能带行输出。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css">tac命令参数如下：<br>-e  等价于-vE<br> <br>-<span class="hljs-selector-tag">b</span>或<span class="hljs-attr">--number-nonblank</span>    对非空输出行编号<br> <br>-<span class="hljs-selector-tag">A</span>或<span class="hljs-attr">--show-all</span>   等价于 -vET<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099258604-f5d4a5bc-7e6f-485f-a6aa-bc3e3ffa8cf0.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="例题1，取反真是一招鲜，吃遍天"><a href="#例题1，取反真是一招鲜，吃遍天" class="headerlink" title="例题1，取反真是一招鲜，吃遍天"></a>例题1，取反真是一招鲜，吃遍天</h1><p>分析要传入id&#x3D;&#x3D;1000，但是会有&gt;999的判断，所以利用intval进行绕过</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ctf.show萌新计划web1<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"></span><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php"><span class="hljs-comment"># 包含数据库连接文件</span></span><br><span class="language-php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;config.php&quot;</span>);</span><br><span class="language-php"><span class="hljs-comment"># 判断get提交的参数id是否存在</span></span><br><span class="language-php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="language-php">    <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];</span><br><span class="language-php">    <span class="hljs-comment"># 判断id的值是否大于999</span></span><br><span class="language-php">    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$id</span>) &gt; <span class="hljs-number">999</span>)&#123;</span><br><span class="language-php">        <span class="hljs-comment"># id 大于 999 直接退出并返回错误</span></span><br><span class="language-php">        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;id error&quot;</span>);</span><br><span class="language-php">    &#125;<span class="hljs-keyword">else</span>&#123;</span><br><span class="language-php">        <span class="hljs-comment"># id 小于 999 拼接sql语句</span></span><br><span class="language-php">        <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from article where id = <span class="hljs-subst">$id</span> order by id limit 1 &quot;</span>;</span><br><span class="language-php">        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;执行的sql为：<span class="hljs-subst">$sql</span>&lt;br&gt;&quot;</span>;</span><br><span class="language-php">        <span class="hljs-comment"># 执行sql 语句</span></span><br><span class="language-php">        <span class="hljs-variable">$result</span> = <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-variable">$sql</span>);</span><br><span class="language-php">        <span class="hljs-comment"># 判断有没有查询结果</span></span><br><span class="language-php">        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>-&gt;num_rows &gt; <span class="hljs-number">0</span>) &#123;</span><br><span class="language-php">            <span class="hljs-comment"># 如果有结果，获取结果对象的值$row</span></span><br><span class="language-php">            <span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span> = <span class="hljs-variable">$result</span>-&gt;<span class="hljs-title function_ invoke__">fetch_assoc</span>()) &#123;</span><br><span class="language-php">                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;id: &quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;id&quot;</span>]. <span class="hljs-string">&quot; - title: &quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;title&quot;</span>]. <span class="hljs-string">&quot; &lt;br&gt;&lt;hr&gt;&quot;</span> . <span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;content&quot;</span>]. <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="language-php">            &#125;</span><br><span class="language-php">        &#125;</span><br><span class="language-php">        <span class="hljs-comment"># 关闭数据库连接</span></span><br><span class="language-php">        <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();</span><br><span class="language-php">    &#125;</span><br><span class="language-php">    </span><br><span class="language-php">&#125;<span class="hljs-keyword">else</span>&#123;</span><br><span class="language-php">    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-meta">?&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-comment">&lt;!-- flag in id = 1000 --&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>可以利用两次取反，?id&#x3D;~~1000</p>
<p>可以使用乘法获取1000，?id&#x3D;250*4等等</p>
<p>?id&#x3D;2 or id&#x3D;1000</p>
<p>?id&#x3D;round(999.6),只要小数部分能进一就行</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721096788442-887f41e4-e4b1-44bd-b3f7-7471c6d1f44f.png" srcset="/img/loading.gif" lazyload></p>
<p>漏洞补上了加号和or，但还是能用乘号和取反符号,还有||</p>
<p>或者可以使用intval(1e3),不行哦，因为开头1被过滤掉了</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721097117032-d57dda34-ea71-41c1-a4fb-21576df6f33f.png" srcset="/img/loading.gif" lazyload></p>
<p>这次过滤了or,-,,*,+,&lt;,&gt;,!,hex,i,所以还能使用取反</p>
<p>?id&#x3D;power(10,3)</p>
<p>?id&#x3D;sqrt(1000000)</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721097577133-43135873-64d6-49a9-b015-6cb865e76ce5.png" srcset="/img/loading.gif" lazyload></p>
<p>这里开始过滤取反，但可以使用二进制</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721097881417-097e8727-4962-49dc-a4bd-537b76d00aaf.png" srcset="/img/loading.gif" lazyload></p>
<p>用 sql 中除号的另外一种写法绕过(div) ?id&#x3D;500 div 0.5</p>
<h1 id="例题2-删库跑路"><a href="#例题2-删库跑路" class="headerlink" title="例题2 删库跑路"></a>例题2 删库跑路</h1><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ctf.show萌新计划web1<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"></span><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php"><span class="hljs-comment"># 包含数据库连接文件,key flag 也在里面定义</span></span><br><span class="language-php"><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;config.php&quot;</span>);</span><br><span class="language-php"><span class="hljs-comment"># 判断get提交的参数id是否存在</span></span><br><span class="language-php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="language-php">        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="language-php">                <span class="hljs-variable">$f</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag&#x27;</span>];</span><br><span class="language-php">                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span>===<span class="hljs-variable">$f</span>)&#123;</span><br><span class="language-php">                        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;</span><br><span class="language-php">                &#125;</span><br><span class="language-php">        &#125;</span><br><span class="language-php">&#125;<span class="hljs-keyword">else</span>&#123;</span><br><span class="language-php">    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);</span><br><span class="language-php">&#125;</span><br><span class="language-php"></span><br><span class="language-php"><span class="hljs-meta">?&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>在 URL 中，? 之后的部分被称为查询字符串（Query String）。</p>
<p>其中的 flag&#x3D;rm%20-rf%20&#x2F;* 是一个 GET 请求的参数。</p>
<p>在这个例子中，flag 是参数名，rm%20-rf%20&#x2F;* 是对应的参数值。</p>
<p>%20 是 URL 编码表示空格字符的方式。</p>
<p>因此，实际的参数值是 rm -rf &#x2F;*。显示根目录</p>
<h1 id="例题3-命令后一定要加；！！！！"><a href="#例题3-命令后一定要加；！！！！" class="headerlink" title="例题3 命令后一定要加；！！！！"></a>例题3 命令后一定要加；！！！！</h1><h2 id="1）无过滤"><a href="#1）无过滤" class="headerlink" title="1）无过滤"></a>1）无过滤</h2><p>先查看文件内容，注意命令后面一定要加；</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099370686-a349c132-93f3-4b43-b359-beb702a35d2f.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099381880-869f8a70-2ea9-4bc7-91bc-a6be18ff646f.png" srcset="/img/loading.gif" lazyload></p>
<p>然后查看这两个文件</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099418494-94cf7196-efee-4868-bb44-2ec872791c2e.png" srcset="/img/loading.gif" lazyload></p>
<p>index说flag在config里面</p>
<p>查看config得到flag</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721099473622-dbf1f2e2-80a2-4093-a74e-9aaf1651f65b.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="2）过滤了system-exec-highlight"><a href="#2）过滤了system-exec-highlight" class="headerlink" title="2）过滤了system|exec|highlight"></a>2）过滤了system|exec|highlight</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment"># flag in config.php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;config.php&quot;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/system|exec|highlight/i&quot;</span>,<span class="hljs-variable">$c</span>))&#123;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$c</span>);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;cmd error&quot;</span>);<br>        &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p>因为增加了过滤，把system过滤了if(!preg_match(“&#x2F;system|exec|highlight&#x2F;i”,$c)){ eval($c);</p>
<p>所以要把代码改一下，改成passthru，这个命令宇system的区别在于passthru直接输出在浏览器，而passthru的语法很简单，直接passthru(‘ls’);</p>
<p>相关技术文章参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaohj/p/3267692.html%EF%BC%8C%E6%89%A7%E8%A1%8C?c=passthru(%27ls%27);%E5%8F%91%E7%8E%B0%E6%9C%89%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%EF%BC%8Cconfig.php%E5%92%8Cindex.php%EF%BC%8C%E5%9B%A0%E4%B8%BAindex.php%E6%98%AF%E9%A6%96%E9%A1%B5%E6%96%87%E4%BB%B6%EF%BC%8C%E6%B2%A1%E6%9C%89flag%E6%89%80%E4%BB%A5%E8%B7%B3%E8%BF%87%EF%BC%8C%E7%84%B6%E5%90%8E%E6%9F%A5%E7%9C%8B%E5%8F%A6%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%EF%BC%8C?c=passthru(%27config.php%27);%E6%89%A7%E8%A1%8C%E5%90%8EF12%E6%A3%80%E6%9F%A5%E9%A1%B5%E9%9D%A2%EF%BC%8C%E5%8F%91%E7%8E%B0flag">https://www.cnblogs.com/gaohj/p/3267692.html</a></p>
<p>执行?c&#x3D;passthru(‘ls’)</p>
<p>发现有两个文件，config.php和index.php</p>
<p>因为index.php是首页文件，没有flag所以跳过，</p>
<p>然后查看另一个文件，?c&#x3D;passthru(‘config.php’)</p>
<p>执行后F12检查页面，发现flag</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721100835442-20a31da3-353b-44e9-9aa0-3f8e0b84f12a.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="3-过滤-system-exec-highlight-cat-php-config"><a href="#3-过滤-system-exec-highlight-cat-php-config" class="headerlink" title="3)过滤&#x2F;system|exec|highlight|cat|.|php|config"></a>3)过滤&#x2F;system|exec|highlight|cat|.|php|config</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721101253506-21c27b83-c6cd-467d-aafa-314b0b26d7b4.png" srcset="/img/loading.gif" lazyload></p>
<p>使用*进行绕过即可</p>
<h2 id="4-过滤了分号-system-exec-highlight-cat-file-php-config-i"><a href="#4-过滤了分号-system-exec-highlight-cat-file-php-config-i" class="headerlink" title="4)过滤了分号&#x2F;system|exec|highlight|cat|.|;|file|php|config&#x2F;i"></a>4)过滤了分号&#x2F;system|exec|highlight|cat|.|;|file|php|config&#x2F;i</h2><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1721107899794-ad4930fe-4802-46fd-945a-8c8e6a7d8265.png" srcset="/img/loading.gif" lazyload>?c&#x3D;passthru(‘tac con\fig*’)?&gt; 用?&gt;代替； 在php中可以用?&gt;来代替最后的一个；</p>
<p>因为php遇到定界符关闭标签会自动在末尾加上一个分号。</p>
<h2 id="5-先转化成base64"><a href="#5-先转化成base64" class="headerlink" title="5)先转化成base64"></a>5)先转化成base64</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721109043464-2e10cc3f-6ff5-4ab4-9687-210eb511456c.png" srcset="/img/loading.gif" lazyload></p>
<p>?c&#x3D;include $_GET[‘a’]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;config.php</p>
<p>再解密</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721109073501-6eda0e5d-0ad0-4d0d-afdc-2f0aad8638d2.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721109089298-337f83b6-8488-4a65-b171-6268353b77dd.png" srcset="/img/loading.gif" lazyload></p>
<p>①涉及到一个php的代码结构，…..</p>
<p>②payload为：?c&#x3D;include $_GET[a]?&gt;，等同于，php的最后一行代码可以省去分号…..</p>
<p>③include函数包含文件，且题目是对参数c正则过滤，因此GET型传参a可以绕过，从而执行我们的伪协议文件命令，读取config.php文件：</p>
<p>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;.&#x2F;config.php</p>
<p>④因此连起来构造的payload为：</p>
<p>?c&#x3D;include $_GET[a]?&gt;&amp;a&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;config.php</p>
<p>还可以直接?c&#x3D;echo$flag</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1721110034654-349d0584-1c85-4403-90ae-27039d61410e.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="例题4-babyphp"><a href="#例题4-babyphp" class="headerlink" title="例题4 babyphp"></a>例题4 babyphp</h1><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1722078779888-3a0c04ec-3a3c-4802-88aa-0790304ae0eb.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li><p>先过第一个if，需要a不含数字而且intval取整数</p>
</li>
<li><p>官方对intval的解释是</p>
</li>
<li><p>通过使用指定的进制 base 转换（默认是十进制），返回变量 value 的 int 数值。</p>
</li>
<li><p>intval() 不能用于 object，否则会产生 E_WARNING 错误并返回 1。</p>
</li>
<li><p>echo intval(array()); &#x2F;&#x2F; 0</p>
</li>
<li><p>echo intval(array(‘foo’, ‘bar’)); &#x2F;&#x2F; 1</p>
</li>
<li><p>所以我们传入数组就能过掉第一个if</p>
</li>
<li><p>a[]&#x3D;1</p>
</li>
<li><p>第三个if，由于md5函数无法处理数组,会返回null</p>
</li>
<li><p>b1[]&#x3D;1&amp;b2[]&#x3D;2</p>
</li>
<li><p>md5(b1[]&#x3D;1) &#x3D;&#x3D;&#x3D; md5(b2[]&#x3D;2)</p>
</li>
<li><p>第四个if，需要传入值是字符串且md5值相等</p>
</li>
</ul>
<h2 id="7-1-弱判断下，0e开头的数等于0，所以使两端的md5值都为0e开头即可"><a href="#7-1-弱判断下，0e开头的数等于0，所以使两端的md5值都为0e开头即可" class="headerlink" title="7.1. 弱判断下，0e开头的数等于0，所以使两端的md5值都为0e开头即可"></a>7.1. 弱判断下，0e开头的数等于0，所以使两端的md5值都为0e开头即可</h2><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dns">QLTHNDT<br><span class="hljs-number">0</span>e40596782540195537<span class="hljs-number">2549139051580</span><br><br>QNKCDZO<br><span class="hljs-number">0</span>e830400451993494058<span class="hljs-number">024219903391</span><br><br>s878926199a<br><span class="hljs-number">0</span>e5459932745177090343<span class="hljs-number">28855841020</span><br></code></pre></td></tr></table></figure>

<p>所以最终的payload是</p>
<p>a[]&#x3D;1&amp;b1[]&#x3D;1&amp;b2[]&#x3D;2&amp;c1&#x3D;QLTHNDT&amp;c2&#x3D;QNKCDZO</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1722079596346-2ecb91b4-2cfd-4240-a902-549b3b75b30f.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="例题5-Ping-Ping-Ping（管道符-）"><a href="#例题5-Ping-Ping-Ping（管道符-）" class="headerlink" title="例题5 Ping Ping Ping（管道符 |）"></a>例题5 Ping Ping Ping（管道符 |）</h1><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1726712425114-c49d122f-93eb-43e7-8f38-8bb304d6cc23.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/WEB/" class="print-no-link">#WEB</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>php反序列化漏洞</div>
      <div>http://example.com/2024/11/30/php反序列化/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>chaye</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>November 30, 2024</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/12/08/0xGame%202024/" title="0xGAME 2024">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">0xGAME 2024</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/11/01/nes%E9%80%86%E5%90%91/" title="nes逆向">
                        <span class="hidden-mobile">nes逆向</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
