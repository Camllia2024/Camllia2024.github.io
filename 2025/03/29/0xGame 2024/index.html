

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="chaye">
  <meta name="keywords" content="">
  
    <meta name="description" content="MISCbase2048 一明一暗报告哈基米长宽一样    zsteg看隐写  1234567891011121314151617181920212223242526272829303132333435363738from PIL import Imagedef arnold(infile: str, outfile: str &#x3D; None, a: int &#x3D; 1, b: int &#x3D; 1, shu">
<meta property="og:type" content="article">
<meta property="og:title" content="0xGAME 2024">
<meta property="og:url" content="http://example.com/2025/03/29/0xGame%202024/index.html">
<meta property="og:site_name" content="chaye的博客">
<meta property="og:description" content="MISCbase2048 一明一暗报告哈基米长宽一样    zsteg看隐写  1234567891011121314151617181920212223242526272829303132333435363738from PIL import Imagedef arnold(infile: str, outfile: str &#x3D; None, a: int &#x3D; 1, b: int &#x3D; 1, shu">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729219754928-9bb6e761-5e71-42d4-9b11-6a025866e500.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729219422264-9504ce79-e161-44bb-86d8-93bd819378df.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729219430567-6efe6a19-afe5-41b4-9dcb-61d279cfee24.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729221190200-c1d82b02-8a0e-41ec-9205-08a8989f72a8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729221293192-81cec015-f4ea-4589-a6da-2a4a7942e4b3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729223301088-fb35ddee-ac94-4fa3-b435-8a1872481dc0.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729223370400-117495c5-1652-4ed8-990a-83367bee1821.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729223942190-8d248a45-8dd8-4fae-b42e-8367902518af.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224309800-424057da-2621-4b59-97f7-59320be86700.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224338523-6a546d58-6e07-4673-9084-213f0d9db700.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729932113462-2c533823-9a6f-496e-b397-c0c9d16a6db8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728374302204-3974860f-548e-4a17-9a25-e720f76aa13f.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728526754517-4be555c3-04b0-42e3-92ab-7471b537a0d4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728540961813-b65fa15c-4fe3-4756-a9dc-3d642bed1ba7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728791670662-b0daa4ab-2dd3-41ac-b812-d53c146c15fe.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728791975266-475acc40-8b28-464b-a4c1-9b650e3e8685.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728793415951-9c510276-3faf-4fce-8545-67ca8dd759b6.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728795728290-b5b7e2f7-5928-433a-987e-b3a3cc870431.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729164305260-c3ae8384-cca5-4d41-a9ae-028b3f7ce46c.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729164321962-ad9a4217-839b-4054-bfeb-cef447c4b3c4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729166172771-1b7aa214-acf0-427e-809a-6dd15afaaf20.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729166122551-695bbd52-a50a-40fc-a3b6-240332fb9de8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729264997925-6c145b40-efa7-4e8f-bdee-e93a85301e33.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729304349422-46a5e60f-437e-4515-bfb4-85a6a1381be4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729304419407-1dc85c9e-9ac0-4c54-8229-1b6bfab4e803.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729395902662-788a14be-5d15-4515-8cdf-6228389e88a4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729395892566-5881f122-b152-43e7-aa94-aa176373947d.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729397568050-494aba5f-7b75-497f-aa92-d62ded6bca06.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729929502771-015b35cb-b440-4d97-9c8e-e390989ca09a.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729930463569-040282a2-15f7-4d46-b6fc-5a8b40f51f3e.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729930476309-220d41eb-72dd-4df8-a0f7-12403b3e8aee.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729931620167-5095ccd4-75f3-4a5c-992f-78298b16882d.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729931574867-adf72c02-a630-4de4-9919-a7b9cf45e81a.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730206348140-e9187c30-843c-4edd-9abf-f3a7e813e201.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730207450923-80459de4-ea4c-447f-b655-6666e186c470.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730208552292-f244735c-f026-4da4-b6b9-584a4b20b36e.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2024/png/42988179/1730209696722-d64b521b-6098-451a-a680-f48503b08a46.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730209896862-3adfe5c5-9adc-4573-a4a0-35c41e8e980d.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728374713484-2a33a21a-52b5-4f46-882e-c813467a6602.png">
<meta property="article:published_time" content="2025-03-29T06:51:17.293Z">
<meta property="article:modified_time" content="2025-03-29T07:18:35.140Z">
<meta property="article:author" content="chaye">
<meta property="article:tag" content="2024比赛">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0.png">
  
  
  
  <title>0xGAME 2024 - chaye的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>chaye</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="0xGAME 2024"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-03-29 14:51" pubdate>
          March 29, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.9k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          25 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">0xGAME 2024</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="base2048"><a href="#base2048" class="headerlink" title="base2048"></a>base2048</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729153577073-82ce4789-d66d-46e6-b481-7004e4b0f5b0.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="一明一暗"><a href="#一明一暗" class="headerlink" title="一明一暗"></a>一明一暗</h2><h2 id="报告哈基米"><a href="#报告哈基米" class="headerlink" title="报告哈基米"></a>报告哈基米</h2><p>长宽一样</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729219754928-9bb6e761-5e71-42d4-9b11-6a025866e500.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729219422264-9504ce79-e161-44bb-86d8-93bd819378df.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729219430567-6efe6a19-afe5-41b4-9dcb-61d279cfee24.png" srcset="/img/loading.gif" lazyload></p>
<p>zsteg看隐写</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729221190200-c1d82b02-8a0e-41ec-9205-08a8989f72a8.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs plain">from PIL import Image<br><br><br>def arnold(infile: str, outfile: str = None, a: int = 1, b: int = 1, shuffle_times: int = 1,<br>           reverse: bool = False) -&gt; None:<br>    &quot;&quot;&quot;<br>    Arnold猫脸变换函数<br><br>    Parameters:<br>        infile - 输入图像路径<br>        outfile - 输出图像路径<br>        a - Anrold 变换参数<br>        b - Anrold 变换参数<br>        shuffle_times - 置乱次数<br>        reverse - 逆变换<br>    &quot;&quot;&quot;<br>    inimg = Image.open(infile)<br>    width, height = inimg.size<br>    indata = inimg.load()<br>    outimg = Image.new(inimg.mode, inimg.size)<br>    outdata = outimg.load()<br><br>    for _ in range(shuffle_times):<br>        for x in range(width):<br>            for y in range(height):<br>                if reverse:<br>                    nx = ((a * b + 1) * x - a * y) % width<br>                    ny = (y - b * x) % height<br>                else:<br>                    nx = (x + a * y) % width<br>                    ny = (b * x + (a * b + 1) * y) % height<br>                outdata[ny, nx] = indata[y, x]<br><br>    outimg.save(outfile if outfile else &quot;arnold_&quot; + infile, inimg.format)<br><br><br>#arnold(&quot;before.png&quot;, &quot;encode.png&quot;, 9, 39, 1)<br>arnold(&quot;1.png&quot;, &quot;decode.png&quot;, 7, 35, 1, True)<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729221293192-81cec015-f4ea-4589-a6da-2a4a7942e4b3.png" srcset="/img/loading.gif" lazyload></p>
<p>0xGame{hajimi_i5_</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729223301088-fb35ddee-ac94-4fa3-b435-8a1872481dc0.png" srcset="/img/loading.gif" lazyload></p>
<p>看到末尾有个zip的反转数据，找一下末尾，然后导出逆向一下</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729223370400-117495c5-1652-4ed8-990a-83367bee1821.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs plain"># 打开并读取原始文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\1.txt&#x27;, &#x27;rb&#x27;) as f:<br>    a = f.read()<br><br># 去掉原始数据中的换行符、空格等不可见字符<br>a = a.replace(b&#x27;\n&#x27;, b&#x27;&#x27;).replace(b&#x27;\r&#x27;, b&#x27;&#x27;).replace(b&#x27; &#x27;, b&#x27;&#x27;)<br><br># 将内容逆序<br>a = a[::-1]<br><br># 将逆序内容写入新的文件<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;wb&#x27;) as new:<br>    new.write(a)<br><br># 读取逆序后的文件内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\new.txt&#x27;, &#x27;rb&#x27;) as f:<br>    b = f.read()<br><br># 将内容转换为可变的字节数组<br>blist = bytearray(b)<br><br># 按两个字节为一组进行交换<br>for i in range(0, len(blist) - 1, 2):<br>    blist[i], blist[i + 1] = blist[i + 1], blist[i]<br><br># 打开目标文件以写入最终内容<br>with open(r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;, &#x27;wb&#x27;) as flag:<br>    # 将所有处理后的字节内容连续写入文件<br>    flag.write(blist)<br><br># 打印最终处理的内容（以逆序显示）<br>print(blist)<br>def format_hex_data_from_file(input_file, output_file):<br>    # 读取文件内容<br>    with open(input_file, &#x27;r&#x27;) as file:<br>        hex_data = file.read().strip()<br><br>    # 将字符串分成每两个字符一组<br>    grouped_data = [hex_data[i:i + 2] for i in range(0, len(hex_data), 2)]<br><br>    # 以16组为一行，每组之间用空格隔开<br>    formatted_data = &#x27;\n&#x27;.join([&#x27; &#x27;.join(grouped_data[i:i + 16]) for i in range(0, len(grouped_data), 16)])<br><br>    # 将格式化后的数据写入输出文件<br>    with open(output_file, &#x27;w&#x27;) as file:<br>        file.write(formatted_data)<br><br><br># 输入和输出文件路径<br>input_file = r&#x27;D:\wangzhanxiazai\exppy\flag.txt&#x27;<br>output_file = r&#x27;D:\wangzhanxiazai\exppy\newflag.txt&#x27;<br><br># 格式化并写入输出文件<br>format_hex_data_from_file(input_file, output_file)<br></code></pre></td></tr></table></figure>



<p>保存为zip文件</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729223942190-8d248a45-8dd8-4fae-b42e-8367902518af.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224309800-424057da-2621-4b59-97f7-59320be86700.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224338523-6a546d58-6e07-4673-9084-213f0d9db700.png" srcset="/img/loading.gif" lazyload></p>
<p>也有相关的在线网站可以解</p>
<h3 id="tupperexp"><a href="#tupperexp" class="headerlink" title="tupperexp"></a>tupperexp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs plain">import numpy as np<br>import matplotlib.pyplot as plt<br>from PIL import Image<br><br><br>def Tupper_self_referential_formula(k):<br>    aa = np.zeros((17, 106))<br><br>    def f(x, y):<br>        y += k<br>        a1 = 2 ** -(-17 * x - y % 17)<br>        a2 = (y // 17) // a1<br>        return 1 if a2 % 2 &gt; 0.5 else 0<br><br>    for y in range(17):<br>        for x in range(106):<br>            aa[y, x] = f(x, y)<br>    return aa[:, ::-1]<br><br><br>k = 9489414856877039590479997730148554425666925984049232945604842888420596111937489062065081199094002132087091572191187170308560128611026043144427876131133135794969867759108490917632153891963456295991713868378392769549376070709924497237322046334486274987407067993824142187115870972520417207510521083293280152434558803258138899515603807505064799735152359900010019631133734298562293682916239050320580346316026460860919542540955914826806059123630945216006606268974979135253968165822806241305783300650874506602000048154282039485531804337171305656252<br><br><br>aa = Tupper_self_referential_formula(k)<br>plt.figure(figsize=(15, 10))<br>plt.imshow(aa, origin=&#x27;lower&#x27;)<br>plt.savefig(&quot;tupper.png&quot;)<br>img = Image.open(&#x27;tupper.png&#x27;)<br># 翻转<br>dst1 = img.transpose(Image.FLIP_LEFT_RIGHT).rotate(180)<br>plt.imshow(dst1)<br>plt.show()<br></code></pre></td></tr></table></figure>

<p>倒序一下数据再生成照片</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224750548-493fc2ee-d29b-4516-bbee-15a2a4ba4c90.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224835166-4b726f7d-cfc4-499f-965e-7b22849313b9.png" srcset="/img/loading.gif" lazyload></p>
<p>倒过来看一下</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729224875926-91580a7e-50bc-446b-b08e-7231c15ccfa6.png" srcset="/img/loading.gif" lazyload></p>
<p>Cute_r1ght?}</p>
<h2 id="诗人握持"><a href="#诗人握持" class="headerlink" title="诗人握持"></a>诗人握持</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729932113462-2c533823-9a6f-496e-b397-c0c9d16a6db8.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="BabyBase"><a href="#BabyBase" class="headerlink" title="BabyBase"></a>BabyBase</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728374302204-3974860f-548e-4a17-9a25-e720f76aa13f.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="BinaryMaster"><a href="#BinaryMaster" class="headerlink" title="BinaryMaster"></a>BinaryMaster</h2><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p>看汇编把数据打印下来</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728526754517-4be555c3-04b0-42e3-92ab-7471b537a0d4.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[0x7e,0x35,0x0b,0x2a,0x27,0x2c,0x33,0x1f,0x76,0x37,0x1b,0x72,0x31,0x1e,0x36,0x0c,0x4c,0x44,0x63,0x72,0x57,0x49,0x8,0x45,0x42,0x1,0x5a,0x4,0x13,0x4c]<br>for i in range(30):<br>    a[i]^=78-i<br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure>



<h2 id="Xor-Endian"><a href="#Xor-Endian" class="headerlink" title="Xor-Endian"></a>Xor-Endian</h2><p>后往前读，最高位只有一位时补齐0 </p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728540961813-b65fa15c-4fe3-4756-a9dc-3d642bed1ba7.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">key = &quot;Key0xGame2024&quot;<br>a = [0x7b, 0x1d, 0x3e, 0x51, 0x15, 0x22, 0x1a, 0x0f, 0x56, 0x0a, 0x51, 0x56, 0x00,<br>     0x28, 0x5d, 0x54, 0x07, 0x4b, 0x74, 0x05, 0x40, 0x51, 0x54, 0x08, 0x54,<br>     0x19, 0x72, 0x56, 0x1d, 0x04, 0x55, 0x76, 0x56, 0x0b, 0x54, 0x57, 0x07,<br>     0x0b, 0x55, 0x73, 0x01, 0x4f, 0x08, 0x05]<br><br><br>for i in range(len(a)):<br><br>    a[i] = a[i] ^ ord(key[i % len(key)])  <br>    #if 32 &lt;= a[i] &lt;= 126:  <br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure>



<h2 id="upx"><a href="#upx" class="headerlink" title="upx"></a>upx</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728791670662-b0daa4ab-2dd3-41ac-b812-d53c146c15fe.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728791975266-475acc40-8b28-464b-a4c1-9b650e3e8685.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>这里的逻辑对每个字节执行如下操作：<ul>
<li><code>*v2 = (16 * *v2) | (*v2 &gt;&gt; 4);</code><ul>
<li>这个表达式将字节左移 4 位，然后将高 4 位通过右移操作保留并通过 <code>|</code> 操作拼接到低 4 位。</li>
<li>换句话说，左移使低 4 位变为 0，高 4 位占据低 4 位，然后用原先的高 4 位来填充新生成的高 4 位。</li>
</ul>
</li>
</ul>
</li>
<li>该操作对字符串的每个字节都重复，直到遇到 <code>0</code>（字符串结束符或空字节）。</li>
</ul>
<p>为了逆向该过程，我们需要恢复原始的字节。给定编码后的字节值，我们可以通过以下操作恢复原始值：</p>
<ul>
<li>将编码后的字节右移 4 位，以获取原始字节的高 4 位。</li>
<li>将编码后的字节进行掩码操作（与 <code>0x0F</code>）保留低 4 位，恢复原始字节的低 4 位。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[<br>    3, 135, 116,  22, 214,  86, 183,  99, 131,  70, <br>  102, 102,  67,  83, 131, 210,  35, 147,  86,  83, <br>  210,  67,  54,  54,   3, 210,  22, 147,  54,  38, <br>  210, 147, 115,  19, 102,  86,  54,  51,  51, 131, <br>   86,  35, 102, 215<br>]<br>for i in range(44):<br>    a[i]=(a[i]&gt;&gt;4 | (a[i]&amp;0x0f)&lt;&lt;4)<br>    print(chr(a[i]),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure>



<h2 id="Ezjar"><a href="#Ezjar" class="headerlink" title="Ezjar"></a>Ezjar</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728793415951-9c510276-3faf-4fce-8545-67ca8dd759b6.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="求逆元"><a href="#求逆元" class="headerlink" title="求逆元"></a>求逆元</h3><p>5x &#x3D;1mod 16</p>
<p>16 &#x3D;5*3+1</p>
<p>5&#x3D;5*1</p>
<p>1&#x3D;16-5*3</p>
<p>-3 mod 16&#x3D;13</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plain">key=&#x27;0123456789abcdef&#x27;<br>a=&#x27;ab50e920-4a97-70d1-b646-cdac5c873376&#x27;<br>inverse=13<br>chang=len(key)<br>for i in range(len(a)):<br>    if(a[i] not in key):<br>        print(a[i],end=&#x27;&#x27;)<br>    else:<br>        suoyin=key.index(a[i])<br>        yuan=key[((suoyin-3+chang)%chang*inverse)%chang]<br>        print(yuan,end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure>

<h2 id="Ezpyc"><a href="#Ezpyc" class="headerlink" title="Ezpyc"></a>Ezpyc</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728795728290-b5b7e2f7-5928-433a-987e-b3a3cc870431.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain"># uncompyle6 version 3.9.1<br># Python bytecode version base 3.8.0 (3413)<br># Decompiled from: Python 3.10.9 | packaged by Anaconda, Inc. | (main, Mar  1 2023, 18:18:15) [MSC v.1916 64 bit (AMD64)]<br># Embedded file name: D:\PortPython3.8.9\App\Python\0xgame\EzPyc.py<br># Compiled at: 2024-09-10 22:18:53<br># Size of source mod 2**32: 519 bytes<br>import hashlib<br>user_input = input(&quot;请输入神秘代号：&quot;)<br>if user_input != &quot;Ciallo~&quot;:<br>    print(&quot;代号不是这个哦&quot;)<br>    exit()<br>input_hash = hashlib.md5(user_input.encode()).hexdigest()<br>print(input_hash)<br>input_hash = list(input_hash)<br><br>for i in range(len(input_hash)):<br>    if ord(input_hash[i]) in range(48, 58):<br>        original_num = int(input_hash[i])<br>        new_num = (original_num + 5) % 10<br>        input_hash[i] = str(new_num)<br>input_hash = &quot;&quot;.join(input_hash)<br>print(&quot;0xGame&#123;&#123;&#123;&#125;&#125;&#125;&quot;.format(input_hash))<br><br># okay decompiling 1.pyc<br></code></pre></td></tr></table></figure>

<h2 id="Xor-Ramdom"><a href="#Xor-Ramdom" class="headerlink" title="Xor::Ramdom"></a>Xor::Ramdom</h2><p>动态看v21的值 v21是0x7b</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729164305260-c3ae8384-cca5-4d41-a9ae-028b3f7ce46c.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729164321962-ad9a4217-839b-4054-bfeb-cef447c4b3c4.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">import random<br>a=[0x0c,0x4f,0x10,0x1f,0x4e, 0x16,0x21,0x12,0x4b,0x24, 0x10,0x4b,0x0a,0x24,0x1f,0x17,0x09,0x4f,0x07,0x08,0x21,0x5c,0x2c,0x1a,0x10,0x1f,0x11,0x16,0x59,0x5a]<br>v23=0<br>v21=0<br>v4=0<br>v5=0<br>random.seed(0x1919810)<br>v21=0x7b<br>for i in range(len(a)):<br>    if(i &amp; 1 !=0):<br>        v8=v21<br>    else:<br>        v8=v21+3<br>    a[i]^=v8<br>for i in range(len(a)):<br>    print(chr(a[i]%256),end=&#x27;&#x27;)<br></code></pre></td></tr></table></figure>



<h2 id="ZZZ"><a href="#ZZZ" class="headerlink" title="ZZZ"></a>ZZZ</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729166172771-1b7aa214-acf0-427e-809a-6dd15afaaf20.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729166122551-695bbd52-a50a-40fc-a3b6-240332fb9de8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729264997925-6c145b40-efa7-4e8f-bdee-e93a85301e33.png" srcset="/img/loading.gif" lazyload></p>
<p>注意开头38*这个数据不是0x，要转化成16进制</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729304349422-46a5e60f-437e-4515-bfb4-85a6a1381be4.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plain">from Crypto.Util.number import long_to_bytes<br>from libnum import n2s<br>from z3 import *<br>v10 = BitVec(&#x27;v10&#x27;, 32)<br>v11 = BitVec(&#x27;v11&#x27;, 32)<br>v12 = BitVec(&#x27;v12&#x27;, 32)<br><br>res=[]<br>solver = Solver()<br>solver.add(11 * v11 + 14 * v10 - v12 == 0x48FB41DDD)<br>solver.add(9 * v10 - 3 * v11 + 4 * v12 == 0x2BA692AD7)<br>solver.add((((v12 - v11)) &gt;&gt; 1) + (v10 ^ 0x87654321) == 3451779756)<br>if solver.check()==sat:<br>    model=solver.model()<br>    res.append(n2s(model[v10].as_long()))<br>    res.append(n2s(model[v11].as_long()))<br>    res.append(n2s(model[v12].as_long()))<br>print(res)<br><br>#0xGame&#123;e544267d-7812-44b3-a35d-d085a85201a4&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729304419407-1dc85c9e-9ac0-4c54-8229-1b6bfab4e803.png" srcset="/img/loading.gif" lazyload></p>
<p>注意最后的结果要倒序过来</p>
<h2 id="ASM"><a href="#ASM" class="headerlink" title="ASM"></a>ASM</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729395902662-788a14be-5d15-4515-8cdf-6228389e88a4.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729395892566-5881f122-b152-43e7-aa94-aa176373947d.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plain">a=[20, 92, 43, 69, 81, 73, 95, 23, 72, 22,24,<br>   69, 25, 27, 22, 17, 23, 29, 24, 73<br>    ,17, 24, 85, 27, 112, 76, 15, 92, 24, 1<br>    ,73, 84, 13, 81, 12, 0, 84, 73, 82, 8<br>    ,82, 81, 76, 125]<br>for i in range(44):<br>    if i &lt;=21:<br>        a[i]+=28<br>    if i&gt;21 and i&lt;43:<br>        a[i]^=a[i-22]<br>for i in range(43):<br>    print(chr(a[i]),end=&#x27;&#x27;)<br>b=&#x27;0xGame&#123;3d24a572-394e-4ec7-b9c2-f9097fda1f4a&#125;&#x27;<br>print(len(b))<br></code></pre></td></tr></table></figure>

<h2 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729397568050-494aba5f-7b75-497f-aa92-d62ded6bca06.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="littlepuzzle"><a href="#littlepuzzle" class="headerlink" title="littlepuzzle"></a>littlepuzzle</h2><p>看到数组</p>
<p>提示密码是48位，所以最后输入的是解出来的数字</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729929502771-015b35cb-b440-4d97-9c8e-e390989ca09a.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729930463569-040282a2-15f7-4d46-b6fc-5a8b40f51f3e.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729930476309-220d41eb-72dd-4df8-a0f7-12403b3e8aee.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729931620167-5095ccd4-75f3-4a5c-992f-78298b16882d.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1729931574867-adf72c02-a630-4de4-9919-a7b9cf45e81a.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="pypro（python-version3-12）"><a href="#pypro（python-version3-12）" class="headerlink" title="pypro（python-version3.12）"></a>pypro（python-version3.12）</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730206348140-e9187c30-843c-4edd-9abf-f3a7e813e201.png" srcset="/img/loading.gif" lazyload>看到他是3.8以上的pyc，所以用pycdc来反编译</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730207450923-80459de4-ea4c-447f-b655-6666e186c470.png" srcset="/img/loading.gif" lazyload></p>
<p>这边不管使用uncompyle6还是pycdc都无法完全编译，使用pycdas查看字节码</p>
<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730208552292-f244735c-f026-4da4-b6b9-584a4b20b36e.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/42988179/1730209696722-d64b521b-6098-451a-a680-f48503b08a46.png" srcset="/img/loading.gif" lazyload></p>
<p>看到加密的有base64，AES，运算模式是ECB，填充类型是PKCS5</p>
<h3 id="上饶ctf-逆向-pvm-exe-pycdc-exe-反编译不了全部代码-CSDN博客"><a href="#上饶ctf-逆向-pvm-exe-pycdc-exe-反编译不了全部代码-CSDN博客" class="headerlink" title="上饶ctf 逆向 pvm.exe_pycdc.exe 反编译不了全部代码-CSDN博客"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42495210/article/details/140088389?ops_request_misc=%257B%2522request%255Fid%2522%253A%252296B93773-09C2-4AAD-B9A4-DA0BAEEC6B78%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=96B93773-09C2-4AAD-B9A4-DA0BAEEC6B78&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-140088389-null-null.142%5Ev100%5Epc_search_result_base6&utm_term=pycdc%20%E5%8F%8D%E7%BC%96%E8%AF%91%E4%B8%8D%E5%AE%8C%E6%95%B4&spm=1018.2226.3001.4187">上饶ctf 逆向 pvm.exe_pycdc.exe 反编译不了全部代码-CSDN博客</a></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><code class="hljs plain">File Name: PyPro.py<br>    Object Name: &lt;module&gt;<br>    Qualified Name: &lt;module&gt;<br>    Arg Count: 0<br>    Pos Only Arg Count: 0<br>    KW Only Arg Count: 0<br>    Stack Size: 2<br>    Flags: 0x00000000<br>    [Names]<br>        &#x27;base64&#x27;<br>        &#x27;Crypto.Cipher&#x27;<br>        &#x27;AES&#x27;<br>        &#x27;Crypto.Util.number&#x27;<br>        &#x27;long_to_bytes&#x27;<br>        &#x27;key&#x27;<br>        &#x27;PKCS5_pad&#x27;<br>        &#x27;main&#x27;<br>        &#x27;__name__&#x27;<br>    [Locals+Names]<br>    [Constants]<br>        0<br>        None<br>        (<br>            &#x27;AES&#x27;<br>        )<br>        (<br>            &#x27;long_to_bytes&#x27;<br>        )<br>        0x554B134A029DE539438BD18604BF114<br>        [Code]<br>            File Name: PyPro.py<br>            Object Name: PKCS5_pad<br>            Qualified Name: PKCS5_pad<br>            Arg Count: 1<br>            Pos Only Arg Count: 0<br>            KW Only Arg Count: 0<br>            Stack Size: 5<br>            Flags: 0x00000003 (CO_OPTIMIZED | CO_NEWLOCALS)<br>            [Names]<br>                &#x27;len&#x27;<br>                &#x27;ljust&#x27;<br>                &#x27;to_bytes&#x27;<br>            [Locals+Names]<br>                &#x27;data&#x27;<br>                &#x27;length&#x27;<br>            [Constants]<br>                None<br>                48<br>            [Disassembly]<br>                0       RESUME                          0<br>                2       LOAD_GLOBAL                     1: NULL + len<br>                12      LOAD_FAST                       0: data<br>                14      CALL                            1<br>                22      LOAD_CONST                      1: 48<br>                24      COMPARE_OP                      2 (&lt;)<br>                28      POP_JUMP_IF_FALSE               46 (to 122)<br>                30      LOAD_CONST                      1: 48<br>                32      LOAD_GLOBAL                     1: NULL + len<br>                42      LOAD_FAST                       0: data<br>                44      CALL                            1<br>                52      BINARY_OP                       10 (-)<br>                56      STORE_FAST                      1: length<br>                58      LOAD_FAST                       0: data<br>                60      LOAD_ATTR                       3: ljust<br>                80      LOAD_CONST                      1: 48<br>                82      LOAD_FAST                       1: length<br>                84      LOAD_ATTR                       5: to_bytes<br>                104     CALL                            0<br>                112     CALL                            2<br>                120     RETURN_VALUE                    <br>                122     RETURN_CONST                    0: None<br>        [Code]<br>            File Name: PyPro.py<br>            Object Name: main<br>            Qualified Name: main<br>            Arg Count: 0<br>            Pos Only Arg Count: 0<br>            KW Only Arg Count: 0<br>            Stack Size: 5<br>            Flags: 0x00000003 (CO_OPTIMIZED | CO_NEWLOCALS)<br>            [Names]<br>                &#x27;input&#x27;<br>                &#x27;encode&#x27;<br>                &#x27;len&#x27;<br>                &#x27;print&#x27;<br>                &#x27;range&#x27;<br>                &#x27;exit&#x27;<br>                &#x27;ord&#x27;<br>                &#x27;AES&#x27;<br>                &#x27;new&#x27;<br>                &#x27;long_to_bytes&#x27;<br>                &#x27;key&#x27;<br>                &#x27;MODE_ECB&#x27;<br>                &#x27;encrypt&#x27;<br>                &#x27;PKCS5_pad&#x27;<br>                &#x27;base64&#x27;<br>                &#x27;b64encode&#x27;<br>                &#x27;decode&#x27;<br>            [Locals+Names]<br>                &#x27;enc&#x27;<br>                &#x27;i&#x27;<br>                &#x27;chiper&#x27;<br>                &#x27;result&#x27;<br>                &#x27;data&#x27;<br>            [Constants]<br>                None<br>                &#x27;在这里输入你的flag:\n&#x27;<br>                &#x27;utf-8&#x27;<br>                44<br>                &#x27;length error!&#x27;<br>                123<br>                6<br>                &#x27;&#123;&#x27;<br>                -1<br>                &#x27;&#125;&#x27;<br>                &#x27;format error&#x27;<br>                1<br>                &#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;<br>                &#x27;flag正确&#x27;<br>                &#x27;错误&#x27;<br>            [Disassembly]<br>                0       RESUME                          0<br>                2       LOAD_GLOBAL                     1: NULL + input<br>                12      LOAD_CONST                      1: &#x27;在这里输入你的flag:\n&#x27;<br>                14      CALL                            1<br>                22      LOAD_ATTR                       3: encode<br>                42      LOAD_CONST                      2: &#x27;utf-8&#x27;<br>                44      CALL                            1<br>                52      STORE_FAST                      0: enc<br>                54      LOAD_GLOBAL                     5: NULL + len<br>                64      LOAD_FAST                       0: enc<br>                66      CALL                            1<br>                74      LOAD_CONST                      3: 44<br>                76      COMPARE_OP                      55 (!=)<br>                80      POP_JUMP_IF_FALSE               48 (to 178)<br>                82      LOAD_GLOBAL                     7: NULL + print<br>                92      LOAD_CONST                      4: &#x27;length error!&#x27;<br>                94      CALL                            1<br>                102     POP_TOP                         <br>                104     LOAD_GLOBAL                     9: NULL + range<br>                114     LOAD_GLOBAL                     5: NULL + len<br>                124     LOAD_FAST                       0: enc<br>                126     CALL                            1<br>                134     CALL                            1<br>                142     GET_ITER                        <br>                144     FOR_ITER                        2 (to 150)<br>                148     STORE_FAST                      1: i<br>                150     JUMP_BACKWARD                   4 (to 144)<br>                152     END_FOR                         <br>                154     LOAD_GLOBAL                     11: NULL + exit<br>                164     LOAD_CONST                      5: 123<br>                166     CALL                            1<br>                174     POP_TOP                         <br>                176     JUMP_FORWARD                    57 (to 292)<br>                178     LOAD_FAST                       0: enc<br>                180     LOAD_CONST                      6: 6<br>                182     BINARY_SUBSCR                   <br>                186     LOAD_GLOBAL                     13: NULL + ord<br>                196     LOAD_CONST                      7: &#x27;&#123;&#x27;<br>                198     CALL                            1<br>                206     COMPARE_OP                      55 (!=)<br>                210     POP_JUMP_IF_TRUE                17 (to 246)<br>                212     LOAD_FAST                       0: enc<br>                214     LOAD_CONST                      8: -1<br>                216     BINARY_SUBSCR                   <br>                220     LOAD_GLOBAL                     13: NULL + ord<br>                230     LOAD_CONST                      9: &#x27;&#125;&#x27;<br>                232     CALL                            1<br>                240     COMPARE_OP                      55 (!=)<br>                244     POP_JUMP_IF_FALSE               23 (to 292)<br>                246     LOAD_GLOBAL                     7: NULL + print<br>                256     LOAD_CONST                      10: &#x27;format error&#x27;<br>                258     CALL                            1<br>                266     POP_TOP                         <br>                268     LOAD_GLOBAL                     11: NULL + exit<br>                278     LOAD_CONST                      11: 1<br>                280     CALL                            1<br>                288     POP_TOP                         <br>                290     NOP                             <br>                292     LOAD_GLOBAL                     15: NULL + AES<br>                302     LOAD_ATTR                       16: new<br>                322     LOAD_GLOBAL                     19: NULL + long_to_bytes<br>                332     LOAD_GLOBAL                     20: key<br>                342     CALL                            1<br>                350     LOAD_GLOBAL                     14: AES<br>                360     LOAD_ATTR                       22: MODE_ECB<br>                380     CALL                            2<br>                388     STORE_FAST                      2: chiper<br>                390     LOAD_FAST                       2: chiper<br>                392     LOAD_ATTR                       25: encrypt<br>                412     LOAD_GLOBAL                     27: NULL + PKCS5_pad<br>                422     LOAD_FAST                       0: enc<br>                424     CALL                            1<br>                432     CALL                            1<br>                440     STORE_FAST                      0: enc<br>                442     LOAD_GLOBAL                     29: NULL + base64<br>                452     LOAD_ATTR                       30: b64encode<br>                472     LOAD_FAST                       0: enc<br>                474     CALL                            1<br>                482     STORE_FAST                      3: result<br>                484     LOAD_CONST                      12: &#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;<br>                486     STORE_FAST                      4: data<br>                488     LOAD_FAST                       3: result<br>                490     LOAD_ATTR                       33: decode<br>                510     CALL                            0<br>                518     LOAD_FAST                       4: data<br>                520     COMPARE_OP                      40 (==)<br>                524     POP_JUMP_IF_FALSE               12 (to 550)<br>                526     LOAD_GLOBAL                     7: NULL + print<br>                536     LOAD_CONST                      13: &#x27;flag正确&#x27;<br>                538     CALL                            1<br>                546     POP_TOP                         <br>                548     RETURN_CONST                    0: None<br>                550     LOAD_GLOBAL                     7: NULL + print<br>                560     LOAD_CONST                      14: &#x27;错误&#x27;<br>                562     CALL                            1<br>                570     POP_TOP                         <br>                572     RETURN_CONST                    0: None<br>        &#x27;__main__&#x27;<br>    [Disassembly]<br>        0       RESUME                          0<br>        2       LOAD_CONST                      0: 0<br>        4       LOAD_CONST                      1: None<br>        6       IMPORT_NAME                     0: base64<br>        8       STORE_NAME                      0: base64<br>        10      LOAD_CONST                      0: 0<br>        12      LOAD_CONST                      2: (&#x27;AES&#x27;,)<br>        14      IMPORT_NAME                     1: Crypto.Cipher<br>        16      IMPORT_FROM                     2: AES<br>        18      STORE_NAME                      2: AES<br>        20      POP_TOP                         <br>        22      LOAD_CONST                      0: 0<br>        24      LOAD_CONST                      3: (&#x27;long_to_bytes&#x27;,)<br>        26      IMPORT_NAME                     3: Crypto.Util.number<br>        28      IMPORT_FROM                     4: long_to_bytes<br>        30      STORE_NAME                      4: long_to_bytes<br>        32      POP_TOP                         <br>        34      LOAD_CONST                      4: 0x554B134A029DE539438BD18604BF114<br>        36      STORE_NAME                      5: key<br>        38      LOAD_CONST                      5: &lt;CODE&gt; PKCS5_pad<br>        40      MAKE_FUNCTION                   0<br>        42      STORE_NAME                      6: PKCS5_pad<br>        44      LOAD_CONST                      6: &lt;CODE&gt; main<br>        46      MAKE_FUNCTION                   0<br>        48      STORE_NAME                      7: main<br>        50      LOAD_NAME                       8: __name__<br>        52      LOAD_CONST                      7: &#x27;__main__&#x27;<br>        54      COMPARE_OP                      40 (==)<br>        58      POP_JUMP_IF_FALSE               8 (to 76)<br>        60      PUSH_NULL                       <br>        62      LOAD_NAME                       7: main<br>        64      CALL                            0<br>        72      POP_TOP                         <br>        74      RETURN_CONST                    1: None<br>        76      RETURN_CONST                    1: None<br></code></pre></td></tr></table></figure>

<p>拿出所有字节码看看，看到数据了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs plain">根据以上的详细字节码反编译信息，我们可以还原并分析Python代码的逻辑。以下是逐步的还原代码和各部分的解释：<br><br>```python<br>import base64<br>from Crypto.Cipher import AES<br>from Crypto.Util.number import long_to_bytes<br><br># 定义AES的密钥，用于对输入的数据进行加密<br>key = 0x554B134A029DE539438BD18604BF114<br><br># PKCS5填充函数，用于确保数据长度是AES块大小的倍数（48字节）<br>def PKCS5_pad(data):<br>    if len(data) &lt; 48:<br>        length = 48 - len(data)<br>        # 将数据填充到48字节<br>        return data + bytes([length] * length)  <br>    return data<br><br>def main():<br>    # 获取用户输入的flag并编码成utf-8格式<br>    enc = input(&#x27;在这里输入你的flag:\n&#x27;).encode(&#x27;utf-8&#x27;)<br><br>    # 检查输入的长度是否为44字节<br>    if len(enc) != 44:<br>        print(&#x27;length error!&#x27;)<br>        for i in range(len(enc)):<br>            pass  # 此处的循环没有实际操作<br>        exit(123)  # 长度错误时退出<br><br>    # 确保flag以特定的字符&#x27;&#123;&#x27;开头和&#x27;&#125;&#x27;结尾<br>    if ord(enc[6]) != ord(&#x27;&#123;&#x27;) or ord(enc[-1]) != ord(&#x27;&#125;&#x27;):<br>        print(&#x27;format error&#x27;)<br>        exit(1)  # 格式错误时退出<br><br>    # 创建AES加密对象，使用ECB模式（Electronic Codebook）<br>    cipher = AES.new(long_to_bytes(key, 16), AES.MODE_ECB)<br>    <br>    # 对输入进行PKCS5填充并加密<br>    encrypted = cipher.encrypt(PKCS5_pad(enc))<br>    <br>    # 将加密结果进行Base64编码<br>    result = base64.b64encode(encrypted)<br>    <br>    # 预定义的加密验证数据<br>    expected_data = &#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;<br><br>    # 将结果解码为字符串并与预期数据进行比较<br>    if result.decode() == expected_data:<br>        print(&#x27;flag正确&#x27;)<br>    else:<br>        print(&#x27;错误&#x27;)<br><br>if __name__ == &#x27;__main__&#x27;:<br>    main()<br></code></pre></td></tr></table></figure>

<h3 id="分析说明"><a href="#分析说明" class="headerlink" title="分析说明"></a>分析说明</h3><ol>
<li><strong>密钥</strong>：<code>key</code>是一个16字节的AES密钥，以十六进制表示，并在程序中使用。</li>
<li><strong>PKCS5填充</strong>：<code>PKCS5_pad</code>函数确保数据的长度达到48字节，填充方式是将缺少的字节用填充值填充。</li>
<li><strong>输入验证</strong>：<ul>
<li>输入的<code>flag</code>必须为44字节长度，不符合长度则直接报错退出。</li>
<li>验证<code>flag</code>的第7个字符为<code>&#39;&#123;&#39;</code>，且最后一个字符为<code>&#39;&#125;&#39;</code>，否则退出并提示格式错误。</li>
</ul>
</li>
<li><strong>AES加密</strong>：<ul>
<li>使用AES ECB模式加密填充后的数据，最终生成密文。</li>
</ul>
</li>
<li><strong>Base64编码和比较</strong>：<ul>
<li>对密文进行Base64编码，将编码结果与预期的字符串<code>expected_data</code>进行比较。</li>
<li>如果匹配，输出“flag正确”；否则输出“错误”。</li>
</ul>
</li>
</ol>
<h3 id="字节码中的细节"><a href="#字节码中的细节" class="headerlink" title="字节码中的细节"></a>字节码中的细节</h3><ul>
<li>反编译时的<code>JUMP_BACKWARD</code>和其他字节码指令实现了长度和格式的验证逻辑，以及字符位置的条件检查。</li>
<li>出现的部分冗余指令可以忽略，因为它们不影响核心逻辑的理解和执行。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>来点chat<br><br>```plain<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-comment"># 定义AES的密钥</span><br>key = <span class="hljs-number">0x554B134A029DE539438BD18604BF114</span><br><br><br><span class="hljs-comment"># PKCS5填充去填充函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PKCS5_unpad</span>(<span class="hljs-params">data</span>):<br>    <span class="hljs-comment"># 获取最后一个字节的值，它表示填充的字节数</span><br>    padding_length = data[-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">return</span> data[:-padding_length]  <span class="hljs-comment"># 返回去掉填充的内容</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">enc_data</span>):<br>    <span class="hljs-comment"># 对Base64编码的数据进行解码</span><br>    encrypted_data = base64.b64decode(enc_data)<br><br>    <span class="hljs-comment"># 创建AES解密对象，使用ECB模式</span><br>    cipher = AES.new(long_to_bytes(key, <span class="hljs-number">16</span>), AES.MODE_ECB)<br><br>    <span class="hljs-comment"># 解密数据</span><br>    decrypted_data = cipher.decrypt(encrypted_data)<br><br>    <span class="hljs-comment"># 去掉PKCS5填充</span><br>    <span class="hljs-keyword">return</span> PKCS5_unpad(decrypted_data)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># 这里替换为需要解密的Base64字符串</span><br>    encrypted_flag = <span class="hljs-string">&#x27;2e8Ugcv8lKVhL3gkv3grJGNE3UqkjlvKqCgJSGRNHHEk98Kd0wv6s60GpAUsU+8Q&#x27;</span><br><br>    <span class="hljs-comment"># 调用解密函数</span><br>    decrypted_flag = decrypt(encrypted_flag)<br><br>    <span class="hljs-comment"># 输出解密结果</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;解密后的flag:&#x27;</span>, decrypted_flag.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1730209896862-3adfe5c5-9adc-4573-a4a0-35c41e8e980d.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="MineSweeper"><a href="#MineSweeper" class="headerlink" title="MineSweeper"></a>MineSweeper</h2><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="caeser"><a href="#caeser" class="headerlink" title="caeser"></a>caeser</h2><p>直接爆破</p>
<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><p><img src="https://raw.githubusercontent.com/xiaaaqqqyue/blogImage/main/img/1728374713484-2a33a21a-52b5-4f46-882e-c813467a6602.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/2024%E6%AF%94%E8%B5%9B/" class="print-no-link">#2024比赛</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>0xGAME 2024</div>
      <div>http://example.com/2025/03/29/0xGame 2024/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>chaye</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>March 29, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/03/29/6.1%20%E6%A0%A1%E8%B5%9B/" title="校赛 6.1">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">校赛 6.1</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/26/metaploit%E6%8C%87%E4%BB%A4%E4%BD%BF%E7%94%A8/" title="Metasploit控制端接口命令">
                        <span class="hidden-mobile">Metasploit控制端接口命令</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
